(self.webpackChunknx_bridge=self.webpackChunknx_bridge||[]).push([[179],{4928:t=>{function e(t){return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=()=>[],e.resolve=e,e.id=4928,t.exports=e},3089:(t,e,n)=>{"use strict";var r=n(1116),i=n(5366);class s extends r.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class o extends s{static makeCurrent(){(0,r.HT)(new o)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=(l=l||document.querySelector("base"),l?l.getAttribute("href"):null);return null==e?null:function(t){a=a||document.createElement("a"),a.setAttribute("href",t);const e=a.pathname;return"/"===e.charAt(0)?e:`/${e}`}(e)}resetBaseElement(){l=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return(0,r.Mx)(document.cookie,t)}}let a,l=null;const c=new i.OlP("TRANSITION_ID"),u=[{provide:i.ip1,useFactory:function(t,e,n){return()=>{n.get(i.CZH).donePromise.then(()=>{const n=(0,r.q)();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[c,r.K0,i.zs3],multi:!0}];class h{static init(){(0,i.VLi)(new h)}addToWindow(t){i.dqk.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},i.dqk.getAllAngularTestabilities=()=>t.getAllTestabilities(),i.dqk.getAllAngularRootElements=()=>t.getAllRootElements(),i.dqk.frameworkStabilizers||(i.dqk.frameworkStabilizers=[]),i.dqk.frameworkStabilizers.push(t=>{const e=i.dqk.getAllAngularTestabilities();let n=e.length,r=!1;const s=function(e){r=r||e,n--,0==n&&t(r)};e.forEach(function(t){t.whenStable(s)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const i=t.getTestability(e);return null!=i?i:n?(0,r.q)().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let d=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const f=new i.OlP("EventManagerPlugins");let p=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(f),i.LFG(i.R0b))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class m{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const i=(0,r.q)().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,n)}}let g=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),y=(()=>{class t extends g{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,e,n){t.forEach(t=>{const r=this._doc.createElement("style");r.textContent=t,n.push(e.appendChild(r))})}addHost(t){const e=[];this._addStylesToHost(this._stylesSet,t,e),this._hostNodes.set(t,e)}removeHost(t){const e=this._hostNodes.get(t);e&&e.forEach(_),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((e,n)=>{this._addStylesToHost(t,n,e)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(_))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(r.K0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function _(t){(0,r.q)().remove(t)}const v={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},b=/%COMP%/g;function w(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?w(t,i,n):(i=i.replace(b,t),n.push(i))}return n}function x(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let S=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new E(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case i.ifc.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new A(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case i.ifc.ShadowDom:return new T(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=w(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(p),i.LFG(y),i.LFG(i.AFp))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class E{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(v[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=v[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=v[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(i.JOm.DashCase|i.JOm.Important)?t.style.setProperty(e,n,r&i.JOm.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&i.JOm.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,x(n)):this.eventManager.addEventListener(t,e,x(n))}}class A extends E{constructor(t,e,n,r){super(t),this.component=n;const i=w(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(b,r+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(b,r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class T extends E{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=w(r.id,r.styles,[]);for(let s=0;s<i.length;s++){const t=document.createElement("style");t.textContent=i[s],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let C=(()=>{class t extends m{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(r.K0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const M=["alt","control","meta","shift"],O={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},P={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},D={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let R=(()=>{class t extends m{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,i){const s=t.parseEventName(n),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,r.q)().onAndCancel(e,s.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let s="";if(M.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),s+=t+".")}),s+=i,0!=n.length||0===i.length)return null;const o={};return o.domEventName=r,o.fullKey=s,o}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&P.hasOwnProperty(e)&&(e=P[e]))}return O[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),M.forEach(r=>{r!=n&&(0,D[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(r.K0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const L=(0,i.eFA)(i._c5,"browser",[{provide:i.Lbi,useValue:r.bD},{provide:i.g9A,useValue:function(){o.makeCurrent(),h.init()},multi:!0},{provide:r.K0,useFactory:function(){return(0,i.RDi)(document),document},deps:[]}]),I=[[],{provide:i.zSh,useValue:"root"},{provide:i.qLn,useFactory:function(){return new i.qLn},deps:[]},{provide:f,useClass:C,multi:!0,deps:[r.K0,i.R0b,i.Lbi]},{provide:f,useClass:R,multi:!0,deps:[r.K0]},[],{provide:S,useClass:S,deps:[p,y,i.AFp]},{provide:i.FYo,useExisting:S},{provide:g,useExisting:y},{provide:y,useClass:y,deps:[r.K0]},{provide:i.dDg,useClass:i.dDg,deps:[i.R0b]},{provide:p,useClass:p,deps:[f,i.R0b]},{provide:r.JF,useClass:d,deps:[]},[]];let N=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:i.AFp,useValue:e.appId},{provide:c,useExisting:i.AFp},u]}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(t,12))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:I,imports:[r.ez,i.hGG]}),t})();"undefined"!=typeof window&&window;var k=n(3714);let F=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["nx-bridge-root"]],decls:2,vars:0,template:function(t,e){1&t&&(i.TgZ(0,"main"),i._UZ(1,"router-outlet"),i.qZA())},directives:[k.lC],styles:[""]}),t})();var B=n(9878),j=n(4812),U=n(9474),V=n(2728);const z="@ngrx/router-store/request",$=((0,B.PH)(z,(0,B.Ky)()),"@ngrx/router-store/navigation"),H=((0,B.PH)($,(0,B.Ky)()),"@ngrx/router-store/cancel"),G=((0,B.PH)(H,(0,B.Ky)()),"@ngrx/router-store/error"),W=((0,B.PH)(G,(0,B.Ky)()),"@ngrx/router-store/navigated");(0,B.PH)(W,(0,B.Ky)());class q{}class Z{serialize(t){return{root:this.serializeRoute(t.root),url:t.url}}serializeRoute(t){const e=t.children.map(t=>this.serializeRoute(t));return{params:t.params,paramMap:t.paramMap,data:t.data,url:t.url,outlet:t.outlet,routeConfig:t.routeConfig?{component:t.routeConfig.component,path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet}:null,queryParams:t.queryParams,queryParamMap:t.queryParamMap,fragment:t.fragment,component:t.routeConfig?t.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:e[0],pathFromRoot:void 0,children:e}}}class Y{serialize(t){return{root:this.serializeRoute(t.root),url:t.url}}serializeRoute(t){const e=t.children.map(t=>this.serializeRoute(t));return{params:t.params,data:t.data,url:t.url,outlet:t.outlet,routeConfig:t.routeConfig?{path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet}:null,queryParams:t.queryParams,fragment:t.fragment,firstChild:e[0],children:e}}}var J=function(t){return t[t.PreActivation=1]="PreActivation",t[t.PostActivation=2]="PostActivation",t}({});const K=new i.OlP("@ngrx/router-store Internal Configuration"),X=new i.OlP("@ngrx/router-store Configuration");function Q(t){return Object.assign({stateKey:"router",serializer:Y,navigationActionTiming:J.PreActivation},t)}var tt=function(t){return t[t.NONE=1]="NONE",t[t.ROUTER=2]="ROUTER",t[t.STORE=3]="STORE",t}({});let et=(()=>{class t{constructor(t,e,n,r,s,o){this.store=t,this.router=e,this.serializer=n,this.errorHandler=r,this.config=s,this.activeRuntimeChecks=o,this.lastEvent=null,this.routerState=null,this.trigger=tt.NONE,this.stateKey=this.config.stateKey,!(0,B.rM)()&&(0,i.X6Q)()&&((null==o?void 0:o.strictActionSerializability)||(null==o?void 0:o.strictStateSerializability))&&this.serializer instanceof Z&&console.warn("@ngrx/router-store: The serializability runtime checks cannot be enabled with the DefaultRouterStateSerializer. The default serializer has an unserializable router state and actions that are not serializable. To use the serializability runtime checks either use the MinimalRouterStateSerializer or implement a custom router state serializer. This also applies to Ivy with immutability runtime checks."),this.setUpStoreStateListener(),this.setUpRouterEventsListener()}static forRoot(e={}){return{ngModule:t,providers:[{provide:K,useValue:e},{provide:X,useFactory:Q,deps:[K]},{provide:q,useClass:e.serializer?e.serializer:0===e.routerState?Z:Y}]}}setUpStoreStateListener(){this.store.pipe((0,B.Ys)(this.stateKey),(0,V.M)(this.store)).subscribe(([t,e])=>{this.navigateIfNeeded(t,e)})}navigateIfNeeded(t,e){if(!t||!t.state)return;if(this.trigger===tt.ROUTER)return;if(this.lastEvent instanceof k.OD)return;const n=t.state.url;var r;r=n,nt(this.router.url)!==nt(r)&&(this.storeState=e,this.trigger=tt.STORE,this.router.navigateByUrl(n).catch(t=>{this.errorHandler.handleError(t)}))}setUpRouterEventsListener(){const t=this.config.navigationActionTiming===J.PostActivation;let e;this.router.events.pipe((0,V.M)(this.store)).subscribe(([n,r])=>{this.lastEvent=n,n instanceof k.OD?(this.routerState=this.serializer.serialize(this.router.routerState.snapshot),this.trigger!==tt.STORE&&(this.storeState=r,this.dispatchRouterRequest(n))):n instanceof k.R9?(e=n,t||this.trigger===tt.STORE||this.dispatchRouterNavigation(n)):n instanceof k.gk?(this.dispatchRouterCancel(n),this.reset()):n instanceof k.Q3?(this.dispatchRouterError(n),this.reset()):n instanceof k.m2&&(this.trigger!==tt.STORE&&(t&&this.dispatchRouterNavigation(e),this.dispatchRouterNavigated(n)),this.reset())})}dispatchRouterRequest(t){this.dispatchRouterAction(z,{event:t})}dispatchRouterNavigation(t){const e=this.serializer.serialize(t.state);this.dispatchRouterAction($,{routerState:e,event:new k.R9(t.id,t.url,t.urlAfterRedirects,e)})}dispatchRouterCancel(t){this.dispatchRouterAction(H,{storeState:this.storeState,event:t})}dispatchRouterError(t){this.dispatchRouterAction(G,{storeState:this.storeState,event:new k.Q3(t.id,t.url,`${t}`)})}dispatchRouterNavigated(t){const e=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction(W,{event:t,routerState:e})}dispatchRouterAction(t,e){this.trigger=tt.ROUTER;try{this.store.dispatch({type:t,payload:Object.assign(Object.assign({routerState:this.routerState},e),{event:0===this.config.routerState?e.event:{id:e.event.id,url:e.event.url,urlAfterRedirects:e.event.urlAfterRedirects}})})}finally{this.trigger=tt.NONE}}reset(){this.trigger=tt.NONE,this.storeState=null,this.routerState=null}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(B.yh),i.LFG(k.F0),i.LFG(q),i.LFG(i.qLn),i.LFG(X),i.LFG(B.hg))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();function nt(t){return t.length>0&&"/"===t[t.length-1]?t.substring(0,t.length-1):t}const rt=[{path:"",redirectTo:`/${n(8651).rF}`,pathMatch:"full"},{path:"replays",loadChildren:()=>Promise.resolve().then(n.bind(n,2895)).then(t=>t.ReplayViewerModule)}];let it=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[k.Bz.forRoot(rt,{preloadingStrategy:k.wm})],k.Bz]}),t})();class st{}const ot="*";function at(t,e=null){return{type:2,steps:t,options:e}}function lt(t){return{type:6,styles:t,offset:null}}function ct(t){Promise.resolve(null).then(t)}class ut{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){ct(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class ht{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const i=this.players.length;0==i?ct(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==i&&this._onFinish()}),t.onDestroy(()=>{++n==i&&this._onDestroy()}),t.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){const t=this.players.reduce((t,e)=>null===t||e.totalTime>t.totalTime?e:t,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}function dt(){return"undefined"!=typeof window&&void 0!==window.document}function ft(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function pt(t){switch(t.length){case 0:return new ut;case 1:return t[0];default:return new ht(t)}}function mt(t,e,n,r,i={},s={}){const o=[],a=[];let l=-1,c=null;if(r.forEach(t=>{const n=t.offset,r=n==l,u=r&&c||{};Object.keys(t).forEach(n=>{let r=n,a=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,o),a){case"!":a=i[n];break;case ot:a=s[n];break;default:a=e.normalizeStyleValue(n,r,a,o)}u[r]=a}),r||a.push(u),c=u,l=n}),o.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${o.join(t)}`)}return a}function gt(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&yt(n,"start",t)));break;case"done":t.onDone(()=>r(n&&yt(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&yt(n,"destroy",t)))}}function yt(t,e,n){const r=n.totalTime,i=_t(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),s=t._data;return null!=s&&(i._data=s),i}function _t(t,e,n,r,i="",s=0,o){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function vt(t,e,n){let r;return t instanceof Map?(r=t.get(e),r||t.set(e,r=n)):(r=t[e],r||(r=t[e]=n)),r}function bt(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let wt=(t,e)=>!1,xt=(t,e)=>!1,St=(t,e,n)=>[];const Et=ft();(Et||"undefined"!=typeof Element)&&(wt=dt()?(t,e)=>{for(;e&&e!==document.documentElement;){if(e===t)return!0;e=e.parentNode||e.host}return!1}:(t,e)=>t.contains(e),xt=(()=>{if(Et||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):xt}})(),St=(t,e,n)=>{let r=[];if(n){const n=t.querySelectorAll(e);for(let t=0;t<n.length;t++)r.push(n[t])}else{const n=t.querySelector(e);n&&r.push(n)}return r});let At=null,Tt=!1;function Ct(t){At||(At=("undefined"!=typeof document?document.body:null)||{},Tt=!!At.style&&"WebkitAppearance"in At.style);let e=!0;return At.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in At.style,!e&&Tt)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in At.style),e}const Mt=xt,Ot=wt,Pt=St;function Dt(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}let Rt=(()=>{class t{validateStyleProperty(t){return Ct(t)}matchesElement(t,e){return Mt(t,e)}containsElement(t,e){return Ot(t,e)}query(t,e,n){return Pt(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,i,s=[],o){return new ut(n,r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Lt=(()=>{class t{}return t.NOOP=new Rt,t})();const It="ng-enter",Nt="ng-leave",kt="ng-trigger",Ft=".ng-trigger",Bt="ng-animating",jt=".ng-animating";function Ut(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Vt(parseFloat(e[1]),e[2])}function Vt(t,e){switch(e){case"s":return 1e3*t;default:return t}}function zt(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,i=0,s="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=Vt(parseFloat(n[1]),n[2]);const o=n[3];null!=o&&(i=Vt(parseFloat(o),n[4]));const a=n[5];a&&(s=a)}else r=t;if(!n){let n=!1,s=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(s,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:i,easing:s}}(t,e,n)}function $t(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function Ht(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else $t(t,n);return n}function Gt(t,e,n){return n?e+":"+n+";":""}function Wt(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=Gt(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=Gt(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function qt(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=ee(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),ft()&&Wt(t))}function Zt(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=ee(e);t.style[n]=""}),ft()&&Wt(t))}function Yt(t){return Array.isArray(t)?1==t.length?t[0]:at(t):t}const Jt=new RegExp("{{\\s*(.+?)\\s*}}","g");function Kt(t){let e=[];if("string"==typeof t){let n;for(;n=Jt.exec(t);)e.push(n[1]);Jt.lastIndex=0}return e}function Xt(t,e,n){const r=t.toString(),i=r.replace(Jt,(t,r)=>{let i=e[r];return e.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?t:i}function Qt(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const te=/-+([a-z0-9])/g;function ee(t){return t.replace(te,(...t)=>t[1].toUpperCase())}function ne(t,e){return 0===t||0===e}function re(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let s=e[0],o=[];if(r.forEach(t=>{s.hasOwnProperty(t)||o.push(t),s[t]=n[t]}),o.length)for(var i=1;i<e.length;i++){let n=e[i];o.forEach(function(e){n[e]=se(t,e)})}}return e}function ie(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function se(t,e){return window.getComputedStyle(t)[e]}const oe="*";function ae(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const i=r[1],s=r[2],o=r[3];e.push(ue(i,o)),"<"!=s[0]||i==oe&&o==oe||e.push(ue(o,i))}(t,n,e)):n.push(t),n}const le=new Set(["true","1"]),ce=new Set(["false","0"]);function ue(t,e){const n=le.has(t)||ce.has(t),r=le.has(e)||ce.has(e);return(i,s)=>{let o=t==oe||t==i,a=e==oe||e==s;return!o&&n&&"boolean"==typeof i&&(o=i?le.has(t):ce.has(t)),!a&&r&&"boolean"==typeof s&&(a=s?le.has(e):ce.has(e)),o&&a}}const he=new RegExp("s*:selfs*,?","g");function de(t,e,n){return new fe(t).build(e,n)}class fe{constructor(t){this._driver=t}build(t,e){const n=new pe(e);return this._resetContextStyleTimingState(n),ie(this,Yt(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const i=[],s=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,i.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const i=this.visitTransition(t,e);n+=i.queryCount,r+=i.depCount,s.push(i)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:i,transitions:s,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const i=new Set,s=r||{};if(n.styles.forEach(t=>{if(me(t)){const e=t;Object.keys(e).forEach(t=>{Kt(e[t]).forEach(t=>{s.hasOwnProperty(t)||i.add(t)})})}}),i.size){const n=Qt(i.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=ie(this,Yt(t.animation),e);return{type:1,matchers:ae(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:ge(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>ie(this,t,e)),options:ge(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const i=t.steps.map(t=>{e.currentTime=n;const i=ie(this,t,e);return r=Math.max(r,e.currentTime),i});return e.currentTime=r,{type:3,steps:i,options:ge(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return ye(zt(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=ye(0,0,"");return t.dynamic=!0,t.strValue=r,t}return n=n||zt(r,e),ye(n.duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let i=t.styles?t.styles:lt({});if(5==i.type)r=this.visitKeyframes(i,e);else{let i=t.styles,s=!1;if(!i){s=!0;const t={};n.easing&&(t.easing=n.easing),i=lt(t)}e.currentTime+=n.duration+n.delay;const o=this.visitStyle(i,e);o.isEmptyStep=s,r=o}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?t==ot?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,i=null;return n.forEach(t=>{if(me(t)){const e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,i=e.currentTime;n&&i>0&&(i-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const s=e.collectedStyles[e.currentQuerySelector],o=s[n];let a=!0;o&&(i!=r&&i>=o.startTime&&r<=o.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),a=!1),i=o.startTime),a&&(s[n]={startTime:i,endTime:r}),e.options&&function(t,e,n){const r=e.params||{},i=Kt(t);i.length&&i.forEach(t=>{r.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let s=!1,o=!1,a=0;const l=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let l=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(me(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(me(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),c=0;return null!=l&&(r++,c=n.offset=l),o=o||c<0||c>1,s=s||c<a,a=c,i.push(c),n});o&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&e.errors.push("Please ensure that all keyframe offsets are in order");const c=t.steps.length;let u=0;r>0&&r<c?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(u=1/(c-1));const h=c-1,d=e.currentTime,f=e.currentAnimateTimings,p=f.duration;return l.forEach((t,r)=>{const s=u>0?r==h?1:u*r:i[r],o=s*p;e.currentTime=d+f.delay+o,f.duration=o,this._validateStyleAst(t,e),t.offset=s,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:ie(this,Yt(t.animation),e),options:ge(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:ge(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:ge(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[i,s]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(he,"")),[t=t.replace(/@\*/g,Ft).replace(/@\w+/g,t=>".ng-trigger-"+t.substr(1)).replace(/:animating/g,jt),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+i:i,vt(e.collectedStyles,e.currentQuerySelector,{});const o=ie(this,Yt(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:o,originalSelector:t.selector,options:ge(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:zt(t.timings,e.errors,!0);return{type:12,animation:ie(this,Yt(t.animation),e),timings:n,options:null}}}class pe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function me(t){return!Array.isArray(t)&&"object"==typeof t}function ge(t){var e;return t?(t=$t(t)).params&&(t.params=(e=t.params)?$t(e):null):t={},t}function ye(t,e,n){return{duration:t,delay:e,easing:n}}function _e(t,e,n,r,i,s,o=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class ve{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const be=new RegExp(":enter","g"),we=new RegExp(":leave","g");function xe(t,e,n,r,i,s={},o={},a,l,c=[]){return(new Se).buildKeyframes(t,e,n,r,i,s,o,a,l,c)}class Se{buildKeyframes(t,e,n,r,i,s,o,a,l,c=[]){l=l||new ve;const u=new Ae(t,e,l,r,i,c,[]);u.options=a,u.currentTimeline.setStyles([s],null,u.errors,a),ie(this,n,u);const h=u.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(o).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([o],null,u.errors,a)}return h.length?h.map(t=>t.buildKeyframes()):[_e(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,s=this._visitSubInstructions(n,r,r.options);i!=s&&e.transformIntoNewTimeline(s)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const i=null!=n.duration?Ut(n.duration):null,s=null!=n.delay?Ut(n.delay):null;return 0!==i&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,i,s);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),ie(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const i=t.options;if(i&&(i.params||i.delay)&&(r=e.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Ee);const t=Ut(i.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>ie(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Ut(t.options.delay):0;t.steps.forEach(s=>{const o=e.createSubContext(t.options);i&&o.delayNextStep(i),ie(this,s,o),r=Math.max(r,o.currentTimeline.currentTime),n.push(o.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return zt(e.params?Xt(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,s=e.createSubContext().currentTimeline;s.easing=n.easing,t.styles.forEach(t=>{s.forwardTime((t.offset||0)*i),s.setStyles(t.styles,t.easing,e.errors,e.options),s.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(s),e.transformIntoNewTimeline(r+i),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},i=r.delay?Ut(r.delay):0;i&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Ee);let s=n;const o=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=o.length;let a=null;o.forEach((n,r)=>{e.currentQueryIndex=r;const o=e.createSubContext(t.options,n);i&&o.delayNextStep(i),n===e.element&&(a=o.currentTimeline),ie(this,t.animation,o),o.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,o.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),a&&(e.currentTimeline.mergeTimelineCollectedStyles(a),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,i=t.timings,s=Math.abs(i.duration),o=s*(e.currentQueryTotal-1);let a=s*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":a=o-a;break;case"full":a=n.currentStaggerTime}const l=e.currentTimeline;a&&l.delayNextStep(a);const c=l.currentTime;ie(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}const Ee={};class Ae{constructor(t,e,n,r,i,s,o,a){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=s,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Ee,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new Te(this._driver,e,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=Ut(n.duration)),null!=n.delay&&(r.delay=Ut(n.delay));const i=n.params;if(i){let t=r.params;t||(t=this.options.params={}),Object.keys(i).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=Xt(i[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,i=new Ae(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=Ee,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new Ce(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,i,s){let o=[];if(r&&o.push(this.element),t.length>0){t=(t=t.replace(be,"."+this._enterClassName)).replace(we,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),o.push(...e)}return i||0!=o.length||s.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),o}}class Te{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new Te(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||ot,this._currentKeyframe[t]=ot}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const i=r&&r.params||{},s=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e),r.forEach(t=>{n[t]=ot})):Ht(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(s).forEach(t=>{const e=Xt(s[t],i,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:ot),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,s)=>{const o=Ht(i,!0);Object.keys(o).forEach(n=>{const r=o[n];"!"==r?t.add(n):r==ot&&e.add(n)}),n||(o.offset=s/this.duration),r.push(o)});const i=t.size?Qt(t.values()):[],s=e.size?Qt(e.values()):[];if(n){const t=r[0],e=$t(t);t.offset=0,e.offset=1,r=[t,e]}return _e(this.element,r,i,s,this.duration,this.startTime,this.easing,!1)}}class Ce extends Te{constructor(t,e,n,r,i,s,o=!1){super(t,e,s.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=o,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],s=n+e,o=e/s,a=Ht(t[0],!1);a.offset=0,i.push(a);const l=Ht(t[0],!1);l.offset=Me(o),i.push(l);const c=t.length-1;for(let r=1;r<=c;r++){let o=Ht(t[r],!1);o.offset=Me((e+o.offset*n)/s),i.push(o)}n=s,e=0,r="",t=i}return _e(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function Me(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class Oe{}class Pe extends Oe{normalizePropertyName(t,e){return ee(t)}normalizeStyleValue(t,e,n,r){let i="";const s=n.toString().trim();if(De[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return s+i}}const De=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Re(t,e,n,r,i,s,o,a,l,c,u,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}const Le={};class Ie{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,i){return t.some(t=>t(e,n,r,i))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],i=this._stateStyles[t],s=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):s}build(t,e,n,r,i,s,o,a,l,c){const u=[],h=this.ast.options&&this.ast.options.params||Le,d=this.buildStyles(n,o&&o.params||Le,u),f=a&&a.params||Le,p=this.buildStyles(r,f,u),m=new Set,g=new Map,y=new Map,_="void"===r,v={params:Object.assign(Object.assign({},h),f)},b=c?[]:xe(t,e,this.ast.animation,i,s,d,p,v,l,u);let w=0;if(b.forEach(t=>{w=Math.max(t.duration+t.delay,w)}),u.length)return Re(e,this._triggerName,n,r,_,d,p,[],[],g,y,w,u);b.forEach(t=>{const n=t.element,r=vt(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const i=vt(y,n,{});t.postStyleProps.forEach(t=>i[t]=!0),n!==e&&m.add(n)});const x=Qt(m.values());return Re(e,this._triggerName,n,r,_,d,p,b,x,g,y,w)}}class Ne{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=$t(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const i=t;Object.keys(i).forEach(t=>{let s=i[t];s.length>1&&(s=Xt(s,r,e)),n[t]=s})}}),n}}class ke{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new Ne(t.style,t.options&&t.options.params||{})}),Fe(this.states,"true","1"),Fe(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new Ie(t,e,this.states))}),this.fallbackTransition=new Ie(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(i=>i.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function Fe(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const Be=new ve;class je{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=de(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,i=mt(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],i=this._animations[t];let s;const o=new Map;if(i?(s=xe(this._driver,e,i,It,Nt,{},{},n,Be,r),s.forEach(t=>{const e=vt(o,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),s=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);o.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,ot)})});const a=pt(s.map(t=>{const e=o.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=a,a.onDestroy(()=>this.destroy(t)),this.players.push(a),a}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,r){const i=_t(e,"","","");return gt(this._getPlayer(t),n,i,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const Ue="ng-animate-queued",Ve="ng-animate-disabled",ze=".ng-animate-disabled",$e=[],He={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Ge={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class We{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=null!=(r=n?t.value:t)?r:null,n){const e=$t(t);delete e.value,this.options=e}else this.options={};var r;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const qe="void",Ze=new We(qe);class Ye{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,nn(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var i;const s=vt(this._elementListeners,t,[]),o={name:e,phase:n,callback:r};s.push(o);const a=vt(this._engine.statesByElement,t,{});return a.hasOwnProperty(e)||(nn(t,kt),nn(t,"ng-trigger-"+e),a[e]=Ze),()=>{this._engine.afterFlush(()=>{const t=s.indexOf(o);t>=0&&s.splice(t,1),this._triggers[e]||delete a[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const i=this._getTrigger(e),s=new Ke(this.id,e,t);let o=this._engine.statesByElement.get(t);o||(nn(t,kt),nn(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,o={}));let a=o[e];const l=new We(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),o[e]=l,a||(a=Ze),l.value!==qe&&a.value===l.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(a.params,l.params)){const e=[],n=i.matchStyles(a.value,a.params,e),r=i.matchStyles(l.value,l.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{Zt(t,n),qt(t,r)})}return}const c=vt(this._engine.playersByElement,t,[]);c.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let u=i.matchTransition(a.value,l.value,t,l.params),h=!1;if(!u){if(!r)return;u=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:u,fromState:a,toState:l,player:s,isFallbackTransition:h}),h||(nn(t,Ue),s.onStart(()=>{rn(t,Ue)})),s.onDone(()=>{let e=this.players.indexOf(s);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(s);t>=0&&n.splice(t,1)}}),this.players.push(s),c.push(s),s}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,Ft,!0);n.forEach(t=>{if(t.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(t=>this.clearElementCache(t)))}triggerLeaveAnimation(t,e,n,r){const i=this._engine.statesByElement.get(t);if(i){const s=[];if(Object.keys(i).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,qe,r);n&&s.push(n)}}),s.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&pt(s).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const r=new Set;e.forEach(e=>{const i=e.name;if(r.has(i))return;r.add(i);const s=this._triggers[i].fallbackTransition,o=n[i]||Ze,a=new We(qe),l=new Ke(this.id,i,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:i,transition:s,fromState:o,toState:a,player:l,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const r=t.__ng_removed;r&&r!==He||(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){nn(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,s=this._elementListeners.get(i);s&&s.forEach(e=>{if(e.name==n.triggerName){const r=_t(i,n.triggerName,n.fromState.value,n.toState.value);r._data=t,gt(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class Je{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new Ye(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=n[t[r]].namespaceId;if(i){const t=this._fetchNamespace(i);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(Xe(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!Xe(e))return;const i=e.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),nn(t,Ve)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),rn(t,Ve))}removeNode(t,e,n,r){if(Xe(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,i){return Xe(e)?this._fetchNamespace(t).listen(e,n,r,i):()=>{}}_buildInstruction(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,Ft,!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,jt,!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return pt(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t.__ng_removed;if(e&&e.setForRemoval){if(t.__ng_removed=He,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,ze)&&this.markElementAsDisabled(t,!1),this.driver.query(t,ze,!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)nn(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?pt(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new ve,r=[],i=new Map,s=[],o=new Map,a=new Map,l=new Map,c=new Set;this.disabledNodes.forEach(t=>{c.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)c.add(e[n])});const u=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=en(h,this.collectedEnterElements),f=new Map;let p=0;d.forEach((t,e)=>{const n=It+p++;f.set(e,n),t.forEach(t=>nn(t,n))});const m=[],g=new Set,y=new Set;for(let P=0;P<this.collectedLeaveElements.length;P++){const t=this.collectedLeaveElements[P],e=t.__ng_removed;e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):y.add(t))}const _=new Map,v=en(h,Array.from(g));v.forEach((t,e)=>{const n=Nt+p++;_.set(e,n),t.forEach(t=>nn(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=f.get(e);t.forEach(t=>rn(t,n))}),v.forEach((t,e)=>{const n=_.get(e);t.forEach(t=>rn(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const b=[],w=[];for(let P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(e).forEach(t=>{const e=t.player,i=t.element;if(b.push(e),this.collectedEnterElements.length){const t=i.__ng_removed;if(t&&t.setForMove)return void e.destroy()}const c=!u||!this.driver.containsElement(u,i),h=_.get(i),d=f.get(i),p=this._buildInstruction(t,n,d,h,c);if(p.errors&&p.errors.length)w.push(p);else{if(c)return e.onStart(()=>Zt(i,p.fromStyles)),e.onDestroy(()=>qt(i,p.toStyles)),void r.push(e);if(t.isFallbackTransition)return e.onStart(()=>Zt(i,p.fromStyles)),e.onDestroy(()=>qt(i,p.toStyles)),void r.push(e);p.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(i,p.timelines),s.push({instruction:p,player:e,element:i}),p.queriedElements.forEach(t=>vt(o,t,[]).push(e)),p.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=a.get(e);t||a.set(e,t=new Set),n.forEach(e=>t.add(e))}}),p.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=l.get(e);r||l.set(e,r=new Set),n.forEach(t=>r.add(t))})}});if(w.length){const t=[];w.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),b.forEach(t=>t.destroy()),this.reportError(t)}const x=new Map,S=new Map;s.forEach(t=>{const e=t.element;n.has(e)&&(S.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,x))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{vt(x,e,[]).push(t),t.destroy()})});const E=m.filter(t=>an(t,a,l)),A=new Map;tn(A,this.driver,y,l,ot).forEach(t=>{an(t,a,l)&&E.push(t)});const T=new Map;d.forEach((t,e)=>{tn(T,this.driver,new Set(t),a,"!")}),E.forEach(t=>{const e=A.get(t),n=T.get(t);A.set(t,Object.assign(Object.assign({},e),n))});const C=[],M=[],O={};s.forEach(t=>{const{element:e,player:s,instruction:o}=t;if(n.has(e)){if(c.has(e))return s.onDestroy(()=>qt(e,o.toStyles)),s.disabled=!0,s.overrideTotalTime(o.totalTime),void r.push(s);let t=O;if(S.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=S.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>S.set(e,t))}const n=this._buildAnimation(s.namespaceId,o,x,i,T,A);if(s.setRealPlayer(n),t===O)C.push(s);else{const e=this.playersByElement.get(t);e&&e.length&&(s.parentPlayer=pt(e)),r.push(s)}}else Zt(e,o.fromStyles),s.onDestroy(()=>qt(e,o.toStyles)),M.push(s),c.has(e)&&r.push(s)}),M.forEach(t=>{const e=i.get(t.element);if(e&&e.length){const n=pt(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let P=0;P<m.length;P++){const t=m[P],e=t.__ng_removed;if(rn(t,Nt),e&&e.hasAnimation)continue;let n=[];if(o.size){let e=o.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,jt,!0);for(let t=0;t<r.length;t++){let e=o.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?sn(this,t,r):this.processLeaveNode(t)}return m.length=0,C.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),C}elementContainsData(t,e){let n=!1;const r=e.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,i){let s=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(s=e)}else{const e=this.playersByElement.get(t);if(e){const t=!i||i==qe;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&s.push(e)})}}return(n||r)&&(s=s.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),s}_beforeAnimationBuild(t,e,n){const r=e.element,i=e.isRemovalTransition?void 0:t,s=e.isRemovalTransition?void 0:e.triggerName;for(const o of e.timelines){const t=o.element,a=t!==r,l=vt(n,t,[]);this._getPreviousPlayers(t,a,i,s,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),l.push(t)})}Zt(r,e.fromStyles)}_buildAnimation(t,e,n,r,i,s){const o=e.triggerName,a=e.element,l=[],c=new Set,u=new Set,h=e.timelines.map(e=>{const h=e.element;c.add(h);const d=h.__ng_removed;if(d&&d.removedBeforeQueried)return new ut(e.duration,e.delay);const f=h!==a,p=function(t){const e=[];return on(t,e),e}((n.get(h)||$e).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=i.get(h),g=s.get(h),y=mt(0,this._normalizer,0,e.keyframes,m,g),_=this._buildPlayer(e,y,p);if(e.subTimeline&&r&&u.add(h),f){const e=new Ke(t,o,h);e.setRealPlayer(_),l.push(e)}return _});l.forEach(t=>{vt(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e),r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e],r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r}(this.playersByQueriedElement,t.element,t))}),c.forEach(t=>nn(t,Bt));const d=pt(h);return d.onDestroy(()=>{c.forEach(t=>rn(t,Bt)),qt(a,e.toStyles)}),u.forEach(t=>{vt(r,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new ut(t.duration,t.delay)}}class Ke{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new ut,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>gt(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){vt(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Xe(t){return t&&1===t.nodeType}function Qe(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function tn(t,e,n,r,i){const s=[];n.forEach(t=>s.push(Qe(t)));const o=[];r.forEach((n,r)=>{const s={};n.forEach(t=>{const n=s[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r.__ng_removed=Ge,o.push(r))}),t.set(r,s)});let a=0;return n.forEach(t=>Qe(t,s[a++])),o}function en(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),i=new Map;function s(t){if(!t)return 1;let e=i.get(t);if(e)return e;const o=t.parentNode;return e=n.has(o)?o:r.has(o)?1:s(o),i.set(t,e),e}return e.forEach(t=>{const e=s(t);1!==e&&n.get(e).push(t)}),n}function nn(t,e){if(t.classList)t.classList.add(e);else{let n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function rn(t,e){if(t.classList)t.classList.remove(e);else{let n=t.$$classes;n&&delete n[e]}}function sn(t,e,n){pt(n).onDone(()=>t.processLeaveNode(e))}function on(t,e){for(let n=0;n<t.length;n++){const r=t[n];r instanceof ht?on(r.players,e):e.push(r)}}function an(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(t=>i.add(t)):e.set(t,r),n.delete(t),!0}class ln{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new Je(t,e,n),this._timelineEngine=new je(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,i){const s=t+"-"+r;let o=this._triggerCache[s];if(!o){const t=[],e=de(this._driver,i,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);o=function(t,e){return new ke(t,e)}(r,e),this._triggerCache[s]=o}this._transitionEngine.registerTrigger(e,r,o)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,i]=bt(n);this._timelineEngine.command(t,e,i,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,i){if("@"==n.charAt(0)){const[t,r]=bt(n);return this._timelineEngine.listen(t,e,r,i)}return this._transitionEngine.listen(t,e,n,r,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function cn(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=hn(e[0]),e.length>1&&(r=hn(e[e.length-1]))):e&&(n=hn(e)),n||r?new un(t,n,r):null}let un=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&qt(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(qt(this._element,this._initialStyles),this._endStyles&&(qt(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Zt(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Zt(this._element,this._endStyles),this._endStyles=null),qt(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function hn(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r];dn(i)&&(e=e||{},e[i]=t[i])}return e}function dn(t){return"display"===t||"position"===t}const fn="animation",pn="animationend";class mn{constructor(t,e,n,r,i,s,o){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=i,this._fillMode=s,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=wn(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),bn(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),vn(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){gn(this._element,this._name,"paused")}resume(){gn(this._element,this._name,"running")}setPosition(t){const e=yn(this._element,this._name);this._position=t*this._duration,bn(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),vn(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=wn(t,"").split(","),r=_n(n,e);r>=0&&(n.splice(r,1),bn(t,"",n.join(",")))}(this._element,this._name))}}function gn(t,e,n){bn(t,"PlayState",n,yn(t,e))}function yn(t,e){const n=wn(t,"");return n.indexOf(",")>0?_n(n.split(","),e):_n([n],e)}function _n(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function vn(t,e,n){n?t.removeEventListener(pn,e):t.addEventListener(pn,e)}function bn(t,e,n,r){const i=fn+e;if(null!=r){const e=t.style[i];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[i]=n}function wn(t,e){return t.style[fn+e]||""}class xn{constructor(t,e,n,r,i,s,o,a){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=o,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=s||"linear",this.totalTime=r+i,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new mn(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:se(this.element,n))})}this.currentSnapshot=t}}class Sn extends ut{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=Dt(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class En{constructor(){this._count=0}validateStyleProperty(t){return Ct(t)}matchesElement(t,e){return Mt(t,e)}containsElement(t,e){return Ot(t,e)}query(t,e,n){return Pt(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>Dt(t));let r=`@keyframes ${e} {\n`,i="";n.forEach(t=>{i=" ";const e=parseFloat(t.offset);r+=`${i}${100*e}% {\n`,i+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${e}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const s=document.createElement("style");return s.textContent=r,s}animate(t,e,n,r,i,s=[],o){const a=s.filter(t=>t instanceof xn),l={};ne(n,r)&&a.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const c=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=re(t,e,l));if(0==n)return new Sn(t,c);const u="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(t,u,e);(function(t){var e;const n=null===(e=t.getRootNode)||void 0===e?void 0:e.call(t);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(t).appendChild(h);const d=cn(t,e),f=new xn(t,e,u,n,r,i,c,d);return f.onDestroy(()=>{var t;(t=h).parentNode.removeChild(t)}),f}}class An{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:se(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class Tn{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(Cn().toString()),this._cssKeyframesDriver=new En}validateStyleProperty(t){return Ct(t)}matchesElement(t,e){return Mt(t,e)}containsElement(t,e){return Ot(t,e)}query(t,e,n){return Pt(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,i,s=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,s);const a={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(a.easing=i);const l={},c=s.filter(t=>t instanceof An);ne(n,r)&&c.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const u=cn(t,e=re(t,e=e.map(t=>Ht(t,!1)),l));return new An(t,e,a,u)}}function Cn(){return dt()&&Element.prototype.animate||{}}let Mn=(()=>{class t extends st{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:i.ifc.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?at(t):t;return Dn(this._renderer,null,e,"register",[n]),new On(e,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.FYo),i.LFG(r.K0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class On extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new Pn(this._id,t,e||{},this._renderer)}}class Pn{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return Dn(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function Dn(t,e,n,r,i){return t.setProperty(e,`@@${n}:${r}`,i)}const Rn="@",Ln="@.disabled";let In=(()=>{class t{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new Nn("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,i=e.id+"-"+this._currentId;this._currentId++,this.engine.register(i,t);const s=e=>{Array.isArray(e)?e.forEach(s):this.engine.registerTrigger(r,i,t,e.name,e)};return e.data.animation.forEach(s),new kn(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.FYo),i.LFG(ln),i.LFG(i.R0b))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class Nn{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,r=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){e.charAt(0)==Rn&&e==Ln?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class kn extends Nn{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){e.charAt(0)==Rn?"."==e.charAt(1)&&e==Ln?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if(e.charAt(0)==Rn){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let i=e.substr(1),s="";return i.charAt(0)!=Rn&&([i,s]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(i)),this.engine.listen(this.namespaceId,r,i,s,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let Fn=(()=>{class t extends ln{constructor(t,e,n){super(t.body,e,n)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(r.K0),i.LFG(Lt),i.LFG(Oe))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Bn=new i.OlP("AnimationModuleType"),jn=[{provide:st,useClass:Mn},{provide:Oe,useFactory:function(){return new Pe}},{provide:ln,useClass:Fn},{provide:i.FYo,useFactory:function(t,e,n){return new In(t,e,n)},deps:[S,ln,i.R0b]}],Un=[{provide:Lt,useFactory:function(){return"function"==typeof Cn()?new Tn:new En}},{provide:Bn,useValue:"BrowserAnimations"},...jn],Vn=[{provide:Lt,useClass:Rt},{provide:Bn,useValue:"NoopAnimations"},...jn];let zn=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?Vn:Un}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:Un,imports:[N]}),t})();var $n=n(2693),Hn=n(2895);let Gn=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t,bootstrap:[F]}),t.\u0275inj=i.cJS({providers:[],imports:[[N,B.Aw.forRoot(j.m5),U.FT.instrument({logOnly:!0}),et.forRoot(),zn,$n.JF,it,Hn.ReplayViewerModule]]}),t})();(0,i.G48)(),L().bootstrapModule(Gn).catch(t=>console.error(t))},8651:(t,e,n)=>{"use strict";n.d(e,{zn:()=>V,eF:()=>I,Nk:()=>L,mh:()=>at,Rb:()=>T,UB:()=>k,RE:()=>C,zA:()=>u,uV:()=>P,ze:()=>S,$L:()=>l,D5:()=>D,Nn:()=>R,g5:()=>O,_Q:()=>N,uS:()=>M,T1:()=>h,HJ:()=>o,qw:()=>d,PQ:()=>f,ij:()=>m,Xs:()=>p,dq:()=>y,M1:()=>A,Kt:()=>E,jH:()=>U,i1:()=>tt,u$:()=>_,rf:()=>g,Ad:()=>Q,lx:()=>K,aP:()=>X,AJ:()=>v,zL:()=>b,q2:()=>w,gO:()=>a,nr:()=>c,hr:()=>s,$E:()=>x,kC:()=>It,tv:()=>Ct,W8:()=>xt,WT:()=>Et,Gt:()=>St,kH:()=>qt,re:()=>Dt,N6:()=>wt,LS:()=>j,hW:()=>q,xD:()=>F,Qo:()=>B,tB:()=>nt,U1:()=>rt,DP:()=>et,Fz:()=>ot,BJ:()=>st,qX:()=>it,xH:()=>vt,o1:()=>J,aM:()=>Z,lw:()=>Y,mL:()=>z,Ph:()=>$,vk:()=>H,cZ:()=>Wt,hh:()=>ht,Wb:()=>ut,V4:()=>Gt,GN:()=>zt,ut:()=>mt,mz:()=>Ht,gd:()=>dt,Od:()=>ft,EN:()=>pt,Tc:()=>Ft,Ah:()=>Vt,N_:()=>Ut,mC:()=>gt,zi:()=>yt,Eg:()=>bt,Zp:()=>Tt,v8:()=>At,pn:()=>jt,Jd:()=>G,RW:()=>W,St:()=>$t,rF:()=>i,Qj:()=>Bt,SW:()=>_t,W9:()=>Mt,UE:()=>Pt,s7:()=>Ot,fo:()=>Rt,ib:()=>Lt,ER:()=>Nt,X7:()=>kt});var r=n(2569);const i="replays",s="userId",o="last",a="username",l="email",c="users",u="Deal passed out",h="/api/getDeals",d="/api/getGames",f="/api/getGameCount",p="/api/getUser",m="/api/getUsers",g="overflow-y-auto",y="h-auto",_="opacity-none",v="translate-left",b="translate-right",w="translate-up",x="visible",S="d-none",E="matched-deal",A="login-card",T="deals-list",C="deal-detail",M="game-detail",O="games-view",P="deal-player",D="filter-manager",R="full-size",L="color-red",I="color-black",N="game-detail-border-bottom",k="deal-detail-button-border-bottom",F=["Open","&#10006;"],B=["Show All","Hide All"],j=["Show","Hide"],U=561,V=500,z="--game-detail-height-above-breakpoint",$="--game-detail-height-below-breakpoint",H="--game-detail-summary-height-percentage",G="--player-labels-display-type",W="--player-names-display-type",q="--deals-list-button-font-size",Z="--game-detail-border",Y="1px solid rgba(var(--color-black-rgb), 1)",J="2px solid rgba(var(--color-primary-4-rgb), .25)",K={[r.D0.small]:r.D0.small,[r.D0.medium]:r.D0.medium,[r.D0.large]:r.D0.large},X={[r.oi.ascending]:r.oi.ascending,[r.oi.descending]:r.oi.descending},Q=[1,2,5,10,25,50,100],tt="N/A",et=["Pick a Contract"],nt=["Pick a Bid"],rt=["Pick a Card",...Array(52).keys()],it=["Pick a Username"],st=["Pick a Game Name"],ot=["Pick a Multiplier","Once","Twice"],at={lessThanEqualTo:"&#8804;",greaterThanEqualTo:"&#8805;"};var lt=n(4812);function ct(t){var e;if(null==t)throw new Error(`Error getting suit for cardAsNumber: ${t}.`);const n=Math.floor(t/13);return-1===n?"":null===(e=Pt[n])||void 0===e?void 0:e.toLowerCase()}function ut(t,e=!1){switch(t%13){case 0:return"2";case 1:return"3";case 2:return"4";case 3:return"5";case 4:return"6";case 5:return"7";case 6:return"8";case 7:return"9";case 8:return e?"T":"10";case 9:return"J";case 10:return"Q";case 11:return"K";case 12:return"A";default:return""}}function ht(t,e=!1){switch(t){case"Ace":return"A";case"King":return"K";case"Queen":return"Q";case"Jack":return"J";case"Ten":return e?"T":"10";case"Nine":return"9";case"Eight":return"8";case"Seven":return"7";case"Six":return"6";case"Five":return"5";case"Four":return"4";case"Three":return"3";case"Two":return"2";case"One":return"1";default:return""}}function dt(t){if("number"==typeof t){const e=ct(t);return e&&Ot[Pt.findIndex(t=>t.toLowerCase()===e.toLowerCase())]||""}const e=Pt.findIndex(e=>e.slice(0,e.length-1).toLowerCase()===t.toLowerCase());return-1!==e?Ot[e]:"NT"}function ft(t,e=!1){let n="color-white",r="";return r=e?function(t){const e=Pt[0].substr(0,Pt[0].length-1),n=Pt[1].substr(0,Pt[1].length-1),r=Pt[2].substr(0,Pt[2].length-1),i=Pt[3].substr(0,Pt[3].length-1);return t.match(new RegExp(e,"i"))?Ot[0]:t.match(new RegExp(n,"i"))?Ot[1]:t.match(new RegExp(r,"i"))?Ot[2]:t.match(new RegExp(i,"i"))?Ot[3]:"NT"}(t):Ht(t),r.match(/diam|heart/i)&&(n=`${L}-light`),`<span class="${n}">${r}</span>`}function pt(t){return!t.match(/double/i)&&!t.match(/pass/i)}function mt(t,e){if(e===tt)return tt;for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===t[n])return n;throw new Error("Invalid username or seating in getDirectionFromSeating()")}function gt(t,e){if(e===tt)return tt;if(e.toLowerCase()===Ct[0].toLowerCase())return t.south;if(e.toLowerCase()===Ct[1].toLowerCase())return t.west;if(e.toLowerCase()===Ct[2].toLowerCase())return t.north;if(e.toLowerCase()===Ct[3].toLowerCase())return t.east;throw new Error("Invalid direction or seating in getPartnerFromDirection()")}function yt(t){if(t&&t.length>0){const e=[];for(let n=0;n<t.length;n++)e.push(ut(t[n]%St,!0));return e.join(",")}return null}function _t(t){let e=[],n=[],r=[],i=[];for(let s=0;s<t.length;s++){const o=t[s],a=ct(o&&o.length>0?o[0]:-1);a===Mt.clubs?e=o:a===Mt.diamonds?n=o:a===Mt.hearts?r=o:a===Mt.spades&&(i=o)}return[e,n,r,i]}function vt(t,e=1){return e>0?t.reduce((t,n)=>t.concat(Array.isArray(n)?vt(n,e-1):n),[]):t.slice()}function bt(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=vt(t[n]);if(null==r?void 0:r.includes(e))return n}return""}function wt(t){const e=[],n=[],r=[],i=[];for(let s=0;s<t.length;s++){const o=t[s];o>=0&&o<=12?i.push(o):o>=13&&o<=25?r.push(o):o>=26&&o<=38?n.push(o):o>=39&&o<=51&&e.push(o)}return[e,n,i,r]}n(1399);const xt=52,St=13,Et=13,At=0,Tt=51,Ct=["north","east","south","west"],Mt={clubs:"clubs",diamonds:"diamonds",hearts:"hearts",spades:"spades",noTrump:null},Ot=["&clubs;","&diams;","&hearts;","&spades;"],Pt=["Clubs","Diamonds","Hearts","Spades"],Dt=["One Club","One Diamond","One Heart","One Spade","One No Trump","Two Club","Two Diamond","Two Heart","Two Spade","Two No Trump","Three Club","Three Diamond","Three Heart","Three Spade","Three No Trump","Four Club","Four Diamond","Four Heart","Four Spade","Four No Trump","Five Club","Five Diamond","Five Heart","Five Spade","Five No Trump","Six Club","Six Diamond","Six Heart","Six Spade","Six No Trump","Seven Club","Seven Diamond","Seven Heart","Seven Spade","Seven No Trump"],Rt=["NS","EW"],Lt=["northSouth","eastWest"];function It(t){return t.split(" ").map(t=>t[0].toUpperCase()+t.slice(1)).join(" ")}function Nt(t,e){var n;let r=null;for(let i=0;i<t.length;i++){const s=t[i];r=null===(n=null==s?void 0:s.classList)||void 0===n?void 0:n.toggle(e)}return r}function kt(t,e){t&&e&&(t.innerHTML=t.innerHTML.match(e[0])?e[1]:e[0])}function Ft(t,e,n,r,i){if(t>=n)return i;if(t<=e)return r;var s=Math.abs(n-e),o=Math.abs(i-r),a=(t-e)/s;return r<=i?r+a*o:r-a*o}const Bt=(t,e,n=!1)=>{const r=window.scrollY+t.getBoundingClientRect().top-e;return n?r:window.scroll({top:r,left:0,behavior:"smooth"})};function jt(t,e,n,i){if(!t||t.length<=0)return[];const s=i*n,o=s+i;let a=[];if(e===r.oi.descending)a=t.slice(s,o);else for(let r=0;r<t.length;r++){const e=t[t.length-1-r];r>=s&&r<o&&a.push(e)}return a}function Ut(t,e){return Math.ceil(e/t)}function Vt(t,e,n,r){const i=Math.ceil(r/n),s=t*e;if(n===e)return t;for(let o=0;o<i;o++){const t=o*n,e=t+(n-1);if(s>=t&&s<=e)return o}return 0}function zt(t,e){if(!(null==t?void 0:t.date))return tt;const n=t.date.toLocaleDateString(),r=n.substr(0,n.length-4)+n.substr(n.length-2,n.length),i=t.date.toLocaleTimeString();return`${e}${i.replace(/(:\d{2}) .*$/i,"")}${i.substr(-2,2)} on ${r}`}function $t(){const t=document.querySelectorAll(`.${E}`);for(let e=0;e<t.length;e++)t[e].classList.remove(E)}function Ht(t){const e=+t;if(isNaN(e))return`${t}`;const n=dt(e);return`${ut(e,!0)}${n}`}function Gt(t){const e=t.split(" ");return`${+ht(e[0])}${ft(e[1],!0)}`}function Wt(t,e,n,r){const i={amountNeeded:tt,amountMade:lt.oc};if(!t.contract||!t.declarer)return i;const s=function(t,e){if(!t)throw new Error("Problem with seating in deal-detail");try{return[e,gt(t,mt(t,e))]}catch(n){return console.log("err =",n),["",""]}}(n,r);return s[0]?{amountNeeded:e+6,amountMade:null==t?void 0:t.roundWinners.reduce((t,e)=>s.includes(e[0])?t+1:t,0)}:i}function qt(t,e,n=""){try{return!(!t||!t.parentNode||t.parentNode.localName!==e||-1===t.parentNode.className.search(n))||-1===t.parentNode.localName.search(/html/i)&&qt(t.parentNode,e,n)}catch(r){return!1}}},2569:(t,e,n)=>{"use strict";n.d(e,{Uv:()=>r,D0:()=>i,zW:()=>s,oi:()=>o,OF:()=>a});var r=function(t){return t[t.before=0]="before",t[t.after=1]="after",t}({}),i=function(t){return t.small="small",t.medium="medium",t.large="large",t}({}),s=function(t){return t.deals="deals",t.games="games",t.users="users",t.filters="filters",t.general="general",t}({}),o=function(t){return t.ascending="ascending",t.descending="descending",t}({}),a=function(t){return t[t.toggle=0]="toggle",t[t.open=1]="open",t[t.close=2]="close",t}({})},2895:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ReplayViewerModule:()=>xd});var r=n(1116),i=n(3714),s=n(8651),o=n(5366),a=n(2693),l=n(9878);let c=(()=>{class t{constructor(t,e,n){this.http=t,this.store=e,this.router=n}getDeals(t){return this.http.post(`${s.T1}`,{deals:t})}getGameCount(t){return this.http.get(`${s.PQ}?${s.hr}=${t}`)}getGames(t,e){return this.http.get(`${s.qw}?${s.hr}=${t}&${s.HJ}=${e}`)}getUser(t,e){return this.http.post(`${s.Xs}`,{[`${s.$L}`]:e,[`${s.gO}`]:t})}getUsers(t){if(t&&!(t.length<=0))return this.http.post(`${s.ij}`,{[`${s.nr}`]:t})}getNeededDeals(t){const e={},n=[];if(!t)return[e,n];for(let r=0;r<t.length;r++){let i=!1;const s=t[r];if(s&&s.deals)for(let t=0;t<s.deals.length;t++){const r=s.deals[t];t===s.deals.length-1&&(i=!0),e[r]=i,n.push(r)}}return[e,n]}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(a.eN),o.LFG(l.yh),o.LFG(i.F0))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var u=n(4812),h=n(2569);let d=(()=>{class t{constructor(t,e){this.helpersService=t,this.store=e,this.usersInLocalStorage="users",this.gamesInLocalStorage="games",this.dealsInLocalStorage="deals",this.sortPreferenceInLocalStorage="sort",this.sizePreferenceInLocalStorage="size",this.resultsPerPagePreferenceInLocalStorage="resultsPerPage",this.userIdsInLocalStorage="userIds",this.EMPTY_LOCAL_STORAGE_USERS_RETURNS=null,this.EMPTY_LOCAL_STORAGE_GAMES_RETURNS={},this.EMPTY_USER_ID_RETURNS="",this.checkForIdsIntervalDuration=1e3,this.maxTimesToCheckForIds=10,this.isFinishedSavingUserIds=!1,this.userIdsMaxLife=2592e5}appendGamesToLocalStorageUser(t,e){var n;const r=this.getLocalStorageUser(t);if(!r)return!1;for(let i=0;i<e.length;i++){const t=e[i];t&&-1===r.gameIds.findIndex(e=>{var n;return e&&e===(null===(n=t)||void 0===n?void 0:n._id)})&&r.gameIds.push(null===(n=t)||void 0===n?void 0:n._id)}return r.lastGameCount=r.gameIds.length,r.lastSearchDate=Date.now(),this.saveLocalStorageUser(t,r),this.saveGameIds(e),r}createLocalStorageUser(t,e,n,r,i){if(!t)return null;let s=this.getLocalStorageUsers();const o={username:e,lastGameCount:i,lastSearchDate:Date.now(),gameIds:this.getGameIds(r),email:n};return s?s[t]=o:s={[t]:o},this.saveLocalStorageUsers(s),this.saveGameIds(r),s}getFreeSpace(){let t,e,n=0;for(e in localStorage)localStorage.hasOwnProperty(e)&&(t=2*(localStorage[e].length+e.length),n+=t,console.log(e.substr(0,50)+" = "+(t/1024).toFixed(2)+" KB"));const r=(n/1024).toFixed(2);return console.log("Total = "+r+" KB"),+r}getGames(t){var e;const n=this.getLocalStorageGames(),r=this.getLocalStorageUser(t);if(!r)return[];const i=[];for(let s=0;s<(null===(e=null==r?void 0:r.gameIds)||void 0===e?void 0:e.length);s++)i.push(n[null==r?void 0:r.gameIds[s]]);return i}getIdFromUsername(t){const e=this.getLocalStorageUsers();for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(r.username&&r.username===t)return n}return this.EMPTY_USER_ID_RETURNS}getIdFromEmail(t){const e=this.getLocalStorageUsers();for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(r.email&&r.email===t)return n}return this.EMPTY_USER_ID_RETURNS}getLastGameCount(t){const e=this.getLocalStorageUsers();return e&&e[t]?e[t].lastGameCount:0}getLocalStorageDeals(){const t=localStorage.getItem(this.dealsInLocalStorage);return t?JSON.parse(t):null}getLocalStorageGames(){const t=localStorage.getItem(this.gamesInLocalStorage);return t?JSON.parse(t):this.EMPTY_LOCAL_STORAGE_GAMES_RETURNS}getLocalStorageUser(t){const e=this.getLocalStorageUsers();return e?e[t]:this.EMPTY_LOCAL_STORAGE_USERS_RETURNS}getLocalStorageUsers(){const t=localStorage.getItem(this.usersInLocalStorage);return t?JSON.parse(t):this.EMPTY_LOCAL_STORAGE_USERS_RETURNS}getPopulatedLocalStorageUser(t){const e=this.getLocalStorageUser(t);if(!e)return this.EMPTY_LOCAL_STORAGE_USERS_RETURNS;const n=[],r=[];for(let i=0;i<e.gameIds.length;i++){const t=this.getGameFromGameId(e.gameIds[i]);if(t){if(0===n.length||t.completionDate<n[n.length-1].completionDate)n.push(t);else{const e=this.getIndexToAddGameIntoGames(n,t);n.splice(e,0,t)}for(let e=0;e<t.players.length;e++){const n=t.players[e];r.includes(n)||r.push(n)}}}return e.games=n,e.userIds=r,delete e.gameIds,e}getPreferences(){return{sort:this.getSortPreference(),size:this.getSizePreference(),resultsPerPage:this.getResultsPerPagePreference()}}getResultsPerPagePreference(){return localStorage.getItem(this.resultsPerPagePreferenceInLocalStorage)||`${s.Ad[s.Ad.length-1]}`}getSizePreference(){return localStorage.getItem(this.sizePreferenceInLocalStorage)||s.lx.large}getSortPreference(){return localStorage.getItem(this.sortPreferenceInLocalStorage)||s.aP.descending}getSpecificUserIdsInLocalStorage(t){const e=this.getUserIdsInLocalStorage();if(!e)return null;const n={};for(let r=0;r<t.length;r++){const i=t[r],s=e[i];s&&(n[i]=s)}return n}getUserIdsInLocalStorage(){const t=localStorage.getItem(this.userIdsInLocalStorage);if(t){const e=JSON.parse(t);return Math.abs(e.lastSearchDate-Date.now())>=this.userIdsMaxLife?(localStorage.removeItem(this.userIdsInLocalStorage),null):e}return null}saveDeals(t){if(!t||0===Object.keys(t).length)return;const e=this.getLocalStorageDeals();localStorage.setItem(this.dealsInLocalStorage,JSON.stringify(Object.assign(Object.assign({},e),t)))}saveResultsPerPagePreference(t){localStorage.setItem(this.resultsPerPagePreferenceInLocalStorage,t)}saveSizePreference(t){localStorage.setItem(this.sizePreferenceInLocalStorage,t)}saveSortPreference(t){localStorage.setItem(this.sortPreferenceInLocalStorage,t)}saveUserIds(t){var e;this.isFinishedSavingUserIds=!1;const n=this.getUserIdsInLocalStorage(),r=[];if(n)for(let i=0;i<t.length;i++){const e=t[i];n[e]||r.push(e)}null===(e=this.helpersService.getUsers(n?r:t))||void 0===e||e.subscribe(t=>{var e,r;const i={};if(t)for(let n=0;n<t.length;n++){const e=t[n],r=Object.keys(e);i[r[0]]=e[r[0]]}i.lastSearchDate=(null===(e=n)||void 0===e?void 0:e.lastSearchDate)?null===(r=n)||void 0===r?void 0:r.lastSearchDate:Date.now();const s=Object.assign(Object.assign({},n),i);localStorage.setItem(this.userIdsInLocalStorage,JSON.stringify(s)),this.isFinishedSavingUserIds=!0}),this.loadUserIdObjsIntoRedux(t)}updateEmailAndUsername(t,e,n){if(!t)return;const r=this.getLocalStorageUser(t);if(!r)return;const i=e?e.trim():"",s=n?n.trim():"";i&&(r.username=i),s&&(r.email=s),this.saveLocalStorageUser(t,r)}getGameIds(t){return t.map(t=>t._id)}getGameFromGameId(t){return this.getLocalStorageGames()[t]}getIndexToAddGameIntoGames(t,e){const n=t.length-1;let r=n;if(t.length<=25){const i=t[t.length-2],s=t[n];if(e.completionDate>s.completionDate)for(let o=0;o<t.length;o++){o===n&&(r=o);const a=t[o],l=t[o+1];if(e.completionDate>=a.completionDate){r=-1;break}if(e.completionDate>=s.completionDate&&e.completionDate<=i.completionDate){r=t.length-2;break}if(e.completionDate<a.completionDate&&e.completionDate>=l.completionDate){r=o;break}}}else{let i,s,o=Math.floor(t.length/2),a=n,l=0;const c=t[n];if(e.completionDate>=t[l].completionDate)r=-1;else if(e.completionDate<=c.completionDate)r=n;else{let n=0;for(;!(n>t.length-2);){if(s=t[o],i=t[o+1],e.completionDate<=s.completionDate&&e.completionDate>=i.completionDate){r=o;break}{let t=!0;e.completionDate>s.completionDate&&(t=!1),t?l=o:a=o,o=Math.floor((a-l)/2+l)}n++}}}return r+1}loadUserIdObjsIntoRedux(t){clearInterval(this.checkForIdsInterval);let e=this.getSpecificUserIdsInLocalStorage(t);if(e&&Object.keys(e).length===t.length)this.store.dispatch(new u.JH(e));else{let n=0;this.checkForIdsInterval=setInterval(()=>{n++,(n===this.maxTimesToCheckForIds||this.isFinishedSavingUserIds)&&(clearInterval(this.checkForIdsInterval),e=this.getSpecificUserIdsInLocalStorage(t),e||(e={}),this.store.dispatch(new u.JH(e))),e=this.getSpecificUserIdsInLocalStorage(t),e&&Object.keys(e).length===t.length&&(clearInterval(this.checkForIdsInterval),this.store.dispatch(new u.JH(e)))},this.checkForIdsIntervalDuration)}}saveGameIds(t){const e=this.getLocalStorageGames();for(let n=0;n<t.length;n++){const r=t[n];if(!r)continue;let i=!0;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&t&&t===r._id){i=!1;break}i&&(e[r._id]=r)}this.saveLocalStorageGames(e)}saveLocalStorageUser(t,e){let n=this.getLocalStorageUsers();n?n[t]=e:n={[t]:e},this.saveLocalStorageUsers(n)}saveLocalStorageUsers(t){localStorage.setItem(this.usersInLocalStorage,JSON.stringify(t))}saveLocalStorageGames(t){localStorage.setItem(this.gamesInLocalStorage,JSON.stringify(t))}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(c),o.LFG(l.yh))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=n(611),p=n(4689);let m=(()=>{class t{constructor(t){this.store=t}getDealCountMessage(t,e){if(!t||t===s.i1)return s.i1;const n=this.getDealFromStore(t),r=this.getFinalScoreFromLastDeal(n);let i=s.fo[0],o=e.northSouth,a=e.eastWest;return r.eastWest===r.northSouth?i="Tie":r.eastWest>r.northSouth&&(i=s.fo[1],o=e.eastWest,a=e.northSouth),`${i} won ${o} deals to ${a}`}getDealsWonCounts(t,e){let n,r=0,i=0;for(let o=0;o<t.length;o++){const a=t[o];if(!a)continue;let l=null;o!==t.length-1?(l=t[o+1],n=this.getDealWinnerFromScoreDifference(a,l,e,o)):n=this.getDealWinnerFromRoundWinners(a,e),n===s.fo[0]?r++:n===s.fo[1]&&i++}return{northSouth:r,eastWest:i}}getDealFromStore(t){let e={};return this.store.select(h.zW.deals).pipe((0,f.q)(1)).subscribe(n=>{e=n.fetchedDeals[t]}),e}getDealsToGet(t){if(!t)return[];let e={};const n=[];this.store.select(h.zW.deals).pipe((0,f.q)(1)).subscribe(t=>{e=t.fetchedDeals});for(let r=0;r<t.length;r++)n.push(e[t[r]]);return n}getDeclarerFromDeal(t){if(!t||!t.declarer||!t.contract)return s.i1;let e="",n="",r=-1;for(let s=t.bids.length-1;s>=0;s--){const i=t.bids[s][0],o=t.bids[s][1];if(!o.match(/pass/i)&&!o.match(/double/i)){e=o,n=i,r=s-2;break}}let i="";i=r>=0?t.bids[r][0]:t.bids[r+4][0];const o=e.split(" ");for(let s=0;s<t.bids.length;s++){const e=t.bids[s][0],r=t.bids[s][1];if((e===i||e===n)&&r.match(o[1]))return e}return s.i1}getDeclarerFromStore(t){if(!t)return s.i1;let e="";return this.store.select(h.zW.users).pipe((0,f.q)(1)).subscribe(n=>{e=n.userIds[t]}),e||s.i1}getDealWinnerFromScoreDifference(t,e,n,r){if(!t.declarer)return null;const i=t[s.ib[0]],o=e[s.ib[0]],a=t[s.ib[1]],l=e[s.ib[1]];if(void 0===i||void 0===o||void 0===a||void 0===l||(null==i?void 0:i.aboveTheLine)!==(null==o?void 0:o.aboveTheLine)&&(null==a?void 0:a.aboveTheLine)!==(null==l?void 0:l.aboveTheLine))return this.getDealWinnerFromRoundWinners(t,n);const c=["aboveTheLine","belowTheLine","totalBelowTheLineScore"];for(const u of c){if(!(i&&o&&a&&l))return"";const t=i[u],e=o[u],n=a[u],r=l[u];if(void 0===t||void 0===n||void 0===e||void 0===r)throw new Error("Invalid key in getDealWinnerFromScoreDifference()");if(t!==e&&n===r)return s.fo[0];if(t===e&&n!==r)return s.fo[1]}return this.getDealWinnerFromRoundWinners(t,n)}getDealWinnerFromRoundWinners(t,e){const n=this.getDeclarerFromDeal(t),r=(0,s.ut)(e,n),i=[n,(0,s.mC)(e,r)],o=+(0,s.hh)(t.contract.split(" ")[0])+6;return t.roundWinners.reduce((t,e)=>(i.includes(e[0])&&t++,t),0)>=o?r===s.tv[0]||r===s.tv[2]?s.fo[0]:s.fo[1]:r===s.tv[0]||r===s.tv[2]?s.fo[1]:s.fo[0]}getIsGameAlreadyOpen(){let t=!1;return this.store.select(h.zW.games).pipe((0,f.q)(1)).subscribe(e=>{t=e.isViewingGame}),t}getMadeAmountString(t,e,n,r){const{amountMade:i,amountNeeded:o}=(0,s.cZ)(t,e,n,r);if(i===u.oc||"number"!=typeof o)return[s.i1,0];const a=Math.abs(i-o);let l=this.getMadeItString();return i<o?l=`went down ${a}`:i>o&&(l=`made ${a} ${1===a?"overtrick":"overtricks"}`),[l,a]}getMadeItString(){const t=["JUST made it","BARELY made it","almost lost the contract"];return t[0+Math.floor(Math.random()*(t.length-1e-5))]}getFinalScoreFromLastDeal(t){return t.northSouth&&t.eastWest?{northSouth:t.northSouth.aboveTheLine+t.northSouth.totalBelowTheLineScore,eastWest:t.eastWest.aboveTheLine+t.eastWest.totalBelowTheLineScore}:{northSouth:u.oc,eastWest:u.oc}}setGameDetailBorderToBlack(){setTimeout(()=>{document.documentElement.style.cssText+=`${s.aM}: ${s.lw}`},s.zn)}setGameDetailBorderToNormal(){document.documentElement.style.cssText+=`${s.aM}: ${s.o1}`}toggleButtonBottomBorder(t,e=h.OF.toggle){if(t)for(let n=0;n<t.length;n++){const r=t[n];e===h.OF.toggle?r.classList.toggle(s.UB):e===h.OF.open?r.classList.remove(s.UB):e===h.OF.close&&r.classList.add(s.UB)}}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(l.yh))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),g=(()=>{class t{constructor(t,e){var n,r,i,s,o,a,l,c,d,f,p,m;this.store=t,this.replayViewerDealService=e,this.filters={afterDate:{string:"afterDate",errorKey:"afterDate-error"},beforeDate:{string:"beforeDate",errorKey:"beforeDate-error"},contract:{string:"contract",errorKey:"contract-error"},dealResult:{string:"dealResult",errorKey:"dealResult-error"},dealsThatMatchFilters:{string:"dealsThatMatchFilters"},declarer:{string:"declarer",errorKey:"declarer-error"},double:{string:"double",errorKey:"double-error"},gameName:{string:"gameName",errorKey:"gameName-error"},openingBid:{string:"openingBid",errorKey:"openingBid-error"},playerHasCard:{string:"playerHasCard",errorKey:"playerHasCardError"},playerInGame:{string:"playerInGame",errorKey:"playerInGame-error"},wonBy:{string:"wonBy",errorKey:"wonBy-error"}},this.filtersInitial={[this.filters.afterDate.string]:0,[this.filters.beforeDate.string]:0,[this.filters.contract.string]:`${u.oc}`,[this.filters.dealResult.string]:`${u.oc}`,[this.filters.dealsThatMatchFilters.string]:[`${u.oc}`],[this.filters.declarer.string]:`${u.oc}`,[this.filters.double.string]:u.oc,[this.filters.gameName.string]:`${u.oc}`,[this.filters.openingBid.string]:`${u.oc}`,[this.filters.playerHasCard.string]:{initial:[u.oc]},[this.filters.playerInGame.string]:[`${u.oc}`],[this.filters.wonBy.string]:u.oc},this.filterResetActions={[this.filters.afterDate.string]:new u.oJ(null===(n=this.filtersInitial)||void 0===n?void 0:n.afterDate),[this.filters.beforeDate.string]:new u.pf(null===(r=this.filtersInitial)||void 0===r?void 0:r.beforeDate),[this.filters.contract.string]:new u.f1(null===(i=this.filtersInitial)||void 0===i?void 0:i.contract),[this.filters.dealResult.string]:new u.XL(null===(s=this.filtersInitial)||void 0===s?void 0:s.dealResult),[this.filters.dealsThatMatchFilters.string]:new u.cE(null===(o=this.filtersInitial)||void 0===o?void 0:o.dealsThatMatchFilters),[this.filters.declarer.string]:new u.zJ(null===(a=this.filtersInitial)||void 0===a?void 0:a.declarer),[this.filters.double.string]:new u.Ex(null===(l=this.filtersInitial)||void 0===l?void 0:l.double),[this.filters.gameName.string]:new u.fm(null===(c=this.filtersInitial)||void 0===c?void 0:c.gameName),[this.filters.openingBid.string]:new u.k7(null===(d=this.filtersInitial)||void 0===d?void 0:d.openingBid),[this.filters.playerHasCard.string]:new u.dQ(null===(f=this.filtersInitial)||void 0===f?void 0:f.playerHasCard),[this.filters.playerInGame.string]:new u.G4(null===(p=this.filtersInitial)||void 0===p?void 0:p.playerInGame),[this.filters.wonBy.string]:new u.SJ(null===(m=this.filtersInitial)||void 0===m?void 0:m.wonBy)},this.filterMsgs={contract:{valid:"Contract was"},dealResult:{valid:"Deal result"},date:{before:{valid:"Before: &nbsp;",invalid:{single:"Invalid before date.",multiple:"Before date &leq; after date."}},after:{valid:"After: &nbsp;",invalid:{single:"Invalid after date.",multiple:"After date &geq; before date.",afterNow:"After date is after now."}}},declarer:{valid:"Declarer was"},double:{valid:"Deal was doubled"},gameName:{valid:"Game was named"},none:"No Filters applied",openingBid:{valid:"Opening bid was"},playerHasCard:{valid:"",invalid:"already set to"},playerInGame:{valid:"was in the game",invalid:{tooMany:"Only allowed to have four players in game",alreadyPresent:"is already present"}},wonBy:{valid:{pre:"Game won by",post:"points."}}},this.inputErrorClassnames=["ng-touched","ng-dirty","ng-invalid"],this.dealsThatMatch=[],this.users=null,this.store.select(h.zW.users).subscribe(t=>{this.users=t.userIds})}canResetDealsThatMatchFilters(t){const e=[this.filters.afterDate.string,this.filters.beforeDate.string,`${this.filters.playerInGame.string}-0`,`${this.filters.playerInGame.string}-1`,`${this.filters.playerInGame.string}-2`,`${this.filters.playerInGame.string}-3`],n=Object.keys(t);for(let r=0;r<n.length;r++)if(!e.includes(n[r]))return!1;return!0}dispatchCorrectResetAction(t){return t.key.match(/playerHasCard\d+/i)?this.store.dispatch(new u.nX({username:t.username?t.username:"",card:void 0!==t.card?t.card:-2})):t.key.match(/playerInGame-\d+/i)?this.store.dispatch(new u.HS(t.username?t.username:"")):this.store.dispatch(t.resetAction)}filterGames(t){if(!t)return t;let e=!0,n=t,r=this.filtersInitial;return this.store.select(h.zW.filters).pipe((0,f.q)(1),(0,p.w)(t=>(e=t.isFilterSame,r=Object.assign({},t),this.store.select(h.zW.games).pipe((0,f.q)(1))))).subscribe(t=>{var r;e&&(null===(r=t.filteredGames)||void 0===r?void 0:r.length)>0&&(n=t.filteredGames)}),e||(n=this.applyFilters(t,r),this.store.dispatch(new u.Ao(n)),this.store.dispatch(new u.Ms(!0))),n}getBeforeAndAfterDateInfo(){let t=-2,e=-2;const n=document.querySelector(`#${this.filters.beforeDate.string}`),r=document.querySelector(`#${this.filters.afterDate.string}`);return this.store.select(h.zW.filters).pipe((0,f.q)(1)).subscribe(n=>{t=n.beforeDate,e=n.afterDate}),{beforeDate:t,afterDate:e,beforeDateElement:n,afterDateElement:r}}getIsSelectedCardUsedAlready(t){if(-1===t)return!1;let e=!1;return this.store.select(h.zW.filters).pipe((0,f.q)(1)).subscribe(n=>{const r=n.playerHasCard;for(const i in r)if(Object.prototype.hasOwnProperty.call(r,i)&&r[i].includes(t)){e=i;break}}),e}getPlayerHasCardFilterItem(t,e,n,r){const i={elementsToReset:[t,e],message:`'${r}' had the ${(0,s.Od)(n)}`,error:"",username:r,card:n},o=Math.round(Math.random()*Math.random()*1e9);return[`${this.filters.playerHasCard.string}${o}`,i]}getPlayerHasCardErrorMessage(t,e){const n=(0,s.Od)(e);return{message:s.i1,error:`${n} ${this.filterMsgs.playerHasCard.invalid} '${t}'`,elementsToReset:[]}}getPlayerInGameFilter(){let t=[];return this.store.select(h.zW.filters).pipe((0,f.q)(1)).subscribe(e=>{t=e.playerInGame}),t}getShouldResetStoreOnDeletion(t){const e=t.key.match(this.filters.playerHasCard.errorKey),n=t.key.match(this.filters.playerInGame.errorKey);return!e&&!n}getUniquePlayerNames(t){if(!t)return;const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=Object.keys(t[n].hands);for(let t=0;t<r.length;t++){const n=r[t];-1===e.findIndex(t=>t===n)&&e.push(n)}}return e}getUniqueGameNames(t){if(!t)return;const e=[];for(let n=0;n<t.length;n++){const r=t[n].room.name;e.includes(r)||e.push(r)}return e}reset(){for(const n in this.filterResetActions)Object.prototype.hasOwnProperty.call(this.filterResetActions,n)&&this.store.dispatch(this.filterResetActions[n]);const t=document.querySelector(`.${s.D5}__applied`),e=null==t?void 0:t.children;if(e)for(let n=0;n<e.length;n++)e[n].innerHTML=""}resetElements(t,e,n){var r;for(let i=0;i<t.length;i++){const s=null===(r=t[i])||void 0===r?void 0:r.nativeElement;s&&(s[e]=n)}}setInputErrorClassnames(t,e){this.inputErrorClassnames.forEach(n=>{e?t.classList.remove(n):t.classList.add(n)})}validateDate(t,e,n,r){let i=!1,s=!0;const o=new Date(t),a=o.getTime(),l=Date.now()-60001,c=e===h.Uv.before?"before":"after";let u="";return a>=l&&e===h.Uv.after?(u="afterNow",i=!0,(null==n?void 0:n.date)&&(s=!1)):(null==n?void 0:n.date)&&e===h.Uv.after?(i=n.date.getTime()<=a,s=!1):(null==r?void 0:r.date)&&e===h.Uv.before?(i=r.date.getTime()>=a,s=!1):i=!t,u||(u=s?"single":"multiple"),{isDateInvalid:i,dateObj:o,filterMsgError:this.filterMsgs.date[c].invalid[u]}}applyFilters(t,e){this.dealsThatMatch=[];const n=this.getCanSkipFilters(e);if(n.all)return t;(0,s.St)();let r=[];this.store.select(h.zW.deals).pipe((0,f.q)(1)).subscribe(t=>{r=t.fetchedDeals});const i=this.getCanSkipDealIteration(n),o=[];for(let s=0;s<t.length;s++){const a=t[s],l=this.getPassesGameFilters(a,e,n);let c=!1;if(l&&i&&(o.push(a),c=!0),i)continue;let u=!1;for(let t=0;t<a.deals.length;t++){const i=a.deals[t];this.getCanAddDeal(r[i],e,n,a)&&(u||c||!l||(u=!0,o.push(a)),l&&(this.dealsThatMatch=[...this.dealsThatMatch,i]))}}return this.dealsThatMatch.length>0&&this.store.dispatch(new u.cE(this.dealsThatMatch)),o}getCanAddDeal(t,e,n,r){let i=!0;return!n.contract&&i&&(i=this.getPassesContractFilter(e.contract,t)),!n.declarer&&i&&(i=this.getPassesDeclarerFilter(e.declarer,t)),!n.openingBid&&i&&(i=this.getPassesOpeningBidFilter(e.openingBid,t)),!n.double&&i&&(i=this.getPassesDoubleFilter(e.double,t)),!n.dealResult&&i&&(i=this.getPassesDealResultFilter(e.dealResult,t,r||{})),!n.playerHasCard&&i&&(i=this.getPassesPlayerHasCardFilter(e.playerHasCard,t)),i}getCanSkipFilters(t){const e=this.getCanSkipAfterDate(t.afterDate),n=this.getCanSkipBeforeDate(t.beforeDate),r=this.getCanSkipContract(t.contract),i=this.getCanSkipDealResult(t.dealResult),s=this.getCanSkipDeclarer(t.declarer),o=this.getCanSkipDouble(t.double),a=this.getCanSkipGameName(t.gameName),l=this.getCanSkipOpeningBid(t.openingBid),c=this.getCanSkipPlayerHasCard(t.playerHasCard),u=this.getCanSkipPlayerInGame(t.playerInGame),h=this.getCanSkipWonBy(t.wonBy);return{all:e&&n&&r&&i&&s&&o&&a&&l&&c&&u&&h,afterDate:e,beforeDate:n,contract:r,dealResult:i,declarer:s,double:o,gameName:a,openingBid:l,playerHasCard:c,playerInGame:u,wonBy:h}}getPassesGameFilters(t,e,n){let r=!0;return!n.afterDate&&r&&(r=this.getPassesAfterDate(e.afterDate,t)),!n.beforeDate&&r&&(r=this.getPassesBeforeDate(e.beforeDate,t)),!n.gameName&&r&&(r=this.getPassesGameName(e.gameName,t)),!n.wonBy&&r&&(r=this.getPassesWonBy(e.wonBy,t)),!n.playerInGame&&r&&(r=this.getPassesPlayerInGame(e.playerInGame,t)),r}getCanSkipDealIteration(t){return t.contract&&t.dealResult&&t.declarer&&t.openingBid&&t.double&&t.playerHasCard}getCanSkipAfterDate(t){return!t}getCanSkipBeforeDate(t){return!t}getCanSkipContract(t){return t===this.filtersInitial.contract}getCanSkipDealResult(t){return!t||t.amount===u.oc||t.type===`${u.oc}`||void 0===t.amount||void 0===t.type}getCanSkipDeclarer(t){return t===this.filtersInitial.declarer}getCanSkipDouble(t){return t===this.filtersInitial.double}getCanSkipGameName(t){return t===`${u.oc}`||!t}getCanSkipOpeningBid(t){return t===this.filtersInitial.openingBid}getCanSkipPlayerHasCard(t){return!(t&&!t.initial&&0!==Object.keys(t).length)}getCanSkipPlayerInGame(t){return!(!t.includes(`${u.oc}`)&&t)}getCanSkipWonBy(t){return!t||!t.type||"less"!==t.type&&"more"!==t.type||null==t.amount||t.amount===u.oc}getPassesAfterDate(t,e){return e.completionDate>=t}getPassesBeforeDate(t,e){return e.completionDate<=t}getPassesContractFilter(t,e){return e.contract===t}getPassesDealResultFilter(t,e,n){if(!e||!(null==n?void 0:n.room))return!0;const r=+(0,s.hh)(e.contract.split(" ")[0]),i=this.replayViewerDealService.getDeclarerFromDeal(e),{amountMade:o,amountNeeded:a}=(0,s.cZ)(e,r,n.room.seating,i);if(o===u.oc||"number"!=typeof a)return!1;const l=o-a;return"equal"===t.type?l===t.amount:"less"===t.type?l<=t.amount:"more"!==t.type||l>=t.amount}getPassesDeclarerFilter(t,e){return t===(this.users?this.users[e.declarer]:null)}getPassesDoubleFilter(t,e){return!!(null==e?void 0:e.doubleValue)&&e.doubleValue===t}getPassesGameName(t,e){return e.room.name===t}getPassesOpeningBidFilter(t,e){let n="";for(let r=0;r<e.bids.length;r++){const t=e.bids[r][1];if(!t.match(/pass/i)&&!t.match(/double/i)){n=t;break}}return!!n.match(new RegExp(t,"i"))}getPassesPlayerHasCardFilter(t,e){let n=!1,r=!0;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const o=t[i],a=e.hands[i];if(!a||a.length<=0){r=!1;break}const l=(0,s.xH)(a);for(let t=0;t<o.length;t++)if(!l.includes(o[t])){r=!1,n=!0;break}if(n)break}return r}getPassesPlayerInGame(t,e){const n=e.room.seating;if(!n)return!0;for(let r=0;r<t.length;r++){const e=t[r];if(!Object.values(n).includes(e))return!1}return!0}getPassesWonBy(t,e){const n=this.replayViewerDealService.getDealFromStore(e.deals[e.deals.length-1]);if(!n.northSouth||!n.eastWest)return!0;const r=Math.abs(n.northSouth.aboveTheLine+n.northSouth.totalBelowTheLineScore-(n.eastWest.aboveTheLine+n.eastWest.totalBelowTheLineScore));return"less"===t.type&&r<=t.amount||"more"===t.type&&r>=t.amount}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(l.yh),o.LFG(m))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),y=(()=>{class t{constructor(t,e,n,r,i,s){this.localStorageManager=t,this.helpersService=e,this.filterManagerService=n,this.store=r,this.router=i,this.route=s,this.shouldNavigateToGames=!1,this.username="",this.email="",this.userId="",this.localGameCount=0,this.gameCountFromServer=0,this.needToCreateLocalStorageUser=!1}static numberRequired(t){return e=>{let n=0;const r=Object.keys(e.controls);for(let t=0;t<r.length;t++){const i=e.controls[r[t]];""!==i.value&&null!=i.value&&n++}return n<t?{numberRequired:!1}:null}}getAreDealsLoaded(){let t=!1;return this.store.select(h.zW.deals).pipe((0,f.q)(1)).subscribe(e=>{t=Object.keys(e.fetchedDeals).length>0}),t}getAreGamesLoaded(){let t=!1;return this.store.select(h.zW.deals).pipe((0,f.q)(1)).subscribe(e=>{t=Object.keys(e.fetchedDeals).length>0}),t}getIsLoading(){let t=!1;return this.store.select(h.zW.general).pipe((0,f.q)(1)).subscribe(e=>{t=e.isLoading}),t}setCurrentlyDisplayingGames(){let t,e,n,r;this.store.select(h.zW.general).pipe((0,f.q)(1),(0,p.w)(r=>(t=r.sortingPreference,e=r.resultsPerPagePreference,n=r.batchNumber,t||(t=this.localStorageManager.getSortPreference()),e||(e=this.localStorageManager.getResultsPerPagePreference()),this.store.select(h.zW.users).pipe((0,f.q)(1))))).subscribe(i=>{if(r=i.currentlyViewingUser.games,!r)return;const o=this.filterManagerService.filterGames(r),a=(0,s.pn)(o,t,n>0?n:0,+e);this.store.dispatch(new u.i5(a))})}startRequest(t,e){return console.log("username =",t),console.log("email =",e),this.getShouldContinue(t,e)?(this.needToCreateLocalStorageUser=!1,this.username=t,this.email=e,this.userId=this.getLocalUserId(),this.userId?this.getGameCount():this.helpersService.getUser(t,e).subscribe(t=>{this.handleGetUserResponse(t)}),""):(this.filterManagerService.reset(),this.store.dispatch(new u.Bn(!1)),this.getAreGamesLoaded()&&this.router.url!==`/${s.rF}/games`?(this.router.navigate([s.rF,"games"]),void this.setCurrentlyDisplayingGames()):`Already viewing the games of <b>'${t||e}'</b>.`)}getDealsToLoad(t,e,n){const r=t;let i={};n&&(i=n);for(let s=0;s<e.length;s++){const t=e[s];i[t]&&delete r[t]}return r}getLocalUserId(){if(!this.localStorageManager.getLocalStorageUsers())return"";let t=this.localStorageManager.getIdFromUsername(this.username);return t||(t=this.localStorageManager.getIdFromEmail(this.email)),t}getGameCount(){this.localGameCount=this.localStorageManager.getLastGameCount(this.userId);const t=this.localStorageManager.getLocalStorageGames();this.localGameCount>Object.keys(t).length&&(this.localGameCount=0),this.helpersService.getGameCount(this.userId).subscribe(t=>{this.gameCountFromServer=t,this.handleGetGameCountResponse()})}getLocalStorageUserWithGames(t){if(this.needToCreateLocalStorageUser)this.localStorageManager.createLocalStorageUser(this.userId,this.username,this.email,t,this.gameCountFromServer+this.localGameCount);else if(!this.localStorageManager.appendGamesToLocalStorageUser(this.userId,t))return this.store.dispatch(new u.sd("Error appending games to localStorageUser"));return this.localStorageManager.updateEmailAndUsername(this.userId,this.username,this.email),this.localStorageManager.getPopulatedLocalStorageUser(this.userId)}getShouldContinue(t,e){let n=!1;return this.store.select(h.zW.users).pipe((0,f.q)(1)).subscribe(r=>{t||e||(n=!1),t?e||(n=r.currentlyViewingUser.username!==t):n=r.currentlyViewingUser.email!==e}),n}handleGetGameCountResponse(){const t=Math.abs(this.gameCountFromServer-this.localGameCount);if(0===this.gameCountFromServer&&0===this.localGameCount){const t="has not finished any games yet...";let e=`'${this.username}' ${t}`;return!this.username&&this.email&&(e=`The user with email '${this.email}' ${t}`),this.store.dispatch(new u.sd(e)),this.store.dispatch(new u.Bn(!1))}if(0===t){const t=this.localStorageManager.getGames(this.userId);return this.handleGetGamesResponse(t||[])}this.helpersService.getGames(this.userId,t).subscribe(t=>{this.handleGetGamesResponse(t)})}handleGetGamesResponse(t){console.log("games =",t);const e=this.getLocalStorageUserWithGames(t);e&&(this.localStorageManager.saveUserIds(null==e?void 0:e.userIds),this.loadDeals(e),this.store.dispatch(new u.G1(e||{})),this.setCurrentlyDisplayingGames())}handleGetUserResponse(t){t?(this.localStorageManager.getLocalStorageUser(t.id)||(this.needToCreateLocalStorageUser=!0),this.username=t.username,this.userId=t.id,this.getGameCount()):(this.store.dispatch(new u.sd(`There is no user with that ${this.username?"username":"email"}. &nbsp;&nbsp;He/She may have recently changed their ${this.username?"username":"email"} to something other than '${this.username?this.username:this.email}'.`)),this.store.dispatch(new u.Bn(!1)))}loadDeals(t){const[e,n]=this.helpersService.getNeededDeals(null==t?void 0:t.games);if(n.length<=0)return;this.store.dispatch(new u.Pm(n));const r=this.localStorageManager.getLocalStorageDeals(),i=this.getDealsToLoad(e,n,r||{});if(Object.keys(i).length>0)this.store.select(h.zW.deals).pipe((0,f.q)(1),(0,p.w)(t=>this.helpersService.getDeals(i))).subscribe(t=>{const e=Object.assign(Object.assign({},r),t);this.localStorageManager.saveDeals(e);const i=this.getRelevantDeals(e,n);this.store.dispatch(new u.Fb(i)),this.store.dispatch(new u.Bn(!1))});else{const t=this.getRelevantDeals(r||{},n);this.store.dispatch(new u.Fb(t)),this.store.dispatch(new u.Bn(!1))}}getRelevantDeals(t,e){const n={};for(let r=0;r<e.length;r++){const i=e[r];n[i]=t[i]}return n}}return t.noEmpty=t=>{var e;return null==t.value||""===(null===(e=t.value)||void 0===e?void 0:e.trim())?{isEmpty:!0}:null},t.\u0275fac=function(e){return new(e||t)(o.LFG(d),o.LFG(c),o.LFG(g),o.LFG(l.yh),o.LFG(i.F0),o.LFG(i.gz))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const _=["*"];let v=(()=>{class t{constructor(){}get classname(){return!0}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-grid"]],hostVars:2,hostBindings:function(t,e){2&t&&o.ekj("main-grid",e.classname)},ngContentSelectors:_,decls:1,vars:0,template:function(t,e){1&t&&(o.F$t(),o.Hsn(0))},styles:[""]}),t})();var b=n(9764),w=n(8318),x=n(8470),S=n(9996),E=n(2056);function A(t,e){return new w.y(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let s=0,o=0;for(let a=0;a<r;a++){const l=(0,b.D)(t[a]);let c=!1;n.add(l.subscribe({next:t=>{c||(c=!0,o++),i[a]=t},error:t=>n.error(t),complete:()=>{s++,s!==r&&c||(o===r&&n.next(e?e.reduce((t,e,n)=>(t[e]=i[n],t),{}):i),n.complete())}}))}})}let T=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}setProperty(t,e){this._renderer.setProperty(this._elementRef.nativeElement,t,e)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.Qsj),o.Y36(o.SBq))},t.\u0275dir=o.lG2({type:t}),t})(),C=(()=>{class t extends T{}return t.\u0275fac=function(){let e;return function(n){return(e||(e=o.n5z(t)))(n||t)}}(),t.\u0275dir=o.lG2({type:t,features:[o.qOj]}),t})();const M=new o.OlP("NgValueAccessor"),O={provide:M,useExisting:(0,o.Gpc)(()=>D),multi:!0},P=new o.OlP("CompositionEventMode");let D=(()=>{class t extends T{constructor(t,e,n){super(t,e),this._compositionMode=n,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=(0,r.q)()?(0,r.q)().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.Qsj),o.Y36(o.SBq),o.Y36(P,8))},t.\u0275dir=o.lG2({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&o.NdJ("input",function(t){return e._handleInput(t.target.value)})("blur",function(){return e.onTouched()})("compositionstart",function(){return e._compositionStart()})("compositionend",function(t){return e._compositionEnd(t.target.value)})},features:[o._Bn([O]),o.qOj]}),t})();function R(t){return null==t||0===t.length}function L(t){return null!=t&&"number"==typeof t.length}const I=new o.OlP("NgValidators"),N=new o.OlP("NgAsyncValidators"),k=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class F{static min(t){return function(t){return e=>{if(R(e.value)||R(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}(t)}static max(t){return function(t){return e=>{if(R(e.value)||R(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}(t)}static required(t){return function(t){return R(t.value)?{required:!0}:null}(t)}static requiredTrue(t){return function(t){return!0===t.value?null:{required:!0}}(t)}static email(t){return function(t){return R(t.value)||k.test(t.value)?null:{email:!0}}(t)}static minLength(t){return function(t){return e=>R(e.value)||!L(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}(t)}static maxLength(t){return B(t)}static pattern(t){return function(t){if(!t)return j;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(R(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return G(t)}static composeAsync(t){return q(t)}}function B(t){return e=>L(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function j(t){return null}function U(t){return null!=t}function V(t){const e=(0,o.QGY)(t)?(0,b.D)(t):t;return(0,o.CqO)(e),e}function z(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function $(t,e){return e.map(e=>e(t))}function H(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}function G(t){if(!t)return null;const e=t.filter(U);return 0==e.length?null:function(t){return z($(t,e))}}function W(t){return null!=t?G(H(t)):null}function q(t){if(!t)return null;const e=t.filter(U);return 0==e.length?null:function(t){return function(...t){if(1===t.length){const e=t[0];if((0,x.k)(e))return A(e,null);if((0,E.K)(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return A(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return A(t=1===t.length&&(0,x.k)(t[0])?t[0]:t,null).pipe((0,S.U)(t=>e(...t)))}return A(t,null)}($(t,e).map(V)).pipe((0,S.U)(z))}}function Z(t){return null!=t?q(H(t)):null}function Y(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function J(t){return t._rawValidators}function K(t){return t._rawAsyncValidators}let X=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=W(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Z(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.lG2({type:t}),t})(),Q=(()=>{class t extends X{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=o.n5z(t)))(n||t)}}(),t.\u0275dir=o.lG2({type:t,features:[o.qOj]}),t})();class tt extends X{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class et{constructor(t){this._cd=t}is(t){var e,n;return!!(null===(n=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===n?void 0:n[t])}}let nt=(()=>{class t extends et{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(tt,2))},t.\u0275dir=o.lG2({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&o.ekj("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))},features:[o.qOj]}),t})(),rt=(()=>{class t extends et{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(Q,10))},t.\u0275dir=o.lG2({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&o.ekj("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))},features:[o.qOj]}),t})();function it(t,e){at(t,e),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&ct(t,e)})}(t,e),function(t,e){const n=(t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&ct(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function(t,e){if(e.valueAccessor.setDisabledState){const n=t=>{e.valueAccessor.setDisabledState(t)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function st(t,e,n=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),lt(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function ot(t,e){t.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function at(t,e){const n=J(t);null!==e.validator?t.setValidators(Y(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const r=K(t);null!==e.asyncValidator?t.setAsyncValidators(Y(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();ot(e._rawValidators,i),ot(e._rawAsyncValidators,i)}function lt(t,e){let n=!1;if(null!==t){if(null!==e.validator){const r=J(t);if(Array.isArray(r)&&r.length>0){const i=r.filter(t=>t!==e.validator);i.length!==r.length&&(n=!0,t.setValidators(i))}}if(null!==e.asyncValidator){const r=K(t);if(Array.isArray(r)&&r.length>0){const i=r.filter(t=>t!==e.asyncValidator);i.length!==r.length&&(n=!0,t.setAsyncValidators(i))}}}const r=()=>{};return ot(e._rawValidators,r),ot(e._rawAsyncValidators,r),n}function ct(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function ut(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const ht="VALID",dt="INVALID",ft="PENDING",pt="DISABLED";function mt(t){return(vt(t)?t.validators:t)||null}function gt(t){return Array.isArray(t)?W(t):t||null}function yt(t,e){return(vt(e)?e.asyncValidators:t)||null}function _t(t){return Array.isArray(t)?Z(t):t||null}function vt(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class bt{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=gt(this._rawValidators),this._composedAsyncValidatorFn=_t(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===ht}get invalid(){return this.status===dt}get pending(){return this.status==ft}get disabled(){return this.status===pt}get enabled(){return this.status!==pt}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=gt(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=_t(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=ft,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=pt,this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=ht,this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==ht&&this.status!==ft||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?pt:ht}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=ft,this._hasOwnPendingAsyncValidator=!0;const e=V(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let r=t;return e.forEach(t=>{r=r instanceof xt?r.controls.hasOwnProperty(t)?r.controls[t]:null:r instanceof St&&r.at(t)||null}),r}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new o.vpe,this.statusChanges=new o.vpe}_calculateStatus(){return this._allControlsDisabled()?pt:this.errors?dt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ft)?ft:this._anyControlsHaveStatus(dt)?dt:ht}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){vt(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class wt extends bt{constructor(t=null,e,n){super(mt(e),yt(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){ut(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){ut(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class xt extends bt{constructor(t,e,n){super(mt(e),yt(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof wt?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class St extends bt{constructor(t,e,n){super(mt(e),yt(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof wt?t.value:t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}let Et=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.lG2({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})(),At=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({}),t})();const Tt=new o.OlP("NgModelWithFormControlWarning"),Ct={provide:Q,useExisting:(0,o.Gpc)(()=>Mt)};let Mt=(()=>{class t extends Q{constructor(t,e){super(),this.validators=t,this.asyncValidators=e,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new o.vpe,this._setValidators(t),this._setAsyncValidators(e)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(lt(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return it(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){st(t.control||null,t,!1),ut(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,e=this.directives,this.form._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}),this.ngSubmit.emit(t),!1;var e}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=t.control,n=this.form.get(t.path);e!==n&&(st(e||null,t),n instanceof wt&&(it(n,t),t.control=n))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const e=this.form.get(t.path);(function(t,e){at(t,e)})(e,t),e.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const e=this.form.get(t.path);e&&function(t,e){return lt(t,e)}(e,t)&&e.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){at(this.form,this),this._oldForm&&lt(this._oldForm,this)}_checkFormPresent(){}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(I,10),o.Y36(N,10))},t.\u0275dir=o.lG2({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&o.NdJ("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[o._Bn([Ct]),o.qOj,o.TTD]}),t})();const Ot={provide:tt,useExisting:(0,o.Gpc)(()=>Pt)};let Pt=(()=>{class t extends tt{constructor(t,e,n,r,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.update=new o.vpe,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=function(t,e){if(!e)return null;let n,r,i;return Array.isArray(e),e.forEach(t=>{t.constructor===D?n=t:Object.getPrototypeOf(t.constructor)===C?r=t:i=t}),i||r||n||null}(0,r)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),function(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return t=null==this.name?this.name:this.name.toString(),[...this._parent.path,t];var t}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(Q,13),o.Y36(I,10),o.Y36(N,10),o.Y36(M,10),o.Y36(Tt,8))},t.\u0275dir=o.lG2({type:t,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[o._Bn([Ot]),o.qOj,o.TTD]}),t._ngModelWarningSentOnce=!1,t})();const Dt={provide:M,useExisting:(0,o.Gpc)(()=>Lt),multi:!0};function Rt(t,e){return null==t?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let Lt=(()=>{class t extends C{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this.setProperty("selectedIndex",-1);const n=Rt(e,t);this.setProperty("value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=o.n5z(t)))(n||t)}}(),t.\u0275dir=o.lG2({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&o.NdJ("change",function(t){return e.onChange(t.target.value)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[o._Bn([Dt]),o.qOj]}),t})(),It=(()=>{class t{constructor(t,e,n){this._element=t,this._renderer=e,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(Rt(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(Lt,9))},t.\u0275dir=o.lG2({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const Nt={provide:M,useExisting:(0,o.Gpc)(()=>Ft),multi:!0};function kt(t,e){return null==t?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}let Ft=(()=>{class t extends C{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const r=t.item(e),i=this._getOptionValue(r.value);n.push(i)}}else{const t=e.options;for(let e=0;e<t.length;e++){const r=t.item(e);if(r.selected){const t=this._getOptionValue(r.value);n.push(t)}}}this.value=n,t(n)}}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=o.n5z(t)))(n||t)}}(),t.\u0275dir=o.lG2({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&o.NdJ("change",function(t){return e.onChange(t.target)})("blur",function(){return e.onTouched()})},inputs:{compareWith:"compareWith"},features:[o._Bn([Nt]),o.qOj]}),t})(),Bt=(()=>{class t{constructor(t,e,n){this._element=t,this._renderer=e,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(kt(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(kt(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(Ft,9))},t.\u0275dir=o.lG2({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const jt={provide:I,useExisting:(0,o.Gpc)(()=>Ut),multi:!0};let Ut=(()=>{class t{constructor(){this._validator=j}ngOnChanges(t){"maxlength"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return null!=this.maxlength?this._validator(t):null}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=B("number"==typeof this.maxlength?this.maxlength:parseInt(this.maxlength,10))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.lG2({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&o.uIk("maxlength",e.maxlength?e.maxlength:null)},inputs:{maxlength:"maxlength"},features:[o._Bn([jt]),o.TTD]}),t})(),Vt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[At]]}),t})(),zt=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Tt,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[Vt]}),t})();var $t=n(7570);let Ht=(()=>{class t{constructor(t,e,n,r){this.renderer=t,this.elRef=e,this.filterManagerService=n,this.store=r,this.filterItem=null,this.filterItemKey="",this.indexOfItem=-1,this.deletion=new o.vpe,this.FILTER_MANAGER_CLASSNAME=s.D5,this.messageToShow="",this.closeButtonHtmlEntity=s.xD[1],this.errorClassnames=["color-red-light"]}ngOnInit(){var t,e,n,r;const i=null===(t=this.elRef.nativeElement)||void 0===t?void 0:t.querySelector(`.${s.D5}__item-text`);(null===(e=this.filterItem)||void 0===e?void 0:e.error)?(this.changeErrorClasses(i,!1),this.messageToShow=this.filterItem.error):(this.changeErrorClasses(i,!0),this.messageToShow=(null===(n=this.filterItem)||void 0===n?void 0:n.message)?null===(r=this.filterItem)||void 0===r?void 0:r.message:"")}onDelete(){var t,e,n;const r=this.getStoreActionKey();this.deletion.emit({key:this.filterItemKey,resetAction:this.filterManagerService.filterResetActions[r],username:null===(t=this.filterItem)||void 0===t?void 0:t.username,card:null===(e=this.filterItem)||void 0===e?void 0:e.card}),this.resetValueAndClasses(null===(n=this.filterItem)||void 0===n?void 0:n.elementsToReset),this.resetBothDatesIfOneWithoutErrorBeingDeleted(this.filterItemKey)}changeErrorClasses(t,e=!1){t&&this.errorClassnames.forEach(n=>{e?this.renderer.removeClass(t,n):this.renderer.addClass(t,n)})}getStoreActionKey(){let t=this.filterItemKey;return t.match(/playerHasCard/i)?t=this.filterManagerService.filters.playerHasCard.string:t.match(/playerInGame/i)&&!t.match(/error/i)&&(t=this.filterManagerService.filters.playerInGame.string),t}resetValueAndClasses(t){if(t)for(let e=0;e<t.length;e++){const n=t[e];let r=n;n.nativeElement&&(r=n.nativeElement),"select"!==r.localName&&(r.value=""),this.filterManagerService.setInputErrorClassnames(r,!0)}}resetBothDatesIfOneWithoutErrorBeingDeleted(t){const{beforeDate:e,beforeDateElement:n,afterDate:r,afterDateElement:i}=this.filterManagerService.getBeforeAndAfterDateInfo();(t===this.filterManagerService.filters.afterDate.string&&-1===e||t===this.filterManagerService.filters.beforeDate.string&&-1===r)&&(n.value="",i.value="",this.store.dispatch(new u.pf(this.filterManagerService.filtersInitial.beforeDate)),this.store.dispatch(new u.oJ(this.filterManagerService.filtersInitial.afterDate)),this.filterManagerService.setInputErrorClassnames(n,!0),this.filterManagerService.setInputErrorClassnames(i,!0))}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.Qsj),o.Y36(o.SBq),o.Y36(g),o.Y36(l.yh))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-filter-manager-item"]],inputs:{filterItem:"filterItem",filterItemKey:"filterItemKey",indexOfItem:"indexOfItem"},outputs:{deletion:"deletion"},decls:4,vars:11,consts:[[3,"innerHtml","click"],[1,"filter-manager__item-text",3,"innerHtml"]],template:function(t,e){1&t&&(o.TgZ(0,"div"),o.TgZ(1,"div"),o.TgZ(2,"button",0),o.NdJ("click",function(){return e.onDelete()}),o.qZA(),o._UZ(3,"span",1),o.qZA(),o.qZA()),2&t&&(o.Gre("",e.FILTER_MANAGER_CLASSNAME,"__item"),o.xp6(1),o.Gre("",e.FILTER_MANAGER_CLASSNAME,"__item-container"),o.xp6(1),o.Gre("",e.FILTER_MANAGER_CLASSNAME,"__button ui button"),o.Q6J("innerHtml",e.closeButtonHtmlEntity,o.oJD),o.xp6(1),o.Q6J("innerHtml",e.messageToShow,o.oJD))},styles:[""]}),t})(),Gt=(()=>{class t{transform(t){return t?t===s.DP[0]||t===s.tB[0]?t:(0,s.V4)(t):"No contract in getContractAsHtmlEntityString"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Yjl({name:"getContractAsHtmlEntityString",type:t,pure:!0}),t})(),Wt=(()=>{class t{transform(t){return(0,s.mz)(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Yjl({name:"cardAsNumberToCardHtmlEntityString",type:t,pure:!0}),t})();const qt=["game"],Zt=["gameName"],Yt=["playerInGame"],Jt=["wonBy"],Kt=["date"],Xt=["deal"],Qt=["dealResult"],te=["playerHasCard"],ee=["contract"],ne=["declarer"],re=["openingBid"],ie=["double"],se=["beforeDate"],oe=["afterDate"],ae=["players"],le=["cards"],ce=["contractsSelect"],ue=["dealResultAmount"],he=["dealResultType"],de=["declarerSelect"],fe=["gameNameSelect"],pe=["openingBidSelect"],me=["doubleSelect"],ge=["playerInGameSelect"],ye=["wonByAmount"],_e=["wonByType"];function ve(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"nx-bridge-filter-manager-item",12),o.NdJ("deletion",function(e){return o.CHM(t),o.oxw(2).onFilterItemDeletion(e)}),o.qZA()}if(2&t){const t=e.$implicit,n=e.index;o.Q6J("filterItem",t.value)("filterItemKey",t.key)("indexOfItem",n)}}function be(t,e){if(1&t&&(o.TgZ(0,"div",9,10),o.TgZ(2,"span"),o._uU(3,"Applied:"),o.qZA(),o.TgZ(4,"div"),o.YNc(5,ve,1,3,"nx-bridge-filter-manager-item",11),o.ALo(6,"keyvalue"),o.qZA(),o.qZA()),2&t){const t=o.oxw();o.xp6(4),o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__item-grid"),o.xp6(1),o.Q6J("ngForOf",o.lcZ(6,4,t.filterItems))}}function we(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,14),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onContractClick()}),o.qZA(),o._uU(3," Contract was ... "),o.qZA()}}function xe(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,15),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onDoubleClick()}),o.qZA(),o._uU(3," Deal was doubled ... "),o.qZA()}}function Se(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,16),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onDeclarerClick()}),o.qZA(),o._uU(3," Declarer was ... "),o.qZA()}}function Ee(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,17),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onOpeningBidClick()}),o.qZA(),o._uU(3," Opening bid was ... "),o.qZA()}}function Ae(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,18),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onPlayerHasCardClick()}),o.qZA(),o._uU(3," Player had a specific card "),o.qZA()}}function Te(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,19),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onDealResultClick()}),o.qZA(),o._uU(3," Deal result was ... "),o.qZA()}}function Ce(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,20),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onGameNameClick()}),o.qZA(),o._uU(3," Game was named ... "),o.qZA()}}function Me(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,21),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onPlayerInGameClick()}),o.qZA(),o._uU(3," Player was in game "),o.qZA()}}function Oe(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"label"),o.TgZ(1,"input",4,22),o.NdJ("click",function(){return o.CHM(t),o.oxw(2).onWonByClick()}),o.qZA(),o._uU(3," Won by ... than ... "),o.qZA()}}function Pe(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label"),o._uU(2," Completed after: "),o.TgZ(3,"input",23,24),o.NdJ("change",function(e){return o.CHM(t),o.oxw(3).onDateAfterChange(e)}),o.qZA(),o.qZA(),o.TgZ(5,"label"),o._uU(6," Completed before: "),o.TgZ(7,"input",25,26),o.NdJ("change",function(e){return o.CHM(t),o.oxw(3).onDateBeforeChange(e)}),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__date"),o.xp6(1),o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__date-inputs"),o.xp6(4),o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__date-inputs")}}function De(t,e){if(1&t&&(o._UZ(0,"option",32),o.ALo(1,"getContractAsHtmlEntityString")),2&t){const t=e.$implicit,n=e.index;o.Tol((n-1)%5==1||(n-1)%5==2?"color-red":"color-black"),o.s9C("innerHTML",o.lcZ(1,4,t),o.oJD),o.Q6J("value",n-1)}}function Re(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Contract was :"),o.qZA(),o.TgZ(4,"select",28,29),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onContractChange()}),o.YNc(6,De,2,6,"option",30),o.qZA(),o.qZA(),o.TgZ(7,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddContract(e)}),o._uU(8," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__contract"),o.xp6(4),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.contracts)}}function Le(t,e){if(1&t&&(o.TgZ(0,"option",35),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.Q6J("value",2*e.index),o.xp6(1),o.hij(" ",t," ")}}function Ie(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Deal was doubled:"),o.qZA(),o.TgZ(4,"select",28,33),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onDoubleChange()}),o.YNc(6,Le,2,2,"option",34),o.qZA(),o.qZA(),o.TgZ(7,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddDouble(e)}),o._uU(8," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__double"),o.xp6(4),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.doubleOptions)}}function Ne(t,e){if(1&t&&(o.TgZ(0,"option"),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.xp6(1),o.hij(" ",t," ")}}function ke(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Declarer was:"),o.qZA(),o.TgZ(4,"select",36,37),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onDeclarerChange()}),o.YNc(6,Ne,2,1,"option",38),o.qZA(),o.qZA(),o.TgZ(7,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddDeclarer(e)}),o._uU(8," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__declarer"),o.xp6(4),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.playerNames)}}function Fe(t,e){if(1&t&&(o._UZ(0,"option",32),o.ALo(1,"getContractAsHtmlEntityString")),2&t){const t=e.$implicit,n=e.index;o.Tol((n-1)%5==1||(n-1)%5==2?"color-red":"color-black"),o.s9C("innerHTML",o.lcZ(1,4,t),o.oJD),o.Q6J("value",n-1)}}function Be(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Opening bid was :"),o.qZA(),o.TgZ(4,"select",28,39),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onOpeningBidChange()}),o.YNc(6,Fe,2,6,"option",30),o.qZA(),o.qZA(),o.TgZ(7,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddOpeningBid(e)}),o._uU(8," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__opening-bid"),o.xp6(4),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.bids)}}function je(t,e){if(1&t&&(o.TgZ(0,"option"),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.xp6(1),o.hij(" ",t," ")}}const Ue=function(t,e){return{"color-red":t,"color-black":e,"filter-manager__player-options":!0}};function Ve(t,e){if(1&t&&(o._UZ(0,"option",43),o.ALo(1,"cardAsNumberToCardHtmlEntityString")),2&t){const t=e.index;o.s9C("innerHTML",o.lcZ(1,3,e.$implicit),o.oJD),o.Q6J("ngClass",o.WLB(5,Ue,t>=14&&t<=39,t<14||t>39))("value",t-1)}}function ze(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Player:"),o.qZA(),o.TgZ(4,"select",36,40),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onPlayerHasCardChange()}),o.YNc(6,je,2,1,"option",38),o.qZA(),o.TgZ(7,"span"),o._uU(8,"\xa0had the\xa0"),o.qZA(),o.TgZ(9,"select",28,41),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onPlayerHasCardChange()}),o.YNc(11,Ve,2,8,"option",42),o.qZA(),o.qZA(),o.TgZ(12,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddPlayerHasCard(e)}),o._uU(13," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__player-has-card"),o.xp6(4),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.playerNames),o.xp6(3),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.cardsAsNumbers)}}function $e(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Deal result was:"),o.qZA(),o.TgZ(4,"span"),o.TgZ(5,"select",44,45),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onDealResultChange()}),o.TgZ(7,"option",46),o._uU(8,"="),o.qZA(),o._UZ(9,"option",47),o._UZ(10,"option",48),o.qZA(),o.TgZ(11,"input",49,50),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onDealResultChange()}),o.qZA(),o.qZA(),o.qZA(),o.TgZ(13,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddDealResult(e)}),o._uU(14," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__deal-result"),o.xp6(4),o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__item-options"),o.xp6(5),o.Q6J("innerHtml",t.comparers.lessThanEqualTo,o.oJD),o.xp6(1),o.Q6J("innerHtml",t.comparers.greaterThanEqualTo,o.oJD)}}function He(t,e){if(1&t&&(o.TgZ(0,"option",35),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.Q6J("value",t),o.xp6(1),o.hij(" ",t," ")}}function Ge(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Game was named:"),o.qZA(),o.TgZ(4,"select",36,51),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onGameNameChange()}),o.YNc(6,He,2,2,"option",34),o.qZA(),o.qZA(),o.TgZ(7,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddGameName(e)}),o._uU(8," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__game-name"),o.xp6(4),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.gameNames)}}function We(t,e){if(1&t&&(o.TgZ(0,"option"),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.xp6(1),o.hij(" ",t," ")}}function qe(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Player was in game:"),o.qZA(),o.TgZ(4,"select",36,52),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onPlayerInGameChange()}),o.YNc(6,We,2,1,"option",38),o.qZA(),o.qZA(),o.TgZ(7,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddPlayerInGame(e)}),o._uU(8," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__player-in-game"),o.xp6(4),o.Tol(t.joinedInputErrorClassnames),o.xp6(2),o.Q6J("ngForOf",t.playerNames)}}function Ze(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div"),o.TgZ(1,"label",27),o.TgZ(2,"span"),o._uU(3,"Won by:"),o.qZA(),o.TgZ(4,"span"),o.TgZ(5,"select",44,53),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onWonByChange()}),o._UZ(7,"option",47),o._UZ(8,"option",48),o.qZA(),o.TgZ(9,"input",54,55),o.NdJ("click",function(){return o.CHM(t),o.oxw(3).onWonByChange()}),o.qZA(),o.qZA(),o.TgZ(11,"span"),o._uU(12,"points"),o.qZA(),o.qZA(),o.TgZ(13,"button",31),o.NdJ("click",function(e){return o.CHM(t),o.oxw(3).onAddWonBy(e)}),o._uU(14," Add "),o.qZA(),o.qZA()}if(2&t){const t=o.oxw(3);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__won-by"),o.xp6(4),o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__item-options"),o.xp6(3),o.Q6J("innerHtml",t.comparers.lessThanEqualTo,o.oJD),o.xp6(1),o.Q6J("innerHtml",t.comparers.greaterThanEqualTo,o.oJD)}}function Ye(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,Pe,9,9,"div",8),o.YNc(2,Re,9,7,"div",8),o.YNc(3,Ie,9,7,"div",8),o.YNc(4,ke,9,7,"div",8),o.YNc(5,Be,9,7,"div",8),o.YNc(6,ze,14,11,"div",8),o.YNc(7,$e,15,8,"div",8),o.YNc(8,Ge,9,7,"div",8),o.YNc(9,qe,9,7,"div",8),o.YNc(10,Ze,15,8,"div",8),o.qZA()),2&t){const t=o.oxw(2),e=o.MAs(12),n=o.MAs(16),r=o.MAs(20);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__details-filters"),o.xp6(1),o.Q6J("ngIf",e.checked),o.xp6(1),o.Q6J("ngIf",n.checked&&(null==t.contractCheckbox?null:t.contractCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",n.checked&&(null==t.doubleCheckbox?null:t.doubleCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",n.checked&&(null==t.declarerCheckbox?null:t.declarerCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",n.checked&&(null==t.openingBidCheckbox?null:t.openingBidCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",n.checked&&!0===(null==t.playerHasCardCheckbox?null:t.playerHasCardCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",n.checked&&(null==t.dealResultCheckbox?null:t.dealResultCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",r.checked&&(null==t.gameNameCheckbox?null:t.gameNameCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",r.checked&&(null==t.playerInGameCheckbox?null:t.playerInGameCheckbox.nativeElement.checked)),o.xp6(1),o.Q6J("ngIf",r.checked&&(null==t.wonByCheckbox?null:t.wonByCheckbox.nativeElement.checked))}}function Je(t,e){if(1&t&&(o.TgZ(0,"div"),o.TgZ(1,"div"),o.YNc(2,we,4,0,"label",13),o.YNc(3,xe,4,0,"label",13),o.YNc(4,Se,4,0,"label",13),o.YNc(5,Ee,4,0,"label",13),o.YNc(6,Ae,4,0,"label",13),o.YNc(7,Te,4,0,"label",13),o.YNc(8,Ce,4,0,"label",13),o.YNc(9,Me,4,0,"label",13),o.YNc(10,Oe,4,0,"label",13),o.qZA(),o.YNc(11,Ye,11,13,"div",8),o.qZA()),2&t){const t=o.oxw(),e=o.MAs(16),n=o.MAs(20),r=o.MAs(12);o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__details"),o.xp6(1),o.Gre("",t.FILTER_MANANGER_CLASSNAME,"__details-checkboxes"),o.xp6(1),o.Q6J("ngIf",e.checked),o.xp6(1),o.Q6J("ngIf",e.checked),o.xp6(1),o.Q6J("ngIf",e.checked),o.xp6(1),o.Q6J("ngIf",e.checked),o.xp6(1),o.Q6J("ngIf",e.checked),o.xp6(1),o.Q6J("ngIf",e.checked),o.xp6(1),o.Q6J("ngIf",n.checked),o.xp6(1),o.Q6J("ngIf",n.checked),o.xp6(1),o.Q6J("ngIf",n.checked),o.xp6(1),o.Q6J("ngIf",r.checked||e.checked||n.checked)}}let Ke=(()=>{class t{constructor(t,e,n,r,i,o){this.renderer=t,this.elRef=e,this.store=n,this.searchService=r,this.filterManagerService=i,this.router=o,this.gameCheckbox=null,this.gameNameCheckbox=null,this.playerInGameCheckbox=null,this.wonByCheckbox=null,this.dateCheckbox=null,this.dealCheckbox=null,this.dealResultCheckbox=null,this.playerHasCardCheckbox=null,this.contractCheckbox=null,this.declarerCheckbox=null,this.openingBidCheckbox=null,this.doubleCheckbox=null,this.beforeDateFilterElement=null,this.afterDateFilterElement=null,this.playersFilterElement=null,this.cardsFilterElement=null,this.contractsFilterElement=null,this.dealResultAmountFilterElement=null,this.dealResultTypeFilterElement=null,this.declarerFilterElement=null,this.gameNameFilterElement=null,this.openingBidFilterElement=null,this.doubleFilterElement=null,this.playerInGameFilterElement=null,this.wonByAmountFilterElement=null,this.wonByTypeFilterElement=null,this.lastButtonPressed=null,this.hasPlayerHasCardChanged=!1,this.FILTER_MANANGER_CLASSNAME=s.D5,this.DISPLAY_NONE_CLASSNAME=s.ze,this.beforeDate={date:null},this.afterDate={date:null},this.filterItems={},this.contracts=[...s.DP,...s.re],this.bids=[...s.tB,...s.re],this.cardsAsNumbers=s.U1,this.playerNames=s.qX,this.gameNames=s.BJ,this.doubleOptions=s.Fz,this.comparers=s.mh}get classname(){return!0}get toggleHidden(){return!this.searchService.getAreDealsLoaded()}get toggleDisplayNone(){return!(window.innerWidth<=s.jH)&&(!this.searchService.getAreDealsLoaded()&&window.innerWidth<=s.jH||this.router.url===`/${s.rF}`)}get getHeightAuto(){return window.innerWidth<=s.jH&&!this.searchService.getAreDealsLoaded()}get toggleAnnounceSelf(){return this.searchService.getAreDealsLoaded()}get joinedInputErrorClassnames(){return this.filterManagerService.inputErrorClassnames.join(" ")}get filterItemsLength(){return Object.keys(this.filterItems).length}ngOnInit(){this.store.select(h.zW.deals).subscribe(t=>{if(t.fetchedDeals&&this.playerNames.length<=1){console.log("adding unique player names------------------------------------------------");const e=this.filterManagerService.getUniquePlayerNames(t.fetchedDeals);e&&(this.playerNames=[...s.qX,...e])}}),this.store.select(h.zW.users).subscribe(t=>{if(t.currentlyViewingUser.games){console.log("adding unique game names------------------------------------------------");const e=this.filterManagerService.getUniqueGameNames(t.currentlyViewingUser.games);e&&(this.gameNames=[...s.BJ,...e])}})}addFilterItem(t,e,n){this.store.dispatch(e),this.store.dispatch(new u.Ms(!1)),this.searchService.setCurrentlyDisplayingGames(),this.filterItems[n]=t,delete this.filterItems[`${this.filterManagerService.filters.playerHasCard.errorKey}`],delete this.filterItems[`${this.filterManagerService.filters.playerInGame.errorKey}`]}onAddContract(t){var e;const n=t.currentTarget||t.target;if(!this.getCanAdd(t,n))return;const r=null===(e=this.contractsFilterElement)||void 0===e?void 0:e.nativeElement,i=s.re[+r.value];if(!i)return;this.lastButtonPressed=n,this.filterManagerService.setInputErrorClassnames(r,!0);const o={message:`${this.filterManagerService.filterMsgs.contract.valid} ${(0,s.V4)(i)}.`,error:"",elementsToReset:[r]};this.addFilterItem(o,new u.f1(i),this.filterManagerService.filters.contract.string)}onAddDealResult(t){var e,n;const r=t.currentTarget||t.target;if(!this.getCanAdd(t,r))return;const i=null===(e=this.dealResultAmountFilterElement)||void 0===e?void 0:e.nativeElement,s=null===(n=this.dealResultTypeFilterElement)||void 0===n?void 0:n.nativeElement,o=+i.value,a=s.value;if(o<-13||o>7||void 0===o||isNaN(o)||!a)return;this.lastButtonPressed=r,this.filterManagerService.setInputErrorClassnames(i,!0),this.filterManagerService.setInputErrorClassnames(s,!0);let l="=";"less"===a||"more"===a&&(l=this.comparers.greaterThanEqualTo);const c={message:`${this.filterManagerService.filterMsgs.dealResult.valid} ${l} ${0===o?"made bid":o>0?`${Math.abs(o)} overtrick`:`${Math.abs(o)} undertrick`}.`,error:"",elementsToReset:[i]};this.addFilterItem(c,new u.XL({amount:+o,type:a}),this.filterManagerService.filters.dealResult.string)}onAddDeclarer(t){var e;const n=t.currentTarget||t.target;if(!this.getCanAdd(t,n))return;const r=null===(e=this.declarerFilterElement)||void 0===e?void 0:e.nativeElement,i=r.value;i!==this.playerNames[0]&&(this.lastButtonPressed=n,this.filterManagerService.setInputErrorClassnames(r,!0),this.addFilterItem({message:`${this.filterManagerService.filterMsgs.declarer.valid} '${i}'.`,error:"",elementsToReset:[r]},new u.zJ(i),this.filterManagerService.filters.declarer.string))}onAddDouble(t){var e;const n=t.currentTarget||t.target;if(!this.getCanAdd(t,n))return;const r=null===(e=this.doubleFilterElement)||void 0===e?void 0:e.nativeElement,i=+r.value;i&&!isNaN(i)&&(this.lastButtonPressed=n,this.filterManagerService.setInputErrorClassnames(r,!0),this.addFilterItem({message:`${this.filterManagerService.filterMsgs.double.valid} ${2===i?"once":"twice"}.`,error:"",elementsToReset:[r]},new u.Ex(i),this.filterManagerService.filters.double.string))}onAddGameName(t){var e;const n=t.currentTarget||t.target;if(!this.getCanAdd(t,n))return;const r=null===(e=this.gameNameFilterElement)||void 0===e?void 0:e.nativeElement,i=r.value;i&&(this.lastButtonPressed=n,this.filterManagerService.setInputErrorClassnames(r,!0),this.addFilterItem({message:`${this.filterManagerService.filterMsgs.gameName.valid} ${i}`,error:"",elementsToReset:[r]},new u.fm(i),this.filterManagerService.filters.gameName.string))}onAddOpeningBid(t){var e;const n=t.currentTarget||t.target;if(!this.getCanAdd(t,n))return;const r=null===(e=this.openingBidFilterElement)||void 0===e?void 0:e.nativeElement,i=s.re[+r.value];if(!i)return;this.lastButtonPressed=n,this.filterManagerService.setInputErrorClassnames(r,!0);const o={message:`${this.filterManagerService.filterMsgs.openingBid.valid} ${(0,s.V4)(i)}`,error:"",elementsToReset:[r]};this.addFilterItem(o,new u.k7(i),this.filterManagerService.filters.openingBid.string)}onAddPlayerHasCard(t){var e,n;const r=t.currentTarget||t.target,i=null===(e=this.cardsFilterElement)||void 0===e?void 0:e.nativeElement,o=null===(n=this.playersFilterElement)||void 0===n?void 0:n.nativeElement,a=+(null==i?void 0:i.value),l=null==o?void 0:o.value,c=this.filterManagerService.getIsSelectedCardUsedAlready(a);if(c)return void(this.hasPlayerHasCardChanged&&(this.filterItems[this.filterManagerService.filters.playerHasCard.errorKey]=this.filterManagerService.getPlayerHasCardErrorMessage(c,a)));this.lastButtonPressed=r,delete this.filterItems[this.filterManagerService.filters.playerHasCard.errorKey];let d=!1,p=!1;if(a>=s.v8&&a<=s.Zp&&(d=!0),l.match(this.playerNames[0])||(p=!0),this.filterManagerService.setInputErrorClassnames(i,d),this.filterManagerService.setInputErrorClassnames(o,p),d&&p){let t={};this.store.select(h.zW.filters).pipe((0,f.q)(1)).subscribe(e=>{t=e.playerHasCard;const n=t[l],r=t.initial;if(!r&&(null==n?void 0:n.includes(a)))return;const[s,c]=this.filterManagerService.getPlayerHasCardFilterItem(i,o,a,l);let h=new u.cd({[l]:[a]});r&&(h=new u.dQ({[l]:[a]})),this.addFilterItem(c,h,s),this.hasPlayerHasCardChanged=!1})}}onAddPlayerInGame(t){var e;const n=null===(e=this.playerInGameFilterElement)||void 0===e?void 0:e.nativeElement,r=n.value;if(r===s.qX[0])return;this.lastButtonPressed=t.currentTarget||t.target,this.filterManagerService.setInputErrorClassnames(n,!0);const i=this.filterManagerService.getPlayerInGameFilter(),o=i.length>=4,a=i.includes(r),l={message:`'${r}' ${this.filterManagerService.filterMsgs.playerInGame.valid}`,error:a?`${r} ${this.filterManagerService.filterMsgs.playerInGame.invalid.alreadyPresent}`:o?this.filterManagerService.filterMsgs.playerInGame.invalid.tooMany:"",elementsToReset:[n],username:r};if(o||a)this.filterItems[`${this.filterManagerService.filters.playerInGame.string}-error`]=l;else{const t=i.includes(`${u.oc}`)?"0":i.length;this.addFilterItem(l,new u.Q2(r),`${this.filterManagerService.filters.playerInGame.string}-${t}`)}}onAddWonBy(t){var e,n;const r=t.currentTarget||t.target;if(!this.getCanAdd(t,r))return;const i=null===(e=this.wonByAmountFilterElement)||void 0===e?void 0:e.nativeElement,s=null===(n=this.wonByTypeFilterElement)||void 0===n?void 0:n.nativeElement,o=+i.value,a=s.value;if(o<0||void 0===o||isNaN(o)||!a)return;this.lastButtonPressed=r,this.filterManagerService.setInputErrorClassnames(i,!0),this.filterManagerService.setInputErrorClassnames(s,!0);let l=`${this.filterManagerService.filterMsgs.wonBy.valid.pre} ${"less"===a?this.comparers.lessThanEqualTo:this.comparers.greaterThanEqualTo} <b>${o}</b> ${this.filterManagerService.filterMsgs.wonBy.valid.post}`;0===o&&"less"===a&&(l="Game was a tie."),this.addFilterItem({message:l,error:"",elementsToReset:[i]},new u.SJ({amount:+o,type:a}),this.filterManagerService.filters.wonBy.string)}onContractChange(){this.lastButtonPressed=null}onContractClick(){}onDateClick(t){}onDateBeforeChange(t){this.lastButtonPressed=null;const e=this.handleDateChange(t,h.Uv.before);this.dispatchChanges(this.beforeDate,e,h.Uv.before)}onDealClick(t){}onDeclarerChange(){this.lastButtonPressed=null}onDateAfterChange(t){this.lastButtonPressed=null;const e=this.handleDateChange(t,h.Uv.after);this.dispatchChanges(this.afterDate,e,h.Uv.after)}onDealResultClick(){this.lastButtonPressed=null}onDealResultChange(){this.lastButtonPressed=null}onDeclarerClick(){}onDoubleClick(){}onDoubleChange(){this.lastButtonPressed=null}onGameClick(t){}onGameNameChange(){this.lastButtonPressed=null}onGameNameClick(){}onPlayerInGameChange(){this.lastButtonPressed=null}onPlayerInGameClick(){}onPlayerHasCardChange(){this.lastButtonPressed=null,this.hasPlayerHasCardChanged=!0}onPlayerHasCardClick(){}onOpeningBidChange(){this.lastButtonPressed=null}onOpeningBidClick(){}onWonByChange(){this.lastButtonPressed=null}onWonByClick(){}onFilterItemDeletion(t){if(!t.key)throw new Error("No toDelete.key...");this.lastButtonPressed=null,delete this.filterItems[t.key],this.filterManagerService.getShouldResetStoreOnDeletion(t)&&(this.filterManagerService.dispatchCorrectResetAction(t),this.store.dispatch(new u.Ms(!1)),this.searchService.setCurrentlyDisplayingGames(),this.removeBothDatesIfOneHasError(t)),this.deleteErrors(t),this.filterItems&&this.filterManagerService.canResetDealsThatMatchFilters(this.filterItems)&&this.store.dispatch(this.filterManagerService.filterResetActions.dealsThatMatchFilters)}onHide(){const t=this.elRef.nativeElement,e=t.querySelector(`.${s.D5}__details`),n=t.querySelector(`.${s.D5}__filters`),r=t.querySelector(`.${s.D5}__hide`);(null==n?void 0:n.classList.contains(s.u$))?(e&&this.renderer.removeClass(e,s.u$),n&&this.renderer.removeClass(n,s.u$),r.innerHTML="Hide"):(e&&this.renderer.addClass(e,s.u$),n&&this.renderer.addClass(n,s.u$),r.innerHTML="Show")}onReset(){const t=[this.gameCheckbox,this.dateCheckbox,this.dealCheckbox],e=[this.beforeDateFilterElement,this.afterDateFilterElement];this.beforeDate.date=null,this.afterDate.date=null,this.filterItems={},this.filterManagerService.resetElements(t,"checked",!1),this.filterManagerService.resetElements(e,"value",""),this.filterManagerService.reset(),this.dispatchChanges(this.afterDate,!0,h.Uv.after),(0,s.St)()}getCanAdd(t,e){return this.lastButtonPressed!==e}deleteError(t,e,n){t.key.match(e)&&delete this.filterItems[n]}deleteErrors(t){this.deleteError(t,"",this.filterManagerService.filters.playerHasCard.errorKey),this.deleteError(t,"",this.filterManagerService.filters.playerInGame.errorKey)}dispatchChanges(t,e,n){var r;let i=null===(r=t.date)||void 0===r?void 0:r.getTime();e?this.store.dispatch(new u.Ms(!1)):i=-1,this.store.dispatch(n===h.Uv.before?new u.pf(i):new u.oJ(i)),this.searchService.setCurrentlyDisplayingGames()}getCorrectFilter(t){let e=this.beforeDate,n=this.filterManagerService.filterMsgs.date.before.valid;return t===h.Uv.after&&(e=this.afterDate,n=this.filterManagerService.filterMsgs.date.after.valid),{filterMsg:n,filterName:e}}getNewElement(t){return this.renderer.createElement(t)}handleDateChange(t,e){let n=!1;const r=t.currentTarget||t.target,{isDateInvalid:i,dateObj:o,filterMsgError:a}=this.filterManagerService.validateDate(r.value,e,this.beforeDate,this.afterDate),{filterMsg:l,filterName:c}=this.getCorrectFilter(e);c.date=i?null:o;const u=(0,s.GN)(c,l),d={message:u,error:u!==s.i1?"":a,date:o,isDateInvalid:i,elementsToReset:[e===h.Uv.before?this.beforeDateFilterElement:this.afterDateFilterElement]};e===h.Uv.before?this.filterItems[this.filterManagerService.filters.beforeDate.string]=d:this.filterItems[this.filterManagerService.filters.afterDate.string]=d;let f=!1;return i||(f=!0,n=!0),this.filterManagerService.setInputErrorClassnames(r,f),n}removeBothDatesIfOneHasError(t){if(!t)return;const{beforeDate:e,afterDate:n}=this.filterManagerService.getBeforeAndAfterDateInfo();(t.key===this.filterManagerService.filters.afterDate.string&&-1===e||t.key===this.filterManagerService.filters.beforeDate.string&&-1===n)&&(delete this.filterItems[this.filterManagerService.filters.beforeDate.string],delete this.filterItems[this.filterManagerService.filters.afterDate.string])}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.Qsj),o.Y36(o.SBq),o.Y36(l.yh),o.Y36(y),o.Y36(g),o.Y36(i.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-filter-manager"]],viewQuery:function(t,e){if(1&t&&(o.Gf(qt,5),o.Gf(Zt,5),o.Gf(Yt,5),o.Gf(Jt,5),o.Gf(Kt,5),o.Gf(Xt,5),o.Gf(Qt,5),o.Gf(te,5),o.Gf(ee,5),o.Gf(ne,5),o.Gf(re,5),o.Gf(ie,5),o.Gf(se,5),o.Gf(oe,5),o.Gf(ae,5),o.Gf(le,5),o.Gf(ce,5),o.Gf(ue,5),o.Gf(he,5),o.Gf(de,5),o.Gf(fe,5),o.Gf(pe,5),o.Gf(me,5),o.Gf(ge,5),o.Gf(ye,5),o.Gf(_e,5)),2&t){let t;o.iGM(t=o.CRH())&&(e.gameCheckbox=t.first),o.iGM(t=o.CRH())&&(e.gameNameCheckbox=t.first),o.iGM(t=o.CRH())&&(e.playerInGameCheckbox=t.first),o.iGM(t=o.CRH())&&(e.wonByCheckbox=t.first),o.iGM(t=o.CRH())&&(e.dateCheckbox=t.first),o.iGM(t=o.CRH())&&(e.dealCheckbox=t.first),o.iGM(t=o.CRH())&&(e.dealResultCheckbox=t.first),o.iGM(t=o.CRH())&&(e.playerHasCardCheckbox=t.first),o.iGM(t=o.CRH())&&(e.contractCheckbox=t.first),o.iGM(t=o.CRH())&&(e.declarerCheckbox=t.first),o.iGM(t=o.CRH())&&(e.openingBidCheckbox=t.first),o.iGM(t=o.CRH())&&(e.doubleCheckbox=t.first),o.iGM(t=o.CRH())&&(e.beforeDateFilterElement=t.first),o.iGM(t=o.CRH())&&(e.afterDateFilterElement=t.first),o.iGM(t=o.CRH())&&(e.playersFilterElement=t.first),o.iGM(t=o.CRH())&&(e.cardsFilterElement=t.first),o.iGM(t=o.CRH())&&(e.contractsFilterElement=t.first),o.iGM(t=o.CRH())&&(e.dealResultAmountFilterElement=t.first),o.iGM(t=o.CRH())&&(e.dealResultTypeFilterElement=t.first),o.iGM(t=o.CRH())&&(e.declarerFilterElement=t.first),o.iGM(t=o.CRH())&&(e.gameNameFilterElement=t.first),o.iGM(t=o.CRH())&&(e.openingBidFilterElement=t.first),o.iGM(t=o.CRH())&&(e.doubleFilterElement=t.first),o.iGM(t=o.CRH())&&(e.playerInGameFilterElement=t.first),o.iGM(t=o.CRH())&&(e.wonByAmountFilterElement=t.first),o.iGM(t=o.CRH())&&(e.wonByTypeFilterElement=t.first)}},hostVars:10,hostBindings:function(t,e){2&t&&o.ekj("filter-manager",e.classname)("hidden",e.toggleHidden)("d-none",e.toggleDisplayNone)("h-0",e.getHeightAuto)("announce-self",e.toggleAnnounceSelf)},decls:23,vars:14,consts:[[1,"ui","form"],[1,"ui","header"],["type","button",3,"click"],["class","filter-manager__applied ui field",4,"ngIf"],["type","checkbox",3,"click"],["date",""],["deal",""],["game",""],[3,"class",4,"ngIf"],[1,"filter-manager__applied","ui","field"],["applied",""],[3,"filterItem","filterItemKey","indexOfItem","deletion",4,"ngFor","ngForOf"],[3,"filterItem","filterItemKey","indexOfItem","deletion"],[4,"ngIf"],["contract",""],["double",""],["declarer",""],["openingBid",""],["playerHasCard",""],["dealResult",""],["gameName",""],["playerInGame",""],["wonBy",""],["id","afterDate","type","datetime-local",3,"change"],["afterDate",""],["id","beforeDate","type","datetime-local",3,"change"],["beforeDate",""],[1,"flex-column-start"],[1,"",3,"click"],["contractsSelect",""],[3,"innerHTML","class","value",4,"ngFor","ngForOf"],[1,"ui","button","filter-manager__add-button",3,"click"],[3,"innerHTML","value"],["doubleSelect",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"click"],["declarerSelect",""],[4,"ngFor","ngForOf"],["openingBidSelect",""],["players",""],["cards",""],[3,"innerHTML","ngClass","value",4,"ngFor","ngForOf"],[3,"innerHTML","ngClass","value"],[1,"ui","input",3,"click"],["dealResultType",""],["value","equal"],["value","less",3,"innerHtml"],["value","more",3,"innerHtml"],["type","number","min","-13","max","7","step","1","value","0",1,"ui","input",3,"click"],["dealResultAmount",""],["gameNameSelect",""],["playerInGameSelect",""],["wonByType",""],["type","number","min","0","max","100000","step","10","value","0","placeholder","Enter won by number here",1,"ui","input",3,"click"],["wonByAmount",""]],template:function(t,e){if(1&t&&(o.TgZ(0,"section",0),o.TgZ(1,"div"),o.TgZ(2,"h2",1),o._uU(3,"Filters"),o.qZA(),o.TgZ(4,"button",2),o.NdJ("click",function(){return e.onReset()}),o._uU(5," Reset "),o.qZA(),o.TgZ(6,"button",2),o.NdJ("click",function(){return e.onHide()}),o._uU(7," Hide "),o.qZA(),o.qZA(),o.YNc(8,be,7,6,"div",3),o.TgZ(9,"div"),o.TgZ(10,"label"),o.TgZ(11,"input",4,5),o.NdJ("click",function(t){return e.onDateClick(t)}),o.qZA(),o._uU(13," Date "),o.qZA(),o.TgZ(14,"label"),o.TgZ(15,"input",4,6),o.NdJ("click",function(t){return e.onDealClick(t)}),o.qZA(),o._uU(17," Deal "),o.qZA(),o.TgZ(18,"label"),o.TgZ(19,"input",4,7),o.NdJ("click",function(t){return e.onGameClick(t)}),o.qZA(),o._uU(21," Game "),o.qZA(),o.qZA(),o.YNc(22,Je,12,16,"div",8),o.qZA()),2&t){const t=o.MAs(12),n=o.MAs(16),r=o.MAs(20);o.xp6(1),o.Gre("",e.FILTER_MANANGER_CLASSNAME,"__header"),o.xp6(3),o.Gre("",e.FILTER_MANANGER_CLASSNAME,"__reset ui button color-white bg-color-red  margin-0"),o.xp6(2),o.Gre("",e.FILTER_MANANGER_CLASSNAME,"__hide ui button color-white bg-color-1  margin-0"),o.xp6(2),o.Q6J("ngIf",e.filterItemsLength>0),o.xp6(1),o.Gre("",e.FILTER_MANANGER_CLASSNAME,"__filters field"),o.xp6(13),o.Q6J("ngIf",t.checked||n.checked||r.checked)}},directives:[r.O5,r.sg,Ht,It,Bt,r.mk],pipes:[r.Nd,Gt,Wt],styles:[""]}),t})();function Xe(t,e){if(1&t&&(o.TgZ(0,"p",17),o._uU(1),o.TgZ(2,"b"),o._uU(3),o.qZA(),o._uU(4,"? "),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.hij(" ",null==t.stringToSearchUsing?null:t.stringToSearchUsing.pre,""),o.xp6(2),o.Oqu(null==t.stringToSearchUsing?null:t.stringToSearchUsing.post)}}function Qe(t,e){1&t&&(o.TgZ(0,"p"),o._uU(1,"\xa0"),o.qZA())}function tn(t,e){if(1&t&&o.YNc(0,Qe,2,0,"p",18),2&t){const t=o.oxw(2);o.Q6J("ngIf",!t.error)}}function en(t,e){if(1&t&&o._UZ(0,"div",19),2&t){const t=o.oxw(2);o.hYB("innerHTML","",t.error,"<b>",t.errorHighlightedValue,"</b>",o.oJD)}}function nn(t,e){if(1&t&&o._UZ(0,"div",19),2&t){const t=o.oxw(2);o.hYB("innerHTML","<b>",t.errorHighlightedValue,"</b> ",t.error,"",o.oJD)}}function rn(t,e){if(1&t&&(o.TgZ(0,"div",13),o.YNc(1,Xe,5,2,"p",14),o.YNc(2,tn,1,1,"ng-template",null,15,o.W1O),o.YNc(4,en,1,2,"div",16),o.YNc(5,nn,1,2,"div",16),o.qZA()),2&t){const t=o.MAs(3),e=o.oxw();o.xp6(1),o.Q6J("ngIf",e.stringToSearchUsing&&!e.error&&(e.emailIsValid||e.usernameIsValid))("ngIfElse",t),o.xp6(3),o.Q6J("ngIf",e.error&&!e.isNoGamesError),o.xp6(1),o.Q6J("ngIf",e.error&&e.isNoGamesError)}}let sn=(()=>{class t{constructor(t,e,n,r,i){this.searchService=t,this.store=e,this.elRef=n,this.renderer=r,this.router=i,this.titleMsg="Search",this.isLandingPage=!1,this.isLoading=!1,this.initialForm=new xt({}),this.error="",this.errorHighlightedValue="",this.errorSub=$t.w,this.isNoGamesError=!1,this.LOGIN_CARD_CLASSNAME=s.M1,this.DISPLAY_NONE_CLASSNAME=s.ze}get classname(){return!0}get currentField(){return"username"}get emailIsValid(){const t=this.initialForm.get("email");return!t||t.valid}get usernameIsValid(){const t=this.initialForm.get("username");return!t||t.valid}get stringToSearchUsing(){var t,e;const n="Search for user with username of ",r=null===(t=this.initialForm.get("email"))||void 0===t?void 0:t.value,i=null===(e=this.initialForm.get("username"))||void 0===e?void 0:e.value,s=`'${i}'`;return i||r?i&&!r?{pre:n,post:s}:!i&&r?{pre:"Search for user with email of ",post:`'${r}'`}:{pre:n,post:s}:void 0}ngOnInit(){this.initializeForm(),this.subscribeToLoadingErrorMessage(),this.subscribeToIsLoading(),this.store.select(h.zW.deals).pipe((0,f.q)(1)).subscribe(t=>{this.router.url===`/${s.rF}/games`&&t.fetchedDeals&&Object.keys(t.fetchedDeals).length>0&&setTimeout(()=>{this.onHide()},100)})}onInputClick(){this.store.select(h.zW.general).pipe((0,f.q)(1),(0,S.U)(t=>{t.loadingError&&this.onReset()})).subscribe()}onEmailClick(){const{usernameInput:t,emailInput:e}=this.getInputs();(null==t?void 0:t.closest("form")).reset(),t&&(t.children[1].value="",this.renderer.addClass(t,s.ze)),e&&(document.querySelector("#emailCheckbox").checked=!0,e.children[1].value="",this.renderer.removeClass(e,s.ze))}onHide(){const t=this.elRef.nativeElement,e=t.querySelector(`.${s.M1}__form`),n=t.querySelector(`.${s.M1}__hide`);(null==e?void 0:e.classList.contains(s.u$))?(e&&(this.renderer.removeClass(e,s.ze),setTimeout(()=>{this.renderer.removeClass(e,s.q2)},s.zn/16),setTimeout(()=>{this.renderer.removeClass(e,s.u$)},s.zn/3)),n.innerHTML="Hide"):(e&&(this.renderer.addClass(e,s.u$),setTimeout(()=>{this.renderer.addClass(e,s.q2)},s.zn/4),setTimeout(()=>{this.renderer.addClass(e,s.ze)},s.zn/2)),n.innerHTML="Show")}onReset(){this.resetForm(),this.store.dispatch(new u.Bn(!1)),this.store.dispatch(new u.sd(""))}onSubmit(){this.store.dispatch(new u.Ms(!1)),this.store.dispatch(new u.Bn(!0));const t=this.initialForm.get("email"),e=this.initialForm.get("username"),n=this.searchService.startRequest(null==e?void 0:e.value,null==t?void 0:t.value);this.error=n||"",this.resetForm(),this.searchService.shouldNavigateToGames=!0}getInputs(){const t=this.elRef.nativeElement,e=null==t?void 0:t.querySelector(`.${s.M1}__username`),n=null==t?void 0:t.querySelector(`.${s.M1}__email`);return n&&e?{usernameInput:e,emailInput:n}:{usernameInput:null,emailInput:null}}resetForm(){this.initializeForm()}onUsernameClick(){const{usernameInput:t,emailInput:e}=this.getInputs();(null==t?void 0:t.closest("form")).reset(),t&&(document.querySelector("#usernameCheckbox").checked=!0,t.children[1].value="",this.renderer.removeClass(t,s.ze)),e&&(e.children[1].value="",this.renderer.addClass(e,s.ze))}initializeForm(){this.initialForm=new xt({username:new wt(null,[F.maxLength(12),y.noEmpty]),email:new wt(null,[F.email,y.noEmpty])},y.numberRequired(1))}subscribeToLoadingErrorMessage(){this.store.select(h.zW.general).subscribe(t=>{const e=t.loadingError,n=e.match(/'.+'/i),r=e.match(/[.?]$/i);if(this.isNoGamesError=!!e.match(/yet/i),n){let t=n[0],i=e.replace(t,"");r&&(this.isNoGamesError||(t+=r[0],i=i.replace(new RegExp(r[0]+"$"),""))),this.error=i,this.errorHighlightedValue=t}else this.error=e})}subscribeToIsLoading(){this.store.select(h.zW.general).subscribe(t=>{this.isLoading=t.isLoading})}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(y),o.Y36(l.yh),o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(i.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-search"]],hostVars:2,hostBindings:function(t,e){2&t&&o.ekj("search",e.classname)},inputs:{titleMsg:"titleMsg",isLandingPage:"isLandingPage"},decls:33,vars:14,consts:[[1,"login-card__header"],["type","button",1,"ui","button","bg-color-1","color-white","d-none","login-card__hide",3,"click"],["autocomplete","off",1,"ui","form","login-card__form",3,"formGroup","ngSubmit"],[1,"login-card__subtitle"],["type","radio","name","search","value","username","id","usernameCheckbox","checked","",3,"click"],["type","radio","name","search","value","email","id","emailCheckbox",3,"click"],[1,"field","login-card__inputs"],[1,"field","login-card__username"],["formControlName","username","type","text","name","username","placeholder","try 'Adam' if you are demoing","maxlength","12",3,"click"],["formControlName","email","type","email","name","email","placeholder","e.g. test@test.com",1,"login-card__email",3,"click"],["class","field login-card__message-area",4,"ngIf"],["type","submit",1,"ui","button","bg-color-3","hover-bg-color-1","hover-color-3","w-100","margin-0",3,"disabled"],["type","button",1,"ui","button","bg-color-4","hover-color-4","hover-bg-color-1","w-100","margin-0",3,"disabled","click"],[1,"field","login-card__message-area"],["else","",4,"ngIf","ngIfElse"],["space",""],["class","ui red message",3,"innerHTML",4,"ngIf"],["else",""],[4,"ngIf"],[1,"ui","red","message",3,"innerHTML"]],template:function(t,e){if(1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"h2"),o._uU(2),o.qZA(),o.TgZ(3,"button",1),o.NdJ("click",function(){return e.onHide()}),o._uU(4,"Hide"),o.qZA(),o.qZA(),o.TgZ(5,"form",2),o.NdJ("ngSubmit",function(){return e.onSubmit()}),o.TgZ(6,"div",3),o.TgZ(7,"h4"),o._uU(8,"Search by:"),o.qZA(),o.TgZ(9,"label"),o.TgZ(10,"input",4),o.NdJ("click",function(){return e.onUsernameClick()}),o.qZA(),o.TgZ(11,"span"),o._uU(12,"Username"),o.qZA(),o.qZA(),o.TgZ(13,"label"),o.TgZ(14,"input",5),o.NdJ("click",function(){return e.onEmailClick()}),o.qZA(),o.TgZ(15,"span"),o._uU(16,"Email"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(17,"div",6),o.TgZ(18,"div",7),o.TgZ(19,"label"),o._uU(20,"Username"),o.qZA(),o.TgZ(21,"input",8),o.NdJ("click",function(){return e.onInputClick()}),o.qZA(),o.qZA(),o.TgZ(22,"div"),o.TgZ(23,"label"),o._uU(24,"Email"),o.qZA(),o.TgZ(25,"input",9),o.NdJ("click",function(){return e.onInputClick()}),o.qZA(),o.qZA(),o.qZA(),o.YNc(26,rn,6,4,"div",10),o.TgZ(27,"div"),o.TgZ(28,"button",11),o._uU(29," Search "),o.qZA(),o.TgZ(30,"button",12),o.NdJ("click",function(){return e.onReset()}),o._uU(31," Reset "),o.qZA(),o.qZA(),o.qZA(),o._UZ(32,"nx-bridge-filter-manager")),2&t){let t;o.xp6(1),o.Gre("ui header ",e.isLandingPage?"login-card__title":"",""),o.xp6(1),o.hij(" ",e.titleMsg," "),o.xp6(3),o.Q6J("formGroup",e.initialForm),o.xp6(17),o.Gre("field login-card__email ",e.DISPLAY_NONE_CLASSNAME,""),o.xp6(4),o.Q6J("ngIf",e.error),o.xp6(1),o.Tol(e.isLandingPage?"login-card__buttons":"login-card__submit"),o.xp6(1),o.Q6J("disabled",!e.emailIsValid&&!e.usernameIsValid),o.xp6(2),o.Q6J("disabled",!!(""===(null==(t=e.initialForm.get("email"))||null==t.value?null:t.value.trim())&&""===(null==(t=e.initialForm.get("username"))||null==t.value?null:t.value.trim())||void 0===(null==(t=e.initialForm.get("email"))?null:t.value)&&void 0===(null==(t=e.initialForm.get("username"))?null:t.value)||null===(null==(t=e.initialForm.get("email"))?null:t.value)&&null===(null==(t=e.initialForm.get("username"))?null:t.value)))}},directives:[Et,rt,Mt,D,nt,Pt,Ut,r.O5,Ke],styles:[""]}),t})();const on=100,an=1e3,ln=1001,cn=1002,un=1003,hn=1006,dn=1008,fn=1009,pn=1012,mn=1014,gn=1015,yn=1016,_n=1020,vn=1022,bn=1023,wn=1026,xn=1027,Sn=2300,En=2301,An=2302,Tn=2400,Cn=2401,Mn=2402,On=3e3,Pn=3001,Dn=7680,Rn=35044,Ln=35048,In="300 es";class Nn{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,r=n.length;e<r;e++)n[e].call(this,t);t.target=null}}}const kn=[];for(let Sd=0;Sd<256;Sd++)kn[Sd]=(Sd<16?"0":"")+Sd.toString(16);const Fn=Math.PI/180,Bn=180/Math.PI;function jn(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(kn[255&t]+kn[t>>8&255]+kn[t>>16&255]+kn[t>>24&255]+"-"+kn[255&e]+kn[e>>8&255]+"-"+kn[e>>16&15|64]+kn[e>>24&255]+"-"+kn[63&n|128]+kn[n>>8&255]+"-"+kn[n>>16&255]+kn[n>>24&255]+kn[255&r]+kn[r>>8&255]+kn[r>>16&255]+kn[r>>24&255]).toUpperCase()}function Un(t,e,n){return Math.max(e,Math.min(n,t))}function Vn(t,e,n){return(1-n)*t+n*e}function zn(t){return 0==(t&t-1)&&0!==t}function $n(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}class Hn{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,s=this.y-t.y;return this.x=i*n-s*r+t.x,this.y=i*r+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Hn.prototype.isVector2=!0;class Gn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,s,o,a,l){const c=this.elements;return c[0]=t,c[1]=r,c[2]=o,c[3]=e,c[4]=i,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],y=r[1],_=r[4],v=r[7],b=r[2],w=r[5],x=r[8];return i[0]=s*p+o*y+a*b,i[3]=s*m+o*_+a*w,i[6]=s*g+o*v+a*x,i[1]=l*p+c*y+u*b,i[4]=l*m+c*_+u*w,i[7]=l*g+c*v+u*x,i[2]=h*p+d*y+f*b,i[5]=h*m+d*_+f*w,i[8]=h*g+d*v+f*x,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-n*i*c+n*o*a+r*i*l-r*s*a}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=c*s-o*l,h=o*a-c*i,d=l*i-s*a,f=e*u+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return t[0]=u*p,t[1]=(r*l-c*n)*p,t[2]=(o*n-r*s)*p,t[3]=h*p,t[4]=(c*e-r*a)*p,t[5]=(r*i-o*e)*p,t[6]=d*p,t[7]=(n*a-l*e)*p,t[8]=(s*e-n*i)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,s,o){const a=Math.cos(i),l=Math.sin(i);return this.set(n*a,n*l,-n*(a*s+l*o)+s+t,-r*l,r*a,-r*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],s=r[3],o=r[6],a=r[1],l=r[4],c=r[7];return r[0]=e*i+n*a,r[3]=e*s+n*l,r[6]=e*o+n*c,r[1]=-n*i+e*a,r[4]=-n*s+e*l,r[7]=-n*o+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}let Wn;Gn.prototype.isMatrix3=!0;class qn{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Wn&&(Wn=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Wn.width=t.width,Wn.height=t.height;const n=Wn.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Wn}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let Zn=0;class Yn extends Nn{constructor(t=Yn.DEFAULT_IMAGE,e=Yn.DEFAULT_MAPPING,n=1001,r=1001,i=1006,s=1008,o=1023,a=1009,l=1,c=3e3){super(),Object.defineProperty(this,"id",{value:Zn++}),this.uuid=jn(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Hn(0,0),this.repeat=new Hn(1,1),this.center=new Hn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Gn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const r=this.image;if(void 0===r.uuid&&(r.uuid=jn()),!e&&void 0===t.images[r.uuid]){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)e.push(Jn(r[t].isDataTexture?r[t].image:r[t]))}else e=Jn(r);t.images[r.uuid]={uuid:r.uuid,url:e}}n.image=r.uuid}return e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case an:t.x=t.x-Math.floor(t.x);break;case ln:t.x=t.x<0?0:1;break;case cn:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case an:t.y=t.y-Math.floor(t.y);break;case ln:t.y=t.y<0?0:1;break;case cn:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function Jn(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?qn.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Yn.DEFAULT_IMAGE=void 0,Yn.DEFAULT_MAPPING=300,Yn.prototype.isTexture=!0;class Kn{constructor(t=0,e=0,n=0,r=1){this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*i,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*i,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*i,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const s=.01,o=.1,a=t.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],f=a[9],p=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+h)<o&&Math.abs(u+p)<o&&Math.abs(f+m)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,a=(d+1)/2,y=(g+1)/2,_=(c+h)/4,v=(u+p)/4,b=(f+m)/4;return t>a&&t>y?t<s?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=_/n,i=v/n):a>y?a<s?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(a),n=_/r,i=b/r):y<s?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(y),n=v/i,r=b/i),this.set(n,r,i,e),this}let y=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(m-f)/y,this.y=(u-p)/y,this.z=(h-c)/y,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Kn.prototype.isVector4=!0;class Xn extends Nn{constructor(t,e,n){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Kn(0,0,t,e),this.scissorTest=!1,this.viewport=new Kn(0,0,t,e),this.texture=new Yn(void 0,(n=n||{}).mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:hn,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Xn.prototype.isWebGLRenderTarget=!0,class extends Xn{constructor(t,e,n){super(t,e);const r=this.texture;this.texture=[];for(let i=0;i<n;i++)this.texture[i]=r.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class Qn extends Xn{constructor(t,e,n){super(t,e,n),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}Qn.prototype.isWebGLMultisampleRenderTarget=!0;class tr{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,i,s,o){let a=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[s+0],d=i[s+1],f=i[s+2],p=i[s+3];if(0===o)return t[e+0]=a,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===o)return t[e+0]=h,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(u!==p||a!==h||l!==d||c!==f){let t=1-o;const e=a*h+l*d+c*f+u*p,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),s=Math.atan2(i,e*n);t=Math.sin(t*s)/i,o=Math.sin(o*s)/i}const i=o*n;if(a=a*t+h*i,l=l*t+d*i,c=c*t+f*i,u=u*t+p*i,t===1-o){const t=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=t,l*=t,c*=t,u*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,r,i,s){const o=n[r],a=n[r+1],l=n[r+2],c=n[r+3],u=i[s],h=i[s+1],d=i[s+2],f=i[s+3];return t[e]=o*f+c*u+a*d-l*h,t[e+1]=a*f+c*h+l*u-o*d,t[e+2]=l*f+c*d+o*h-a*u,t[e+3]=c*f-o*u-a*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,i=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(r/2),u=o(i/2),h=a(n/2),d=a(r/2),f=a(i/2);switch(s){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],u=e[10],h=n+o+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-a)*t,this._y=(i-l)*t,this._z=(s-r)*t}else if(n>o&&n>u){const t=2*Math.sqrt(1+n-o-u);this._w=(c-a)/t,this._x=.25*t,this._y=(r+s)/t,this._z=(i+l)/t}else if(o>u){const t=2*Math.sqrt(1+o-n-u);this._w=(i-l)/t,this._x=(r+s)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+u-n-o);this._w=(s-r)/t,this._x=(i+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Un(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+s*o+r*l-i*a,this._y=r*c+s*a+i*o-n*l,this._z=i*c+s*l+n*a-r*o,this._w=s*c-n*o-r*a-i*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,s=this._w;let o=s*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=r,this._z=i,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}tr.prototype.isQuaternion=!0;class er{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(rr.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(rr.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,s=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*s,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*s,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,o=t.z,a=t.w,l=a*e+s*r-o*n,c=a*n+o*e-i*r,u=a*r+i*n-s*e,h=-i*e-s*n-o*r;return this.x=l*a+h*-i+c*-o-u*-s,this.y=c*a+h*-s+u*-i-l*-o,this.z=u*a+h*-o+l*-s-c*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,s=e.x,o=e.y,a=e.z;return this.x=r*a-i*o,this.y=i*s-n*a,this.z=n*o-r*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return nr.copy(this).projectOnVector(t),this.sub(nr)}reflect(t){return this.sub(nr.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Un(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}er.prototype.isVector3=!0;const nr=new er,rr=new tr;class ir{constructor(t=new er(1/0,1/0,1/0),e=new er(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){const l=t[a],c=t[a+1],u=t[a+2];l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,r),this.max.set(i,s,o),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){const l=t.getX(a),c=t.getY(a),u=t.getZ(a);l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,r),this.max.set(i,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=or.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new er),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new er),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),ar.copy(e.boundingBox),ar.applyMatrix4(t.matrixWorld),this.union(ar));const n=t.children;for(let r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new er),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,or),or.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(pr),mr.subVectors(this.max,pr),lr.subVectors(t.a,pr),cr.subVectors(t.b,pr),ur.subVectors(t.c,pr),hr.subVectors(cr,lr),dr.subVectors(ur,cr),fr.subVectors(lr,ur);let e=[0,-hr.z,hr.y,0,-dr.z,dr.y,0,-fr.z,fr.y,hr.z,0,-hr.x,dr.z,0,-dr.x,fr.z,0,-fr.x,-hr.y,hr.x,0,-dr.y,dr.x,0,-fr.y,fr.x,0];return!!_r(e,lr,cr,ur,mr)&&(e=[1,0,0,0,1,0,0,0,1],!!_r(e,lr,cr,ur,mr)&&(gr.crossVectors(hr,dr),e=[gr.x,gr.y,gr.z],_r(e,lr,cr,ur,mr)))}clampPoint(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new er),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return or.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(or).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(sr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),sr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),sr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),sr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),sr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),sr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),sr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),sr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(sr)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}ir.prototype.isBox3=!0;const sr=[new er,new er,new er,new er,new er,new er,new er,new er],or=new er,ar=new ir,lr=new er,cr=new er,ur=new er,hr=new er,dr=new er,fr=new er,pr=new er,mr=new er,gr=new er,yr=new er;function _r(t,e,n,r,i){for(let s=0,o=t.length-3;s<=o;s+=3){yr.fromArray(t,s);const o=i.x*Math.abs(yr.x)+i.y*Math.abs(yr.y)+i.z*Math.abs(yr.z),a=e.dot(yr),l=n.dot(yr),c=r.dot(yr);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const vr=new ir,br=new er,wr=new er,xr=new er;class Sr{constructor(t=new er,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):vr.setFromPoints(t).getCenter(n);let r=0;for(let i=0,s=t.length;i<s;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new er),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new ir),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){xr.subVectors(t,this.center);const e=xr.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(xr.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return wr.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(br.copy(t.center).add(wr)),this.expandByPoint(br.copy(t.center).sub(wr)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Er=new er,Ar=new er,Tr=new er,Cr=new er,Mr=new er,Or=new er,Pr=new er;class Dr{constructor(t=new er,e=new er(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new er),e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Er)),this}closestPointToPoint(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new er),e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Er.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Er.copy(this.direction).multiplyScalar(e).add(this.origin),Er.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){Ar.copy(t).add(e).multiplyScalar(.5),Tr.copy(e).sub(t).normalize(),Cr.copy(this.origin).sub(Ar);const i=.5*t.distanceTo(e),s=-this.direction.dot(Tr),o=Cr.dot(this.direction),a=-Cr.dot(Tr),l=Cr.lengthSq(),c=Math.abs(1-s*s);let u,h,d,f;if(c>0)if(u=s*a-o,h=s*o-a,f=i*c,u>=0)if(h>=-f)if(h<=f){const t=1/c;u*=t,h*=t,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-f?(u=Math.max(0,-(-s*i+o)),h=u>0?-i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l):h<=f?(u=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+l):(u=Math.max(0,-(s*i+o)),h=u>0?i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l);else h=s>0?-i:i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(Tr).multiplyScalar(h).add(Ar),d}intersectSphere(t,e){Er.subVectors(t.center,this.origin);const n=Er.dot(this.direction),r=Er.dot(Er)-n*n,i=t.radius*t.radius;if(r>i)return null;const s=Math.sqrt(i-r),o=n-s,a=n+s;return o<0&&a<0?null:this.at(o<0?a:o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,r,i,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),c>=0?(i=(t.min.y-h.y)*c,s=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,s=(t.min.y-h.y)*c),n>s||i>r?null:((i>n||n!=n)&&(n=i),(s<r||r!=r)&&(r=s),u>=0?(o=(t.min.z-h.z)*u,a=(t.max.z-h.z)*u):(o=(t.max.z-h.z)*u,a=(t.min.z-h.z)*u),n>a||o>r?null:((o>n||n!=n)&&(n=o),(a<r||r!=r)&&(r=a),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,Er)}intersectTriangle(t,e,n,r,i){Mr.subVectors(e,t),Or.subVectors(n,t),Pr.crossVectors(Mr,Or);let s,o=this.direction.dot(Pr);if(o>0){if(r)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}Cr.subVectors(this.origin,t);const a=s*this.direction.dot(Or.crossVectors(Cr,Or));if(a<0)return null;const l=s*this.direction.dot(Mr.cross(Cr));if(l<0)return null;if(a+l>o)return null;const c=-s*Cr.dot(Pr);return c<0?null:this.at(c/o,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Rr{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,s,o,a,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Rr).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/Lr.setFromMatrixColumn(t,0).length(),i=1/Lr.setFromMatrixColumn(t,1).length(),s=1/Lr.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,i=t.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){const t=s*c,n=s*u,r=o*c,i=o*u;e[0]=a*c,e[4]=-a*u,e[8]=l,e[1]=n+r*l,e[5]=t-i*l,e[9]=-o*a,e[2]=i-t*l,e[6]=r+n*l,e[10]=s*a}else if("YXZ"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t+i*o,e[4]=r*o-n,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-o,e[2]=n*o-r,e[6]=i+t*o,e[10]=s*a}else if("ZXY"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t-i*o,e[4]=-s*u,e[8]=r+n*o,e[1]=n+r*o,e[5]=s*c,e[9]=i-t*o,e[2]=-s*l,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){const t=s*c,n=s*u,r=o*c,i=o*u;e[0]=a*c,e[4]=r*l-n,e[8]=t*l+i,e[1]=a*u,e[5]=i*l+t,e[9]=n*l-r,e[2]=-l,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){const t=s*a,n=s*l,r=o*a,i=o*l;e[0]=a*c,e[4]=i-t*u,e[8]=r*u+n,e[1]=u,e[5]=s*c,e[9]=-o*c,e[2]=-l*c,e[6]=n*u+r,e[10]=t-i*u}else if("XZY"===t.order){const t=s*a,n=s*l,r=o*a,i=o*l;e[0]=a*c,e[4]=-u,e[8]=l*c,e[1]=t*u+i,e[5]=s*c,e[9]=n*u-r,e[2]=r*u-n,e[6]=o*c,e[10]=i*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Nr,t,kr)}lookAt(t,e,n){const r=this.elements;return jr.subVectors(t,e),0===jr.lengthSq()&&(jr.z=1),jr.normalize(),Fr.crossVectors(n,jr),0===Fr.lengthSq()&&(1===Math.abs(n.z)?jr.x+=1e-4:jr.z+=1e-4,jr.normalize(),Fr.crossVectors(n,jr)),Fr.normalize(),Br.crossVectors(jr,Fr),r[0]=Fr.x,r[4]=Br.x,r[8]=jr.x,r[1]=Fr.y,r[5]=Br.y,r[9]=jr.y,r[2]=Fr.z,r[6]=Br.z,r[10]=jr.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],y=n[3],_=n[7],v=n[11],b=n[15],w=r[0],x=r[4],S=r[8],E=r[12],A=r[1],T=r[5],C=r[9],M=r[13],O=r[2],P=r[6],D=r[10],R=r[14],L=r[3],I=r[7],N=r[11],k=r[15];return i[0]=s*w+o*A+a*O+l*L,i[4]=s*x+o*T+a*P+l*I,i[8]=s*S+o*C+a*D+l*N,i[12]=s*E+o*M+a*R+l*k,i[1]=c*w+u*A+h*O+d*L,i[5]=c*x+u*T+h*P+d*I,i[9]=c*S+u*C+h*D+d*N,i[13]=c*E+u*M+h*R+d*k,i[2]=f*w+p*A+m*O+g*L,i[6]=f*x+p*T+m*P+g*I,i[10]=f*S+p*C+m*D+g*N,i[14]=f*E+p*M+m*R+g*k,i[3]=y*w+_*A+v*O+b*L,i[7]=y*x+_*T+v*P+b*I,i[11]=y*S+_*C+v*D+b*N,i[15]=y*E+_*M+v*R+b*k,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],s=t[1],o=t[5],a=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+i*a*u-r*l*u-i*o*h+n*l*h+r*o*d-n*a*d)+t[7]*(+e*a*d-e*l*h+i*s*h-r*s*d+r*l*c-i*a*c)+t[11]*(+e*l*u-e*o*d-i*s*u+n*s*d+i*o*c-n*l*c)+t[15]*(-r*o*c-e*a*u+e*o*h+r*s*u-n*s*h+n*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],y=u*m*l-p*h*l+p*a*d-o*m*d-u*a*g+o*h*g,_=f*h*l-c*m*l-f*a*d+s*m*d+c*a*g-s*h*g,v=c*p*l-f*u*l+f*o*d-s*p*d-c*o*g+s*u*g,b=f*u*a-c*p*a-f*o*h+s*p*h+c*o*m-s*u*m,w=e*y+n*_+r*v+i*b;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/w;return t[0]=y*x,t[1]=(p*h*i-u*m*i-p*r*d+n*m*d+u*r*g-n*h*g)*x,t[2]=(o*m*i-p*a*i+p*r*l-n*m*l-o*r*g+n*a*g)*x,t[3]=(u*a*i-o*h*i-u*r*l+n*h*l+o*r*d-n*a*d)*x,t[4]=_*x,t[5]=(c*m*i-f*h*i+f*r*d-e*m*d-c*r*g+e*h*g)*x,t[6]=(f*a*i-s*m*i-f*r*l+e*m*l+s*r*g-e*a*g)*x,t[7]=(s*h*i-c*a*i+c*r*l-e*h*l-s*r*d+e*a*d)*x,t[8]=v*x,t[9]=(f*u*i-c*p*i-f*n*d+e*p*d+c*n*g-e*u*g)*x,t[10]=(s*p*i-f*o*i+f*n*l-e*p*l-s*n*g+e*o*g)*x,t[11]=(c*o*i-s*u*i-c*n*l+e*u*l+s*n*d-e*o*d)*x,t[12]=b*x,t[13]=(c*p*r-f*u*r+f*n*h-e*p*h-c*n*m+e*u*m)*x,t[14]=(f*o*r-s*p*r-f*n*a+e*p*a+s*n*m-e*o*m)*x,t[15]=(s*u*r-c*o*r+c*n*a-e*u*a-s*n*h+e*o*h)*x,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,s=t.x,o=t.y,a=t.z,l=i*s,c=i*o;return this.set(l*s+n,l*o-r*a,l*a+r*o,0,l*o+r*a,c*o+n,c*a-r*s,0,l*a-r*o,c*a+r*s,i*a*a+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,s){return this.set(1,n,i,0,t,1,s,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,s=e._y,o=e._z,a=e._w,l=i+i,c=s+s,u=o+o,h=i*l,d=i*c,f=i*u,p=s*c,m=s*u,g=o*u,y=a*l,_=a*c,v=a*u,b=n.x,w=n.y,x=n.z;return r[0]=(1-(p+g))*b,r[1]=(d+v)*b,r[2]=(f-_)*b,r[3]=0,r[4]=(d-v)*w,r[5]=(1-(h+g))*w,r[6]=(m+y)*w,r[7]=0,r[8]=(f+_)*x,r[9]=(m-y)*x,r[10]=(1-(h+p))*x,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=Lr.set(r[0],r[1],r[2]).length();const s=Lr.set(r[4],r[5],r[6]).length(),o=Lr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Ir.copy(this);const a=1/i,l=1/s,c=1/o;return Ir.elements[0]*=a,Ir.elements[1]*=a,Ir.elements[2]*=a,Ir.elements[4]*=l,Ir.elements[5]*=l,Ir.elements[6]*=l,Ir.elements[8]*=c,Ir.elements[9]*=c,Ir.elements[10]*=c,e.setFromRotationMatrix(Ir),n.x=i,n.y=s,n.z=o,this}makePerspective(t,e,n,r,i,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*i/(n-r),l=(e+t)/(e-t),c=(n+r)/(n-r),u=-(s+i)/(s-i),h=-2*s*i/(s-i);return o[0]=2*i/(e-t),o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=a,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,n,r,i,s){const o=this.elements,a=1/(e-t),l=1/(n-r),c=1/(s-i),u=(e+t)*a,h=(n+r)*l,d=(s+i)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}Rr.prototype.isMatrix4=!0;const Lr=new er,Ir=new Rr,Nr=new er(0,0,0),kr=new er(1,1,1),Fr=new er,Br=new er,jr=new er,Ur=new Rr,Vr=new tr;class zr{constructor(t=0,e=0,n=0,r=zr.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e,n){const r=t.elements,i=r[0],s=r[4],o=r[8],a=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(Un(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Un(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Un(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-Un(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Un(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Un(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Ur.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Ur,e,n)}setFromVector3(t,e){return this.set(t.x,t.y,t.z,e||this._order)}reorder(t){return Vr.setFromEuler(this),this.setFromQuaternion(Vr,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new er(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}zr.prototype.isEuler=!0,zr.DefaultOrder="XYZ",zr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class $r{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}}let Hr=0;const Gr=new er,Wr=new tr,qr=new Rr,Zr=new er,Yr=new er,Jr=new er,Kr=new tr,Xr=new er(1,0,0),Qr=new er(0,1,0),ti=new er(0,0,1),ei={type:"added"},ni={type:"removed"};class ri extends Nn{constructor(){super(),Object.defineProperty(this,"id",{value:Hr++}),this.uuid=jn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ri.DefaultUp.clone();const t=new er,e=new zr,n=new tr,r=new er(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Rr},normalMatrix:{value:new Gn}}),this.matrix=new Rr,this.matrixWorld=new Rr,this.matrixAutoUpdate=ri.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new $r,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Wr.setFromAxisAngle(t,e),this.quaternion.multiply(Wr),this}rotateOnWorldAxis(t,e){return Wr.setFromAxisAngle(t,e),this.quaternion.premultiply(Wr),this}rotateX(t){return this.rotateOnAxis(Xr,t)}rotateY(t){return this.rotateOnAxis(Qr,t)}rotateZ(t){return this.rotateOnAxis(ti,t)}translateOnAxis(t,e){return Gr.copy(t).applyQuaternion(this.quaternion),this.position.add(Gr.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Xr,t)}translateY(t){return this.translateOnAxis(Qr,t)}translateZ(t){return this.translateOnAxis(ti,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(qr.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Zr.copy(t):Zr.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Yr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?qr.lookAt(Yr,Zr,this.up):qr.lookAt(Zr,Yr,this.up),this.quaternion.setFromRotationMatrix(qr),r&&(qr.extractRotation(r.matrixWorld),Wr.setFromRotationMatrix(qr),this.quaternion.premultiply(Wr.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(ei)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(ni)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(ni)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),qr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),qr.multiply(t.parent.matrixWorld)),t.applyMatrix4(qr),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getWorldPosition(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new er),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new tr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yr,t,Jr),t}getWorldScale(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new er),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yr,Kr,t),t}getWorldDirection(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new er),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++)i(t.shapes,n[e]);else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++)r.animations.push(i(t.animations,this.animations[e]))}if(e){const e=s(t.geometries),r=s(t.materials),i=s(t.textures),o=s(t.images),a=s(t.shapes),l=s(t.skeletons),c=s(t.animations);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=r,n;function s(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}ri.DefaultUp=new er(0,1,0),ri.DefaultMatrixAutoUpdate=!0,ri.prototype.isObject3D=!0;const ii=new er,si=new er,oi=new Gn;class ai{constructor(t=new er(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=ii.subVectors(n,e).cross(si.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new er),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new er);const n=t.delta(ii),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:e.copy(n).multiplyScalar(i).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new er),t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||oi.getNormalMatrix(t),r=this.coplanarPoint(ii).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}ai.prototype.isPlane=!0;const li=new er,ci=new er,ui=new er,hi=new er,di=new er,fi=new er,pi=new er,mi=new er,gi=new er,yi=new er;class _i{constructor(t=new er,e=new er,n=new er){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new er),r.subVectors(n,e),li.subVectors(t,e),r.cross(li);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){li.subVectors(r,e),ci.subVectors(n,e),ui.subVectors(t,e);const s=li.dot(li),o=li.dot(ci),a=li.dot(ui),l=ci.dot(ci),c=ci.dot(ui),u=s*l-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new er),0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,f=(s*c-o*a)*h;return i.set(1-d-f,f,d)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,hi),hi.x>=0&&hi.y>=0&&hi.x+hi.y<=1}static getUV(t,e,n,r,i,s,o,a){return this.getBarycoord(t,e,n,r,hi),a.set(0,0),a.addScaledVector(i,hi.x),a.addScaledVector(s,hi.y),a.addScaledVector(o,hi.z),a}static isFrontFacing(t,e,n,r){return li.subVectors(n,e),ci.subVectors(t,e),li.cross(ci).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return li.subVectors(this.c,this.b),ci.subVectors(this.a,this.b),.5*li.cross(ci).length()}getMidpoint(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new er),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return _i.getNormal(this.a,this.b,this.c,t)}getPlane(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new ai),t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return _i.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,i){return _i.getUV(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return _i.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return _i.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new er);const n=this.a,r=this.b,i=this.c;let s,o;di.subVectors(r,n),fi.subVectors(i,n),mi.subVectors(t,n);const a=di.dot(mi),l=fi.dot(mi);if(a<=0&&l<=0)return e.copy(n);gi.subVectors(t,r);const c=di.dot(gi),u=fi.dot(gi);if(c>=0&&u<=c)return e.copy(r);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(n).addScaledVector(di,s);yi.subVectors(t,i);const d=di.dot(yi),f=fi.dot(yi);if(f>=0&&d<=f)return e.copy(i);const p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),e.copy(n).addScaledVector(fi,o);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return pi.subVectors(i,r),o=(u-c)/(u-c+(d-f)),e.copy(r).addScaledVector(pi,o);const g=1/(m+p+h);return s=p*g,o=h*g,e.copy(n).addScaledVector(di,s).addScaledVector(fi,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let vi=0;class bi extends Nn{constructor(){super(),Object.defineProperty(this,"id",{value:vi++}),this.uuid=jn(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=on,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Dn,this.stencilZFail=Dn,this.stencilZPass=Dn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}bi.prototype.isMaterial=!0;const wi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},xi={h:0,s:0,l:0},Si={h:0,s:0,l:0};function Ei(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Ai(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ti(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class Ci{constructor(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=(t%1+1)%1,e=Un(e,0,1),n=Un(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=Ei(i,r,t+1/3),this.g=Ei(i,r,t),this.b=Ei(i,r,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const r=n[2];switch(n[1]){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const n=parseFloat(t[1])/360,r=parseInt(t[2],10)/100,i=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,r,i)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=wi[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=Ai(t.r),this.g=Ai(t.g),this.b=Ai(t.b),this}copyLinearToSRGB(t){return this.r=Ti(t.r),this.g=Ti(t.g),this.b=Ti(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const e=this.r,n=this.g,r=this.b,i=Math.max(e,n,r),s=Math.min(e,n,r);let o,a;const l=(s+i)/2;if(s===i)o=0,a=0;else{const t=i-s;switch(a=l<=.5?t/(i+s):t/(2-i-s),i){case e:o=(n-r)/t+(n<r?6:0);break;case n:o=(r-e)/t+2;break;case r:o=(e-n)/t+4}o/=6}return t.h=o,t.s=a,t.l=l,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(xi),xi.h+=t,xi.s+=e,xi.l+=n,this.setHSL(xi.h,xi.s,xi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(xi),t.getHSL(Si);const n=Vn(xi.h,Si.h,e),r=Vn(xi.s,Si.s,e),i=Vn(xi.l,Si.l,e);return this.setHSL(n,r,i),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Ci.NAMES=wi,Ci.prototype.isColor=!0,Ci.prototype.r=1,Ci.prototype.g=1,Ci.prototype.b=1;class Mi extends bi{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new Ci(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this}}Mi.prototype.isMeshBasicMaterial=!0;const Oi=new er,Pi=new Hn;class Di{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=Rn,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new Ci),e[n++]=i.r,e[n++]=i.g,e[n++]=i.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new Hn),e[n++]=i.x,e[n++]=i.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new er),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new Kn),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z,e[n++]=i.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Pi.fromBufferAttribute(this,e),Pi.applyMatrix3(t),this.setXY(e,Pi.x,Pi.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Oi.fromBufferAttribute(this,e),Oi.applyMatrix3(t),this.setXYZ(e,Oi.x,Oi.y,Oi.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Oi.x=this.getX(e),Oi.y=this.getY(e),Oi.z=this.getZ(e),Oi.applyMatrix4(t),this.setXYZ(e,Oi.x,Oi.y,Oi.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Oi.x=this.getX(e),Oi.y=this.getY(e),Oi.z=this.getZ(e),Oi.applyNormalMatrix(t),this.setXYZ(e,Oi.x,Oi.y,Oi.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Oi.x=this.getX(e),Oi.y=this.getY(e),Oi.z=this.getZ(e),Oi.transformDirection(t),this.setXYZ(e,Oi.x,Oi.y,Oi.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,i){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Rn&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}Di.prototype.isBufferAttribute=!0;class Ri extends Di{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Li extends Di{constructor(t,e,n){super(new Uint32Array(t),e,n)}}(class extends Di{constructor(t,e,n){super(new Uint16Array(t),e,n)}}).prototype.isFloat16BufferAttribute=!0;class Ii extends Di{constructor(t,e,n){super(new Float32Array(t),e,n)}}function Ni(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let ki=0;const Fi=new Rr,Bi=new ri,ji=new er,Ui=new ir,Vi=new ir,zi=new er;class $i extends Nn{constructor(){super(),Object.defineProperty(this,"id",{value:ki++}),this.uuid=jn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return this.index=Array.isArray(t)?new(Ni(t)>65535?Li:Ri)(t,1):t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Gn).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Fi.makeRotationFromQuaternion(t),this.applyMatrix4(Fi),this}rotateX(t){return Fi.makeRotationX(t),this.applyMatrix4(Fi),this}rotateY(t){return Fi.makeRotationY(t),this.applyMatrix4(Fi),this}rotateZ(t){return Fi.makeRotationZ(t),this.applyMatrix4(Fi),this}translate(t,e,n){return Fi.makeTranslation(t,e,n),this.applyMatrix4(Fi),this}scale(t,e,n){return Fi.makeScale(t,e,n),this.applyMatrix4(Fi),this}lookAt(t){return Bi.lookAt(t),Bi.updateMatrix(),this.applyMatrix4(Bi.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ji).negate(),this.translate(ji.x,ji.y,ji.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Ii(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ir);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new er(-1/0,-1/0,-1/0),new er(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++)Ui.setFromBufferAttribute(e[n]),this.morphTargetsRelative?(zi.addVectors(this.boundingBox.min,Ui.min),this.boundingBox.expandByPoint(zi),zi.addVectors(this.boundingBox.max,Ui.max),this.boundingBox.expandByPoint(zi)):(this.boundingBox.expandByPoint(Ui.min),this.boundingBox.expandByPoint(Ui.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sr);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new er,1/0);if(t){const n=this.boundingSphere.center;if(Ui.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++)Vi.setFromBufferAttribute(e[t]),this.morphTargetsRelative?(zi.addVectors(Ui.min,Vi.min),Ui.expandByPoint(zi),zi.addVectors(Ui.max,Vi.max),Ui.expandByPoint(zi)):(Ui.expandByPoint(Vi.min),Ui.expandByPoint(Vi.max));Ui.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)zi.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(zi));if(e)for(let i=0,s=e.length;i<s;i++){const s=e[i],o=this.morphTargetsRelative;for(let e=0,i=s.count;e<i;e++)zi.fromBufferAttribute(s,e),o&&(ji.fromBufferAttribute(t,e),zi.add(ji)),r=Math.max(r,n.distanceToSquared(zi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,i=e.normal.array,s=e.uv.array,o=r.length/3;void 0===e.tangent&&this.setAttribute("tangent",new Di(new Float32Array(4*o),4));const a=e.tangent.array,l=[],c=[];for(let A=0;A<o;A++)l[A]=new er,c[A]=new er;const u=new er,h=new er,d=new er,f=new Hn,p=new Hn,m=new Hn,g=new er,y=new er;function _(t,e,n){u.fromArray(r,3*t),h.fromArray(r,3*e),d.fromArray(r,3*n),f.fromArray(s,2*t),p.fromArray(s,2*e),m.fromArray(s,2*n),h.sub(u),d.sub(u),p.sub(f),m.sub(f);const i=1/(p.x*m.y-m.x*p.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(i),y.copy(d).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(i),l[t].add(g),l[e].add(g),l[n].add(g),c[t].add(y),c[e].add(y),c[n].add(y))}let v=this.groups;0===v.length&&(v=[{start:0,count:n.length}]);for(let A=0,T=v.length;A<T;++A){const t=v[A],e=t.start;for(let r=e,i=e+t.count;r<i;r+=3)_(n[r+0],n[r+1],n[r+2])}const b=new er,w=new er,x=new er,S=new er;function E(t){x.fromArray(i,3*t),S.copy(x);const e=l[t];b.copy(e),b.sub(x.multiplyScalar(x.dot(e))).normalize(),w.crossVectors(S,e);const n=w.dot(c[t])<0?-1:1;a[4*t]=b.x,a[4*t+1]=b.y,a[4*t+2]=b.z,a[4*t+3]=n}for(let A=0,T=v.length;A<T;++A){const t=v[A],e=t.start;for(let r=e,i=e+t.count;r<i;r+=3)E(n[r+0]),E(n[r+1]),E(n[r+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Di(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new er,i=new er,s=new er,o=new er,a=new er,l=new er,c=new er,u=new er;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),f=t.getX(h+1),p=t.getX(h+2);r.fromBufferAttribute(e,d),i.fromBufferAttribute(e,f),s.fromBufferAttribute(e,p),c.subVectors(s,i),u.subVectors(r,i),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(f,a.x,a.y,a.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,i),u.subVectors(r,i),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===t.attributes[r])continue;const i=n[r].array,s=t.attributes[r],o=s.array,a=s.itemSize*e,l=Math.min(o.length,i.length-a);for(let t=0,e=a;t<l;t++,e++)i[e]=o[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)zi.fromBufferAttribute(t,e),zi.normalize(),t.setXYZ(e,zi.x,zi.y,zi.z)}toNonIndexed(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,s=new n.constructor(e.length*r);let o=0,a=0;for(let l=0,c=e.length;l<c;l++){o=e[l]*r;for(let t=0;t<r;t++)s[a++]=n[o++]}return new Di(s,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new $i,n=this.index.array,r=this.attributes;for(const o in r){const i=t(r[o],n);e.setAttribute(o,i)}const i=this.morphAttributes;for(const o in i){const r=[],s=i[o];for(let e=0,i=s.length;e<i;e++){const i=t(s[e],n);r.push(i)}e.morphAttributes[o]=r}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const t=s[o];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const a in n)t.data.attributes[a]=n[a].toJSON(t.data);const r={};let i=!1;for(const a in this.morphAttributes){const e=this.morphAttributes[a],n=[];for(let r=0,i=e.length;r<i;r++)n.push(e[r].toJSON(t.data));n.length>0&&(r[a]=n,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return(new $i).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const l in r)this.setAttribute(l,r[l].clone(e));const i=t.morphAttributes;for(const l in i){const t=[],n=i[l];for(let r=0,i=n.length;r<i;r++)t.push(n[r].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,c=s.length;l<c;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}$i.prototype.isBufferGeometry=!0;const Hi=new Rr,Gi=new Dr,Wi=new Sr,qi=new er,Zi=new er,Yi=new er,Ji=new er,Ki=new er,Xi=new er,Qi=new er,ts=new er,es=new er,ns=new Hn,rs=new Hn,is=new Hn,ss=new er,os=new er;class as extends ri{constructor(t=new $i,e=new Mi){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Wi.copy(n.boundingSphere),Wi.applyMatrix4(i),!1===t.ray.intersectsSphere(Wi))return;if(Hi.copy(i).invert(),Gi.copy(t.ray).applyMatrix4(Hi),null!==n.boundingBox&&!1===Gi.intersectsBox(n.boundingBox))return;let s;if(n.isBufferGeometry){const i=n.index,o=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==i)if(Array.isArray(r))for(let n=0,f=h.length;n<f;n++){const f=h[n],p=r[f.materialIndex];for(let n=Math.max(f.start,d.start),r=Math.min(f.start+f.count,d.start+d.count);n<r;n+=3){const r=i.getX(n),h=i.getX(n+1),d=i.getX(n+2);s=ls(this,p,t,Gi,o,a,l,c,u,r,h,d),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=f.materialIndex,e.push(s))}}else for(let n=Math.max(0,d.start),f=Math.min(i.count,d.start+d.count);n<f;n+=3){const h=i.getX(n),d=i.getX(n+1),f=i.getX(n+2);s=ls(this,r,t,Gi,o,a,l,c,u,h,d,f),s&&(s.faceIndex=Math.floor(n/3),e.push(s))}else if(void 0!==o)if(Array.isArray(r))for(let n=0,f=h.length;n<f;n++){const i=h[n],f=r[i.materialIndex];for(let n=Math.max(i.start,d.start),r=Math.min(i.start+i.count,d.start+d.count);n<r;n+=3)s=ls(this,f,t,Gi,o,a,l,c,u,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=i.materialIndex,e.push(s))}else for(let n=Math.max(0,d.start),f=Math.min(o.count,d.start+d.count);n<f;n+=3)s=ls(this,r,t,Gi,o,a,l,c,u,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),e.push(s))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function ls(t,e,n,r,i,s,o,a,l,c,u,h){qi.fromBufferAttribute(i,c),Zi.fromBufferAttribute(i,u),Yi.fromBufferAttribute(i,h);const d=t.morphTargetInfluences;if(e.morphTargets&&s&&d){Qi.set(0,0,0),ts.set(0,0,0),es.set(0,0,0);for(let t=0,e=s.length;t<e;t++){const e=d[t],n=s[t];0!==e&&(Ji.fromBufferAttribute(n,c),Ki.fromBufferAttribute(n,u),Xi.fromBufferAttribute(n,h),o?(Qi.addScaledVector(Ji,e),ts.addScaledVector(Ki,e),es.addScaledVector(Xi,e)):(Qi.addScaledVector(Ji.sub(qi),e),ts.addScaledVector(Ki.sub(Zi),e),es.addScaledVector(Xi.sub(Yi),e)))}qi.add(Qi),Zi.add(ts),Yi.add(es)}t.isSkinnedMesh&&(t.boneTransform(c,qi),t.boneTransform(u,Zi),t.boneTransform(h,Yi));const f=function(t,e,n,r,i,s,o,a){let l;if(l=1===e.side?r.intersectTriangle(o,s,i,!0,a):r.intersectTriangle(i,s,o,2!==e.side,a),null===l)return null;os.copy(a),os.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(os);return c<n.near||c>n.far?null:{distance:c,point:os.clone(),object:t}}(t,e,n,r,qi,Zi,Yi,ss);if(f){a&&(ns.fromBufferAttribute(a,c),rs.fromBufferAttribute(a,u),is.fromBufferAttribute(a,h),f.uv=_i.getUV(ss,qi,Zi,Yi,ns,rs,is,new Hn)),l&&(ns.fromBufferAttribute(l,c),rs.fromBufferAttribute(l,u),is.fromBufferAttribute(l,h),f.uv2=_i.getUV(ss,qi,Zi,Yi,ns,rs,is,new Hn));const t={a:c,b:u,c:h,normal:new er,materialIndex:0};_i.getNormal(qi,Zi,Yi,t.normal),f.face=t}return f}as.prototype.isMesh=!0;class cs extends $i{constructor(t=1,e=1,n=1,r=1,i=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:s};const o=this;r=Math.floor(r),i=Math.floor(i),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function f(t,e,n,r,i,s,f,p,m,g,y){const _=s/m,v=f/g,b=s/2,w=f/2,x=p/2,S=m+1,E=g+1;let A=0,T=0;const C=new er;for(let o=0;o<E;o++){const s=o*v-w;for(let a=0;a<S;a++)C[t]=(a*_-b)*r,C[e]=s*i,C[n]=x,l.push(C.x,C.y,C.z),C[t]=0,C[e]=0,C[n]=p>0?1:-1,c.push(C.x,C.y,C.z),u.push(a/m),u.push(1-o/g),A+=1}for(let o=0;o<g;o++)for(let t=0;t<m;t++){const e=h+t+S*(o+1),n=h+(t+1)+S*(o+1),r=h+(t+1)+S*o;a.push(h+t+S*o,e,r),a.push(e,n,r),T+=6}o.addGroup(d,T,y),d+=T,h+=A}f("z","y","x",-1,-1,n,e,t,s,i,0),f("z","y","x",1,-1,n,e,-t,s,i,1),f("x","z","y",1,1,t,n,e,r,s,2),f("x","z","y",1,-1,t,n,-e,r,s,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new Ii(l,3)),this.setAttribute("normal",new Ii(c,3)),this.setAttribute("uv",new Ii(u,2))}}function us(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];e[n][r]=i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.clone():Array.isArray(i)?i.slice():i}}return e}function hs(t){const e={};for(let n=0;n<t.length;n++){const r=us(t[n]);for(const t in r)e[t]=r[t]}return e}const ds={clone:us,merge:hs};class fs extends bi{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=us(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;e.uniforms[r]=n&&n.isTexture?{type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?{type:"c",value:n.getHex()}:n&&n.isVector2?{type:"v2",value:n.toArray()}:n&&n.isVector3?{type:"v3",value:n.toArray()}:n&&n.isVector4?{type:"v4",value:n.toArray()}:n&&n.isMatrix3?{type:"m3",value:n.toArray()}:n&&n.isMatrix4?{type:"m4",value:n.toArray()}:{value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}fs.prototype.isShaderMaterial=!0;class ps extends ri{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Rr,this.projectionMatrix=new Rr,this.projectionMatrixInverse=new Rr}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new er),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}ps.prototype.isCamera=!0;class ms extends ps{constructor(t=50,e=1,n=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Bn*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*Fn*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*Bn*Math.atan(Math.tan(.5*Fn*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,i,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*Fn*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,o=s.fullHeight;i+=s.offsetX*r/t,e-=s.offsetY*n/o,r*=s.width/t,n*=s.height/o}const o=this.filmOffset;0!==o&&(i+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}ms.prototype.isPerspectiveCamera=!0;const gs=90;class ys extends ri{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new ms(gs,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new er(1,0,0)),this.add(r);const i=new ms(gs,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new er(-1,0,0)),this.add(i);const s=new ms(gs,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new er(0,1,0)),this.add(s);const o=new ms(gs,1,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new er(0,-1,0)),this.add(o);const a=new ms(gs,1,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new er(0,0,1)),this.add(a);const l=new ms(gs,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new er(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,s,o,a,l]=this.children,c=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,i),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,o),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.xr.enabled=c}}class _s extends Yn{constructor(t,e,n,r,i,s,o,a,l,c){super(t=void 0!==t?t:[],e=void 0!==e?e:301,n,r,i,s,o=void 0!==o?o:vn,a,l,c),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}_s.prototype.isCubeTexture=!0;class vs extends Xn{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),this.texture=new _s(void 0,(e=e||{}).mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:hn,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=bn,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n=new cs(5,5,5),r=new fs({name:"CubemapFromEquirect",uniforms:us({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:1,blending:0});r.uniforms.tEquirect.value=e;const i=new as(n,r),s=e.minFilter;return e.minFilter===dn&&(e.minFilter=hn),new ys(1,10,this).update(t,i),e.minFilter=s,i.geometry.dispose(),i.material.dispose(),this}clear(t,e,n,r){const i=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,r);t.setRenderTarget(i)}}vs.prototype.isWebGLCubeRenderTarget=!0;const bs=new Sr,ws=new er;class xs{constructor(t=new ai,e=new ai,n=new ai,r=new ai,i=new ai,s=new ai){this.planes=[t,e,n,r,i,s]}set(t,e,n,r,i,s){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],y=n[14],_=n[15];return e[0].setComponents(o-r,u-a,p-h,_-m).normalize(),e[1].setComponents(o+r,u+a,p+h,_+m).normalize(),e[2].setComponents(o+i,u+l,p+d,_+g).normalize(),e[3].setComponents(o-i,u-l,p-d,_-g).normalize(),e[4].setComponents(o-s,u-c,p-f,_-y).normalize(),e[5].setComponents(o+s,u+c,p+f,_+y).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),bs.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(bs)}intersectsSprite(t){return bs.center.set(0,0,0),bs.radius=.7071067811865476,bs.applyMatrix4(t.matrixWorld),this.intersectsSphere(bs)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let i=0;i<6;i++)if(e[i].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(ws.x=r.normal.x>0?t.max.x:t.min.x,ws.y=r.normal.y>0?t.max.y:t.min.y,ws.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(ws)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ss(){let t=null,e=!1,n=null,r=null;function i(e,s){n(e,s),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Es(t,e){const n=e.isWebGL2,r=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))},update:function(e,i){if(e.isGLBufferAttribute){const t=r.get(e);return void((!t||t.version<e.version)&&r.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const s=r.get(e);void 0===s?r.set(e,function(e,r){const i=e.array,s=e.usage,o=t.createBuffer();t.bindBuffer(r,o),t.bufferData(r,i,s),e.onUploadCallback();let a=5126;return i instanceof Float32Array?a=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?e.isFloat16BufferAttribute?n?a=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):a=5123:i instanceof Int16Array?a=5122:i instanceof Uint32Array?a=5125:i instanceof Int32Array?a=5124:i instanceof Int8Array?a=5120:(i instanceof Uint8Array||i instanceof Uint8ClampedArray)&&(a=5121),{buffer:o,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}(e,i)):s.version<e.version&&(function(e,r,i){const s=r.array,o=r.updateRange;t.bindBuffer(i,e),-1===o.count?t.bufferSubData(i,0,s):(n?t.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):t.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1)}(s.buffer,e,i),s.version=e.version)}}}class As extends $i{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=t/2,s=e/2,o=Math.floor(n),a=Math.floor(r),l=o+1,c=a+1,u=t/o,h=e/a,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const t=g*h-s;for(let e=0;e<l;e++)f.push(e*u-i,-t,0),p.push(0,0,1),m.push(e/o),m.push(1-g/a)}for(let g=0;g<a;g++)for(let t=0;t<o;t++){const e=t+l*(g+1),n=t+1+l*(g+1),r=t+1+l*g;d.push(t+l*g,e,r),d.push(e,n,r)}this.setIndex(d),this.setAttribute("position",new Ii(f,3)),this.setAttribute("normal",new Ii(p,3)),this.setAttribute("uv",new Ii(m,2))}}const Ts={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), rawDiffuseColor, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), rawDiffuseColor, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSNMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition.xyz / vWorldPosition.w;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\tfloat ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );\n\tvec3 f0 = vec3( pow( ior - 1.0, 2.0 ) / pow( ior + 1.0, 2.0 ) );\n\tvec3 f90 = vec3( 1.0 );\n\tvec3 f_transmission = totalTransmission * getIBLVolumeRefraction(\n\t\tnormal, v, viewDir, roughnessFactor, diffuseColor.rgb, f0, f90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance);\n\tdiffuseColor.rgb = mix( diffuseColor.rgb, f_transmission, totalTransmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec4 vWorldPosition;\n\tvec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {\n\t\tvec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length(vec3(modelMatrix[0].xyz));\n\t\tmodelScale.y = length(vec3(modelMatrix[1].xyz));\n\t\tmodelScale.z = length(vec3(modelMatrix[2].xyz));\n\t\treturn normalize(refractionVector) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness(float roughness, float ior) {\n\t\treturn roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);\n\t}\n\tvec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {\n\t\tfloat framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);\n\t\treturn texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;\n\t}\n\tvec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {\n\t\tif (attenuationDistance == 0.0) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;\n\t\t\tvec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec3 getIBLVolumeRefraction(vec3 n, vec3 v, vec3 viewDir, float perceptualRoughness, vec3 baseColor, vec3 f0, vec3 f90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec3 attenuationColor, float attenuationDistance) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);\n\t\tvec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);\n\t\tfloat NdotV = saturate(dot(n, viewDir));\n\t\tvec2 brdf = integrateSpecularBRDF(NdotV, perceptualRoughness);\n\t\tvec3 specularColor = f0 * brdf.x + f90 * brdf.y;\n\t\treturn (1.0 - specularColor) * attenuatedColor * baseColor;\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform vec3 attenuationColor;\n\tuniform float attenuationDistance;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef USE_TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t\tfloat thicknessFactor = thickness;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\tvec3 rawDiffuseColor = diffuseColor.rgb;\n\t#include <transmission_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#ifdef USE_TRANSMISSION\n\tvarying vec4 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition;\n#endif\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Cs={common:{diffuse:{value:new Ci(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Gn},uv2Transform:{value:new Gn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Hn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ci(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ci(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Gn}},sprite:{diffuse:{value:new Ci(16777215)},opacity:{value:1},center:{value:new Hn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Gn}}},Ms={basic:{uniforms:hs([Cs.common,Cs.specularmap,Cs.envmap,Cs.aomap,Cs.lightmap,Cs.fog]),vertexShader:Ts.meshbasic_vert,fragmentShader:Ts.meshbasic_frag},lambert:{uniforms:hs([Cs.common,Cs.specularmap,Cs.envmap,Cs.aomap,Cs.lightmap,Cs.emissivemap,Cs.fog,Cs.lights,{emissive:{value:new Ci(0)}}]),vertexShader:Ts.meshlambert_vert,fragmentShader:Ts.meshlambert_frag},phong:{uniforms:hs([Cs.common,Cs.specularmap,Cs.envmap,Cs.aomap,Cs.lightmap,Cs.emissivemap,Cs.bumpmap,Cs.normalmap,Cs.displacementmap,Cs.fog,Cs.lights,{emissive:{value:new Ci(0)},specular:{value:new Ci(1118481)},shininess:{value:30}}]),vertexShader:Ts.meshphong_vert,fragmentShader:Ts.meshphong_frag},standard:{uniforms:hs([Cs.common,Cs.envmap,Cs.aomap,Cs.lightmap,Cs.emissivemap,Cs.bumpmap,Cs.normalmap,Cs.displacementmap,Cs.roughnessmap,Cs.metalnessmap,Cs.fog,Cs.lights,{emissive:{value:new Ci(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ts.meshphysical_vert,fragmentShader:Ts.meshphysical_frag},toon:{uniforms:hs([Cs.common,Cs.aomap,Cs.lightmap,Cs.emissivemap,Cs.bumpmap,Cs.normalmap,Cs.displacementmap,Cs.gradientmap,Cs.fog,Cs.lights,{emissive:{value:new Ci(0)}}]),vertexShader:Ts.meshtoon_vert,fragmentShader:Ts.meshtoon_frag},matcap:{uniforms:hs([Cs.common,Cs.bumpmap,Cs.normalmap,Cs.displacementmap,Cs.fog,{matcap:{value:null}}]),vertexShader:Ts.meshmatcap_vert,fragmentShader:Ts.meshmatcap_frag},points:{uniforms:hs([Cs.points,Cs.fog]),vertexShader:Ts.points_vert,fragmentShader:Ts.points_frag},dashed:{uniforms:hs([Cs.common,Cs.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ts.linedashed_vert,fragmentShader:Ts.linedashed_frag},depth:{uniforms:hs([Cs.common,Cs.displacementmap]),vertexShader:Ts.depth_vert,fragmentShader:Ts.depth_frag},normal:{uniforms:hs([Cs.common,Cs.bumpmap,Cs.normalmap,Cs.displacementmap,{opacity:{value:1}}]),vertexShader:Ts.normal_vert,fragmentShader:Ts.normal_frag},sprite:{uniforms:hs([Cs.sprite,Cs.fog]),vertexShader:Ts.sprite_vert,fragmentShader:Ts.sprite_frag},background:{uniforms:{uvTransform:{value:new Gn},t2D:{value:null}},vertexShader:Ts.background_vert,fragmentShader:Ts.background_frag},cube:{uniforms:hs([Cs.envmap,{opacity:{value:1}}]),vertexShader:Ts.cube_vert,fragmentShader:Ts.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ts.equirect_vert,fragmentShader:Ts.equirect_frag},distanceRGBA:{uniforms:hs([Cs.common,Cs.displacementmap,{referencePosition:{value:new er},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ts.distanceRGBA_vert,fragmentShader:Ts.distanceRGBA_frag},shadow:{uniforms:hs([Cs.lights,Cs.fog,{color:{value:new Ci(0)},opacity:{value:1}}]),vertexShader:Ts.shadow_vert,fragmentShader:Ts.shadow_frag}};function Os(t,e,n,r,i){const s=new Ci(0);let o,a,l=0,c=null,u=0,h=null;function d(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,i)}return{getClearColor:function(){return s},setClearColor:function(t,e=1){s.set(t),l=e,d(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(t){l=t,d(s,l)},render:function(n,i){let f=!1,p=!0===i.isScene?i.background:null;p&&p.isTexture&&(p=e.get(p));const m=t.xr,g=m.getSession&&m.getSession();g&&"additive"===g.environmentBlendMode&&(p=null),null===p?d(s,l):p&&p.isColor&&(d(p,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&(p.isCubeTexture||306===p.mapping)?(void 0===a&&(a=new as(new cs(1,1,1),new fs({name:"BackgroundCubeMaterial",uniforms:us(Ms.cube.uniforms),vertexShader:Ms.cube.vertexShader,fragmentShader:Ms.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a)),a.material.uniforms.envMap.value=p,a.material.uniforms.flipEnvMap.value=p.isCubeTexture&&p._needsFlipEnvMap?-1:1,c===p&&u===p.version&&h===t.toneMapping||(a.material.needsUpdate=!0,c=p,u=p.version,h=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null)):p&&p.isTexture&&(void 0===o&&(o=new as(new As(2,2),new fs({name:"BackgroundMaterial",uniforms:us(Ms.background.uniforms),vertexShader:Ms.background.vertexShader,fragmentShader:Ms.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),o.material.uniforms.uvTransform.value.copy(p.matrix),c===p&&u===p.version&&h===t.toneMapping||(o.material.needsUpdate=!0,c=p,u=p.version,h=t.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function Ps(t,e,n,r){const i=t.getParameter(34921),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||null!==s,a={},l=d(null);let c=l;function u(e){return r.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function h(e){return r.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function d(t){const e=[],n=[],r=[];for(let s=0;s<i;s++)e[s]=0,n[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:r,object:t,attributes:{},index:null}}function f(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function p(t){m(t,0)}function m(n,i){const s=c.enabledAttributes,o=c.attributeDivisors;c.newAttributes[n]=1,0===s[n]&&(t.enableVertexAttribArray(n),s[n]=1),o[n]!==i&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),o[n]=i)}function g(){const e=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function y(e,n,i,s,o,a){!0!==r.isWebGL2||5124!==i&&5125!==i?t.vertexAttribPointer(e,n,i,s,o,a):t.vertexAttribIPointer(e,n,i,o,a)}function _(){v(),c!==l&&(c=l,u(c.object))}function v(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,_,v){let b=!1;if(o){const e=function(e,n,i){const o=!0===i.wireframe;let l=a[e.id];void 0===l&&(l={},a[e.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[o];return void 0===u&&(u=d(r.isWebGL2?t.createVertexArray():s.createVertexArrayOES()),c[o]=u),u}(_,h,l);c!==e&&(c=e,u(c.object)),b=function(t,e){const n=c.attributes,r=t.attributes;let i=0;for(const s in r){const t=n[s],e=r[s];if(void 0===t)return!0;if(t.attribute!==e)return!0;if(t.data!==e.data)return!0;i++}return c.attributesNum!==i||c.index!==e}(_,v),b&&function(t,e){const n={},r=t.attributes;let i=0;for(const s in r){const t=r[s],e={};e.attribute=t,t.data&&(e.data=t.data),n[s]=e,i++}c.attributes=n,c.attributesNum=i,c.index=e}(_,v)}else{const t=!0===l.wireframe;c.geometry===_.id&&c.program===h.id&&c.wireframe===t||(c.geometry=_.id,c.program=h.id,c.wireframe=t,b=!0)}!0===i.isInstancedMesh&&(b=!0),null!==v&&n.update(v,34963),b&&(function(i,s,o,a){if(!1===r.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;f();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const e in c){const r=c[e];if(r>=0){const s=l[e];if(void 0!==s){const e=s.normalized,i=s.itemSize,o=n.get(s);if(void 0===o)continue;const l=o.buffer,c=o.type,u=o.bytesPerElement;if(s.isInterleavedBufferAttribute){const n=s.data,o=n.stride,h=s.offset;n&&n.isInstancedInterleavedBuffer?(m(r,n.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)):p(r),t.bindBuffer(34962,l),y(r,i,c,e,o*u,h*u)}else s.isInstancedBufferAttribute?(m(r,s.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)):p(r),t.bindBuffer(34962,l),y(r,i,c,e,0,0)}else if("instanceMatrix"===e){const e=n.get(i.instanceMatrix);if(void 0===e)continue;const s=e.buffer,o=e.type;m(r+0,1),m(r+1,1),m(r+2,1),m(r+3,1),t.bindBuffer(34962,s),t.vertexAttribPointer(r+0,4,o,!1,64,0),t.vertexAttribPointer(r+1,4,o,!1,64,16),t.vertexAttribPointer(r+2,4,o,!1,64,32),t.vertexAttribPointer(r+3,4,o,!1,64,48)}else if("instanceColor"===e){const e=n.get(i.instanceColor);if(void 0===e)continue;const s=e.buffer,o=e.type;m(r,1),t.bindBuffer(34962,s),t.vertexAttribPointer(r,3,o,!1,12,0)}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(r,n);break;case 3:t.vertexAttrib3fv(r,n);break;case 4:t.vertexAttrib4fv(r,n);break;default:t.vertexAttrib1fv(r,n)}}}}g()}(i,l,h,_),null!==v&&t.bindBuffer(34963,n.get(v).buffer))},reset:_,resetDefaultState:v,dispose:function(){_();for(const t in a){const e=a[t];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t]}},releaseStatesOfGeometry:function(t){if(void 0===a[t.id])return;const e=a[t.id];for(const n in e){const t=e[n];for(const e in t)h(t[e].object),delete t[e];delete e[n]}delete a[t.id]},releaseStatesOfProgram:function(t){for(const e in a){const n=a[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)h(r[t].object),delete r[t];delete n[t.id]}},initAttributes:f,enableAttribute:p,disableUnusedAttributes:g}}function Ds(t,e,n,r){const i=r.isWebGL2;let s;this.setMode=function(t){s=t},this.render=function(e,r){t.drawArrays(s,e,r),n.update(r,s,1)},this.renderInstances=function(r,o,a){if(0===a)return;let l,c;if(i)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,r,o,a),n.update(o,s,a)}}function Rs(t,e,n){let r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const a=i(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=s||e.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),f=t.getParameter(34076),p=t.getParameter(34921),m=t.getParameter(36347),g=t.getParameter(36348),y=t.getParameter(36349),_=h>0,v=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:_,floatFragmentTextures:v,floatVertexTextures:_&&v,maxSamples:s?t.getParameter(36183):0}}function Ls(t){const e=this;let n=null,r=0,i=!1,s=!1;const o=new ai,a=new Gn,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,n,r,i){const s=null!==t?t.length:0;let c=null;if(0!==s){if(c=l.value,!0!==i||null===c){const e=r+4*s,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=r;n!==s;++n,l+=4)o.copy(t[n]).applyMatrix4(i,a),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,s){const o=0!==t.length||e||0!==r||i;return i=e,n=u(t,s,0),r=t.length,o},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(e,o,a){const h=e.clippingPlanes,d=e.clipIntersection,f=e.clipShadows,p=t.get(e);if(!i||null===h||0===h.length||s&&!f)s?u(null):c();else{const t=s?0:r,e=4*t;let i=p.clippingState||null;l.value=i,i=u(h,o,e,a);for(let r=0;r!==e;++r)i[r]=n[r];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function Is(t){let e=new WeakMap;function n(t,e){return 303===e?t.mapping=301:304===e&&(t.mapping=302),t}function r(t){const n=t.target;n.removeEventListener("dispose",r);const i=e.get(n);void 0!==i&&(e.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping;if(303===s||304===s){if(e.has(i))return n(e.get(i).texture,i.mapping);{const s=i.image;if(s&&s.height>0){const o=t.getRenderTarget(),a=new vs(s.height/2);return a.fromEquirectangularTexture(t,i),e.set(i,a),t.setRenderTarget(o),i.addEventListener("dispose",r),n(a.texture,i.mapping)}return null}}}return i},dispose:function(){e=new WeakMap}}}function Ns(t){const e={};function n(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(t){const e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function ks(t,e,n,r){const i={},s=new WeakMap;function o(t){const a=t.target;null!==a.index&&e.remove(a.index);for(const n in a.attributes)e.remove(a.attributes[n]);a.removeEventListener("dispose",o),delete i[a.id];const l=s.get(a);l&&(e.remove(l),s.delete(a)),r.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(t){const n=[],r=t.index,i=t.attributes.position;let o=0;if(null!==r){const t=r.array;o=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],s=t[e+2];n.push(r,i,i,s,s,r)}}else{o=i.version;for(let t=0,e=i.array.length/3-1;t<e;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}const a=new(Ni(n)>65535?Li:Ri)(n,1);a.version=o;const l=s.get(t);l&&e.remove(l),s.set(t,a)}return{get:function(t,e){return!0===i[e.id]||(e.addEventListener("dispose",o),i[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const i in n)e.update(n[i],34962);const r=t.morphAttributes;for(const i in r){const t=r[i];for(let n=0,r=t.length;n<r;n++)e.update(t[n],34962)}},getWireframeAttribute:function(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return s.get(t)}}}function Fs(t,e,n,r){const i=r.isWebGL2;let s,o,a;this.setMode=function(t){s=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,r){t.drawElements(s,r,o,e*a),n.update(r,s,1)},this.renderInstances=function(r,l,c){if(0===c)return;let u,h;if(i)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](s,l,o,r*a,c),n.update(l,s,c)}}function Bs(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,r){switch(e.calls++,n){case 4:e.triangles+=r*(t/3);break;case 1:e.lines+=r*(t/2);break;case 3:e.lines+=r*(t-1);break;case 2:e.lines+=r*t;break;case 0:e.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function js(t,e){return t[0]-e[0]}function Us(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Vs(t){const e={},n=new Float32Array(8),r=[];for(let i=0;i<8;i++)r[i]=[i,0];return{update:function(i,s,o,a){const l=i.morphTargetInfluences,c=void 0===l?0:l.length;let u=e[s.id];if(void 0===u){u=[];for(let t=0;t<c;t++)u[t]=[t,0];e[s.id]=u}for(let t=0;t<c;t++){const e=u[t];e[0]=t,e[1]=l[t]}u.sort(Us);for(let t=0;t<8;t++)t<c&&u[t][1]?(r[t][0]=u[t][0],r[t][1]=u[t][1]):(r[t][0]=Number.MAX_SAFE_INTEGER,r[t][1]=0);r.sort(js);const h=o.morphTargets&&s.morphAttributes.position,d=o.morphNormals&&s.morphAttributes.normal;let f=0;for(let t=0;t<8;t++){const e=r[t],i=e[0],o=e[1];i!==Number.MAX_SAFE_INTEGER&&o?(h&&s.getAttribute("morphTarget"+t)!==h[i]&&s.setAttribute("morphTarget"+t,h[i]),d&&s.getAttribute("morphNormal"+t)!==d[i]&&s.setAttribute("morphNormal"+t,d[i]),n[t]=o,f+=o):(h&&!0===s.hasAttribute("morphTarget"+t)&&s.deleteAttribute("morphTarget"+t),d&&!0===s.hasAttribute("morphNormal"+t)&&s.deleteAttribute("morphNormal"+t),n[t]=0)}const p=s.morphTargetsRelative?1:1-f;a.getUniforms().setValue(t,"morphTargetBaseInfluence",p),a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function zs(t,e,n,r){let i=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){const o=r.render.frame,a=e.get(t,t.geometry);return i.get(a)!==o&&(e.update(a),i.set(a,o)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",s)&&t.addEventListener("dispose",s),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),a},dispose:function(){i=new WeakMap}}}Ms.physical={uniforms:hs([Ms.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Hn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Ci(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Hn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ci(0)}}]),vertexShader:Ts.meshphysical_vert,fragmentShader:Ts.meshphysical_frag};class $s extends Yn{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=un,this.minFilter=un,this.wrapR=ln,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}$s.prototype.isDataTexture2DArray=!0;class Hs extends Yn{constructor(t=null,e=1,n=1,r=1){super(null),this.image={data:t,width:e,height:n,depth:r},this.magFilter=un,this.minFilter=un,this.wrapR=ln,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Hs.prototype.isDataTexture3D=!0;const Gs=new Yn,Ws=new $s,qs=new Hs,Zs=new _s,Ys=[],Js=[],Ks=new Float32Array(16),Xs=new Float32Array(9),Qs=new Float32Array(4);function to(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let s=Ys[i];if(void 0===s&&(s=new Float32Array(i),Ys[i]=s),0!==e){r.toArray(s,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(s,i)}return s}function eo(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function no(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function ro(t,e){let n=Js[e];void 0===n&&(n=new Int32Array(e),Js[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function io(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function so(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(eo(n,e))return;t.uniform2fv(this.addr,e),no(n,e)}}function oo(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(eo(n,e))return;t.uniform3fv(this.addr,e),no(n,e)}}function ao(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(eo(n,e))return;t.uniform4fv(this.addr,e),no(n,e)}}function lo(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(eo(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),no(n,e)}else{if(eo(n,r))return;Qs.set(r),t.uniformMatrix2fv(this.addr,!1,Qs),no(n,r)}}function co(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(eo(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),no(n,e)}else{if(eo(n,r))return;Xs.set(r),t.uniformMatrix3fv(this.addr,!1,Xs),no(n,r)}}function uo(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(eo(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),no(n,e)}else{if(eo(n,r))return;Ks.set(r),t.uniformMatrix4fv(this.addr,!1,Ks),no(n,r)}}function ho(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function fo(t,e){const n=this.cache;eo(n,e)||(t.uniform2iv(this.addr,e),no(n,e))}function po(t,e){const n=this.cache;eo(n,e)||(t.uniform3iv(this.addr,e),no(n,e))}function mo(t,e){const n=this.cache;eo(n,e)||(t.uniform4iv(this.addr,e),no(n,e))}function go(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function yo(t,e){const n=this.cache;eo(n,e)||(t.uniform2uiv(this.addr,e),no(n,e))}function _o(t,e){const n=this.cache;eo(n,e)||(t.uniform3uiv(this.addr,e),no(n,e))}function vo(t,e){const n=this.cache;eo(n,e)||(t.uniform4uiv(this.addr,e),no(n,e))}function bo(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(e||Gs,i)}function wo(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||qs,i)}function xo(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(e||Zs,i)}function So(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||Ws,i)}function Eo(t,e){t.uniform1fv(this.addr,e)}function Ao(t,e){const n=to(e,this.size,2);t.uniform2fv(this.addr,n)}function To(t,e){const n=to(e,this.size,3);t.uniform3fv(this.addr,n)}function Co(t,e){const n=to(e,this.size,4);t.uniform4fv(this.addr,n)}function Mo(t,e){const n=to(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Oo(t,e){const n=to(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Po(t,e){const n=to(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Do(t,e){t.uniform1iv(this.addr,e)}function Ro(t,e){t.uniform2iv(this.addr,e)}function Lo(t,e){t.uniform3iv(this.addr,e)}function Io(t,e){t.uniform4iv(this.addr,e)}function No(t,e){t.uniform1uiv(this.addr,e)}function ko(t,e){t.uniform2uiv(this.addr,e)}function Fo(t,e){t.uniform3uiv(this.addr,e)}function Bo(t,e){t.uniform4uiv(this.addr,e)}function jo(t,e,n){const r=e.length,i=ro(n,r);t.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)n.safeSetTexture2D(e[s]||Gs,i[s])}function Uo(t,e,n){const r=e.length,i=ro(n,r);t.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)n.safeSetTextureCube(e[s]||Zs,i[s])}function Vo(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return io;case 35664:return so;case 35665:return oo;case 35666:return ao;case 35674:return lo;case 35675:return co;case 35676:return uo;case 5124:case 35670:return ho;case 35667:case 35671:return fo;case 35668:case 35672:return po;case 35669:case 35673:return mo;case 5125:return go;case 36294:return yo;case 36295:return _o;case 36296:return vo;case 35678:case 36198:case 36298:case 36306:case 35682:return bo;case 35679:case 36299:case 36307:return wo;case 35680:case 36300:case 36308:case 36293:return xo;case 36289:case 36303:case 36311:case 36292:return So}}(e.type)}function zo(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Eo;case 35664:return Ao;case 35665:return To;case 35666:return Co;case 35674:return Mo;case 35675:return Oo;case 35676:return Po;case 5124:case 35670:return Do;case 35667:case 35671:return Ro;case 35668:case 35672:return Lo;case 35669:case 35673:return Io;case 5125:return No;case 36294:return ko;case 36295:return Fo;case 36296:return Bo;case 35678:case 36198:case 36298:case 36306:case 35682:return jo;case 35680:case 36300:case 36308:case 36293:return Uo}}(e.type)}function $o(t){this.id=t,this.seq=[],this.map={}}zo.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),no(e,t)},$o.prototype.setValue=function(t,e,n){const r=this.seq;for(let i=0,s=r.length;i!==s;++i){const s=r[i];s.setValue(t,e[s.id],n)}};const Ho=/(\w+)(\])?(\[|\.)?/g;function Go(t,e){t.seq.push(e),t.map[e.id]=e}function Wo(t,e,n){const r=t.name,i=r.length;for(Ho.lastIndex=0;;){const s=Ho.exec(r),o=Ho.lastIndex;let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&o+2===i){Go(n,void 0===l?new Vo(a,t,e):new zo(a,t,e));break}{let t=n.map[a];void 0===t&&(t=new $o(a),Go(n,t)),n=t}}}function qo(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let r=0;r<n;++r){const n=t.getActiveUniform(e,r);Wo(n,t.getUniformLocation(e,n.name),this)}}function Zo(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}qo.prototype.setValue=function(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)},qo.prototype.setOptional=function(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)},qo.upload=function(t,e,n,r){for(let i=0,s=e.length;i!==s;++i){const s=e[i],o=n[s.id];!1!==o.needsUpdate&&s.setValue(t,o.value,r)}},qo.seqWithValue=function(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n};let Yo=0;function Jo(t){switch(t){case On:return["Linear","( value )"];case Pn:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function Ko(t,e,n){const r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(t){const e=t.split("\n");for(let n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function Xo(t,e){const n=Jo(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Qo(t,e){const n=Jo(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function ta(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function ea(t){return""!==t}function na(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ra(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ia=/^[ \t]*#include +<([\w\d./]+)>/gm;function sa(t){return t.replace(ia,oa)}function oa(t,e){const n=Ts[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return sa(n)}const aa=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,la=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ca(t){return t.replace(la,ha).replace(aa,ua)}function ua(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ha(0,e,n,r)}function ha(t,e,n,r){let i="";for(let s=parseInt(e);s<parseInt(n);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function da(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function fa(t,e,n,r){const i=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),d=t.gammaFactor>0?t.gammaFactor:1,f=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission>0)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ea).join("\n")}(n),p=function(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(s),m=i.createProgram();let g,y,_=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=[p].filter(ea).join("\n"),g.length>0&&(g+="\n"),y=[f,p].filter(ea).join("\n"),y.length>0&&(y+="\n")):(g=[da(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ea).join("\n"),y=[f,da(n),"#define SHADER_NAME "+n.shaderName,p,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Ts.tonemapping_pars_fragment:"",0!==n.toneMapping?ta("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Ts.encodings_pars_fragment,n.map?Xo("mapTexelToLinear",n.mapEncoding):"",n.matcap?Xo("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Xo("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Xo("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Xo("lightMapTexelToLinear",n.lightMapEncoding):"",Qo("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ea).join("\n")),o=sa(o),o=na(o,n),o=ra(o,n),a=sa(a),a=na(a,n),a=ra(a,n),o=ca(o),a=ca(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(_="#version 300 es\n",g=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#define varying in",n.glslVersion===In?"":"out highp vec4 pc_fragColor;",n.glslVersion===In?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const v=_+y+a,b=Zo(i,35633,_+g+o),w=Zo(i,35632,v);if(i.attachShader(m,b),i.attachShader(m,w),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),t.debug.checkShaderErrors){const t=i.getProgramInfoLog(m).trim(),e=i.getShaderInfoLog(b).trim(),n=i.getShaderInfoLog(w).trim();let r=!0,s=!0;if(!1===i.getProgramParameter(m,35714)){r=!1;const e=Ko(i,b,"vertex"),n=Ko(i,w,"fragment");console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(m,35715),"gl.getProgramInfoLog",t,e,n)}else""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==e&&""!==n||(s=!1);s&&(this.diagnostics={runnable:r,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:n,prefix:y}})}let x,S;return i.deleteShader(b),i.deleteShader(w),this.getUniforms=function(){return void 0===x&&(x=new qo(i,m)),x},this.getAttributes=function(){return void 0===S&&(S=function(t,e){const n={},r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i).name;n[r]=t.getAttribLocation(e,r)}return n}(i,m)),S},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=Yo++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=w,this}function pa(t,e,n,r,i,s){const o=[],a=r.isWebGL2,l=r.logarithmicDepthBuffer,c=r.floatVertexTextures,u=r.maxVertexUniforms,h=r.vertexTextures;let d=r.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},p=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function m(t){let e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=On,e}return{getParameters:function(i,o,p,g,y){const _=g.fog,v=e.get(i.envMap||(i.isMeshStandardMaterial?g.environment:null)),b=f[i.type],w=y.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(c)return 1024;{const t=Math.floor((u-20)/4),n=Math.min(t,e.length);return n<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+n+"."),0):n}}(y):0;let x,S;if(null!==i.precision&&(d=r.getMaxPrecision(i.precision),d!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",d,"instead.")),b){const t=Ms[b];x=t.vertexShader,S=t.fragmentShader}else x=i.vertexShader,S=i.fragmentShader;const E=t.getRenderTarget();return{isWebGL2:a,shaderID:b,shaderName:i.type,vertexShader:x,fragmentShader:S,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:d,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:h,outputEncoding:null!==E?m(E.texture):t.outputEncoding,map:!!i.map,mapEncoding:m(i.map),matcap:!!i.matcap,matcapEncoding:m(i.matcap),envMap:!!v,envMapMode:v&&v.mapping,envMapEncoding:m(v),envMapCubeUV:!!v&&(306===v.mapping||307===v.mapping),lightMap:!!i.lightMap,lightMapEncoding:m(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:m(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmission:!!i.transmission,transmissionMap:!!i.transmissionMap,thicknessMap:!!i.thicknessMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexAlphas:!0===i.vertexColors&&y.geometry&&y.geometry.attributes.color&&4===y.geometry.attributes.color.itemSize,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmission||i.transmissionMap||i.thicknessMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmission||i.transmissionMap||i.thicknessMap||!i.displacementMap),fog:!!_,useFog:i.fog,fogExp2:_&&_.isFogExp2,flatShading:!!i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:l,skinning:!0===y.isSkinnedMesh&&w>0,maxBones:w,useVertexTexture:c,morphTargets:i.morphTargets,morphNormals:i.morphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:i.dithering,shadowMapEnabled:t.shadowMap.enabled&&p.length>0,shadowMapType:t.shadowMap.type,toneMapping:i.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);if(!1===e.isRawShaderMaterial){for(let t=0;t<p.length;t++)n.push(e[p[t]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=f[t.type];let n;return n=e?ds.clone(Ms[e].uniforms):t.uniforms,n},acquireProgram:function(e,n){let r;for(let t=0,i=o.length;t<i;t++){const e=o[t];if(e.cacheKey===n){r=e,++r.usedTimes;break}}return void 0===r&&(r=new fa(t,n,e,i),o.push(r)),r},releaseProgram:function(t){if(0==--t.usedTimes){const e=o.indexOf(t);o[e]=o[o.length-1],o.pop(),t.destroy()}},programs:o}}function ma(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}}function ga(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ya(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function _a(t){const e=[];let n=0;const r=[],i=[],s=[],o={id:-1};function a(r,i,s,a,l,c){let u=e[n];const h=t.get(s);return void 0===u?(u={id:r.id,object:r,geometry:i,material:s,program:h.program||o,groupOrder:a,renderOrder:r.renderOrder,z:l,group:c},e[n]=u):(u.id=r.id,u.object=r,u.geometry=i,u.material=s,u.program=h.program||o,u.groupOrder=a,u.renderOrder=r.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:r,transmissive:i,transparent:s,init:function(){n=0,r.length=0,i.length=0,s.length=0},push:function(t,e,n,o,l,c){const u=a(t,e,n,o,l,c);n.transmission>0?i.push(u):!0===n.transparent?s.push(u):r.push(u)},unshift:function(t,e,n,o,l,c){const u=a(t,e,n,o,l,c);n.transmission>0?i.unshift(u):!0===n.transparent?s.unshift(u):r.unshift(u)},finish:function(){for(let t=n,r=e.length;t<r;t++){const n=e[t];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(t,e){r.length>1&&r.sort(t||ga),i.length>1&&i.sort(e||ya),s.length>1&&s.sort(e||ya)}}}function va(t){let e=new WeakMap;return{get:function(n,r){let i;return!1===e.has(n)?(i=new _a(t),e.set(n,[i])):r>=e.get(n).length?(i=new _a(t),e.get(n).push(i)):i=e.get(n)[r],i},dispose:function(){e=new WeakMap}}}function ba(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new er,color:new Ci};break;case"SpotLight":n={position:new er,direction:new er,color:new Ci,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new er,color:new Ci,distance:0,decay:0};break;case"HemisphereLight":n={direction:new er,skyColor:new Ci,groundColor:new Ci};break;case"RectAreaLight":n={color:new Ci,position:new er,halfWidth:new er,halfHeight:new er}}return t[e.id]=n,n}}}let wa=0;function xa(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Sa(t,e){const n=new ba,r=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hn,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)i.probe.push(new er);const s=new er,o=new Rr,a=new Rr;return{setup:function(s){let o=0,a=0,l=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let c=0,u=0,h=0,d=0,f=0,p=0,m=0,g=0;s.sort(xa);for(let t=0,e=s.length;t<e;t++){const e=s[t],y=e.color,_=e.intensity,v=e.distance,b=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)o+=y.r*_,a+=y.g*_,l+=y.b*_;else if(e.isLightProbe)for(let t=0;t<9;t++)i.probe[t].addScaledVector(e.sh.coefficients[t],_);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.directionalShadow[c]=n,i.directionalShadowMap[c]=b,i.directionalShadowMatrix[c]=e.shadow.matrix,p++}i.directional[c]=t,c++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(y).multiplyScalar(_),t.distance=v,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.spotShadow[h]=n,i.spotShadowMap[h]=b,i.spotShadowMatrix[h]=e.shadow.matrix,g++}i.spot[h]=t,h++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(y).multiplyScalar(_),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),i.rectArea[d]=t,d++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,i.pointShadow[u]=n,i.pointShadowMap[u]=b,i.pointShadowMatrix[u]=e.shadow.matrix,m++}i.point[u]=t,u++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(_),t.groundColor.copy(e.groundColor).multiplyScalar(_),i.hemi[f]=t,f++}}d>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=Cs.LTC_FLOAT_1,i.rectAreaLTC2=Cs.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Cs.LTC_HALF_1,i.rectAreaLTC2=Cs.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=o,i.ambient[1]=a,i.ambient[2]=l;const y=i.hash;y.directionalLength===c&&y.pointLength===u&&y.spotLength===h&&y.rectAreaLength===d&&y.hemiLength===f&&y.numDirectionalShadows===p&&y.numPointShadows===m&&y.numSpotShadows===g||(i.directional.length=c,i.spot.length=h,i.rectArea.length=d,i.point.length=u,i.hemi.length=f,i.directionalShadow.length=p,i.directionalShadowMap.length=p,i.pointShadow.length=m,i.pointShadowMap.length=m,i.spotShadow.length=g,i.spotShadowMap.length=g,i.directionalShadowMatrix.length=p,i.pointShadowMatrix.length=m,i.spotShadowMatrix.length=g,y.directionalLength=c,y.pointLength=u,y.spotLength=h,y.rectAreaLength=d,y.hemiLength=f,y.numDirectionalShadows=p,y.numPointShadows=m,y.numSpotShadows=g,i.version=wa++)},setupView:function(t,e){let n=0,r=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let d=0,f=t.length;d<f;d++){const e=t[d];if(e.isDirectionalLight){const t=i.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),n++}else if(e.isSpotLight){const t=i.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),l++}else if(e.isRectAreaLight){const t=i.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),a.identity(),o.copy(e.matrixWorld),o.premultiply(h),a.extractRotation(o),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(e.isPointLight){const t=i.point[r];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),r++}else if(e.isHemisphereLight){const t=i.hemi[u];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(h),t.direction.normalize(),u++}}},state:i}}function Ea(t,e){const n=new Sa(t,e),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(t){n.setupView(r,t)},pushLight:function(t){r.push(t)},pushShadow:function(t){i.push(t)}}}function Aa(t,e){let n=new WeakMap;return{get:function(r,i=0){let s;return!1===n.has(r)?(s=new Ea(t,e),n.set(r,[s])):i>=n.get(r).length?(s=new Ea(t,e),n.get(r).push(s)):s=n.get(r)[i],s},dispose:function(){n=new WeakMap}}}class Ta extends bi{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}Ta.prototype.isMeshDepthMaterial=!0;class Ca extends bi{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new er,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function Ma(t,e,n){let r=new xs;const i=new Hn,s=new Hn,o=new Kn,a=[],l=[],c={},u=n.maxTextureSize,h={0:1,1:0,2:2},d=new fs({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Hn},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new $i;p.setAttribute("position",new Di(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new as(p,d),g=this;function y(n,r){const i=e.update(m);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,d,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,f,m,null)}function _(t){const e=t<<0;let n=a[e];return void 0===n&&(n=new Ta({depthPacking:3201,morphTargets:t}),a[e]=n),n}function v(t){const e=t<<0;let n=l[e];return void 0===n&&(n=new Ca({morphTargets:t}),l[e]=n),n}function b(e,n,r,i,s,o,a){let l=null,u=_,d=e.customDepthMaterial;if(!0===i.isPointLight&&(u=v,d=e.customDistanceMaterial),void 0===d){let t=!1;!0===r.morphTargets&&(t=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0),l=u(t)}else l=d;if(t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){const t=l.uuid,e=r.uuid;let n=c[t];void 0===n&&(n={},c[t]=n);let i=n[e];void 0===i&&(i=l.clone(),n[e]=i),l=i}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=3===a?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:h[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=s,l.farDistance=o),l}function w(n,i,s,o,a){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===a)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const r=e.update(n),i=n.material;if(Array.isArray(i)){const e=r.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=i[c.materialIndex];if(u&&u.visible){const e=b(n,r,u,o,s.near,s.far,a);t.renderBufferDirect(s,null,r,e,n,c)}}}else if(i.visible){const e=b(n,r,i,o,s.near,s.far,a);t.renderBufferDirect(s,null,r,e,n,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)w(l[t],i,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,n,a){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let f=0,p=e.length;f<p;f++){const l=e[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const h=c.getFrameExtents();if(i.multiply(h),s.copy(c.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/h.x),i.x=s.x*h.x,c.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/h.y),i.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map&&!c.isPointLightShadow&&3===this.type){const t={minFilter:hn,magFilter:hn,format:bn};c.map=new Xn(i.x,i.y,t),c.map.texture.name=l.name+".shadowMap",c.mapPass=new Xn(i.x,i.y,t),c.camera.updateProjectionMatrix()}null===c.map&&(c.map=new Xn(i.x,i.y,{minFilter:un,magFilter:un,format:bn}),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()),t.setRenderTarget(c.map),t.clear();const p=c.getViewportCount();for(let t=0;t<p;t++){const e=c.getViewport(t);o.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(o),c.updateMatrices(l,t),r=c.getFrustum(),w(n,a,c.camera,l,this.type)}c.isPointLightShadow||3!==this.type||y(c,a),c.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function Oa(t,e,n){const r=n.isWebGL2,i=new function(){let e=!1;const n=new Kn;let r=null;const i=new Kn(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,s,o,a){!0===a&&(e*=o,r*=o,s*=o),n.set(e,r,s,o),!1===i.equals(n)&&(t.clearColor(e,r,s,o),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},s=new function(){let e=!1,n=null,r=null,i=null;return{setTest:function(t){t?F(2929):B(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},o=new function(){let e=!1,n=null,r=null,i=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(t){e||(t?F(2960):B(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,o){r===e&&i===n&&s===o||(t.stencilFunc(e,n,o),r=e,i=n,s=o)},setOp:function(e,n,r){o===e&&a===n&&l===r||(t.stencilOp(e,n,r),o=e,a=n,l=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,s=null,o=null,a=null,l=null,c=null}}};let a={},l=null,c={},u=null,h=!1,d=null,f=null,p=null,m=null,g=null,y=null,_=null,v=!1,b=null,w=null,x=null,S=null,E=null;const A=t.getParameter(35661);let T=!1,C=0;const M=t.getParameter(7938);-1!==M.indexOf("WebGL")?(C=parseFloat(/^WebGL (\d)/.exec(M)[1]),T=C>=1):-1!==M.indexOf("OpenGL ES")&&(C=parseFloat(/^OpenGL ES (\d)/.exec(M)[1]),T=C>=2);let O=null,P={};const D=t.getParameter(3088),R=t.getParameter(2978),L=(new Kn).fromArray(D),I=(new Kn).fromArray(R);function N(e,n,r){const i=new Uint8Array(4),s=t.createTexture();t.bindTexture(e,s),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let o=0;o<r;o++)t.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return s}const k={};function F(e){!0!==a[e]&&(t.enable(e),a[e]=!0)}function B(e){!1!==a[e]&&(t.disable(e),a[e]=!1)}k[3553]=N(3553,3553,1),k[34067]=N(34067,34069,6),i.setClear(0,0,0,1),s.setClear(1),o.setClear(0),F(2929),s.setFunc(3),z(!1),$(1),F(2884),V(0);const j={[on]:32774,101:32778,102:32779};if(r)j[103]=32775,j[104]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(j[103]=t.MIN_EXT,j[104]=t.MAX_EXT)}const U={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function V(e,n,r,i,s,o,a,l){if(0!==e){if(!1===h&&(F(3042),h=!0),5===e)s=s||n,o=o||r,a=a||i,n===f&&s===g||(t.blendEquationSeparate(j[n],j[s]),f=n,g=s),r===p&&i===m&&o===y&&a===_||(t.blendFuncSeparate(U[r],U[i],U[o],U[a]),p=r,m=i,y=o,_=a),d=e,v=null;else if(e!==d||l!==v){if(f===on&&g===on||(t.blendEquation(32774),f=on,g=on),l)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}p=null,m=null,y=null,_=null,d=e,v=l}}else!0===h&&(B(3042),h=!1)}function z(e){b!==e&&(t.frontFace(e?2304:2305),b=e)}function $(e){0!==e?(F(2884),e!==w&&t.cullFace(1===e?1029:2===e?1028:1032)):B(2884),w=e}function H(e,n,r){e?(F(32823),S===n&&E===r||(t.polygonOffset(n,r),S=n,E=r)):B(32823)}function G(e){void 0===e&&(e=33984+A-1),O!==e&&(t.activeTexture(e),O=e)}return{buffers:{color:i,depth:s,stencil:o},enable:F,disable:B,bindFramebuffer:function(e,n){return null===n&&null!==l&&(n=l),c[e]!==n&&(t.bindFramebuffer(e,n),c[e]=n,r&&(36009===e&&(c[36160]=n),36160===e&&(c[36009]=n)),!0)},bindXRFramebuffer:function(e){e!==l&&(t.bindFramebuffer(36160,e),l=e)},useProgram:function(e){return u!==e&&(t.useProgram(e),u=e,!0)},setBlending:V,setMaterial:function(t,e){2===t.side?B(2884):F(2884);let n=1===t.side;e&&(n=!n),z(n),1===t.blending&&!1===t.transparent?V(0):V(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),i.setMask(t.colorWrite);const r=t.stencilWrite;o.setTest(r),r&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),H(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?F(32926):B(32926)},setFlipSided:z,setCullFace:$,setLineWidth:function(e){e!==x&&(T&&t.lineWidth(e),x=e)},setPolygonOffset:H,setScissorTest:function(t){t?F(3089):B(3089)},activeTexture:G,bindTexture:function(e,n){null===O&&G();let r=P[O];void 0===r&&(r={type:void 0,texture:void 0},P[O]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||k[e]),r.type=e,r.texture=n)},unbindTexture:function(){const e=P[O];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===L.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),L.copy(e))},viewport:function(e){!1===I.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),I.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===r&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),a={},O=null,P={},l=null,c={},u=null,h=!1,d=null,f=null,p=null,m=null,g=null,y=null,_=null,v=!1,b=null,w=null,x=null,S=null,E=null,L.set(0,0,t.canvas.width,t.canvas.height),I.set(0,0,t.canvas.width,t.canvas.height),i.reset(),s.reset(),o.reset()}}}function Pa(t,e,n,r,i,s,o){const a=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,u=i.maxTextureSize,h=i.maxSamples,d=new WeakMap;let f,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(F){}function m(t,e){return p?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(t,e,n,r){let i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const r=e?$n:Math.floor,s=r(i*t.width),o=r(i*t.height);void 0===f&&(f=m(s,o));const a=n?m(s,o):f;return a.width=s,a.height=o,a.getContext("2d").drawImage(t,0,0,s,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+s+"x"+o+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function y(t){return zn(t.width)&&zn(t.height)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==un&&t.minFilter!==hn}function v(e,n,i,s){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log2(Math.max(i,s))}function b(n,r,i){if(!1===a)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let s=r;return 6403===r&&(5126===i&&(s=33326),5131===i&&(s=33325),5121===i&&(s=33321)),6407===r&&(5126===i&&(s=34837),5131===i&&(s=34843),5121===i&&(s=32849)),6408===r&&(5126===i&&(s=34836),5131===i&&(s=34842),5121===i&&(s=32856)),33325!==s&&33326!==s&&34842!==s&&34836!==s||e.get("EXT_color_buffer_float"),s}function w(t){return t===un||1004===t||1005===t?9728:9729}function x(e){const n=e.target;n.removeEventListener("dispose",x),function(e){const n=r.get(e);void 0!==n.__webglInit&&(t.deleteTexture(n.__webglTexture),r.remove(e))}(n),n.isVideoTexture&&d.delete(n),o.memory.textures--}function S(e){const n=e.target;n.removeEventListener("dispose",S),function(e){const n=e.texture,i=r.get(e),s=r.get(n);if(e){if(void 0!==s.__webglTexture&&(t.deleteTexture(s.__webglTexture),o.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(i.__webglFramebuffer[e]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[e]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&t.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,i=n.length;e<i;e++){const i=r.get(n[e]);i.__webglTexture&&(t.deleteTexture(i.__webglTexture),o.memory.textures--),r.remove(n[e])}r.remove(n),r.remove(e)}}(n)}let E=0;function A(t,e){const i=r.get(t);if(t.isVideoTexture&&function(t){const e=o.render.frame;d.get(t)!==e&&(d.set(t,e),t.update())}(t),t.version>0&&i.__version!==t.version){const n=t.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void D(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function T(e,i){const o=r.get(e);e.version>0&&o.__version!==e.version?function(e,r,i){if(6!==r.image.length)return;P(e,r),n.activeTexture(33984+i),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);const o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),l=r.image[0]&&r.image[0].isDataTexture,u=[];for(let t=0;t<6;t++)u[t]=o||l?l?r.image[t].image:r.image[t]:g(r.image[t],!1,!0,c);const h=u[0],d=y(h)||a,f=s.convert(r.format),p=s.convert(r.type),m=b(r.internalFormat,f,p);let w;if(O(34067,r,d),o){for(let t=0;t<6;t++){w=u[t].mipmaps;for(let e=0;e<w.length;e++){const i=w[e];r.format!==bn&&r.format!==vn?null!==f?n.compressedTexImage2D(34069+t,e,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+t,e,m,i.width,i.height,0,f,p,i.data)}}e.__maxMipLevel=w.length-1}else{w=r.mipmaps;for(let t=0;t<6;t++)if(l){n.texImage2D(34069+t,0,m,u[t].width,u[t].height,0,f,p,u[t].data);for(let e=0;e<w.length;e++){const r=w[e].image[t].image;n.texImage2D(34069+t,e+1,m,r.width,r.height,0,f,p,r.data)}}else{n.texImage2D(34069+t,0,m,f,p,u[t]);for(let e=0;e<w.length;e++)n.texImage2D(34069+t,e+1,m,f,p,w[e].image[t])}e.__maxMipLevel=w.length}_(r,d)&&v(34067,r,h.width,h.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}(o,e,i):(n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture))}const C={[an]:10497,[ln]:33071,[cn]:33648},M={[un]:9728,1004:9984,1005:9986,[hn]:9729,1007:9985,[dn]:9987};function O(n,s,o){if(o?(t.texParameteri(n,10242,C[s.wrapS]),t.texParameteri(n,10243,C[s.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,C[s.wrapR]),t.texParameteri(n,10240,M[s.magFilter]),t.texParameteri(n,10241,M[s.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),s.wrapS===ln&&s.wrapT===ln||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,w(s.magFilter)),t.texParameteri(n,10241,w(s.minFilter)),s.minFilter!==un&&s.minFilter!==hn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const o=e.get("EXT_texture_filter_anisotropic");if(s.type===gn&&!1===e.has("OES_texture_float_linear"))return;if(!1===a&&s.type===yn&&!1===e.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||r.get(s).__currentAnisotropy)&&(t.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),r.get(s).__currentAnisotropy=s.anisotropy)}}function P(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",x),e.__webglTexture=t.createTexture(),o.memory.textures++)}function D(e,r,i){let o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),P(e,r),n.activeTexture(33984+i),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);const l=function(t){return!a&&(t.wrapS!==ln||t.wrapT!==ln||t.minFilter!==un&&t.minFilter!==hn)}(r)&&!1===y(r.image),c=g(r.image,l,!1,u),h=y(c)||a,d=s.convert(r.format);let f,p=s.convert(r.type),m=b(r.internalFormat,d,p);O(o,r,h);const w=r.mipmaps;if(r.isDepthTexture)m=6402,a?m=r.type===gn?36012:r.type===mn?33190:r.type===_n?35056:33189:r.type===gn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===wn&&6402===m&&r.type!==pn&&r.type!==mn&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=pn,p=s.convert(r.type)),r.format===xn&&6402===m&&(m=34041,r.type!==_n&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=_n,p=s.convert(r.type))),n.texImage2D(3553,0,m,c.width,c.height,0,d,p,null);else if(r.isDataTexture)if(w.length>0&&h){for(let t=0,e=w.length;t<e;t++)f=w[t],n.texImage2D(3553,t,m,f.width,f.height,0,d,p,f.data);r.generateMipmaps=!1,e.__maxMipLevel=w.length-1}else n.texImage2D(3553,0,m,c.width,c.height,0,d,p,c.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(let t=0,e=w.length;t<e;t++)f=w[t],r.format!==bn&&r.format!==vn?null!==d?n.compressedTexImage2D(3553,t,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,t,m,f.width,f.height,0,d,p,f.data);e.__maxMipLevel=w.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,d,p,c.data),e.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,d,p,c.data),e.__maxMipLevel=0;else if(w.length>0&&h){for(let t=0,e=w.length;t<e;t++)f=w[t],n.texImage2D(3553,t,m,d,p,f);r.generateMipmaps=!1,e.__maxMipLevel=w.length-1}else n.texImage2D(3553,0,m,d,p,c),e.__maxMipLevel=0;_(r,h)&&v(o,r,c.width,c.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function R(e,i,o,a,l){const c=s.convert(o.format),u=s.convert(o.type),h=b(o.internalFormat,c,u);32879===l||35866===l?n.texImage3D(l,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(l,0,h,i.width,i.height,0,c,u,null),n.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,l,r.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function L(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===gn?i=36012:e.type===mn&&(i=33190));const r=I(n);t.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(r){const e=I(n);t.renderbufferStorageMultisample(36161,e,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,i=s.convert(e.format),o=s.convert(e.type),a=b(e.internalFormat,i,o);if(r){const e=I(n);t.renderbufferStorageMultisample(36161,e,a,n.width,n.height)}else t.renderbufferStorage(36161,a,n.width,n.height)}t.bindRenderbuffer(36161,null)}function I(t){return a&&t.isWebGLMultisampleRenderTarget?Math.min(h,t.samples):0}let N=!1,k=!1;this.allocateTextureUnit=function(){const t=E;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),E+=1,t},this.resetTextureUnits=function(){E=0},this.setTexture2D=A,this.setTexture2DArray=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?D(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?D(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=T,this.setupRenderTarget=function(e){const l=e.texture,c=r.get(e),u=r.get(l);e.addEventListener("dispose",S),!0!==e.isWebGLMultipleRenderTargets&&(u.__webglTexture=t.createTexture(),u.__version=l.version,o.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,f=!0===e.isWebGLMultisampleRenderTarget,p=l.isDataTexture3D||l.isDataTexture2DArray,m=y(e)||a;if(!a||l.format!==vn||l.type!==gn&&l.type!==yn||(l.format=bn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else if(c.__webglFramebuffer=t.createFramebuffer(),d)if(i.drawBuffers){const n=e.texture;for(let e=0,i=n.length;e<i;e++){const i=r.get(n[e]);void 0===i.__webglTexture&&(i.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(f)if(a){c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const r=s.convert(l.format),i=s.convert(l.type),o=b(l.internalFormat,r,i),a=I(e);t.renderbufferStorageMultisample(36161,a,o,e.width,e.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),L(c.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(34067,u.__webglTexture),O(34067,l,m);for(let t=0;t<6;t++)R(c.__webglFramebuffer[t],e,l,36064,34069+t);_(l,m)&&v(34067,l,e.width,e.height),n.bindTexture(34067,null)}else if(d){const t=e.texture;for(let i=0,s=t.length;i<s;i++){const s=t[i],o=r.get(s);n.bindTexture(3553,o.__webglTexture),O(3553,s,m),R(c.__webglFramebuffer,e,s,36064+i,3553),_(s,m)&&v(3553,s,e.width,e.height)}n.bindTexture(3553,null)}else{let t=3553;p&&(a?t=l.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(t,u.__webglTexture),O(t,l,m),R(c.__webglFramebuffer,e,l,36064,t),_(l,m)&&v(3553,l,e.width,e.height),n.bindTexture(3553,null)}e.depthBuffer&&function(e){const i=r.get(e),s=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),A(i.depthTexture,0);const s=r.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===wn)t.framebufferTexture2D(36160,36096,3553,s,0);else{if(i.depthTexture.format!==xn)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,s,0)}}(i.__webglFramebuffer,e)}else if(s){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(36160,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=t.createRenderbuffer(),L(i.__webglDepthbuffer[r],e,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),L(i.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}(e)},this.updateRenderTargetMipmap=function(t){const e=y(t)||a,i=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let s=0,o=i.length;s<o;s++){const o=i[s];if(_(o,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,i=r.get(o).__webglTexture;n.bindTexture(e,i),v(e,o,t.width,t.height),n.bindTexture(e,null)}}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(a){const i=e.width,s=e.height;let o=16384;e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024);const a=r.get(e);n.bindFramebuffer(36008,a.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,a.__webglFramebuffer),t.blitFramebuffer(0,0,i,s,0,0,i,s,o,9728),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,a.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===N&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),N=!0),t=t.texture),A(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===k&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),k=!0),t=t.texture),T(t,e)}}function Da(t,e,n){const r=n.isWebGL2;return{convert:function(t){let n;if(t===fn)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(t===pn)return 5123;if(1013===t)return 5124;if(t===mn)return 5125;if(t===gn)return 5126;if(t===yn)return r?5131:(n=e.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(1021===t)return 6406;if(t===vn)return 6407;if(t===bn)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(t===wn)return 6402;if(t===xn)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(n=e.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(33776===t)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(n=e.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(35840===t)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return n=e.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&(n=e.get("WEBGL_compressed_texture_etc"),null!==n)){if(37492===t)return n.COMPRESSED_RGB8_ETC2;if(37496===t)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?(n=e.get("WEBGL_compressed_texture_astc"),null!==n?t:null):36492===t?(n=e.get("EXT_texture_compression_bptc"),null!==n?t:null):t===_n?r?34042:(n=e.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Ca.prototype.isMeshDistanceMaterial=!0;class Ra extends ms{constructor(t=[]){super(),this.cameras=t}}Ra.prototype.isArrayCamera=!0;class La extends ri{constructor(){super(),this.type="Group"}}La.prototype.isGroup=!0;const Ia={type:"move"};class Na{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new La,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new La,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new er,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new er),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new La,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new er,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new er),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,i=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==o&&(r=e.getPose(t.targetRaySpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Ia))),l&&t.hand){s=!0;for(const s of t.hand.values()){const t=e.getJointPose(s,n);if(void 0===l.joints[s.jointName]){const t=new La;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[s.jointName]=t,l.add(t)}const r=l.joints[s.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const r=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),i=.02,o=.005;l.inputState.pinching&&r>i+o?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&r<=i-o&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==r),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==s),this}}class ka extends Nn{constructor(t,e){super();const n=this,r=t.state;let i=null,s=1,o=null,a="local-floor",l=null;const c=[],u=new Map,h=new ms;h.layers.enable(1),h.viewport=new Kn;const d=new ms;d.layers.enable(2),d.viewport=new Kn;const f=[h,d],p=new Ra;p.layers.enable(1),p.layers.enable(2);let m=null,g=null;function y(t){const e=u.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function _(){u.forEach(function(t,e){t.disconnect(e)}),u.clear(),m=null,g=null,r.bindXRFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),E.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(t){const e=i.inputSources;for(let n=0;n<c.length;n++)u.set(e[n],c[n]);for(let n=0;n<t.removed.length;n++){const e=t.removed[n],r=u.get(e);r&&(r.dispatchEvent({type:"disconnected",data:e}),u.delete(e))}for(let n=0;n<t.added.length;n++){const e=t.added[n],r=u.get(e);r&&r.dispatchEvent({type:"connected",data:e})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=c[t];return void 0===e&&(e=new Na,c[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=c[t];return void 0===e&&(e=new Na,c[t]=e),e.getGripSpace()},this.getHand=function(t){let e=c[t];return void 0===e&&(e=new Na,c[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){s=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return i},this.setSession=async function(t){if(i=t,null!==i){i.addEventListener("select",y),i.addEventListener("selectstart",y),i.addEventListener("selectend",y),i.addEventListener("squeeze",y),i.addEventListener("squeezestart",y),i.addEventListener("squeezeend",y),i.addEventListener("end",_),i.addEventListener("inputsourceschange",v);const t=e.getContextAttributes();!0!==t.xrCompatible&&await e.makeXRCompatible();const r=new XRWebGLLayer(i,e,{antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:s});i.updateRenderState({baseLayer:r}),o=await i.requestReferenceSpace(a),E.setContext(i),E.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const b=new er,w=new er;function x(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===i)return;p.near=d.near=h.near=t.near,p.far=d.far=h.far=t.far,m===p.near&&g===p.far||(i.updateRenderState({depthNear:p.near,depthFar:p.far}),m=p.near,g=p.far);const e=t.parent,n=p.cameras;x(p,e);for(let i=0;i<n.length;i++)x(n[i],e);t.matrixWorld.copy(p.matrixWorld),t.matrix.copy(p.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);const r=t.children;for(let i=0,s=r.length;i<s;i++)r[i].updateMatrixWorld(!0);2===n.length?function(t,e,n){b.setFromMatrixPosition(e.matrixWorld),w.setFromMatrixPosition(n.matrixWorld);const r=b.distanceTo(w),i=e.projectionMatrix.elements,s=n.projectionMatrix.elements,o=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(s[8]+1)/s[0],d=o*u,f=o*h,p=r/(-u+h),m=p*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=o+p,y=a+p;t.projectionMatrix.makePerspective(d-m,f+(r-m),l*a/y*g,c*a/y*g,g,y)}(p,h,d):p.projectionMatrix.copy(h.projectionMatrix)},this.getCamera=function(){return p};let S=null;const E=new Ss;E.setAnimationLoop(function(t,e){if(l=e.getViewerPose(o),null!==l){const t=l.views,e=i.renderState.baseLayer;r.bindXRFramebuffer(e.framebuffer);let n=!1;t.length!==p.cameras.length&&(p.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r],s=e.getViewport(i),o=f[r];o.matrix.fromArray(i.transform.matrix),o.projectionMatrix.fromArray(i.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===r&&p.matrix.copy(o.matrix),!0===n&&p.cameras.push(o)}}const n=i.inputSources;for(let r=0;r<c.length;r++)c[r].update(n[r],e,o);S&&S(t,e)}),this.setAnimationLoop=function(t){S=t},this.dispose=function(){}}}function Fa(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap);const r=t.get(n).envMap;if(r){e.envMap.value=r,e.flipEnvMap.value=r.isCubeTexture&&r._needsFlipEnvMap?-1:1,e.reflectivity.value=n.reflectivity,e.refractionRatio.value=n.refractionRatio;const i=t.get(r).__maxMipLevel;void 0!==i&&(e.maxMipLevel.value=i)}let i,s;n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?i=n.map:n.specularMap?i=n.specularMap:n.displacementMap?i=n.displacementMap:n.normalMap?i=n.normalMap:n.bumpMap?i=n.bumpMap:n.roughnessMap?i=n.roughnessMap:n.metalnessMap?i=n.metalnessMap:n.alphaMap?i=n.alphaMap:n.emissiveMap?i=n.emissiveMap:n.clearcoatMap?i=n.clearcoatMap:n.clearcoatNormalMap?i=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(i=n.clearcoatRoughnessMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix)),n.aoMap?s=n.aoMap:n.lightMap&&(s=n.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),e.uv2Transform.value.copy(s.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,r,i,s,o){r.isMeshBasicMaterial?e(t,r):r.isMeshLambertMaterial?(e(t,r),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,r)):r.isMeshToonMaterial?(e(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshPhongMaterial?(e(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshStandardMaterial?(e(t,r),r.isMeshPhysicalMaterial?function(t,e,r){n(t,e),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen),e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()),t.transmission.value=e.transmission,e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),e.transmission>0&&(t.transmissionSamplerMap.value=r.texture,t.transmissionSamplerSize.value.set(r.width,r.height)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)}(t,r,o):n(t,r)):r.isMeshMatcapMaterial?(e(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDepthMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isMeshDistanceMaterial?(e(t,r),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,r)):r.isMeshNormalMaterial?(e(t,r),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,r)):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,n,r){let i;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?i=e.map:e.alphaMap&&(i=e.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,r,i,s):r.isSpriteMaterial?function(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Ba(t){const e=void 0!==(t=t||{}).canvas?t.canvas:function(){const t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,s=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let h=null,d=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=On,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const m=this;let g=!1,y=0,_=0,v=null,b=-1,w=null;const x=new Kn,S=new Kn;let E=null,A=e.width,T=e.height,C=1,M=null,O=null;const P=new Kn(0,0,A,T),D=new Kn(0,0,A,T);let R=!1;const L=[],I=new xs;let N=!1,k=!1,F=null;const B=new Rr,j=new er,U={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function V(){return null===v?C:1}let z,$,H,G,W,q,Z,Y,J,K,X,Q,tt,et,nt,rt,it,st,ot,at,lt,ct,ut=n;function ht(t,n){for(let r=0;r<t.length;r++){const i=e.getContext(t[r],n);if(null!==i)return i}return null}try{const t={alpha:r,depth:i,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if(e.addEventListener("webglcontextlost",pt,!1),e.addEventListener("webglcontextrestored",mt,!1),null===ut){const e=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&e.shift(),ut=ht(e,t),null===ut)throw ht(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ut.getShaderPrecisionFormat&&(ut.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ct){throw console.error("THREE.WebGLRenderer: "+Ct.message),Ct}function dt(){z=new Ns(ut),$=new Rs(ut,z,t),z.init($),lt=new Da(ut,z,$),H=new Oa(ut,z,$),L[0]=1029,G=new Bs(ut),W=new ma,q=new Pa(ut,z,H,W,$,lt,G),Z=new Is(m),Y=new Es(ut,$),ct=new Ps(ut,z,Y,$),J=new ks(ut,Y,G,ct),K=new zs(ut,J,Y,G),st=new Vs(ut),nt=new Ls(W),X=new pa(m,Z,z,$,ct,nt),Q=new Fa(W),tt=new va(W),et=new Aa(z,$),it=new Os(m,Z,H,K,a),rt=new Ma(m,K,$),ot=new Ds(ut,z,G,$),at=new Fs(ut,z,G,$),G.programs=X.programs,m.capabilities=$,m.extensions=z,m.properties=W,m.renderLists=tt,m.shadowMap=rt,m.state=H,m.info=G}dt();const ft=new ka(m,ut);function pt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function mt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const t=G.autoReset,e=rt.enabled,n=rt.autoUpdate,r=rt.needsUpdate,i=rt.type;dt(),G.autoReset=t,rt.enabled=e,rt.autoUpdate=n,rt.needsUpdate=r,rt.type=i}function gt(t){const e=t.target;e.removeEventListener("dispose",gt),function(t){(function(t){const e=W.get(t).programs;void 0!==e&&e.forEach(function(t){X.releaseProgram(t)})})(t),W.remove(t)}(e)}this.xr=ft,this.getContext=function(){return ut},this.getContextAttributes=function(){return ut.getContextAttributes()},this.forceContextLoss=function(){const t=z.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=z.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(t){void 0!==t&&(C=t,this.setSize(A,T,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new Hn),t.set(A,T)},this.setSize=function(t,n,r){ft.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(A=t,T=n,e.width=Math.floor(t*C),e.height=Math.floor(n*C),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new Hn),t.set(A*C,T*C).floor()},this.setDrawingBufferSize=function(t,n,r){A=t,T=n,C=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new Kn),t.copy(x)},this.getViewport=function(t){return t.copy(P)},this.setViewport=function(t,e,n,r){t.isVector4?P.set(t.x,t.y,t.z,t.w):P.set(t,e,n,r),H.viewport(x.copy(P).multiplyScalar(C).floor())},this.getScissor=function(t){return t.copy(D)},this.setScissor=function(t,e,n,r){t.isVector4?D.set(t.x,t.y,t.z,t.w):D.set(t,e,n,r),H.scissor(S.copy(D).multiplyScalar(C).floor())},this.getScissorTest=function(){return R},this.setScissorTest=function(t){H.setScissorTest(R=t)},this.setOpaqueSort=function(t){M=t},this.setTransparentSort=function(t){O=t},this.getClearColor=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),t=new Ci),t.copy(it.getClearColor())},this.setClearColor=function(){it.setClearColor.apply(it,arguments)},this.getClearAlpha=function(){return it.getClearAlpha()},this.setClearAlpha=function(){it.setClearAlpha.apply(it,arguments)},this.clear=function(t,e,n){let r=0;(void 0===t||t)&&(r|=16384),(void 0===e||e)&&(r|=256),(void 0===n||n)&&(r|=1024),ut.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",pt,!1),e.removeEventListener("webglcontextrestored",mt,!1),tt.dispose(),et.dispose(),W.dispose(),Z.dispose(),K.dispose(),ct.dispose(),ft.dispose(),ft.removeEventListener("sessionstart",_t),ft.removeEventListener("sessionend",vt),F&&(F.dispose(),F=null),bt.stop()},this.renderBufferImmediate=function(t,e){ct.initAttributes();const n=W.get(t);t.hasPositions&&!n.position&&(n.position=ut.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=ut.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=ut.createBuffer()),t.hasColors&&!n.color&&(n.color=ut.createBuffer());const r=e.getAttributes();t.hasPositions&&(ut.bindBuffer(34962,n.position),ut.bufferData(34962,t.positionArray,35048),ct.enableAttribute(r.position),ut.vertexAttribPointer(r.position,3,5126,!1,0,0)),t.hasNormals&&(ut.bindBuffer(34962,n.normal),ut.bufferData(34962,t.normalArray,35048),ct.enableAttribute(r.normal),ut.vertexAttribPointer(r.normal,3,5126,!1,0,0)),t.hasUvs&&(ut.bindBuffer(34962,n.uv),ut.bufferData(34962,t.uvArray,35048),ct.enableAttribute(r.uv),ut.vertexAttribPointer(r.uv,2,5126,!1,0,0)),t.hasColors&&(ut.bindBuffer(34962,n.color),ut.bufferData(34962,t.colorArray,35048),ct.enableAttribute(r.color),ut.vertexAttribPointer(r.color,3,5126,!1,0,0)),ct.disableUnusedAttributes(),ut.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,s){null===e&&(e=U);const o=i.isMesh&&i.matrixWorld.determinant()<0,a=Tt(t,e,r,i);H.setMaterial(r,o);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===r.wireframe&&(l=J.getWireframeAttribute(n),h=2),(r.morphTargets||r.morphNormals)&&st.update(i,n,r,a),ct.setup(i,r,a,n,l);let d=ot;null!==l&&(u=Y.get(l),d=at,d.setIndex(u));const f=null!==l?l.count:c.count,p=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==s?s.start*h:0,y=null!==s?s.count*h:1/0,_=Math.max(p,g),v=Math.min(f,p+m,g+y)-1,b=Math.max(0,v-_+1);if(0!==b){if(i.isMesh)!0===r.wireframe?(H.setLineWidth(r.wireframeLinewidth*V()),d.setMode(1)):d.setMode(4);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),H.setLineWidth(t*V()),d.setMode(i.isLineSegments?1:i.isLineLoop?2:3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);if(i.isInstancedMesh)d.renderInstances(_,b,i.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(_,b,t)}else d.render(_,b)}},this.compile=function(t,e){d=et.get(t),d.init(),t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))}),d.setupLights(),t.traverse(function(e){const n=e.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++)Et(n[r],t,e);else Et(n,t,e)})};let yt=null;function _t(){bt.stop()}function vt(){bt.start()}const bt=new Ss;function wt(t,e,n,r){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||I.intersectsSprite(t)){r&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);const e=K.update(t),i=t.material;i.visible&&h.push(t,e,i,n,j.z,null)}}else if(t.isImmediateRenderObject)r&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B),h.push(t,null,t.material,n,j.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==G.render.frame&&(t.skeleton.update(),t.skeleton.frame=G.render.frame),!t.frustumCulled||I.intersectsObject(t))){r&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);const e=K.update(t),i=t.material;if(Array.isArray(i)){const r=e.groups;for(let s=0,o=r.length;s<o;s++){const o=r[s],a=i[o.materialIndex];a&&a.visible&&h.push(t,e,a,n,j.z,o)}}else i.visible&&h.push(t,e,i,n,j.z,null)}const i=t.children;for(let s=0,o=i.length;s<o;s++)wt(i[s],e,n,r)}function xt(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,s=t.length;i<s;i++){const s=t[i],o=s.object,a=s.geometry,l=null===r?s.material:r,c=s.group;if(n.isArrayCamera){const t=n.cameras;for(let n=0,r=t.length;n<r;n++){const r=t[n];o.layers.test(r.layers)&&(H.viewport(x.copy(r.viewport)),d.setupLightsView(r),St(o,e,r,a,l,c))}}else St(o,e,n,a,l,c)}}function St(t,e,n,r,i,s){if(t.onBeforeRender(m,e,n,r,i,s),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){const r=Tt(n,e,i,t);H.setMaterial(i),ct.reset(),function(t,e){t.render(function(t){m.renderBufferImmediate(t,e)})}(t,r)}else m.renderBufferDirect(n,e,r,i,t,s);t.onAfterRender(m,e,n,r,i,s)}function Et(t,e,n){!0!==e.isScene&&(e=U);const r=W.get(t),i=d.state.lights,s=i.state.version,o=X.getParameters(t,i.state,d.state.shadowsArray,e,n),a=X.getProgramCacheKey(o);let l=r.programs;r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=Z.get(t.envMap||r.environment),void 0===l&&(t.addEventListener("dispose",gt),l=new Map,r.programs=l);let c=l.get(a);if(void 0!==c){if(r.currentProgram===c&&r.lightsStateVersion===s)return At(t,o),c}else o.uniforms=X.getUniforms(t),t.onBuild(o,m),t.onBeforeCompile(o,m),c=X.acquireProgram(o,a),l.set(a,c),r.uniforms=o.uniforms;const u=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(u.clippingPlanes=nt.uniform),At(t,o),r.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),r.lightsStateVersion=s,r.needsLights&&(u.ambientLightColor.value=i.state.ambient,u.lightProbe.value=i.state.probe,u.directionalLights.value=i.state.directional,u.directionalLightShadows.value=i.state.directionalShadow,u.spotLights.value=i.state.spot,u.spotLightShadows.value=i.state.spotShadow,u.rectAreaLights.value=i.state.rectArea,u.ltc_1.value=i.state.rectAreaLTC1,u.ltc_2.value=i.state.rectAreaLTC2,u.pointLights.value=i.state.point,u.pointLightShadows.value=i.state.pointShadow,u.hemisphereLights.value=i.state.hemi,u.directionalShadowMap.value=i.state.directionalShadowMap,u.directionalShadowMatrix.value=i.state.directionalShadowMatrix,u.spotShadowMap.value=i.state.spotShadowMap,u.spotShadowMatrix.value=i.state.spotShadowMatrix,u.pointShadowMap.value=i.state.pointShadowMap,u.pointShadowMatrix.value=i.state.pointShadowMatrix);const h=c.getUniforms(),f=qo.seqWithValue(h.seq,u);return r.currentProgram=c,r.uniformsList=f,c}function At(t,e){const n=W.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas}function Tt(t,e,n,r){!0!==e.isScene&&(e=U),q.resetTextureUnits();const i=e.fog,s=null===v?m.outputEncoding:v.texture.encoding,o=Z.get(n.envMap||(n.isMeshStandardMaterial?e.environment:null)),a=!0===n.vertexColors&&r.geometry&&r.geometry.attributes.color&&4===r.geometry.attributes.color.itemSize,l=W.get(n),c=d.state.lights;!0!==N||!0!==k&&t===w||nt.setState(n,t,t===w&&n.id===b);let u=!1;n.version===l.__version?l.needsLights&&l.lightsStateVersion!==c.state.version||l.outputEncoding!==s||r.isInstancedMesh&&!1===l.instancing?u=!0:r.isInstancedMesh||!0!==l.instancing?r.isSkinnedMesh&&!1===l.skinning?u=!0:r.isSkinnedMesh||!0!==l.skinning?l.envMap!==o||n.fog&&l.fog!==i?u=!0:void 0===l.numClippingPlanes||l.numClippingPlanes===nt.numPlanes&&l.numIntersection===nt.numIntersection?l.vertexAlphas!==a&&(u=!0):u=!0:u=!0:u=!0:(u=!0,l.__version=n.version);let h=l.currentProgram;!0===u&&(h=Et(n,e,r));let f=!1,p=!1,g=!1;const y=h.getUniforms(),_=l.uniforms;if(H.useProgram(h.program)&&(f=!0,p=!0,g=!0),n.id!==b&&(b=n.id,p=!0),f||w!==t){if(y.setValue(ut,"projectionMatrix",t.projectionMatrix),$.logarithmicDepthBuffer&&y.setValue(ut,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),w!==t&&(w=t,p=!0,g=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const e=y.map.cameraPosition;void 0!==e&&e.setValue(ut,j.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&y.setValue(ut,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||r.isSkinnedMesh)&&y.setValue(ut,"viewMatrix",t.matrixWorldInverse)}if(r.isSkinnedMesh){y.setOptional(ut,r,"bindMatrix"),y.setOptional(ut,r,"bindMatrixInverse");const t=r.skeleton;t&&($.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),y.setValue(ut,"boneTexture",t.boneTexture,q),y.setValue(ut,"boneTextureSize",t.boneTextureSize)):y.setOptional(ut,t,"boneMatrices"))}var x,S;return(p||l.receiveShadow!==r.receiveShadow)&&(l.receiveShadow=r.receiveShadow,y.setValue(ut,"receiveShadow",r.receiveShadow)),p&&(y.setValue(ut,"toneMappingExposure",m.toneMappingExposure),l.needsLights&&((x=_).ambientLightColor.needsUpdate=S=g,x.lightProbe.needsUpdate=S,x.directionalLights.needsUpdate=S,x.directionalLightShadows.needsUpdate=S,x.pointLights.needsUpdate=S,x.pointLightShadows.needsUpdate=S,x.spotLights.needsUpdate=S,x.spotLightShadows.needsUpdate=S,x.rectAreaLights.needsUpdate=S,x.hemisphereLights.needsUpdate=S),i&&n.fog&&Q.refreshFogUniforms(_,i),Q.refreshMaterialUniforms(_,n,C,T,F),qo.upload(ut,l.uniformsList,_,q)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(qo.upload(ut,l.uniformsList,_,q),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&y.setValue(ut,"center",r.center),y.setValue(ut,"modelViewMatrix",r.modelViewMatrix),y.setValue(ut,"normalMatrix",r.normalMatrix),y.setValue(ut,"modelMatrix",r.matrixWorld),h}bt.setAnimationLoop(function(t){yt&&yt(t)}),"undefined"!=typeof window&&bt.setContext(window),this.setAnimationLoop=function(t){yt=t,ft.setAnimationLoop(t),null===t?bt.stop():bt.start()},ft.addEventListener("sessionstart",_t),ft.addEventListener("sessionend",vt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===ft.enabled&&!0===ft.isPresenting&&(!0===ft.cameraAutoUpdate&&ft.updateCamera(e),e=ft.getCamera()),!0===t.isScene&&t.onBeforeRender(m,t,e,v),d=et.get(t,p.length),d.init(),p.push(d),B.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),I.setFromProjectionMatrix(B),k=this.localClippingEnabled,N=nt.init(this.clippingPlanes,k,e),h=tt.get(t,f.length),h.init(),f.push(h),wt(t,e,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(M,O),!0===N&&nt.beginShadows(),rt.render(d.state.shadowsArray,t,e),d.setupLights(),d.setupLightsView(e),!0===N&&nt.endShadows(),!0===this.info.autoReset&&this.info.reset(),it.render(h,t);const n=h.opaque,r=h.transmissive,i=h.transparent;n.length>0&&xt(n,t,e),r.length>0&&function(t,e,n,r){null===F&&(F=new Xn(1024,1024,{generateMipmaps:!0,minFilter:dn,magFilter:un,wrapS:ln,wrapT:ln}));const i=m.getRenderTarget();m.setRenderTarget(F),m.clear(),xt(t,n,r),q.updateRenderTargetMipmap(F),m.setRenderTarget(i),xt(e,n,r)}(n,r,t,e),i.length>0&&xt(i,t,e),null!==v&&(q.updateRenderTargetMipmap(v),q.updateMultisampleRenderTarget(v)),!0===t.isScene&&t.onAfterRender(m,t,e),H.buffers.depth.setTest(!0),H.buffers.depth.setMask(!0),H.buffers.color.setMask(!0),H.setPolygonOffset(!1),ct.resetDefaultState(),b=-1,w=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return v},this.setRenderTarget=function(t,e=0,n=0){v=t,y=e,_=n,t&&void 0===W.get(t).__webglFramebuffer&&q.setupRenderTarget(t);let r=null,i=!1,s=!1;if(t){const n=t.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(s=!0);const o=W.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=o[e],i=!0):r=t.isWebGLMultisampleRenderTarget?W.get(t).__webglMultisampledFramebuffer:o,x.copy(t.viewport),S.copy(t.scissor),E=t.scissorTest}else x.copy(P).multiplyScalar(C).floor(),S.copy(D).multiplyScalar(C).floor(),E=R;if(H.bindFramebuffer(36160,r)&&$.drawBuffers){let e=!1;if(t)if(t.isWebGLMultipleRenderTargets){const n=t.texture;if(L.length!==n.length||36064!==L[0]){for(let t=0,e=n.length;t<e;t++)L[t]=36064+t;L.length=n.length,e=!0}}else 1===L.length&&36064===L[0]||(L[0]=36064,L.length=1,e=!0);else 1===L.length&&1029===L[0]||(L[0]=1029,L.length=1,e=!0);e&&($.isWebGL2?ut.drawBuffers(L):z.get("WEBGL_draw_buffers").drawBuffersWEBGL(L))}if(H.viewport(x),H.scissor(S),H.setScissorTest(E),i){const r=W.get(t.texture);ut.framebufferTexture2D(36160,36064,34069+e,r.__webglTexture,n)}else if(s){const r=W.get(t.texture);ut.framebufferTextureLayer(36160,36064,r.__webglTexture,n||0,e||0)}},this.readRenderTargetPixels=function(t,e,n,r,i,s,o){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=W.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){H.bindFramebuffer(36160,a);try{const o=t.texture,a=o.format,l=o.type;if(a!==bn&&lt.convert(a)!==ut.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===yn&&(z.has("EXT_color_buffer_half_float")||$.isWebGL2&&z.has("EXT_color_buffer_float"));if(!(l===fn||lt.convert(l)===ut.getParameter(35738)||l===gn&&($.isWebGL2||z.has("OES_texture_float")||z.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ut.checkFramebufferStatus(36160)?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&ut.readPixels(e,n,r,i,lt.convert(a),lt.convert(l),s):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const t=null!==v?W.get(v).__webglFramebuffer:null;H.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),s=Math.floor(e.image.height*r);let o=lt.convert(e.format);$.isWebGL2&&(6407===o&&(o=32849),6408===o&&(o=32856)),q.setTexture2D(e,0),ut.copyTexImage2D(3553,n,o,t.x,t.y,i,s,0),H.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r=0){const i=e.image.width,s=e.image.height,o=lt.convert(n.format),a=lt.convert(n.type);q.setTexture2D(n,0),ut.pixelStorei(37440,n.flipY),ut.pixelStorei(37441,n.premultiplyAlpha),ut.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?ut.texSubImage2D(3553,r,t.x,t.y,i,s,o,a,e.image.data):e.isCompressedTexture?ut.compressedTexSubImage2D(3553,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):ut.texSubImage2D(3553,r,t.x,t.y,o,a,e.image),0===r&&n.generateMipmaps&&ut.generateMipmap(3553),H.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,r,i=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const{width:s,height:o,data:a}=n.image,l=lt.convert(r.format),c=lt.convert(r.type);let u;if(r.isDataTexture3D)q.setTexture3D(r,0),u=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");q.setTexture2DArray(r,0),u=35866}ut.pixelStorei(37440,r.flipY),ut.pixelStorei(37441,r.premultiplyAlpha),ut.pixelStorei(3317,r.unpackAlignment);const h=ut.getParameter(3314),d=ut.getParameter(32878),f=ut.getParameter(3316),p=ut.getParameter(3315),g=ut.getParameter(32877);ut.pixelStorei(3314,s),ut.pixelStorei(32878,o),ut.pixelStorei(3316,t.min.x),ut.pixelStorei(3315,t.min.y),ut.pixelStorei(32877,t.min.z),ut.texSubImage3D(u,i,e.x,e.y,e.z,t.max.x-t.min.x+1,t.max.y-t.min.y+1,t.max.z-t.min.z+1,l,c,a),ut.pixelStorei(3314,h),ut.pixelStorei(32878,d),ut.pixelStorei(3316,f),ut.pixelStorei(3315,p),ut.pixelStorei(32877,g),0===i&&r.generateMipmaps&&ut.generateMipmap(u),H.unbindTexture()},this.initTexture=function(t){q.setTexture2D(t,0),H.unbindTexture()},this.resetState=function(){y=0,_=0,v=null,H.reset(),ct.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends Ba{}).prototype.isWebGL1Renderer=!0;class ja{constructor(t,e=25e-5){this.name="",this.color=new Ci(t),this.density=e}clone(){return new ja(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}ja.prototype.isFogExp2=!0;class Ua{constructor(t,e=1,n=1e3){this.name="",this.color=new Ci(t),this.near=e,this.far=n}clone(){return new Ua(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Ua.prototype.isFog=!0;class Va extends ri{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}Va.prototype.isScene=!0;class za{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Rn,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=jn()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jn()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jn()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}za.prototype.isInterleavedBuffer=!0;const $a=new er;class Ha{constructor(t,e,n,r){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)$a.x=this.getX(e),$a.y=this.getY(e),$a.z=this.getZ(e),$a.applyMatrix4(t),this.setXYZ(e,$a.x,$a.y,$a.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)$a.x=this.getX(e),$a.y=this.getY(e),$a.z=this.getZ(e),$a.applyNormalMatrix(t),this.setXYZ(e,$a.x,$a.y,$a.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)$a.x=this.getX(e),$a.y=this.getY(e),$a.z=this.getZ(e),$a.transformDirection(t),this.setXYZ(e,$a.x,$a.y,$a.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,i){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Di(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Ha(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ha.prototype.isInterleavedBufferAttribute=!0;class Ga extends bi{constructor(t){super(),this.type="SpriteMaterial",this.color=new Ci(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let Wa;Ga.prototype.isSpriteMaterial=!0;const qa=new er,Za=new er,Ya=new er,Ja=new Hn,Ka=new Hn,Xa=new Rr,Qa=new er,tl=new er,el=new er,nl=new Hn,rl=new Hn,il=new Hn;function sl(t,e,n,r,i,s){Ja.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(Ka.x=s*Ja.x-i*Ja.y,Ka.y=i*Ja.x+s*Ja.y):Ka.copy(Ja),t.copy(e),t.x+=Ka.x,t.y+=Ka.y,t.applyMatrix4(Xa)}(class extends ri{constructor(t){if(super(),this.type="Sprite",void 0===Wa){Wa=new $i;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new za(t,5);Wa.setIndex([0,1,2,0,2,3]),Wa.setAttribute("position",new Ha(e,3,0,!1)),Wa.setAttribute("uv",new Ha(e,2,3,!1))}this.geometry=Wa,this.material=void 0!==t?t:new Ga,this.center=new Hn(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Za.setFromMatrixScale(this.matrixWorld),Xa.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Ya.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Za.multiplyScalar(-Ya.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const s=this.center;sl(Qa.set(-.5,-.5,0),Ya,s,Za,r,i),sl(tl.set(.5,-.5,0),Ya,s,Za,r,i),sl(el.set(.5,.5,0),Ya,s,Za,r,i),nl.set(0,0),rl.set(1,0),il.set(1,1);let o=t.ray.intersectTriangle(Qa,tl,el,!1,qa);if(null===o&&(sl(tl.set(-.5,.5,0),Ya,s,Za,r,i),rl.set(0,1),o=t.ray.intersectTriangle(Qa,el,tl,!1,qa),null===o))return;const a=t.ray.origin.distanceTo(qa);a<t.near||a>t.far||e.push({distance:a,point:qa.clone(),uv:_i.getUV(qa,Qa,tl,el,nl,rl,il,new Hn),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}).prototype.isSprite=!0;const ol=new er,al=new Kn,ll=new Kn,cl=new er,ul=new Rr;class hl extends as{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Rr,this.bindMatrixInverse=new Rr}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Kn,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,r=this.geometry;al.fromBufferAttribute(r.attributes.skinIndex,t),ll.fromBufferAttribute(r.attributes.skinWeight,t),ol.fromBufferAttribute(r.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let i=0;i<4;i++){const t=ll.getComponent(i);if(0!==t){const r=al.getComponent(i);ul.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(cl.copy(ol).applyMatrix4(ul),t)}}return e.applyMatrix4(this.bindMatrixInverse)}}hl.prototype.isSkinnedMesh=!0,class extends ri{constructor(){super(),this.type="Bone"}}.prototype.isBone=!0,class extends Yn{constructor(t,e,n,r,i,s,o,a,l,c,u,h){super(null,s,o,a,l,c,r,i,u,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==l?l:un,this.minFilter=void 0!==c?c:un,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}.prototype.isDataTexture=!0;const dl=new Rr,fl=new Rr,pl=[],ml=new as;(class extends as{constructor(t,e,n){super(t,e),this.instanceMatrix=new Di(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(ml.geometry=this.geometry,ml.material=this.material,void 0!==ml.material)for(let i=0;i<r;i++){this.getMatrixAt(i,dl),fl.multiplyMatrices(n,dl),ml.matrixWorld=fl,ml.raycast(t,pl);for(let t=0,n=pl.length;t<n;t++){const n=pl[t];n.instanceId=i,n.object=this,e.push(n)}pl.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new Di(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class gl extends bi{constructor(t){super(),this.type="LineBasicMaterial",this.color=new Ci(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this}}gl.prototype.isLineBasicMaterial=!0;const yl=new er,_l=new er,vl=new Rr,bl=new Dr,wl=new Sr;class xl extends ri{constructor(t=new $i,e=new gl){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)yl.fromBufferAttribute(e,t-1),_l.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=yl.distanceTo(_l);t.setAttribute("lineDistance",new Ii(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),wl.copy(n.boundingSphere),wl.applyMatrix4(r),wl.radius+=i,!1===t.ray.intersectsSphere(wl))return;vl.copy(r).invert(),bl.copy(t.ray).applyMatrix4(vl);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new er,c=new er,u=new er,h=new er,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const r=n.index,i=n.attributes.position;if(null!==r)for(let n=Math.max(0,s.start),o=Math.min(r.count,s.start+s.count)-1;n<o;n+=d){const s=r.getX(n),o=r.getX(n+1);if(l.fromBufferAttribute(i,s),c.fromBufferAttribute(i,o),bl.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(h);d<t.near||d>t.far||e.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}else for(let n=Math.max(0,s.start),o=Math.min(i.count,s.start+s.count)-1;n<o;n+=d){if(l.fromBufferAttribute(i,n),c.fromBufferAttribute(i,n+1),bl.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const r=t.ray.origin.distanceTo(h);r<t.near||r>t.far||e.push({distance:r,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}xl.prototype.isLine=!0;const Sl=new er,El=new er;class Al extends xl{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)Sl.fromBufferAttribute(e,t),El.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+Sl.distanceTo(El);t.setAttribute("lineDistance",new Ii(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Al.prototype.isLineSegments=!0,class extends xl{constructor(t,e){super(t,e),this.type="LineLoop"}}.prototype.isLineLoop=!0;class Tl extends bi{constructor(t){super(),this.type="PointsMaterial",this.color=new Ci(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this}}Tl.prototype.isPointsMaterial=!0;const Cl=new Rr,Ml=new Dr,Ol=new Sr,Pl=new er;function Dl(t,e,n,r,i,s,o){const a=Ml.distanceSqToPoint(t);if(a<n){const n=new er;Ml.closestPointToPoint(t,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:o})}}(class extends ri{constructor(t=new $i,e=new Tl){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ol.copy(n.boundingSphere),Ol.applyMatrix4(r),Ol.radius+=i,!1===t.ray.intersectsSphere(Ol))return;Cl.copy(r).invert(),Ml.copy(t.ray).applyMatrix4(Cl);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){const i=n.index,o=n.attributes.position;if(null!==i)for(let n=Math.max(0,s.start),l=Math.min(i.count,s.start+s.count);n<l;n++){const s=i.getX(n);Pl.fromBufferAttribute(o,s),Dl(Pl,s,a,r,t,e,this)}else for(let n=Math.max(0,s.start),l=Math.min(o.count,s.start+s.count);n<l;n++)Pl.fromBufferAttribute(o,n),Dl(Pl,n,a,r,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class extends Yn{constructor(t,e,n,r,i,s,o,a,l){super(t,e,n,r,i,s,o,a,l),this.format=void 0!==o?o:vn,this.minFilter=void 0!==s?s:hn,this.magFilter=void 0!==i?i:hn,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)})}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;0=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class extends Yn{constructor(t,e,n,r,i,s,o,a,l,c,u,h){super(null,s,o,a,l,c,r,i,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isCompressedTexture=!0,class extends Yn{constructor(t,e,n,r,i,s,o,a,l){super(t,e,n,r,i,s,o,a,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;class Rl extends Yn{constructor(t,e,n,r,i,s,o,a,l,c){if((c=void 0!==c?c:wn)!==wn&&c!==xn)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===wn&&(n=pn),void 0===n&&c===xn&&(n=_n),super(null,r,i,s,o,a,c,n,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:un,this.minFilter=void 0!==a?a:un,this.flipY=!1,this.generateMipmaps=!1}}function Ll(t,e,n,r,i){let s,o;if(i===function(t,e,n,r){let i=0;for(let s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}(t,e,n,r)>0)for(s=e;s<n;s+=r)o=tc(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=tc(s,t[s],t[s+1],o);return o&&Zl(o,o.next)&&(ec(o),o=o.next),o}function Il(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!Zl(r,r.next)&&0!==ql(r.prev,r,r.next))r=r.next;else{if(ec(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function Nl(t,e,n,r,i,s,o){if(!t)return;!o&&s&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=$l(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,r);e++);for(l=c;a>0||l>0&&r;)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1)}(i)}(t,r,i,s);let a,l,c=t;for(;t.prev!==t.next;)if(a=t.prev,l=t.next,s?Fl(t,r,i,s):kl(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),ec(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?Nl(t=Bl(Il(t),e,n),e,n,r,i,s,2):2===o&&jl(t,e,n,r,i,s):Nl(Il(t),e,n,r,i,s,1);break}}function kl(t){const e=t.prev,n=t,r=t.next;if(ql(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(Gl(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&ql(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Fl(t,e,n,r){const i=t.prev,s=t,o=t.next;if(ql(i,s,o)>=0)return!1;const a=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,l=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,c=$l(i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,e,n,r),u=$l(a,l,e,n,r);let h=t.prevZ,d=t.nextZ;for(;h&&h.z>=c&&d&&d.z<=u;){if(h!==t.prev&&h!==t.next&&Gl(i.x,i.y,s.x,s.y,o.x,o.y,h.x,h.y)&&ql(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==t.prev&&d!==t.next&&Gl(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&ql(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=c;){if(h!==t.prev&&h!==t.next&&Gl(i.x,i.y,s.x,s.y,o.x,o.y,h.x,h.y)&&ql(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=u;){if(d!==t.prev&&d!==t.next&&Gl(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&ql(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Bl(t,e,n){let r=t;do{const i=r.prev,s=r.next.next;!Zl(i,s)&&Yl(i,r,r.next,s)&&Xl(i,s)&&Xl(s,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(s.i/n),ec(r),ec(r.next),r=t=s),r=r.next}while(r!==t);return Il(r)}function jl(t,e,n,r,i,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&Wl(o,t)){let a=Ql(o,t);return o=Il(o,o.next),a=Il(a,a.next),Nl(o,e,n,r,i,s),void Nl(a,e,n,r,i,s)}t=t.next}o=o.next}while(o!==t)}function Ul(t,e){return t.x-e.x}function Vl(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let s,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>o){if(o=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!s)return null;if(r===o)return s;const a=s,l=s.x,c=s.y;let u,h=1/0;n=s;do{r>=n.x&&n.x>=l&&r!==n.x&&Gl(i<c?r:o,i,l,c,i<c?o:r,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(r-n.x),Xl(n,t)&&(u<h||u===h&&(n.x>s.x||n.x===s.x&&zl(s,n)))&&(s=n,h=u)),n=n.next}while(n!==a);return s}(t,e)){const n=Ql(e,t);Il(e,e.next),Il(n,n.next)}}function zl(t,e){return ql(t.prev,t,e.prev)<0&&ql(e.next,t,t.next)<0}function $l(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Hl(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Gl(t,e,n,r,i,s,o,a){return(i-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(i-o)*(r-a)>=0}function Wl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Yl(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Xl(t,e)&&Xl(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(ql(t.prev,t,e.prev)||ql(t,e.prev,e))||Zl(t,e)&&ql(t.prev,t,t.next)>0&&ql(e.prev,e,e.next)>0)}function ql(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Zl(t,e){return t.x===e.x&&t.y===e.y}function Yl(t,e,n,r){const i=Kl(ql(t,e,n)),s=Kl(ql(t,e,r)),o=Kl(ql(n,r,t)),a=Kl(ql(n,r,e));return i!==s&&o!==a||!(0!==i||!Jl(t,n,e))||!(0!==s||!Jl(t,r,e))||!(0!==o||!Jl(n,t,r))||!(0!==a||!Jl(n,e,r))}function Jl(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Kl(t){return t>0?1:t<0?-1:0}function Xl(t,e){return ql(t.prev,t,t.next)<0?ql(t,e,t.next)>=0&&ql(t,t.prev,e)>=0:ql(t,e,t.prev)<0||ql(t,t.next,e)<0}function Ql(t,e){const n=new nc(t.i,t.x,t.y),r=new nc(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function tc(t,e,n,r){const i=new nc(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ec(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function nc(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Rl.prototype.isDepthTexture=!0,new er,new er,new er,new _i;class rc{static area(t){const e=t.length;let n=0;for(let r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n}static isClockWise(t){return rc.area(t)<0}static triangulateShape(t,e){const n=[],r=[],i=[];ic(t),sc(n,t);let s=t.length;e.forEach(ic);for(let a=0;a<e.length;a++)r.push(s),s+=e[a].length,sc(n,e[a]);const o=function(t,e,n){n=n||2;const r=e&&e.length,i=r?e[0]*n:t.length;let s=Ll(t,0,i,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,f;if(r&&(s=function(t,e,n,r){const i=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=Ll(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(Hl(c));for(i.sort(Ul),s=0;s<i.length;s++)Vl(i[s],n),n=Il(n,n.next);return n}(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(let e=n;e<i;e+=n)h=t[e],d=t[e+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return Nl(s,o,n,a,l,f),o}(n,r);for(let a=0;a<o.length;a+=3)i.push(o.slice(a,a+3));return i}}function ic(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function sc(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class oc extends $i{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],i=[];for(let o=0,a=t.length;o<a;o++)s(t[o]);function s(t){const s=[],o=void 0!==e.curveSegments?e.curveSegments:12,a=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:100,c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:u-2,d=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3;const p=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:ac;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let g,y,_,v,b,w=!1;p&&(g=p.getSpacedPoints(a),w=!0,c=!1,y=p.computeFrenetFrames(a,!1),_=new er,v=new er,b=new er),c||(f=0,u=0,h=0,d=0);const x=t.extractPoints(o);let S=x.shape;const E=x.holes;if(!rc.isClockWise(S)){S=S.reverse();for(let t=0,e=E.length;t<e;t++){const e=E[t];rc.isClockWise(e)&&(E[t]=e.reverse())}}const A=rc.triangulateShape(S,E),T=S;for(let e=0,n=E.length;e<n;e++)S=S.concat(E[e]);function C(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const M=S.length,O=A.length;function P(t,e,n){let r,i,s;const o=t.x-e.x,a=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=o*o+a*a;if(Math.abs(o*c-a*l)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),f=e.x-a/h,p=e.y+o/h,m=((n.x-c/d-f)*c-(n.y+l/d-p)*l)/(o*c-a*l);r=f+o*m-t.x,i=p+a*m-t.y;const g=r*r+i*i;if(g<=2)return new Hn(r,i);s=Math.sqrt(g/2)}else{let t=!1;o>Number.EPSILON?l>Number.EPSILON&&(t=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(c)&&(t=!0),t?(r=-a,i=o,s=Math.sqrt(u)):(r=o,i=a,s=Math.sqrt(u/2))}return new Hn(r/s,i/s)}const D=[];for(let e=0,n=T.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),D[e]=P(T[e],T[r],T[i]);const R=[];let L,I=D.concat();for(let e=0,n=E.length;e<n;e++){const t=E[e];L=[];for(let e=0,n=t.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),L[e]=P(t[e],t[r],t[i]);R.push(L),I=I.concat(L)}for(let e=0;e<f;e++){const t=e/f,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,i=T.length;e<i;e++){const t=C(T[e],D[e],r);F(t.x,t.y,-n)}for(let e=0,i=E.length;e<i;e++){const t=E[e];L=R[e];for(let e=0,i=t.length;e<i;e++){const i=C(t[e],L[e],r);F(i.x,i.y,-n)}}}const N=h+d;for(let e=0;e<M;e++){const t=c?C(S[e],I[e],N):S[e];w?(v.copy(y.normals[0]).multiplyScalar(t.x),_.copy(y.binormals[0]).multiplyScalar(t.y),b.copy(g[0]).add(v).add(_),F(b.x,b.y,b.z)):F(t.x,t.y,0)}for(let e=1;e<=a;e++)for(let t=0;t<M;t++){const n=c?C(S[t],I[t],N):S[t];w?(v.copy(y.normals[e]).multiplyScalar(n.x),_.copy(y.binormals[e]).multiplyScalar(n.y),b.copy(g[e]).add(v).add(_),F(b.x,b.y,b.z)):F(n.x,n.y,l/a*e)}for(let e=f-1;e>=0;e--){const t=e/f,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,i=T.length;e<i;e++){const t=C(T[e],D[e],r);F(t.x,t.y,l+n)}for(let e=0,i=E.length;e<i;e++){const t=E[e];L=R[e];for(let e=0,i=t.length;e<i;e++){const i=C(t[e],L[e],r);w?F(i.x,i.y+g[a-1].y,g[a-1].x+n):F(i.x,i.y,l+n)}}}function k(t,e){let n=t.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=t.length-1);for(let t=0,n=a+2*f;t<n;t++){const n=M*t,s=M*(t+1);j(e+r+n,e+i+n,e+i+s,e+r+s)}}}function F(t,e,n){s.push(t),s.push(e),s.push(n)}function B(t,e,i){U(t),U(e),U(i);const s=r.length/3,o=m.generateTopUV(n,r,s-3,s-2,s-1);V(o[0]),V(o[1]),V(o[2])}function j(t,e,i,s){U(t),U(e),U(s),U(e),U(i),U(s);const o=r.length/3,a=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);V(a[0]),V(a[1]),V(a[3]),V(a[1]),V(a[2]),V(a[3])}function U(t){r.push(s[3*t+0]),r.push(s[3*t+1]),r.push(s[3*t+2])}function V(t){i.push(t.x),i.push(t.y)}!function(){const t=r.length/3;if(c){let t=0,e=M*t;for(let n=0;n<O;n++){const t=A[n];B(t[2]+e,t[1]+e,t[0]+e)}t=a+2*f,e=M*t;for(let n=0;n<O;n++){const t=A[n];B(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<O;t++){const e=A[t];B(e[2],e[1],e[0])}for(let t=0;t<O;t++){const e=A[t];B(e[0]+M*a,e[1]+M*a,e[2]+M*a)}}n.addGroup(t,r.length/3-t,0)}(),function(){const t=r.length/3;let e=0;k(T,e),e+=T.length;for(let n=0,r=E.length;n<r;n++){const t=E[n];k(t,e),e+=t.length}n.addGroup(t,r.length/3-t,1)}()}this.setAttribute("position",new Ii(r,3)),this.setAttribute("uv",new Ii(i,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let r=0,i=t.length;r<i;r++)n.shapes.push(t[r].uuid);else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)}}const ac={generateTopUV:function(t,e,n,r,i){const s=e[3*r],o=e[3*r+1],a=e[3*i],l=e[3*i+1];return[new Hn(e[3*n],e[3*n+1]),new Hn(s,o),new Hn(a,l)]},generateSideWallUV:function(t,e,n,r,i,s){const o=e[3*n],a=e[3*n+1],l=e[3*n+2],c=e[3*r],u=e[3*r+1],h=e[3*r+2],d=e[3*i],f=e[3*i+1],p=e[3*i+2],m=e[3*s],g=e[3*s+1],y=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new Hn(o,1-l),new Hn(c,1-h),new Hn(d,1-p),new Hn(m,1-y)]:[new Hn(a,1-l),new Hn(u,1-h),new Hn(f,1-p),new Hn(g,1-y)]}};class lc extends $i{constructor(t,e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],i=[],s=[];let o=0,a=0;if(!1===Array.isArray(t))l(t);else for(let c=0;c<t.length;c++)l(t[c]),this.addGroup(o,a,c),o+=a,a=0;function l(t){const o=r.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===rc.isClockWise(c)&&(c=c.reverse());for(let e=0,n=u.length;e<n;e++){const t=u[e];!0===rc.isClockWise(t)&&(u[e]=t.reverse())}const h=rc.triangulateShape(c,u);for(let e=0,n=u.length;e<n;e++)c=c.concat(u[e]);for(let e=0,n=c.length;e<n;e++){const t=c[e];r.push(t.x,t.y,0),i.push(0,0,1),s.push(t.x,t.y)}for(let e=0,r=h.length;e<r;e++){const t=h[e];n.push(t[0]+o,t[1]+o,t[2]+o),a+=3}}this.setIndex(n),this.setAttribute("position",new Ii(r,3)),this.setAttribute("normal",new Ii(i,3)),this.setAttribute("uv",new Ii(s,2))}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++)e.shapes.push(t[n].uuid);else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}}(class extends bi{constructor(t){super(),this.type="ShadowMaterial",this.color=new Ci(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}).prototype.isShadowMaterial=!0,class extends fs{constructor(t){super(t),this.type="RawShaderMaterial"}}.prototype.isRawShaderMaterial=!0;class cc extends bi{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ci(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ci(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this}}cc.prototype.isMeshStandardMaterial=!0,class extends cc{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Hn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=Un(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ci(1,1,1),this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new Ci).copy(t.sheen):null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this}}.prototype.isMeshPhysicalMaterial=!0,class extends bi{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new Ci(16777215),this.specular=new Ci(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ci(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}.prototype.isMeshPhongMaterial=!0,class extends bi{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ci(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ci(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}.prototype.isMeshToonMaterial=!0,class extends bi{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}.prototype.isMeshNormalMaterial=!0;class uc extends bi{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new Ci(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ci(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}uc.prototype.isMeshLambertMaterial=!0,class extends bi{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ci(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Hn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}.prototype.isMeshMatcapMaterial=!0,class extends gl{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}.prototype.isLineDashedMaterial=!0;const hc={arraySlice:function(t,e,n){return hc.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){const r=t.length,i=new t.constructor(r);for(let s=0,o=0;o!==r;++s){const r=n[s]*e;for(let n=0;n!==e;++n)i[o++]=t[r+n]}return i},flattenJSON:function(t,e,n,r){let i=1,s=t[0];for(;void 0!==s&&void 0===s[r];)s=t[i++];if(void 0===s)return;let o=s[r];if(void 0!==o)if(Array.isArray(o))do{o=s[r],void 0!==o&&(e.push(s.time),n.push.apply(n,o)),s=t[i++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[r],void 0!==o&&(e.push(s.time),o.toArray(n,n.length)),s=t[i++]}while(void 0!==s);else do{o=s[r],void 0!==o&&(e.push(s.time),n.push(o)),s=t[i++]}while(void 0!==s)},subclip:function(t,e,n,r,i=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const t=s.tracks[l],e=t.getValueSize(),a=[],c=[];for(let s=0;s<t.times.length;++s){const o=t.times[s]*i;if(!(o<n||o>=r)){a.push(t.times[s]);for(let n=0;n<e;++n)c.push(t.values[s*e+n])}}0!==a.length&&(t.times=hc.convertArray(a,t.times.constructor),t.values=hc.convertArray(c,t.values.constructor),o.push(t))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(t,e=0,n=t,r=30){r<=0&&(r=30);const i=n.tracks.length,s=e/r;for(let o=0;o<i;++o){const e=n.tracks[o],r=e.ValueTypeName;if("bool"===r||"string"===r)continue;const i=t.tracks.find(function(t){return t.name===e.name&&t.ValueTypeName===r});if(void 0===i)continue;let a=0;const l=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=e.times.length-1;let d;if(s<=e.times[0])d=hc.arraySlice(e.values,a,l-a);else if(s>=e.times[h]){const t=h*l+a;d=hc.arraySlice(e.values,t,t+l-a)}else{const t=e.createInterpolant(),n=a,r=l-a;t.evaluate(s),d=hc.arraySlice(t.resultBuffer,n,r)}"quaternion"===r&&(new tr).fromArray(d).normalize().conjugate().toArray(d);const f=i.times.length;for(let t=0;t<f;++t){const e=t*u+c;if("quaternion"===r)tr.multiplyQuaternionsFlat(i.values,e,d,0,i.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)i.values[e+n]-=d[n]}}}return t.blendMode=2501,t}};class dc{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let s;n:{r:if(!(t<r)){for(let s=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===s)break;if(i=r,r=e[++n],t<r)break e}s=e.length;break n}if(t>=i)break t;{const o=e[1];t<o&&(n=2,i=o);for(let s=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===s)break;if(r=i,i=e[--n-1],t>=i)break e}s=n,n=0}}for(;n<s;){const r=n+s>>>1;t<e[r]?s=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let s=0;s!==r;++s)e[s]=n[i+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}dc.prototype.beforeStart_=dc.prototype.copySampleValue_,dc.prototype.afterEnd_=dc.prototype.copySampleValue_;class fc extends dc{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Tn,endingEnd:Tn}}intervalChanged_(t,e,n){const r=this.parameterPositions;let i=t-2,s=t+1,o=r[i],a=r[s];if(void 0===o)switch(this.getSettings_().endingStart){case Cn:i=t,o=2*e-n;break;case Mn:i=r.length-2,o=e+r[i]-r[i+1];break;default:i=t,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case Cn:s=t,a=2*n-e;break;case Mn:s=1,a=n+r[1]-r[0];break;default:s=t-1,a=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-n),this._offsetPrev=i*c,this._offsetNext=s*c}interpolate_(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-e)/(r-e),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,y=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,_=(-1-d)*m+(1.5+d)*p+.5*f,v=d*m-d*p;for(let b=0;b!==o;++b)i[b]=g*s[c+b]+y*s[l+b]+_*s[a+b]+v*s[u+b];return i}}class pc extends dc{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=(n-e)/(r-e),u=1-c;for(let h=0;h!==o;++h)i[h]=s[l+h]*u+s[a+h]*c;return i}}class mc extends dc{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class gc{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=hc.convertArray(e,this.TimeBufferType),this.values=hc.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:hc.convertArray(t.times,Array),values:hc.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new mc(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new pc(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new fc(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Sn:e=this.InterpolantFactoryMethodDiscrete;break;case En:e=this.InterpolantFactoryMethodLinear;break;case An:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Sn;case this.InterpolantFactoryMethodLinear:return En;case this.InterpolantFactoryMethodSmooth:return An}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let i=0,s=r-1;for(;i!==r&&n[i]<t;)++i;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==i||s!==r){i>=s&&(s=Math.max(s,1),i=s-1);const t=this.getValueSize();this.times=hc.arraySlice(n,i,s),this.values=hc.arraySlice(this.values,i*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==i;o++){const e=n[o];if("number"==typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,e),t=!1;break}if(null!==s&&s>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,e,s),t=!1;break}s=e}if(void 0!==r&&hc.isTypedArray(r))for(let o=0,a=r.length;o!==a;++o){const e=r[o];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,e),t=!1;break}}return t}optimize(){const t=hc.arraySlice(this.times),e=hc.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===An,i=t.length-1;let s=1;for(let o=1;o<i;++o){let i=!1;const a=t[o];if(a!==t[o+1]&&(1!==o||a!==t[0]))if(r)i=!0;else{const t=o*n,r=t-n,s=t+n;for(let o=0;o!==n;++o){const n=e[t+o];if(n!==e[r+o]||n!==e[s+o]){i=!0;break}}}if(i){if(o!==s){t[s]=t[o];const r=o*n,i=s*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++s}}if(i>0){t[s]=t[i];for(let t=i*n,r=s*n,o=0;o!==n;++o)e[r+o]=e[t+o];++s}return s!==t.length?(this.times=hc.arraySlice(t,0,s),this.values=hc.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){const t=hc.arraySlice(this.times,0),e=hc.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}gc.prototype.TimeBufferType=Float32Array,gc.prototype.ValueBufferType=Float32Array,gc.prototype.DefaultInterpolation=En;class yc extends gc{}yc.prototype.ValueTypeName="bool",yc.prototype.ValueBufferType=Array,yc.prototype.DefaultInterpolation=Sn,yc.prototype.InterpolantFactoryMethodLinear=void 0,yc.prototype.InterpolantFactoryMethodSmooth=void 0;class _c extends gc{}_c.prototype.ValueTypeName="color";class vc extends gc{}vc.prototype.ValueTypeName="number";class bc extends dc{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-e)/(r-e);let l=t*o;for(let c=l+o;l!==c;l+=4)tr.slerpFlat(i,0,s,l-o,s,l,a);return i}}class wc extends gc{InterpolantFactoryMethodLinear(t){return new bc(this.times,this.values,this.getValueSize(),t)}}wc.prototype.ValueTypeName="quaternion",wc.prototype.DefaultInterpolation=En,wc.prototype.InterpolantFactoryMethodSmooth=void 0;class xc extends gc{}xc.prototype.ValueTypeName="string",xc.prototype.ValueBufferType=Array,xc.prototype.DefaultInterpolation=Sn,xc.prototype.InterpolantFactoryMethodLinear=void 0,xc.prototype.InterpolantFactoryMethodSmooth=void 0;class Sc extends gc{}Sc.prototype.ValueTypeName="vector";class Ec{constructor(t,e=-1,n,r=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=jn(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let s=0,o=n.length;s!==o;++s)e.push(Ac(n[s]).scale(r));const i=new this(t.name,t.duration,e,t.blendMode);return i.uuid=t.uuid,i}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let i=0,s=n.length;i!==s;++i)e.push(gc.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const i=e.length,s=[];for(let o=0;o<i;o++){let t=[],a=[];t.push((o+i-1)%i,o,(o+1)%i),a.push(0,1,0);const l=hc.getKeyframeOrder(t);t=hc.sortedArray(t,1,l),a=hc.sortedArray(a,1,l),r||0!==t[0]||(t.push(i),a.push(a[0])),s.push(new vc(".morphTargetInfluences["+e[o].name+"]",t,a).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){const e=t[o],n=e.name.match(i);if(n&&n.length>1){const t=n[1];let i=r[t];i||(r[t]=i=[]),i.push(e)}}const s=[];for(const o in r)s.push(this.CreateFromMorphTargetSequence(o,r[o],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,r,i){if(0!==n.length){const s=[],o=[];hc.flattenJSON(n,s,o,r),0!==s.length&&i.push(new t(e,s,o))}},r=[],i=t.name||"default",s=t.fps||30,o=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let c=0;c<l.length;c++){const t=l[c].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let r=0;r<t[n].morphTargets.length;r++)e[t[n].morphTargets[r]]=-1;for(const i in e){const e=[],s=[];for(let r=0;r!==t[n].morphTargets.length;++r){const r=t[n];e.push(r.time),s.push(r.morphTarget===i?1:0)}r.push(new vc(".morphTargetInfluence["+i+"]",e,s))}a=e.length*(s||1)}else{const i=".bones["+e[c].name+"]";n(Sc,i+".position",t,"pos",r),n(wc,i+".quaternion",t,"rot",r),n(Sc,i+".scale",t,"scl",r)}}return 0===r.length?null:new this(i,a,r,o)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ac(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vc;case"vector":case"vector2":case"vector3":case"vector4":return Sc;case"color":return _c;case"quaternion":return wc;case"bool":case"boolean":return yc;case"string":return xc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];hc.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Tc={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Cc=new class{constructor(t,e,n){const r=this;let i,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===s&&void 0!==r.onStart&&r.onStart(t,o,a),s=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}};class Mc{constructor(t){this.manager=void 0!==t?t:Cc,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(r,i){n.load(t,r,e,i)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Oc={};class Pc extends Mc{constructor(t){super(t)}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,s=Tc.get(t);if(void 0!==s)return i.manager.itemStart(t),setTimeout(function(){e&&e(s),i.manager.itemEnd(t)},0),s;if(void 0!==Oc[t])return void Oc[t].push({onLoad:e,onProgress:n,onError:r});const o=t.match(/^data:(.*?)(;base64)?,(.*)$/);let a;if(o){const n=o[1],s=!!o[2];let a=o[3];a=decodeURIComponent(a),s&&(a=atob(a));try{let r;const s=(this.responseType||"").toLowerCase();switch(s){case"arraybuffer":case"blob":const t=new Uint8Array(a.length);for(let n=0;n<a.length;n++)t[n]=a.charCodeAt(n);r="blob"===s?new Blob([t.buffer],{type:n}):t.buffer;break;case"document":const e=new DOMParser;r=e.parseFromString(a,n);break;case"json":r=JSON.parse(a);break;default:r=a}setTimeout(function(){e&&e(r),i.manager.itemEnd(t)},0)}catch(l){setTimeout(function(){r&&r(l),i.manager.itemError(t),i.manager.itemEnd(t)},0)}}else{Oc[t]=[],Oc[t].push({onLoad:e,onProgress:n,onError:r}),a=new XMLHttpRequest,a.open("GET",t,!0),a.addEventListener("load",function(e){const n=this.response,r=Oc[t];if(delete Oc[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Tc.add(t,n);for(let t=0,e=r.length;t<e;t++){const e=r[t];e.onLoad&&e.onLoad(n)}i.manager.itemEnd(t)}else{for(let t=0,n=r.length;t<n;t++){const n=r[t];n.onError&&n.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)}},!1),a.addEventListener("progress",function(e){const n=Oc[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onProgress&&r.onProgress(e)}},!1),a.addEventListener("error",function(e){const n=Oc[t];delete Oc[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)},!1),a.addEventListener("abort",function(e){const n=Oc[t];delete Oc[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}i.manager.itemError(t),i.manager.itemEnd(t)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeader)a.setRequestHeader(t,this.requestHeader[t]);a.send(null)}return i.manager.itemStart(t),a}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Dc extends Mc{constructor(t){super(t)}load(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,s=Tc.get(t);if(void 0!==s)return i.manager.itemStart(t),setTimeout(function(){e&&e(s),i.manager.itemEnd(t)},0),s;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function a(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1),Tc.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(t),o.src=t,o}}class Rc extends Mc{constructor(t){super(t)}load(t,e,n,r){const i=new _s,s=new Dc(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(n){s.load(t[n],function(t){i.images[n]=t,o++,6===o&&(i.needsUpdate=!0,e&&e(i))},void 0,r)}for(let l=0;l<t.length;++l)a(l);return i}}class Lc extends Mc{constructor(t){super(t)}load(t,e,n,r){const i=new Yn,s=new Dc(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(n){i.image=n;const r=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?vn:bn,i.needsUpdate=!0,void 0!==e&&e(i)},n,r),i}}class Ic{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),i=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),i+=n.distanceTo(r),e.push(i),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const i=n.length;let s;s=e||t*n[i-1];let o,a=0,l=i-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),o=n[r]-s,o<0)a=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(r=l,n[r]===s)return r/(i-1);const c=n[r];return(r+(s-c)/(n[r+1]-c))/(i-1)}getTangent(t,e){const n=1e-4;let r=t-n,i=t+n;r<0&&(r=0),i>1&&(i=1);const s=this.getPoint(r),o=this.getPoint(i),a=e||(s.isVector2?new Hn:new er);return a.copy(o).sub(s).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new er,r=[],i=[],s=[],o=new er,a=new Rr;for(let d=0;d<=t;d++)r[d]=this.getTangentAt(d/t,new er),r[d].normalize();i[0]=new er,s[0]=new er;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),s[0].crossVectors(r[0],i[0]);for(let d=1;d<=t;d++){if(i[d]=i[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(r[d-1],r[d]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(Un(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(a.makeRotationAxis(o,t))}s[d].crossVectors(r[d],i[d])}if(!0===e){let e=Math.acos(Un(i[0].dot(i[t]),-1,1));e/=t,r[0].dot(o.crossVectors(i[0],i[t]))>0&&(e=-e);for(let n=1;n<=t;n++)i[n].applyMatrix4(a.makeRotationAxis(r[n],e*n)),s[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Nc extends Ic{constructor(t=0,e=0,n=1,r=1,i=0,s=2*Math.PI,o=!1,a=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){const n=e||new Hn,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const s=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=s?0:r),!0!==this.aClockwise||s||(i===r?i=-r:i-=r);const o=this.aStartAngle+t*i;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,r=l-this.aY;a=n*t-r*e+this.aX,l=n*e+r*t+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}Nc.prototype.isEllipseCurve=!0;class kc extends Nc{constructor(t,e,n,r,i,s){super(t,e,n,n,r,i,s),this.type="ArcCurve"}}function Fc(){let t=0,e=0,n=0,r=0;function i(i,s,o,a){t=i,e=o,n=-3*i+3*s-2*o-a,r=2*i-2*s+o+a}return{initCatmullRom:function(t,e,n,r,s){i(e,n,s*(n-t),s*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,s,o,a){let l=(e-t)/s-(n-t)/(s+o)+(n-e)/o,c=(n-e)/o-(r-e)/(o+a)+(r-n)/a;l*=o,c*=o,i(e,n,l,c)},calc:function(i){const s=i*i;return t+e*i+n*s+r*(s*i)}}}kc.prototype.isArcCurve=!0;const Bc=new er,jc=new Fc,Uc=new Fc,Vc=new Fc;class zc extends Ic{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new er){const n=e,r=this.points,i=r.length,s=(i-(this.closed?0:1))*t;let o,a,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?o=r[(l-1)%i]:(Bc.subVectors(r[0],r[1]).add(r[0]),o=Bc);const u=r[l%i],h=r[(l+1)%i];if(this.closed||l+2<i?a=r[(l+2)%i]:(Bc.subVectors(r[i-1],r[i-2]).add(r[i-1]),a=Bc),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),r=Math.pow(h.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),r<1e-4&&(r=n),jc.initNonuniformCatmullRom(o.x,u.x,h.x,a.x,e,n,r),Uc.initNonuniformCatmullRom(o.y,u.y,h.y,a.y,e,n,r),Vc.initNonuniformCatmullRom(o.z,u.z,h.z,a.z,e,n,r)}else"catmullrom"===this.curveType&&(jc.initCatmullRom(o.x,u.x,h.x,a.x,this.tension),Uc.initCatmullRom(o.y,u.y,h.y,a.y,this.tension),Vc.initCatmullRom(o.z,u.z,h.z,a.z,this.tension));return n.set(jc.calc(c),Uc.calc(c),Vc.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new er).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function $c(t,e,n,r,i){const s=.5*(r-e),o=.5*(i-n),a=t*t;return(2*n-2*r+s+o)*(t*a)+(-3*n+3*r-2*s-o)*a+s*t+n}function Hc(t,e,n,r){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function Gc(t,e,n,r,i){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}zc.prototype.isCatmullRomCurve3=!0;class Wc extends Ic{constructor(t=new Hn,e=new Hn,n=new Hn,r=new Hn){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new Hn){const n=e,r=this.v0,i=this.v1,s=this.v2,o=this.v3;return n.set(Gc(t,r.x,i.x,s.x,o.x),Gc(t,r.y,i.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}Wc.prototype.isCubicBezierCurve=!0;class qc extends Ic{constructor(t=new er,e=new er,n=new er,r=new er){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new er){const n=e,r=this.v0,i=this.v1,s=this.v2,o=this.v3;return n.set(Gc(t,r.x,i.x,s.x,o.x),Gc(t,r.y,i.y,s.y,o.y),Gc(t,r.z,i.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}qc.prototype.isCubicBezierCurve3=!0;class Zc extends Ic{constructor(t=new Hn,e=new Hn){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Hn){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new Hn;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Zc.prototype.isLineCurve=!0;class Yc extends Ic{constructor(t=new Hn,e=new Hn,n=new Hn){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Hn){const n=e,r=this.v0,i=this.v1,s=this.v2;return n.set(Hc(t,r.x,i.x,s.x),Hc(t,r.y,i.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Yc.prototype.isQuadraticBezierCurve=!0;class Jc extends Ic{constructor(t=new er,e=new er,n=new er){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new er){const n=e,r=this.v0,i=this.v1,s=this.v2;return n.set(Hc(t,r.x,i.x,s.x),Hc(t,r.y,i.y,s.y),Hc(t,r.z,i.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}Jc.prototype.isQuadraticBezierCurve3=!0;class Kc extends Ic{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new Hn){const n=e,r=this.points,i=(r.length-1)*t,s=Math.floor(i),o=i-s,a=r[0===s?s:s-1],l=r[s],c=r[s>r.length-2?r.length-1:s+1],u=r[s>r.length-3?r.length-1:s+2];return n.set($c(o,a.x,l.x,c.x,u.x),$c(o,a.y,l.y,c.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Hn).fromArray(n))}return this}}Kc.prototype.isSplineCurve=!0;var Xc=Object.freeze({__proto__:null,ArcCurve:kc,CatmullRomCurve3:zc,CubicBezierCurve:Wc,CubicBezierCurve3:qc,EllipseCurve:Nc,LineCurve:Zc,LineCurve3:class extends Ic{constructor(t=new er,e=new er){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new er){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:Yc,QuadraticBezierCurve3:Jc,SplineCurve:Kc});class Qc extends Ic{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Zc(e,t))}getPoint(t){const e=t*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=e){const t=n[r]-e,i=this.curves[r],s=i.getLength();return i.getPointAt(0===s?0:1-t/s)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const s=i[r],o=s.getPoints(s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t);for(let t=0;t<o.length;t++){const r=o[t];n&&n.equals(r)||(e.push(r),n=r)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++)t.curves.push(this.curves[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new Xc[n.type]).fromJSON(n))}return this}}class tu extends Qc{constructor(t){super(),this.type="Path",this.currentPoint=new Hn,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Zc(this.currentPoint.clone(),new Hn(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const i=new Yc(this.currentPoint.clone(),new Hn(t,e),new Hn(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,i,s){const o=new Wc(this.currentPoint.clone(),new Hn(t,e),new Hn(n,r),new Hn(i,s));return this.curves.push(o),this.currentPoint.set(i,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Kc(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,i,s){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,s),this}absarc(t,e,n,r,i,s){return this.absellipse(t,e,n,n,r,i,s),this}ellipse(t,e,n,r,i,s,o,a){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,s,o,a),this}absellipse(t,e,n,r,i,s,o,a){const l=new Nc(t,e,n,r,i,s,o,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class eu extends tu{constructor(t){super(t),this.uuid=jn(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++)this.holes.push(t.holes[e].clone());return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++)t.holes.push(this.holes[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new tu).fromJSON(n))}return this}}class nu extends ri{constructor(t,e=1){super(),this.type="Light",this.color=new Ci(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}nu.prototype.isLight=!0,class extends nu{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(ri.DefaultUp),this.updateMatrix(),this.groundColor=new Ci(e)}copy(t){return nu.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}.prototype.isHemisphereLight=!0;const ru=new Rr,iu=new er,su=new er;class ou{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Hn(512,512),this.map=null,this.mapPass=null,this.matrix=new Rr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new xs,this._frameExtents=new Hn(1,1),this._viewportCount=1,this._viewports=[new Kn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;iu.setFromMatrixPosition(t.matrixWorld),e.position.copy(iu),su.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(su),e.updateMatrixWorld(),ru.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ru),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class au extends ou{constructor(){super(new ms(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*Bn*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}au.prototype.isSpotLightShadow=!0,class extends nu{constructor(t,e,n=0,r=Math.PI/3,i=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(ri.DefaultUp),this.updateMatrix(),this.target=new ri,this.distance=n,this.angle=r,this.penumbra=i,this.decay=s,this.shadow=new au}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}.prototype.isSpotLight=!0;const lu=new Rr,cu=new er,uu=new er;class hu extends ou{constructor(){super(new ms(90,1,.5,500)),this._frameExtents=new Hn(4,2),this._viewportCount=6,this._viewports=[new Kn(2,1,1,1),new Kn(0,1,1,1),new Kn(3,1,1,1),new Kn(1,1,1,1),new Kn(3,0,1,1),new Kn(1,0,1,1)],this._cubeDirections=[new er(1,0,0),new er(-1,0,0),new er(0,0,1),new er(0,0,-1),new er(0,1,0),new er(0,-1,0)],this._cubeUps=[new er(0,1,0),new er(0,1,0),new er(0,1,0),new er(0,1,0),new er(0,0,1),new er(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,i=t.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),cu.setFromMatrixPosition(t.matrixWorld),n.position.copy(cu),uu.copy(n.position),uu.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(uu),n.updateMatrixWorld(),r.makeTranslation(-cu.x,-cu.y,-cu.z),lu.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lu)}}hu.prototype.isPointLightShadow=!0;class du extends nu{constructor(t,e,n=0,r=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new hu}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}du.prototype.isPointLight=!0;class fu extends ps{constructor(t=-1,e=1,n=1,r=-1,i=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,i,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,s=n+t,o=r+e,a=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,s=i+t*this.view.width,o-=e*this.view.offsetY,a=o-e*this.view.height}this.projectionMatrix.makeOrthographic(i,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}fu.prototype.isOrthographicCamera=!0;class pu extends ou{constructor(){super(new fu(-5,5,5,-5,.5,500))}}pu.prototype.isDirectionalLightShadow=!0;class mu extends nu{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(ri.DefaultUp),this.updateMatrix(),this.target=new ri,this.shadow=new pu}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}mu.prototype.isDirectionalLight=!0;class gu extends nu{constructor(t,e){super(t,e),this.type="AmbientLight"}}gu.prototype.isAmbientLight=!0,class extends nu{constructor(t,e,n=10,r=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=r}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}.prototype.isRectAreaLight=!0;class yu{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new er)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,i=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*r),e.addScaledVector(s[2],.488603*i),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*r*1.092548),e.addScaledVector(s[5],r*i*1.092548),e.addScaledVector(s[6],.315392*(3*i*i-1)),e.addScaledVector(s[7],n*i*1.092548),e.addScaledVector(s[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,i=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*r),e.addScaledVector(s[2],1.023328*i),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*r),e.addScaledVector(s[5],.858086*r*i),e.addScaledVector(s[6],.743125*i*i-.247708),e.addScaledVector(s[7],.858086*n*i),e.addScaledVector(s[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}yu.prototype.isSphericalHarmonics3=!0;class _u extends nu{constructor(t=new yu,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}let vu;_u.prototype.isLightProbe=!0,class extends $i{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}.prototype.isInstancedBufferGeometry=!0,class extends Di{constructor(t,e,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=r||1}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}.prototype.isInstancedBufferAttribute=!0,class extends Mc{constructor(t){super(t),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,s=Tc.get(t);if(void 0!==s)return i.manager.itemStart(t),setTimeout(function(){e&&e(s),i.manager.itemEnd(t)},0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(t,o).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(n){Tc.add(t,n),e&&e(n),i.manager.itemEnd(t)}).catch(function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}),i.manager.itemStart(t)}}.prototype.isImageBitmapLoader=!0;class bu extends Mc{constructor(t){super(t)}load(t,e,n,r){const i=this,s=new Pc(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(n){try{const t=n.slice(0);(void 0===vu&&(vu=new(window.AudioContext||window.webkitAudioContext)),vu).decodeAudioData(t,function(t){e(t)})}catch(s){r?r(s):console.error(s),i.manager.itemError(t)}},n,r)}}(class extends _u{constructor(t,e,n=1){super(void 0,n);const r=(new Ci).set(t),i=(new Ci).set(e),s=new er(r.r,r.g,r.b),o=new er(i.r,i.g,i.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,class extends _u{constructor(t,e=1){super(void 0,e);const n=(new Ci).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class wu{constructor(t,e,n){let r,i,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let s=this.cumulativeWeight;if(0===s){for(let t=0;t!==r;++t)n[i+t]=n[t];s=e}else s+=e,this._mixBufferRegion(n,i,0,e/s,r);this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1&&this._mixBufferRegion(n,r,e*this._origIndex,1-i,e),s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let a=e,l=e+e;a!==l;++a)if(n[a]!==n[a+e]){o.setValue(n,r);break}}saveOriginalState(){const t=this.buffer,e=this.valueSize,n=e*this._origIndex;this.binding.getValue(t,n);for(let r=e,i=n;r!==i;++r)t[r]=t[n+r%e];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,i){if(r>=.5)for(let s=0;s!==i;++s)t[e+s]=t[n+s]}_slerp(t,e,n,r){tr.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,i){const s=this._workIndex*i;tr.multiplyQuaternionsFlat(t,s,t,e,t,n),tr.slerpFlat(t,e,t,e,t,s,r)}_lerp(t,e,n,r,i){const s=1-r;for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]*s+t[n+o]*r}}_lerpAdditive(t,e,n,r,i){for(let s=0;s!==i;++s){const i=e+s;t[i]=t[i]+t[n+s]*r}}}const xu=new RegExp("[\\[\\]\\.:\\/]","g"),Su="[^\\[\\]\\.:\\/]",Eu="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Au=/((?:WC+[\/:])*)/.source.replace("WC",Su),Tu=/(WCOD+)?/.source.replace("WCOD",Eu),Cu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Su),Mu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Su),Ou=new RegExp("^"+Au+Tu+Cu+Mu+"$"),Pu=["material","materials","bones"];class Du{constructor(t,e,n){this.path=e,this.parsedPath=n||Du.parseTrackName(e),this.node=Du.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Du.Composite(t,e,n):new Du(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(xu,"")}static parseTrackName(t){const e=Ou.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==Pu.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const s=n(i.children);if(s)return s}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.node[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=Du.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}const s=t[r];if(void 0===s)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+r+" but it wasn't found.",t);let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Du.Composite=class{constructor(t,e,n){const r=n||Du.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Du.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Du.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Du.prototype.GetterByBindingType=[Du.prototype._getValue_direct,Du.prototype._getValue_array,Du.prototype._getValue_arrayElement,Du.prototype._getValue_toArray],Du.prototype.SetterByBindingTypeAndVersioning=[[Du.prototype._setValue_direct,Du.prototype._setValue_direct_setNeedsUpdate,Du.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Du.prototype._setValue_array,Du.prototype._setValue_array_setNeedsUpdate,Du.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Du.prototype._setValue_arrayElement,Du.prototype._setValue_arrayElement_setNeedsUpdate,Du.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Du.prototype._setValue_fromArray,Du.prototype._setValue_fromArray_setNeedsUpdate,Du.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Ru{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const i=e.tracks,s=i.length,o=new Array(s),a={endingStart:Tn,endingEnd:Tn};for(let l=0;l!==s;++l){const t=i[l].createInterpolant(null);o[l]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=n/r;t.warp(1,r/n,e),this.warp(i,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,i=r.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=i,a[1]=i+n,l[0]=t/s,l[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;if(r<0||0===n)return;this._startTime=null,e=n*r}e*=this._updateTimeScale(t);const s=this._updateTime(e),o=this._updateWeight(t);if(o>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case 2501:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(s),e[n].accumulateAdditive(o);break;case 2500:default:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(s),e[n].accumulate(r,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const s=2202===n;if(0===t)return-1===i?r:s&&1==(1&i)?e-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){const e=t<0;this._setEndings(e,!e,s)}else this._setEndings(!1,!1,s);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(s&&1==(1&i))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=Cn,r.endingEnd=Cn):(r.endingStart=t?this.zeroSlopeAtStart?Cn:Tn:Mn,r.endingEnd=e?this.zeroSlopeAtEnd?Cn:Tn:Mn)}_scheduleFading(t,e,n){const r=this._mixer,i=r.time;let s=this._weightInterpolant;null===s&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=i,a[0]=e,o[1]=i+t,a[1]=n,this}}(class extends Nn{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,s=t._propertyBindings,o=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let u=0;u!==i;++u){const t=r[u],i=t.name;let l=c[i];if(void 0!==l)s[u]=l;else{if(l=s[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,i));continue}l=new wu(Du.create(n,i,e&&e._propertyBindings[u].binding.parsedPath),t.ValueTypeName,t.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,i),s[u]=l}o[u].resultBuffer=l.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,i=this._actionsByClip;let s=i[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=s;else{const e=s.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),s.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,s=this._actionsByClip,o=s[i],a=o.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete s[i],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const t=e[n];0==--t.referenceCount&&this._removeInactiveBinding(t)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let s=r[e];void 0===s&&(s={},r[e]=s),s[n]=t,t._cacheIndex=i.length,i.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,s=this._bindingsByRootAndName,o=s[r],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[i],0===Object.keys(o).length&&delete s[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new pc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i}clipAction(t,e,n){const r=e||this._root,i=r.uuid;let s="string"==typeof t?Ec.findByName(r,t):t;const o=null!==s?s.uuid:t,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:2500),void 0!==a){const t=a.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new Ru(this,s,e,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}existingAction(t,e){const n=e||this._root,r=n.uuid,i="string"==typeof t?Ec.findByName(n,t):t,s=this._actionsByClip[i?i.uuid:t];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){const e=this._actions,n=this._nActiveActions,r=this.time+=t*=this.timeScale,i=Math.sign(t),s=this._accuIndex^=1;for(let l=0;l!==n;++l)e[l]._update(r,t,i,s);const o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,s=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,s._cacheIndex=i,e[i]=s,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const i in n){const t=n[i].actionByRoot[e];void 0!==t&&(this._deactivateAction(t),this._removeInactiveAction(t))}const r=this._bindingsByRootAndName[e];if(void 0!==r)for(const i in r){const t=r[i];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Lu{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new Lu(void 0===this.value.clone?this.value:this.value.clone())}}(class extends za{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n||1}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}).prototype.isInstancedInterleavedBuffer=!0;const Iu=new Hn;class Nu{constructor(t=new Hn(1/0,1/0),e=new Hn(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Iu.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Hn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Hn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Hn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Hn),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Iu.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}Nu.prototype.isBox2=!0,class extends ri{constructor(t){super(),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}.prototype.isImmediateRenderObject=!0;const ku=new er,Fu=new Rr,Bu=new Rr;function ju(t){const e=[];t&&t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,ju(t.children[n]));return e}const Uu=new Float32Array(1);new Int32Array(Uu.buffer),Math.pow(2,8);const Vu=new Mi({side:1,depthWrite:!1,depthTest:!1});new as(new cs,Vu),Math.sqrt(5),Ic.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Ic.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},tu.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},class extends Al{constructor(t=10,e=10,n=4473924,r=8947848){n=new Ci(n),r=new Ci(r);const i=e/2,s=t/e,o=t/2,a=[],l=[];for(let u=0,h=0,d=-o;u<=e;u++,d+=s){a.push(-o,0,d,o,0,d),a.push(d,0,-o,d,0,o);const t=u===i?n:r;t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3}const c=new $i;c.setAttribute("position",new Ii(a,3)),c.setAttribute("color",new Ii(l,3)),super(c,new gl({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends Al{constructor(t){const e=ju(t),n=new $i,r=[],i=[],s=new Ci(0,0,1),o=new Ci(0,1,0);for(let a=0;a<e.length;a++){const t=e[a];t.parent&&t.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(s.r,s.g,s.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new Ii(r,3)),n.setAttribute("color",new Ii(i,3)),super(n,new gl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");Bu.copy(this.root.matrixWorld).invert();for(let i=0,s=0;i<e.length;i++){const t=e[i];t.parent&&t.parent.isBone&&(Fu.multiplyMatrices(Bu,t.matrixWorld),ku.setFromMatrixPosition(Fu),r.setXYZ(s,ku.x,ku.y,ku.z),Fu.multiplyMatrices(Bu,t.parent.matrixWorld),ku.setFromMatrixPosition(Fu),r.setXYZ(s+1,ku.x,ku.y,ku.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Mc.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let r=0,i=t.length;r<i;r++)e+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}}.extractUrlBase(t)},Mc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Nu.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},Nu.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Nu.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Nu.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},ir.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ir.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ir.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},ir.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},ir.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},Sr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},xs.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Gn.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Gn.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Gn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Gn.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Gn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Gn.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Rr.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},Rr.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Rr.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new er).setFromMatrixColumn(this,3)},Rr.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},Rr.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Rr.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Rr.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Rr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Rr.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},Rr.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Rr.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Rr.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Rr.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Rr.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Rr.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Rr.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Rr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Rr.prototype.makeFrustum=function(t,e,n,r,i,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,s)},Rr.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},ai.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},tr.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},tr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Dr.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Dr.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},Dr.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},_i.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},_i.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},_i.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},_i.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},_i.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},_i.barycoordFromPoint=function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),_i.getBarycoord(t,e,n,r,i)},_i.normal=function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),_i.getNormal(t,e,n,r)},eu.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},eu.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new oc(this,t)},eu.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new lc(this,t)},Hn.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Hn.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Hn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},er.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},er.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},er.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},er.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},er.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},er.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},er.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},er.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},er.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Kn.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Kn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ri.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},ri.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},ri.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},ri.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},ri.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(ri.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),as.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(as.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),hl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},ms.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(nu.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Di.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ln},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ln)}}}),Di.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Ln:Rn),this},Di.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Di.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},$i.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},$i.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Di(arguments[1],arguments[2])))},$i.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},$i.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},$i.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},$i.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},$i.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties($i.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),za.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Ln:Rn),this},za.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},oc.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},oc.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},oc.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Va.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Lu.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(bi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ci}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(fs.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Ba.prototype.clearTarget=function(t,e,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,r)},Ba.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},Ba.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Ba.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Ba.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Ba.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Ba.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Ba.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Ba.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Ba.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Ba.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Ba.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Ba.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Ba.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Ba.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},Ba.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Ba.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Ba.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Ba.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Ba.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Ba.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Ba.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Ba.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Ba.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Ba.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Ba.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?Pn:On}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Ma.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Xn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),class extends ri{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new bu).load(t,function(t){e.setBuffer(t)}),this},ys.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},ys.prototype.clear=function(t,e,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,r)},qn.crossOrigin=void 0,qn.loadTexture=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new Lc;i.setCrossOrigin(this.crossOrigin);const s=i.load(t,n,void 0,r);return e&&(s.mapping=e),s},qn.loadTextureCube=function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new Rc;i.setCrossOrigin(this.crossOrigin);const s=i.load(t,n,void 0,r);return e&&(s.mapping=e),s},qn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},qn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"129"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="129");var zu="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",$u=class extends fs{constructor(t=new Hn){super({type:"ConvolutionMaterial",uniforms:{inputBuffer:new Lu(null),texelSize:new Lu(new Hn),halfTexelSize:new Lu(new Hn),kernel:new Lu(0),scale:new Lu(1)},fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <dithering_fragment>\n}",vertexShader:"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",blending:0,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(t.x,t.y),this.kernelSize=Gu.LARGE}getKernel(){return Hu[this.kernelSize]}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e),this.uniforms.halfTexelSize.value.set(t,e).multiplyScalar(.5)}},Hu=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Gu={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Wu=class extends fs{constructor(){super({type:"CopyMaterial",uniforms:{inputBuffer:new Lu(null),opacity:new Lu(1)},fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n}",vertexShader:zu,blending:0,depthWrite:!1,depthTest:!1}),this.toneMapped=!1}},qu=class extends fs{constructor(t=null,e=null,n=null,r,i=!1){super({type:"EffectMaterial",defines:{DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Lu(null),depthBuffer:new Lu(null),resolution:new Lu(new Hn),texelSize:new Lu(new Hn),cameraNear:new Lu(.3),cameraFar:new Lu(1e3),aspect:new Lu(1),time:new Lu(0)},blending:0,depthWrite:!1,depthTest:!1,dithering:i}),this.toneMapped=!1,null!==t&&this.setShaderParts(t),null!==e&&this.setDefines(e),null!==n&&this.setUniforms(n),this.adoptCameraSettings(r)}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setShaderParts(t){return this.fragmentShader="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}".replace(Zu.FRAGMENT_HEAD,t.get(Zu.FRAGMENT_HEAD)).replace(Zu.FRAGMENT_MAIN_UV,t.get(Zu.FRAGMENT_MAIN_UV)).replace(Zu.FRAGMENT_MAIN_IMAGE,t.get(Zu.FRAGMENT_MAIN_IMAGE)),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(Zu.VERTEX_HEAD,t.get(Zu.VERTEX_HEAD)).replace(Zu.VERTEX_MAIN_SUPPORT,t.get(Zu.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}adoptCameraSettings(t=null){null!==t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof ms?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const n=Math.max(t,1),r=Math.max(e,1);this.uniforms.resolution.value.set(n,r),this.uniforms.texelSize.value.set(1/n,1/r),this.uniforms.aspect.value=n/r}},Zu={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Yu=class extends fs{constructor(t=!1,e=null){const n=null!==e;super({type:"LuminanceMaterial",uniforms:{inputBuffer:new Lu(null),threshold:new Lu(0),smoothing:new Lu(1),range:new Lu(n?e:new Hn)},fragmentShader:"#include <common>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:zu,blending:0,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.colorOutput=t,this.useThreshold=!0,this.useRange=n}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.uniforms.threshold.value=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.uniforms.smoothing.value=t}get useThreshold(){return void 0!==this.defines.THRESHOLD}set useThreshold(t){t?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.needsUpdate=!0}get colorOutput(){return void 0!==this.defines.COLOR}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return void 0!==this.defines.RANGE}set useRange(t){t?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}get luminanceRange(){return this.useRange}set luminanceRange(t){this.useRange=t}setLuminanceRangeEnabled(t){this.useRange=t}},Ju=new ps,Ku=null,Xu=class{constructor(t="Pass",e=new Va,n=Ju){this.name=t,this.scene=e,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){const e=this.getFullscreenMaterial();null!==e&&(e.needsUpdate=!0),this.rtt=!t}}getFullscreenMaterial(){return null!==this.screen?this.screen.material:null}setFullscreenMaterial(t){let e=this.screen;null!==e?e.material=t:(e=new as(function(){if(null===Ku){const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);void 0!==(Ku=new $i).setAttribute?(Ku.setAttribute("position",new Di(t,3)),Ku.setAttribute("uv",new Di(e,2))):(Ku.addAttribute("position",new Di(t,3)),Ku.addAttribute("uv",new Di(e,2)))}return Ku}(),t),e.frustumCulled=!1,null===this.scene&&(this.scene=new Va),this.scene.add(e),this.screen=e)}getDepthTexture(){return null}setDepthTexture(t,e=0){}render(t,e,n,r,i){throw new Error("Render method not implemented!")}setSize(t,e){}initialize(t,e,n){}dispose(){const t=this.getFullscreenMaterial();null!==t&&t.dispose();for(const e of Object.keys(this)){const t=this[e];if(null!==t&&"function"==typeof t.dispose){if(t instanceof Va)continue;this[e].dispose()}}}},Qu=-1,th=class{constructor(t,e=-1,n=-1,r=1){this.resizable=t,this.base=new Hn(1,1),this.target=new Hn(e,n),this.s=r}get scale(){return this.s}set scale(t){this.s=t,this.target.x=Qu,this.target.y=Qu,this.resizable.setSize(this.base.x,this.base.y)}get width(){const t=this.base,e=this.target;let n;return n=e.x!==Qu?e.x:e.y!==Qu?Math.round(e.y*(t.x/t.y)):Math.round(t.x*this.s),n}set width(t){this.target.x=t,this.resizable.setSize(this.base.x,this.base.y)}get height(){const t=this.base,e=this.target;let n;return n=e.y!==Qu?e.y:e.x!==Qu?Math.round(e.x/(t.x/t.y)):Math.round(t.y*this.s),n}set height(t){this.target.y=t,this.resizable.setSize(this.base.x,this.base.y)}static get AUTO_SIZE(){return Qu}},eh=class extends Xu{constructor({resolutionScale:t=.5,width:e=th.AUTO_SIZE,height:n=th.AUTO_SIZE,kernelSize:r=Gu.LARGE}={}){super("BlurPass"),this.renderTargetA=new Xn(1,1,{minFilter:hn,magFilter:hn,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B",this.resolution=new th(this,e,n,t),this.convolutionMaterial=new $u,this.ditheredConvolutionMaterial=new $u,this.ditheredConvolutionMaterial.dithering=!0,this.dithering=!1,this.kernelSize=r}get width(){return this.resolution.width}set width(t){this.resolution.width=t}get height(){return this.resolution.height}set height(t){this.resolution.height=t}get scale(){return this.convolutionMaterial.uniforms.scale.value}set scale(t){this.convolutionMaterial.uniforms.scale.value=t,this.ditheredConvolutionMaterial.uniforms.scale.value=t}get kernelSize(){return this.convolutionMaterial.kernelSize}set kernelSize(t){this.convolutionMaterial.kernelSize=t,this.ditheredConvolutionMaterial.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,r,i){const s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB;let c=this.convolutionMaterial,u=c.uniforms;const h=c.getKernel();let d,f,p,m=e;for(this.setFullscreenMaterial(c),f=0,p=h.length-1;f<p;++f)d=0==(1&f)?a:l,u.kernel.value=h[f],u.inputBuffer.value=m.texture,t.setRenderTarget(d),t.render(s,o),m=d;this.dithering&&(c=this.ditheredConvolutionMaterial,u=c.uniforms,this.setFullscreenMaterial(c)),u.kernel.value=h[f],u.inputBuffer.value=m.texture,t.setRenderTarget(this.renderToScreen?null:n),t.render(s,o)}setSize(t,e){const n=this.resolution;n.base.set(t,e);const r=n.width,i=n.height;this.renderTargetA.setSize(r,i),this.renderTargetB.setSize(r,i),this.convolutionMaterial.setTexelSize(1/r,1/i),this.ditheredConvolutionMaterial.setTexelSize(1/r,1/i)}initialize(t,e,n){if(e||n!==fn||(this.renderTargetA.texture.format=vn,this.renderTargetB.texture.format=vn),void 0!==n&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==fn)){const t=this.ditheredConvolutionMaterial;this.convolutionMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",t.defines.FRAMEBUFFER_PRECISION_HIGH="1"}}static get AUTO_SIZE(){return th.AUTO_SIZE}},nh=class extends Xu{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,r,i){const s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},rh=new Ci,ih=class extends Xu{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}render(t,e,n,r,i){const s=this.overrideClearColor,o=this.overrideClearAlpha,a=t.getClearAlpha(),l=null!==s,c=o>=0;l?(rh.copy(t.getClearColor(rh)),t.setClearColor(s,c?o:a)):c&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),l?t.setClearColor(rh,a):c&&t.setClearAlpha(a)}},sh=!1,oh=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let e;if(t.material.flatShading)switch(t.material.side){case 2:e=this.materialsFlatShadedDoubleSide;break;case 1:e=this.materialsFlatShadedBackSide;break;default:e=this.materialsFlatShaded}else switch(t.material.side){case 2:e=this.materialsDoubleSide;break;case 1:e=this.materialsBackSide;break;default:e=this.materials}this.originalMaterials.set(t,t.material),t.material=t.isSkinnedMesh?e[2]:t.isInstancedMesh?e[1]:e[0],++this.meshCount}}}setMaterial(t){if(this.disposeMaterials(),this.material=t,null!==t){const e=this.materials=[t.clone(),t.clone(),t.clone()];for(const n of e)n.uniforms=Object.assign({},t.uniforms),n.side=0;e[2].skinning=!0,this.materialsBackSide=e.map(e=>{const n=e.clone();return n.uniforms=Object.assign({},t.uniforms),n.side=1,n}),this.materialsDoubleSide=e.map(e=>{const n=e.clone();return n.uniforms=Object.assign({},t.uniforms),n.side=2,n}),this.materialsFlatShaded=e.map(e=>{const n=e.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(e=>{const n=e.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n.side=1,n}),this.materialsFlatShadedDoubleSide=e.map(e=>{const n=e.clone();return n.uniforms=Object.assign({},t.uniforms),n.flatShading=!0,n.side=2,n})}}render(t,e,n){const r=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,sh){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(const t of r)t[0].material=t[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=r}t.shadowMap.enabled=r}disposeMaterials(){if(null!==this.material){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return sh}static set workaroundEnabled(t){sh=t}},ah=class extends Xu{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new ih,this.overrideMaterialManager=null===n?null:new oh(n)}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return null!==t?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;null!==t?null!==e?e.setMaterial(t):this.overrideMaterialManager=new oh(t):null!==e&&(e.dispose(),this.overrideMaterialManager=null)}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}render(t,e,n,r,i){const s=this.scene,o=this.camera,a=s.background,l=this.renderToScreen?null:e;this.clear&&(null!==this.clearPass.overrideClearColor&&(s.background=null),this.clearPass.render(t,e)),t.setRenderTarget(l),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(t,s,o):t.render(s,o),s.background!==a&&(s.background=a)}};new Float32Array([255/256/256**3,255/256/65536,255/256/256,255/256]);var lh=new Map([[0,null],[1,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[2,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[3,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[4,"float blend(const in float x,const in float y){return(y==0.0)? y : max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[5,"float blend(const in float x,const in float y){return(y==1.0)? y : min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[6,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[7,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[8,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[9,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[10,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[11,"float blend(const in float x,const in float y){return(y>0.0)? min(x/y,1.0): 1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[12,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[13,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[14,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[15,"float blend(const in float x,const in float y){return(y==1.0)? y : min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[16,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[17,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[18,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),ch=class extends Nn{constructor(t,e=1){super(),this.blendFunction=t,this.opacity=new Lu(e)}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t,this.dispatchEvent({type:"change"})}getShaderCode(){return lh.get(this.blendFunction)}},uh=class extends Nn{constructor(t,e,{attributes:n=hh.NONE,blendFunction:r=16,defines:i=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=t,this.attributes=n,this.fragmentShader=e,this.vertexShader=a,this.defines=i,this.uniforms=s,this.extensions=o,this.blendMode=new ch(r),this.blendMode.addEventListener("change",t=>this.setChanged())}setChanged(){this.dispatchEvent({type:"change"})}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setDepthTexture(t,e=0){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(const t of Object.keys(this)){const e=this[t];if(null!==e&&"function"==typeof e.dispose){if(e instanceof Va)continue;this[t].dispose()}}}},hh={NONE:0,DEPTH:1,CONVOLUTION:2};function dh(t,e){const n=[];let r;for(;null!==(r=t.exec(e));)n.push(r[1]);return n}function fh(t,e,n){let r,i;for(const s of e){r="$1"+t+s.charAt(0).toUpperCase()+s.slice(1),i=new RegExp("([^\\.])(\\b"+s+"\\b)","g");for(const t of n.entries())null!==t[1]&&n.set(t[0],t[1].replace(i,r))}}function ph(t,e,n,r,i,s,o){const a=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,l=/(?:varying\s+\w+\s+(\w*))/g,c=e.blendMode,u=new Map([["fragment",e.getFragmentShader()],["vertex",e.getVertexShader()]]),h=void 0!==u.get("fragment")&&/mainImage/.test(u.get("fragment")),d=void 0!==u.get("fragment")&&/mainUv/.test(u.get("fragment"));let f=[],p=[],m=!1,g=!1;if(void 0===u.get("fragment"))console.error("Missing fragment shader",e);else if(d&&0!=(o&hh.CONVOLUTION))console.error("Effects that transform UV coordinates are incompatible with convolution effects",e);else if(h||d){if(d&&(n.set(Zu.FRAGMENT_MAIN_UV,n.get(Zu.FRAGMENT_MAIN_UV)+"\t"+t+"MainUv(UV);\n"),m=!0),null!==u.get("vertex")&&/mainSupport/.test(u.get("vertex"))){let e="\t"+t+"MainSupport(";/mainSupport *\([\w\s]*?uv\s*?\)/.test(u.get("vertex"))&&(e+="vUv"),e+=");\n",n.set(Zu.VERTEX_MAIN_SUPPORT,n.get(Zu.VERTEX_MAIN_SUPPORT)+e),f=f.concat(dh(l,u.get("vertex"))),p=p.concat(f).concat(dh(a,u.get("vertex")))}if(p=p.concat(dh(a,u.get("fragment"))).concat(Array.from(e.defines.keys()).map(t=>t.replace(/\([\w\s,]*\)/g,""))).concat(Array.from(e.uniforms.keys())),e.uniforms.forEach((e,n)=>s.set(t+n.charAt(0).toUpperCase()+n.slice(1),e)),e.defines.forEach((e,n)=>i.set(t+n.charAt(0).toUpperCase()+n.slice(1),e)),fh(t,p,i),fh(t,p,u),r.set(c.blendFunction,c),h){const e=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;let r=t+"MainImage(color0, UV, ";0!=(o&hh.DEPTH)&&e.test(u.get("fragment"))&&(r+="depth, ",g=!0),r+="color1);\n\t";const i=t+"BlendOpacity";s.set(i,c.opacity),r+="color0 = blend"+c.getBlendFunction()+"(color0, color1, "+i+");\n\n\t",n.set(Zu.FRAGMENT_MAIN_IMAGE,n.get(Zu.FRAGMENT_MAIN_IMAGE)+r),n.set(Zu.FRAGMENT_HEAD,n.get(Zu.FRAGMENT_HEAD)+"uniform float "+i+";\n\n")}n.set(Zu.FRAGMENT_HEAD,n.get(Zu.FRAGMENT_HEAD)+u.get("fragment")+"\n"),null!==u.get("vertex")&&n.set(Zu.VERTEX_HEAD,n.get(Zu.VERTEX_HEAD)+u.get("vertex")+"\n")}else console.error("The fragment shader contains neither a mainImage nor a mainUv function",e);return{varyings:f,transformedUv:m,readDepth:g}}var mh=class extends Xu{constructor(t,...e){super("EffectPass"),this.setFullscreenMaterial(new qu(null,null,null,t)),this.effects=e.sort((t,e)=>e.attributes-t.attributes),this.skipRendering=!1,this.uniforms=0,this.varyings=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return void 0!==this.getFullscreenMaterial().defines.ENCODE_OUTPUT}set encodeOutput(t){if(this.encodeOutput!==t){const e=this.getFullscreenMaterial();e.needsUpdate=!0,t?e.defines.ENCODE_OUTPUT="1":delete e.defines.ENCODE_OUTPUT}}get dithering(){return this.getFullscreenMaterial().dithering}set dithering(t){const e=this.getFullscreenMaterial();e.dithering!==t&&(e.dithering=t,e.needsUpdate=!0)}verifyResources(t){const e=t.capabilities;let n=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniforms>n&&console.warn("The current rendering context doesn't support more than "+n+" uniforms, but "+this.uniforms+" were defined"),n=e.maxVaryings,this.varyings>n&&console.warn("The current rendering context doesn't support more than "+n+" varyings, but "+this.varyings+" were defined")}updateMaterial(){const t=/\bblend\b/g,e=new Map([[Zu.FRAGMENT_HEAD,""],[Zu.FRAGMENT_MAIN_UV,""],[Zu.FRAGMENT_MAIN_IMAGE,""],[Zu.VERTEX_HEAD,""],[Zu.VERTEX_MAIN_SUPPORT,""]]),n=new Map,r=new Map,i=new Map,s=new Set;let o,a=0,l=0,c=0,u=!1,h=!1;for(const f of this.effects)if(0===f.blendMode.getBlendFunction())c|=f.getAttributes()&hh.DEPTH;else if(0!=(c&hh.CONVOLUTION)&&0!=(f.getAttributes()&hh.CONVOLUTION))console.error("Convolution effects cannot be merged",f);else if(c|=f.getAttributes(),o=ph("e"+a++,f,e,n,r,i,c),l+=o.varyings.length,u=u||o.transformedUv,h=h||o.readDepth,null!==f.extensions)for(const t of f.extensions)s.add(t);for(const f of n.values())e.set(Zu.FRAGMENT_HEAD,e.get(Zu.FRAGMENT_HEAD)+f.getShaderCode().replace(t,"blend"+f.getBlendFunction())+"\n");0!=(c&hh.DEPTH)?(h&&e.set(Zu.FRAGMENT_MAIN_IMAGE,"float depth = readDepth(UV);\n\n\t"+e.get(Zu.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=null===this.getDepthTexture()):this.needsDepthTexture=!1,u?(e.set(Zu.FRAGMENT_MAIN_UV,"vec2 transformedUv = vUv;\n"+e.get(Zu.FRAGMENT_MAIN_UV)),r.set("UV","transformedUv")):r.set("UV","vUv"),e.forEach((t,e,n)=>n.set(e,t.trim().replace(/^#/,"\n#"))),this.uniforms=i.size,this.varyings=l,this.skipRendering=0===a,this.needsSwap=!this.skipRendering;const d=this.getFullscreenMaterial();if(d.setShaderParts(e).setDefines(r).setUniforms(i),d.extensions={},s.size>0)for(const f of s)d.extensions[f]=!0;this.needsUpdate=!1}recompile(t){this.updateMaterial(),void 0!==t&&this.verifyResources(t)}getDepthTexture(){return this.getFullscreenMaterial().uniforms.depthBuffer.value}setDepthTexture(t,e=3200){const n=this.getFullscreenMaterial();n.uniforms.depthBuffer.value=t,n.depthPacking=e,n.needsUpdate=!0;for(const r of this.effects)r.setDepthTexture(t,e)}render(t,e,n,r,i){const s=this.getFullscreenMaterial(),o=s.uniforms.time.value+r;this.needsUpdate&&this.recompile(t);for(const a of this.effects)a.update(t,e,r);this.skipRendering&&!this.renderToScreen||(s.uniforms.inputBuffer.value=e.texture,s.uniforms.time.value=o<=this.maxTime?o:this.minTime,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera))}setSize(t,e){this.getFullscreenMaterial().setSize(t,e);for(const n of this.effects)n.setSize(t,e)}initialize(t,e,n){for(const r of this.effects)r.initialize(t,e,n),r.addEventListener("change",t=>this.handleEvent(t));this.updateMaterial(),this.verifyResources(t),void 0!==n&&n!==fn&&(this.getFullscreenMaterial().defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.dispose()}handleEvent(t){switch(t.type){case"change":this.needsUpdate=!0}}},gh=class extends Xu{constructor({width:t=th.AUTO_SIZE,height:e=th.AUTO_SIZE,renderTarget:n,luminanceRange:r,colorOutput:i}={}){super("LuminancePass"),this.setFullscreenMaterial(new Yu(i,r)),this.needsSwap=!1,this.renderTarget=n,void 0===this.renderTarget&&(this.renderTarget=new Xn(1,1,{minFilter:hn,magFilter:hn,format:i?bn:1024,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1),this.resolution=new th(this,t,e)}get texture(){return this.renderTarget.texture}render(t,e,n,r,i){this.getFullscreenMaterial().uniforms.inputBuffer.value=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.base.set(t,e),this.renderTarget.setSize(n.width,n.height)}initialize(t,e,n){void 0!==n&&n!==fn&&(this.getFullscreenMaterial().defines.FRAMEBUFFER_PRECISION_HIGH="1")}},yh=class extends Xu{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new ih(!1,!1,!0),this.inverse=!1}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}render(t,e,n,r,i){const s=t.getContext(),o=t.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,u=this.inverse?0:1,h=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,u,4294967295),o.stencil.setClear(h),o.stencil.setLocked(!0),this.clear&&(this.renderToScreen?c.render(t,null):(c.render(t,e),c.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(a,l)):(t.setRenderTarget(e),t.render(a,l),t.setRenderTarget(n),t.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},_h=class extends Xu{constructor(t,e="inputBuffer"){super("ShaderPass"),this.setFullscreenMaterial(t),this.uniform=null,this.setInput(e)}setInput(t){const e=this.getFullscreenMaterial();if(this.uniform=null,null!==e){const n=e.uniforms;void 0!==n&&void 0!==n[t]&&(this.uniform=n[t])}}render(t,e,n,r,i){null!==this.uniform&&null!==e&&(this.uniform.value=e.texture),t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}initialize(t,e,n){void 0!==n&&n!==fn&&(this.getFullscreenMaterial().defines.FRAMEBUFFER_PRECISION_HIGH="1")}},vh=(Set,class extends uh{constructor({blendFunction:t=16,luminanceThreshold:e=.9,luminanceSmoothing:n=.025,resolutionScale:r=.5,intensity:i=1,width:s=th.AUTO_SIZE,height:o=th.AUTO_SIZE,kernelSize:a=Gu.LARGE}={}){super("BloomEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}",{blendFunction:t,uniforms:new Map([["map",new Lu(null)],["intensity",new Lu(i)]])}),this.renderTarget=new Xn(1,1,{minFilter:hn,magFilter:hn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.blurPass=new eh({resolutionScale:r,width:s,height:o,kernelSize:a}),this.blurPass.resolution.resizable=this,this.luminancePass=new gh({renderTarget:this.renderTarget,colorOutput:!0}),this.luminancePass.resolution=this.resolution,this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=n}get texture(){return this.renderTarget.texture}get luminanceMaterial(){return this.luminancePass.getFullscreenMaterial()}get resolution(){return this.blurPass.resolution}get width(){return this.resolution.width}set width(t){this.resolution.width=t}get height(){return this.resolution.height}set height(t){this.resolution.height=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead."),1}set distinction(t){console.warn(this.name,"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,n){const r=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(t,e,r),this.blurPass.render(t,r,r)):this.blurPass.render(t,e,r)}setSize(t,e){this.blurPass.setSize(t,e),this.renderTarget.setSize(this.resolution.width,this.resolution.height)}initialize(t,e,n){this.blurPass.initialize(t,e,n),e||n!==fn||(this.renderTarget.texture.format=vn),void 0!==n&&(this.renderTarget.texture.type=n)}});new er,new Rr,new Ci,Math,new er,new er;var bh="#ifdef ASPECT_CORRECTION\nuniform float scale;\n#else\nuniform mat3 uvTransform;\n#endif\nvarying vec2 vUv2;void mainSupport(const in vec2 uv){\n#ifdef ASPECT_CORRECTION\nvUv2=uv*vec2(aspect,1.0)*scale;\n#else\nvUv2=(uvTransform*vec3(uv,1.0)).xy;\n#endif\n}",wh=class extends uh{constructor({blendFunction:t=13,texture:e=null,aspectCorrection:n=!1}={}){super("TextureEffect","#ifdef TEXTURE_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\n#if defined(ASPECT_CORRECTION) || defined(UV_TRANSFORM)\nvarying vec2 vUv2;\n#endif\nvoid mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){\n#if defined(ASPECT_CORRECTION) || defined(UV_TRANSFORM)\nvec4 texel=texelToLinear(texture2D(map,vUv2));\n#else\nvec4 texel=texelToLinear(texture2D(map,uv));\n#endif\noutputColor=TEXEL;}",{blendFunction:t,defines:new Map([["TEXEL","texel"]]),uniforms:new Map([["map",new Lu(null)],["scale",new Lu(1)],["uvTransform",new Lu(null)]])}),this.texture=e,this.aspectCorrection=n}get texture(){return this.uniforms.get("map").value}set texture(t){const e=this.texture;if(e!==t&&(this.uniforms.get("map").value=t,this.defines.delete("TEXTURE_PRECISION_HIGH"),null!==t)){switch(t.encoding){case Pn:this.defines.set("texelToLinear(texel)","sRGBToLinear(texel)");break;case On:this.defines.set("texelToLinear(texel)","texel");break;default:console.error("Unsupported encoding:",t.encoding)}t.type!==fn&&this.defines.set("TEXTURE_PRECISION_HIGH","1"),null!==e&&e.type===t.type&&e.encoding===t.encoding||this.setChanged()}}get aspectCorrection(){return this.defines.has("ASPECT_CORRECTION")}set aspectCorrection(t){this.aspectCorrection!==t&&(t?(this.uvTransform&&(this.uvTransform=!1),this.defines.set("ASPECT_CORRECTION","1"),this.setVertexShader(bh)):(this.defines.delete("ASPECT_CORRECTION"),this.setVertexShader(null)),this.setChanged())}get uvTransform(){return this.defines.has("UV_TRANSFORM")}set uvTransform(t){this.uvTransform!==t&&(t?(this.aspectCorrection&&(this.aspectCorrection=!1),this.defines.set("UV_TRANSFORM","1"),this.uniforms.get("uvTransform").value=new Gn,this.setVertexShader(bh)):(this.defines.delete("UV_TRANSFORM"),this.uniforms.get("uvTransform").value=null,this.setVertexShader(null)),this.setChanged())}setTextureSwizzleRGBA(t,e=t,n=t,r=t){const i="rgba";let s="";0===t&&1===e&&2===n&&3===r||(s=[".",i[t],i[e],i[n],i[r]].join("")),this.defines.set("TEXEL","texel"+s),this.setChanged()}update(t,e,n){const r=this.uniforms.get("map").value;this.uvTransform&&r.matrixAutoUpdate&&(r.updateMatrix(),this.uniforms.get("uvTransform").value.copy(r.matrix))}};function xh(t,e,n){return t+(e-t)*n}function Sh(t,e,n,r){const i=xh(t,e,.75),s=xh(n,r,.75);return xh(i,s,.875)}new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array(2),new Float32Array(2),new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125]),new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4]),new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3]),new Map([[Sh(0,0,0,0),new Float32Array([0,0,0,0])],[Sh(0,0,0,1),new Float32Array([0,0,0,1])],[Sh(0,0,1,0),new Float32Array([0,0,1,0])],[Sh(0,0,1,1),new Float32Array([0,0,1,1])],[Sh(0,1,0,0),new Float32Array([0,1,0,0])],[Sh(0,1,0,1),new Float32Array([0,1,0,1])],[Sh(0,1,1,0),new Float32Array([0,1,1,0])],[Sh(0,1,1,1),new Float32Array([0,1,1,1])],[Sh(1,0,0,0),new Float32Array([1,0,0,0])],[Sh(1,0,0,1),new Float32Array([1,0,0,1])],[Sh(1,0,1,0),new Float32Array([1,0,1,0])],[Sh(1,0,1,1),new Float32Array([1,0,1,1])],[Sh(1,1,0,0),new Float32Array([1,1,0,0])],[Sh(1,1,0,1),new Float32Array([1,1,0,1])],[Sh(1,1,1,0),new Float32Array([1,1,1,0])],[Sh(1,1,1,1),new Float32Array([1,1,1,1])]]);let Eh=(()=>{class t{constructor(t){this.elRef=t,this.canvasElement=null,this.insertionElementSelector="#nebula",this.smokeImagePath="assets/replay-viewer/smoke.png",this.starsPath="assets/replay-viewer/stars.jpg",this.colorPrimary1=2642811,this.colorPrimary1Fogged=676559701,this.colorPrimary1Light=10066329,this.colorPrimary2=9094864,this.colorPrimary3=16044642,this.colorPrimary4=16510636,this.colorRed=8074280,this.colorRedLight=16749716,this.colorGreen=5471016,this.colorGreenLight=9028937,this.bestVisual={powerPreference:"default",antialias:!0,stencil:!0,depth:!0},this.bestPerformance={powerPreference:"high-performance",antialias:!1,stencil:!1,depth:!1},this.renderer=new Ba(this.bestPerformance),this.loader=new Lc,this.scene=new Va,this.composer=new class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:n=!1,alpha:r=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=t,this.inputBuffer=null,this.outputBuffer=null,null!==this.renderer&&(this.renderer.autoClear=!1,this.inputBuffer=this.createBuffer(e,n,s,i),this.outputBuffer=this.inputBuffer.clone()),this.copyPass=new _h(new Wu),this.alpha=r,this.depthTexture=null,this.passes=[],this.autoRenderToScreen=!0}get multisampling(){return this.inputBuffer instanceof Qn?this.inputBuffer.samples:0}set multisampling(t){const e=this.inputBuffer,n=this.multisampling;n>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t):n!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getRenderer(){return this.renderer}replaceRenderer(t,e=!0){const n=this.renderer;if(null!==n&&n!==t){const r=n.getSize(new Hn),i=t.getSize(new Hn),s=n.domElement.parentNode;this.renderer=t,this.renderer.autoClear=!1,r.equals(i)||this.setSize(),e&&null!==s&&(s.removeChild(n.domElement),s.appendChild(t.domElement))}return n}createDepthTexture(){const t=this.depthTexture=new Rl;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=xn,t.type=_n):t.type=mn,t}deleteDepthTexture(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,n,r){const i=this.renderer,s=i.getContext(),o=i.getDrawingBufferSize(new Hn),a={format:this.alpha||s.getContextAttributes().alpha||n!==fn?bn:vn,minFilter:hn,magFilter:hn,stencilBuffer:e,depthBuffer:t,type:n},l=r>0?new Qn(o.width,o.height,a):new Xn(o.width,o.height,a);return r>0&&(l.samples=r),l.texture.name="EffectComposer.Buffer",l.texture.generateMipmaps=!1,l}addPass(t,e){const n=this.passes,r=this.renderer,i=r.getDrawingBufferSize(new Hn),s=r.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(t.setSize(i.width,i.height),t.initialize(r,s,o),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==e?n.splice(e,0,t):n.push(t),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),t.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){const e=this.createDepthTexture();for(t of n)t.setDepthTexture(e)}else t.setDepthTexture(this.depthTexture)}removePass(t){const e=this.passes,n=e.indexOf(t);-1!==n&&e.splice(n,1).length>0&&(null!==this.depthTexture&&(e.reduce((t,e)=>t||e.needsDepthTexture,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())),this.autoRenderToScreen&&n===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0)))}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const e=this.renderer,n=this.copyPass;let r,i,s,o=this.inputBuffer,a=this.outputBuffer,l=!1;for(const c of this.passes)c.enabled&&(c.render(e,o,a,t,l),c.needsSwap&&(l&&(n.renderToScreen=c.renderToScreen,r=e.getContext(),i=e.state.buffers.stencil,i.setFunc(r.NOTEQUAL,1,4294967295),n.render(e,o,a,t,l),i.setFunc(r.EQUAL,1,4294967295)),s=o,o=a,a=s),c instanceof yh?l=!0:c instanceof nh&&(l=!1))}setSize(t,e,n){const r=this.renderer;if(void 0===t||void 0===e){const n=r.getSize(new Hn);t=n.width,e=n.height}else r.setSize(t,e,n);const i=r.getDrawingBufferSize(new Hn);this.inputBuffer.setSize(i.width,i.height),this.outputBuffer.setSize(i.width,i.height);for(const s of this.passes)s.setSize(i.width,i.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose()}}(this.renderer),this.camera=new ms(60,window.innerWidth/window.innerHeight,.1,1e4),this.cameraZPositionStart=1,this.cameraXRotationStart=1.16,this.cameraYRotationStart=-.12,this.cameraZRotationStart=.27,this.cloudOpacityMin=.25,this.cloudOpacityMax=.5,this.cloudParticlesMin=50,this.cloudParticlesMax=150,this.cloudWidthMin=400,this.cloudWidthMax=600,this.cloudZRotationAmountMin=33e-5,this.cloudZRotationAmountMax=9e-4,this.fogDensityMin=5e-4,this.fogDensityMax=.001,this.cloudXRotationStart=1.16,this.cloudYRotationStart=-.12,this.cloudZRotationStart=2*Math.random()*Math.PI,this.blendFunctionOptions={skip:0,add:1,alpha:2,average:3,burn:4,dodge:5,darken:6,difference:7,exclusion:8,lighten:9,multiply:10,divide:11,negation:12,normal:13,overlay:14,reflect:15,screen:16,soft_light:17,subtract:18},this.blendFunctionsToUse=[this.blendFunctionOptions.alpha,this.blendFunctionOptions.difference,this.blendFunctionOptions.overlay,this.blendFunctionOptions.overlay,this.blendFunctionOptions.overlay,this.blendFunctionOptions.reflect,this.blendFunctionOptions.reflect,this.blendFunctionOptions.reflect,this.blendFunctionOptions.reflect,this.blendFunctionOptions.reflect,this.blendFunctionOptions.reflect,this.blendFunctionOptions.reflect,this.blendFunctionOptions.screen,this.blendFunctionOptions.screen,this.blendFunctionOptions.screen,this.blendFunctionOptions.soft_light,this.blendFunctionOptions.soft_light,this.blendFunctionOptions.soft_light,this.blendFunctionOptions.soft_light,this.blendFunctionOptions.soft_light],this.luminanceThreshold=.33,this.luminanceSmoothing=.33,this.bloomEffectBlendModeOpacityValue=.7,this.textureEffectBlendModeOpacityValue=.2,this.optionToUse=Math.floor(Math.random()*this.blendFunctionsToUse.length),this.blendFunction=this.blendFunctionsToUse[this.optionToUse],this.fogColor=218190,this.ambientLightColor=this.colorPrimary1,this.directionalLightColor=this.colorPrimary2,this.orangeLightColor=this.colorRedLight,this.redLightColor=this.colorRed,this.blueLightColor=this.colorPrimary2,this.orangeLightIntensity=60,this.orangeLightDistance=450,this.orangeLightDecay=1.7,this.redLightIntensity=60,this.redLightDistance=450,this.redLightDecay=1.7,this.blueLightIntensity=60,this.blueLightDistance=450,this.blueLightDecay=1.7,this.orangeLightXPosition=200,this.orangeLightYPosition=300,this.orangeLightZPosition=100,this.redLightXPosition=100,this.redLightYPosition=300,this.redLightZPosition=100,this.blueLightXPosition=300,this.blueLightYPosition=300,this.blueLightZPosition=200,this.ambient=new gu(this.ambientLightColor),this.directionalLight=new mu(this.directionalLightColor),this.orangeLight=new du(this.orangeLightColor,this.orangeLightIntensity,this.orangeLightDistance,this.orangeLightDecay),this.redLight=new du(this.redLightColor,this.redLightIntensity,this.redLightDistance,this.redLightDecay),this.blueLight=new du(this.blueLightColor,this.blueLightIntensity,this.blueLightDistance,this.blueLightDecay),this.cloudZRotationAmount=this.cloudZRotationAmountMin+Math.random()*(this.cloudZRotationAmountMax-this.cloudZRotationAmountMin),this.fogDensity=this.fogDensityMin+Math.random()*(this.fogDensityMax-this.fogDensityMin),this.cloudOpacity=this.cloudOpacityMin+Math.random()*(this.cloudOpacityMax-this.cloudOpacityMin),this.cloudWidth=this.cloudWidthMin+Math.random()*(this.cloudWidthMax-this.cloudWidthMin),this.cloudHeight=this.cloudWidth,this.numberOfCloudParticles=this.cloudParticlesMin+Math.random()*(this.cloudParticlesMax-this.cloudParticlesMin),this.cloudParticles=[]}ngOnInit(){window.addEventListener("resize",this.onResize.bind(this)),this.addCanvasToDom(),this.addEverythingToScene(),this.setCamera(),this.setLights(),this.setRenderer(),this.loadCloudParticles(),this.loadStarsAndThenStart()}addCanvasToDom(){var t;this.canvasElement=null===(t=this.elRef.nativeElement.querySelector(this.insertionElementSelector))||void 0===t?void 0:t.appendChild(this.renderer.domElement)}addEverythingToScene(){this.scene.add(this.ambient),this.scene.add(this.directionalLight),this.scene.add(this.orangeLight),this.scene.add(this.redLight),this.scene.add(this.blueLight)}animateClouds(){this.cloudParticles.forEach(t=>{t.rotation.z-=this.cloudZRotationAmount})}loadCloudParticles(){this.loader.load(this.smokeImagePath,t=>{const e=new As(this.cloudWidth,this.cloudHeight),n=new uc({map:t,transparent:!0,color:this.colorPrimary4});for(let r=0;r<this.numberOfCloudParticles;r++){const t=new as(e,n);t.position.set(800*Math.random()-400,500,500*Math.random()-500),t.rotation.x=this.cloudXRotationStart,t.rotation.y=this.cloudYRotationStart,t.rotation.z=this.cloudZRotationStart,t.material.opacity=this.cloudOpacity,this.scene.add(t),this.cloudParticles.push(t)}})}loadStarsAndThenStart(){this.loader.load(this.starsPath,t=>{const e=new wh({blendFunction:5,texture:t});e.blendMode.opacity.value=this.textureEffectBlendModeOpacityValue;const n=new vh({blendFunction:this.blendFunction,kernelSize:Gu.SMALL,useLuminanceFilter:!0,luminanceThreshold:this.luminanceThreshold,luminanceSmoothing:this.luminanceSmoothing});n.blendMode.opacity.value=this.bloomEffectBlendModeOpacityValue;const r=new mh(this.camera,n,e);r.renderToScreen=!0,this.composer.addPass(new ah(this.scene,this.camera)),this.composer.addPass(r),this.startAnimation()})}onResize(){return this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight),null}setCamera(){this.camera.position.z=this.cameraZPositionStart,this.camera.rotation.x=this.cameraXRotationStart,this.camera.rotation.y=this.cameraYRotationStart,this.camera.rotation.z=this.cameraZRotationStart}setLights(){this.directionalLight.position.set(0,0,1),this.orangeLight.position.set(this.orangeLightXPosition,this.orangeLightYPosition,this.orangeLightZPosition),this.redLight.position.set(this.redLightXPosition,this.redLightYPosition,this.redLightZPosition),this.blueLight.position.set(this.blueLightXPosition,this.blueLightYPosition,this.blueLightZPosition)}setRenderer(){var t,e;this.scene.fog=new ja(this.fogColor,this.fogDensity),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(null===(e=null===(t=this.scene)||void 0===t?void 0:t.fog)||void 0===e?void 0:e.color),this.renderer.render(this.scene,this.camera)}startAnimation(){const t=()=>{requestAnimationFrame(t),this.animateClouds(),this.composer.render(.1)};t()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.SBq))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-nebula"]],decls:1,vars:0,consts:[["id","nebula"]],template:function(t,e){1&t&&o._UZ(0,"div",0)},styles:["#nebula[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-1}"]}),t})(),Ah=(()=>{class t{constructor(t,e,n,r){this.searchService=t,this.store=e,this.router=n,this.route=r}ngOnInit(){this.subscribeToUsers()}subscribeToUsers(){this.store.select(h.zW.users).subscribe(t=>{var e;(null===(e=null==t?void 0:t.currentlyViewingUser)||void 0===e?void 0:e.games)&&t.currentlyViewingUser.games.length>0&&this.searchService.shouldNavigateToGames&&(this.router.navigate([s.rF,"games"]),this.searchService.shouldNavigateToGames=!1)})}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(y),o.Y36(l.yh),o.Y36(i.F0),o.Y36(i.gz))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-landing-page"]],decls:5,vars:2,consts:[[1,"login-card"],[1,"logo"],[3,"titleMsg","isLandingPage"]],template:function(t,e){1&t&&(o.TgZ(0,"nx-bridge-grid"),o.TgZ(1,"section",0),o._UZ(2,"div",1),o._UZ(3,"nx-bridge-search",2),o.qZA(),o.qZA(),o._UZ(4,"nx-bridge-nebula")),2&t&&(o.xp6(3),o.Q6J("titleMsg","A#Maj Bridge Replay Viewer")("isLandingPage",!0))},directives:[v,sn,Eh],styles:[""]}),t})(),Th=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez]]}),t})();getComputedStyle(document.documentElement);const Ch={[h.D0.small]:{summaryHeightPercent:"100%",gameDetailHeight:{aboveBreakpoint:"3.2rem",belowBreakpoint:"3.2rem"},playerLabelsDisplayType:"flex",playerNamesDisplayType:"grid",dealsListButtonFontSize:"1.6rem"},[h.D0.medium]:{summaryHeightPercent:"50%",gameDetailHeight:{aboveBreakpoint:Math.round(580.0000000000001)/100+"rem",belowBreakpoint:"5.800000000000001rem"},playerLabelsDisplayType:"none",playerNamesDisplayType:"none",dealsListButtonFontSize:"3.2rem"},[h.D0.large]:{summaryHeightPercent:"80%",gameDetailHeight:{aboveBreakpoint:Math.round(1120)/100+"rem",belowBreakpoint:"12rem"},playerLabelsDisplayType:"flex",playerNamesDisplayType:"grid",dealsListButtonFontSize:"3.2rem"}};let Mh=(()=>{class t{constructor(t){this.store=t}ngOnInit(){}changeGameSize(t){t&&(document.documentElement.style.setProperty(s.mL,Ch[t].gameDetailHeight.aboveBreakpoint),document.documentElement.style.setProperty(s.Ph,Ch[t].gameDetailHeight.belowBreakpoint),document.documentElement.style.setProperty(s.vk,Ch[t].summaryHeightPercent),document.documentElement.style.setProperty(s.Jd,Ch[t].playerLabelsDisplayType),document.documentElement.style.setProperty(s.RW,Ch[t].playerNamesDisplayType),document.documentElement.style.setProperty(s.hW,Ch[t].dealsListButtonFontSize))}selectCurrentPage(t,e){setTimeout(()=>{const n=null==e?void 0:e.nativeElement,r=null==n?void 0:n.children[t];r&&(r.selected=!0)},50)}setDefaultResultsPerPage(t){const e=null==t?void 0:t.nativeElement,n=e.children[e.children.length-1];n&&(n.selected=!0)}setSortPreference(t){this.store.dispatch(new u.tC(t))}setResultsPerPagePreference(t){this.store.dispatch(new u.SB(t))}showSearchHideButton(t){const e=(null==t?void 0:t.nativeElement).querySelector(`.${s.M1}__hide`);null==e||e.classList.remove(s.ze)}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(l.yh))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Oh=n(8036);let Ph=(()=>{class t{constructor(t){this.store=t,this.firstCardPlayed=-1,this.firstCardPlayer="",this.seating=null,this.keepCardsCentered=!1,this.deal=null,this.cardsPlayed=[],this.playCount=0,this.scope=null,this.project=null,this.cards=[],this.cardPlayerOrder=null,this.handsToRender=null,this.SCALE_AMOUNT_THRESHOLD_VIEW_PORT_WIDTH=1350,this.cardWidth=-1,this.cardHeight=-1,this.cardVisibleOffset=-1,this.cardSpacingIncrement=-1,this.canvasHeight=-1,this.canvasWidth=-1,this.cardsLoaded=0,this.DEFAULT_CARD_POSITION=-1e3,this.CARD_MOBILE_PIXEL_WIDTH=233,this.CARD_FULL_PIXEL_WIDTH=360,this.MAX_SCALE_AMOUNT_BELOW_THRESHOLD=.7,this.MAX_SCALE_AMOUNT_ABOVE_THRESHOLD=.75,this.MIN_SCALE_AMOUNT_MOBILE=.7,this.MIN_SCALE_AMOUNT_NORMAL=.5,this.MIN_TARGET_VIEW_PORT_WIDTH=600,this.MAX_TARGET_VIEW_PORT_WIDTH=1800,this.SMALL_VIEWPORT_THRESHOLD=400,this.LARGE_VIEWPORT_THRESHOLD=this.SCALE_AMOUNT_THRESHOLD_VIEW_PORT_WIDTH,this.SMALL_VIEWPORT_OFFSET=-1,this.LARGE_VIEWPORT_OFFSET=-1,this.isMobile=window.innerWidth<=s.jH,this.cardScaleAmount=this.isMobile?this.MIN_SCALE_AMOUNT_MOBILE:window.innerWidth<this.SCALE_AMOUNT_THRESHOLD_VIEW_PORT_WIDTH?(0,s.Tc)(window.innerWidth,s.jH,this.SCALE_AMOUNT_THRESHOLD_VIEW_PORT_WIDTH,this.MIN_SCALE_AMOUNT_NORMAL,this.MAX_SCALE_AMOUNT_BELOW_THRESHOLD):(0,s.Tc)(window.innerWidth,this.MIN_TARGET_VIEW_PORT_WIDTH,this.MAX_TARGET_VIEW_PORT_WIDTH,this.MIN_SCALE_AMOUNT_NORMAL,this.MAX_SCALE_AMOUNT_ABOVE_THRESHOLD)}getCorrectlyArrangedHand(t,e){return e===s.tv[0]||e===s.tv[1]?t.reverse():t}getHandWithTrumpOnLeft(t){let e="";if(this.store.select(h.zW.deals).pipe((0,f.q)(1)).subscribe(t=>{e=t.currentlyViewingDeal.contract}),!e)return t;const n=[...s.UE.map(t=>t.substr(0,t.length-1).toLowerCase()),"no trump"].findIndex(t=>{const n=new RegExp(t,"i");return null==e?void 0:e.match(n)}),r=[...t[0]],i=[...t[1]],o=[...t[2]],a=[...t[3]];return 0===n?i&&0!==i.length?[o,i,r,a]:[o,a,r,i]:1===n?r&&0!==r.length?[a,r,i,o]:[a,o,i,r]:2===n?r&&0!==r.length?[i,r,a,o]:[i,o,a,r]:3===n?i&&0!==i.length?t:[r,a,o,i]:4===n?i&&0!==i.length?r&&0!==r.length?a&&0!==a.length?o&&0!==o.length?t:[i,r,a,o]:[r,i,o,a]:[a,o,i,r]:[r,a,o,i]:t}getStartingPosition(t,e){const n=this.cardWidth+12*this.cardSpacingIncrement;let r=this.canvasWidth,i=0;e!==s.tv[1]&&e!==s.tv[3]||(r=this.canvasHeight,i=2*this.cardVisibleOffset);const o=2*this.cardVisibleOffset+t*this.cardSpacingIncrement,a=i+n,l=(s.WT-t)*this.cardSpacingIncrement;if(this.keepCardsCentered){if(e===s.tv[0])return this.cardVisibleOffset+(r-o)/2-(this.cardWidth-this.cardSpacingIncrement);if(e===s.tv[1])return this.cardVisibleOffset+(r-o)/2-(this.cardWidth-this.cardSpacingIncrement);if(e===s.tv[2])return this.cardVisibleOffset+(r-o)/2;if(e===s.tv[3])return this.cardVisibleOffset+(r-o)/2}else{if(e===s.tv[0])return this.cardVisibleOffset+(r-a)/2-(this.cardWidth-this.cardSpacingIncrement)+l;if(e===s.tv[1])return 2*this.cardVisibleOffset+(r-a)/2-(this.cardWidth-this.cardSpacingIncrement)+l;if(e===s.tv[2])return this.cardVisibleOffset+(r-n)/2;if(e===s.tv[3])return this.cardVisibleOffset+(r-n)/2}throw new Error("Invalid direction in getCalculatedStart")}hideCards(t){for(let e=0;e<t.length;e++)this.cards[t[e]].position.x=this.DEFAULT_CARD_POSITION}loadCards(){this.cards.length>0&&this.removeCards(),this.cards=[];for(let t=0;t<s.W8;t++){const e=new Oh.Raster(`card-${t}`);e.position.x=this.DEFAULT_CARD_POSITION,e.scale(this.cardScaleAmount),e.onLoad=this.onCardLoad.bind(this),this.cards.push(e)}}onCardLoad(){this.cardsLoaded+=1,this.cardsLoaded>=s.W8&&(this.setCanvasMetrics(),this.setCardMetrics(),this.positionHands(),this.cardsLoaded=0)}onResize(t){clearTimeout(this.redrawTimeout),this.isMobile=window.innerWidth<=s.jH,this.redrawTimeout=setTimeout(()=>{this.cardScaleAmount=this.isMobile?this.MIN_SCALE_AMOUNT_MOBILE:window.innerWidth<this.SCALE_AMOUNT_THRESHOLD_VIEW_PORT_WIDTH?(0,s.Tc)(window.innerWidth,s.jH,this.SCALE_AMOUNT_THRESHOLD_VIEW_PORT_WIDTH,this.MIN_SCALE_AMOUNT_NORMAL,this.MAX_SCALE_AMOUNT_BELOW_THRESHOLD):(0,s.Tc)(window.innerWidth,this.MIN_TARGET_VIEW_PORT_WIDTH,this.MAX_TARGET_VIEW_PORT_WIDTH,this.MIN_SCALE_AMOUNT_NORMAL,this.MAX_SCALE_AMOUNT_ABOVE_THRESHOLD),this.setCardsSize(),this.setCanvasMetrics(),this.setCardMetrics(),this.positionHands()},125)}positionHands(){const t={};for(const n in this.handsToRender)if(Object.prototype.hasOwnProperty.call(this.handsToRender,n)){const r=this.handsToRender[n];try{const e=(0,s.ut)(this.seating,n);if(isNaN(this.cardWidth)||isNaN(this.cardHeight))return this.loadCards();t[e]=r}catch(e){return this.setCardsRotationAndPosition(),void console.error("err =",e)}}t.east&&this.positionHand(t.east,s.tv[1]),t.west&&this.positionHand(t.west,s.tv[3]),t.north&&this.positionHand(t.north,s.tv[0]),t.south&&this.positionHand(t.south,s.tv[2])}positionHand(t,e){var n;if(-1===this.cardSpacingIncrement)return;const r=this.getHandWithTrumpOnLeft(t),i=(0,s.xH)(r),o=this.getStartingPosition(i.length,e),a=this.getCorrectlyArrangedHand(i,e),l=[];for(let c=0;c<a.length;c++){const t=a[c],r=this.cards.find(e=>{const n=e.image.id.indexOf("-");return e.image.id.slice(n+1).match(t)});l.push(r),e===s.tv[0]?this.setNorthCard(r,c,o):e===s.tv[1]?this.setEastCard(r,c,o):e===s.tv[2]?this.setSouthCard(r,c,o):e===s.tv[3]&&this.setWestCard(r,c,o),null===(n=this.project)||void 0===n||n.activeLayer.addChild(r)}e!==s.tv[0]&&e!==s.tv[1]||this.reverseHandLayering(l)}resetCardsPlayed(){this.cardsPlayed=[],this.playCount=0}removeCards(){for(let t=0;t<this.cards.length;t++)this.cards[t].remove()}reverseHandLayering(t){var e;for(let n=t.length-1;n>=0;n--){const r=t[n];null===(e=this.project)||void 0===e||e.activeLayer.addChild(r)}}setCardPlayOrderAsDirections(){const t=(0,s.ut)(this.seating,this.firstCardPlayer),e=s.tv.indexOf(t);this.cardPlayerOrder=[...s.tv.slice(e),...s.tv.slice(0,e)]}setCardsRotationAndPosition(t=0,e=0){for(let n=0;n<this.cards.length;n++){const r=this.cards[n];r.position.x=t,r.rotation=e}}setCardMetrics(){const t=this.cards[0];if(void 0===(null==t?void 0:t.rotation))return;const e=Math.round(t.rotation);this.cardWidth=0===e||180===e?t.bounds.width:t.bounds.height,this.cardHeight=1.5*this.cardWidth,this.cardVisibleOffset=this.cardHeight/4-2.5,this.cardSpacingIncrement=this.cardWidth/6,this.SMALL_VIEWPORT_OFFSET=window.innerWidth<=this.SMALL_VIEWPORT_THRESHOLD?this.cardWidth/16:0,this.LARGE_VIEWPORT_OFFSET=window.innerWidth>=this.LARGE_VIEWPORT_THRESHOLD?this.cardWidth/16:0}setCanvasMetrics(){const t=document.getElementById(`${s.uV}-canvas`),e=null==t?void 0:t.getBoundingClientRect();e&&(this.canvasHeight=e.height,this.canvasWidth=e.width)}setNorthCard(t,e,n){t.position.x=n+this.cardWidth/2+this.cardSpacingIncrement*e+(this.keepCardsCentered?0:this.SMALL_VIEWPORT_OFFSET),t.position.y=-this.cardVisibleOffset}setSouthCard(t,e,n){t.position.x=n+this.cardWidth/2+this.cardSpacingIncrement*e+(this.keepCardsCentered?0:this.SMALL_VIEWPORT_OFFSET),t.position.y=this.canvasHeight+this.cardVisibleOffset}setEastCard(t,e,n){t.position.y=n+this.cardWidth/2+this.cardSpacingIncrement*e+(this.keepCardsCentered?0:2*this.LARGE_VIEWPORT_OFFSET),t.position.x=this.canvasWidth+this.cardVisibleOffset,(t.rotation>-89.5||t.rotation<-90.5)&&t.rotate(-90)}setWestCard(t,e,n){t.position.y=n+this.cardWidth/2+this.cardSpacingIncrement*e-(this.keepCardsCentered?0:.33*this.LARGE_VIEWPORT_OFFSET),t.position.x=-this.cardVisibleOffset,(t.rotation<89.5||t.rotation>90.5)&&t.rotate(90)}setCardsSize(){for(let t=0;t<this.cards.length;t++){const e=this.cards[t];let n=e.bounds.width;(e.rotation>89&&e.rotation<=91||e.rotation<-89&&e.rotation>-91)&&(n=e.bounds.height),e.scale((this.isMobile?this.CARD_MOBILE_PIXEL_WIDTH:this.CARD_FULL_PIXEL_WIDTH)/n),e.scale(this.cardScaleAmount)}}setFirstCardPlayedAndPlayer(){var t,e;-1===this.firstCardPlayed&&(this.firstCardPlayed=(0,s.xH)(null===(t=this.deal)||void 0===t?void 0:t.cardPlayOrder)[0]),this.firstCardPlayer=(0,s.Eg)(null===(e=this.deal)||void 0===e?void 0:e.hands,this.firstCardPlayed)}setupProject(){this.project=new Oh.Project(document.querySelector(`#${s.uV}-canvas`))}updateHands(){var t;let e=0;const n=[],r={};for(const i in this.handsToRender)if(Object.prototype.hasOwnProperty.call(this.handsToRender,i)){const o=[...null===(t=this.deal)||void 0===t?void 0:t.hands[i]];if(e>=this.cardsPlayed.length){r[i]=o;continue}const a=(0,s.xH)(o);let l=!1;for(let t=0;t<this.cardsPlayed.length;t++){const r=this.cardsPlayed[t],i=a.indexOf(r);-1!==i&&(e++,l=!0,n.push(r),a.splice(i,1))}let c=o;l&&(c=(0,s.N6)(a)),r[i]=c}this.hideCards(n),this.handsToRender=Object.assign({},r),this.positionHands()}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(l.yh))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Dh(t,e){if(1&t&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.dealSummaryUsername)}}function Rh(t,e){1&t&&(o.TgZ(0,"span"),o._uU(1,"\xa0played\xa0"),o.qZA())}function Lh(t,e){if(1&t&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&t){const t=o.oxw(2);o.xp6(1),o.hij(" ",2===t.contract.doubleMultiplier?"doubled":4===t.contract.doubleMultiplier?"re-doubled":""," ")}}function Ih(t,e){if(1&t&&(o.TgZ(0,"span"),o.TgZ(1,"span"),o._uU(2),o.qZA(),o._UZ(3,"span",5),o.YNc(4,Lh,2,1,"span",1),o.qZA()),2&t){const t=o.oxw();o.xp6(2),o.Oqu(t.contract.prefix),o.xp6(1),o.Q6J("innerHtml",t.contract.htmlEntity,o.oJD),o.xp6(1),o.Q6J("ngIf",1!==t.contract.doubleMultiplier)}}function Nh(t,e){1&t&&(o.TgZ(0,"span"),o._uU(1,"\xa0and\xa0"),o.qZA())}function kh(t,e){if(1&t&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.dealSummaryMessageSuffixPost)}}let Fh=(()=>{class t{constructor(t,e,n,r){this.renderer=t,this.elRef=e,this.store=n,this.replayViewerDealService=r,this.deal=null,this.dealIndex=null,this.seating=null,this.hands=null,this.declarer="",this.dealer="",this.dealSummaryUsername="",this.dealSummaryMessageContract="",this.dealSummaryMessageSuffixPre="",this.dealSummaryMessageSuffixNumber="",this.dealSummaryMessageSuffixPost="",this.contract={prefix:"",htmlEntity:"",doubleMultiplier:1},this.buttonChoices=s.LS,this.DEAL_DETAIL_CLASSNAME=s.RE,this.DISPLAY_NONE_CLASSNAME=s.ze,this.MATCHED_DEAL_CLASSNAME=s.Kt,this.users=null,this.DEAL_PASSED_OUT_MESSAGE=s.zA}get classname(){return!0}get dealDetailFailure(){return!this.dealSummaryMessageSuffixPost.match(/overtrick/i)&&!this.dealSummaryMessageSuffixPre.match(/made/i)&&!this.dealSummaryMessageSuffixPre.match(/almost/i)}get dealDetailSuccess(){return this.dealSummaryMessageSuffixPost.match(/overtrick/i)||this.dealSummaryMessageSuffixPre.match(/made/i)||this.dealSummaryMessageSuffixPre.match(/almost/i)}ngOnInit(){this.store.select(h.zW.users).subscribe(t=>{this.users=t.userIds}),this.setHands(),this.setDealer(),this.setDeclarer(),this.setContract(),this.setDealSummaryPrefix(),this.setDealSummarySuffix(),this.setHandsTable(),this.setBiddingTable();let t=[];this.store.select(h.zW.filters).pipe((0,p.w)(e=>(t=e.dealsThatMatchFilters,this.store.select(h.zW.games)))).subscribe(e=>{if(t.includes(this.deal._id)){const t=this.elRef.nativeElement.querySelector(`.${s.RE}__summary`);this.renderer.addClass(t,s.Kt)}})}onDetailClick(t){const e=t.currentTarget||t.target;this.replayViewerDealService.toggleButtonBottomBorder([e,e.nextElementSibling]);const n=this.elRef.nativeElement.querySelector(`.${s.RE}__tables`);if((0,s.ER)([n],s.ze),(0,s.X7)(e,this.buttonChoices),e.innerHTML.match(this.buttonChoices[1])){const t=e.closest(`.${s.uS}`),n=null==t?void 0:t.querySelector(`.${s.uS}__summary`),r=null==n?void 0:n.getBoundingClientRect(),i=(null==r?void 0:r.bottom)+window.innerHeight/6,o=(0,s.Qj)(e,i||0,!0);t&&(t.scrollTop=o)}}onWatchClick(t){var e,n;this.store.dispatch(new u.lL(this.contract));const r=(t.currentTarget||t.target).closest(`.${s.RE}__summary`),i=null===(e=null==r?void 0:r.querySelector(`.${s.RE}__summary-number`))||void 0===e?void 0:e.innerHTML.match(/\d+/i);this.store.dispatch(new u.KS(Object.assign(Object.assign({},this.deal),{dealNumber:i?i[0]:-1,declarer:this.declarer,biddingTable:null===(n=this.elRef.nativeElement.querySelector(`.${s.RE}__bids`))||void 0===n?void 0:n.innerHTML,summaryPre:this.dealSummaryMessageSuffixPre,summaryNumber:this.dealSummaryMessageSuffixNumber,summaryPost:this.dealSummaryMessageSuffixPost})))}setBiddingTable(){var t;const e=this.getBiddingAsTable(null===(t=this.deal)||void 0===t?void 0:t.bids),n=this.elRef.nativeElement.querySelector(`.${s.RE}__bids`);this.renderer.appendChild(n,e)}setContract(){var t,e;if(!(null===(t=this.deal)||void 0===t?void 0:t.contract))return this.contract={prefix:"",htmlEntity:"",doubleMultiplier:1};const n=null===(e=this.deal)||void 0===e?void 0:e.contract.split(" ");if(!n)return;const r=(0,s.hh)(n[0],!0),i=(0,s.gd)(null==n?void 0:n.slice(1).join(" "));return this.contract={prefix:r,htmlEntity:i,doubleMultiplier:this.deal.doubleValue}}setDealer(){var t;const e=null===(t=this.deal)||void 0===t?void 0:t.dealer;this.dealer=e&&this.users?this.users[e]:s.i1}setDealSummaryPrefix(){this.dealSummaryUsername=this.declarer?`'${this.declarer}'`:""}setDealSummarySuffix(){const[t,e]=this.replayViewerDealService.getMadeAmountString(this.deal,+this.contract.prefix,this.seating,this.declarer);if(t===s.i1)return this.dealSummaryMessageSuffixPre=this.DEAL_PASSED_OUT_MESSAGE,this.dealSummaryMessageContract="",this.dealSummaryMessageSuffixNumber="",this.dealSummaryMessageSuffixPost="",void(this.dealSummaryUsername="");if(e>0){const n=`${e}`,r=t.indexOf(n),i=t.substr(0,r);t.length>r&&(this.dealSummaryMessageSuffixPost=t.substr(r+1)),this.dealSummaryMessageSuffixPre=i,this.dealSummaryMessageSuffixNumber=n}else this.setDealSummaryPreOnly(t)}setDeclarer(){this.declarer=this.replayViewerDealService.getDeclarerFromDeal(this.deal)}setHands(){var t;const e=[],n=null===(t=this.deal)||void 0===t?void 0:t.hands;if(n){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.push([t,n[t]]);this.hands=e}}setHandsTable(){const t=this.getHandAsTable(this.hands),e=this.flattenTable(t,5),n=this.elRef.nativeElement.querySelector(`.${s.RE}__hands`);n&&e&&this.renderer.appendChild(n,e)}setDealSummaryPreOnly(t){this.dealSummaryMessageSuffixPre=`${t}`,this.dealSummaryMessageSuffixNumber="",this.dealSummaryMessageSuffixPost=""}getBiddingAsTable(t){if(!t||t.length<0)return this.getNewElement("div");const e=this.getNewElement("div");this.renderer.addClass(e,`${s.RE}__bids-table`);const n=[];for(let r=0;r<t.length;r++){const i=t[r];r<4&&n.push(i[1]);let s=!1,o=`${i[0]}`;if(r>=4&&(o=this.getInnerHTMLOfBid(i[1]),s=!0),this.addBidToTable(o,e,s),3===r)for(let t=0;t<n.length;t++){const r=this.getInnerHTMLOfBid(n[t]);this.addBidToTable(r,e,!0)}}return e}getInnerHTMLOfBid(t){if((0,s.EN)(t)){const e=t.split(" ");return`${(0,s.hh)(e[0])}${(0,s.gd)(e[1])}`}return(0,s.kC)(t)}addBidToTable(t,e,n=!1){const r=this.getNewElement("div");if(this.renderer.setProperty(r,"innerHTML",t),n){const e=t.match(s.s7[1])||t.match(s.s7[2]);let n=s.eF;e&&(n=s.Nk),this.renderer.addClass(r,n)}this.renderer.appendChild(e,r)}getHandAsTable(t){const e=this.getNewElement("div");if(this.renderer.appendChild(e,this.getSuitColumn()),!t)return null;for(let n=0;n<t.length;n++){const r=t[n][1],i=t[n][0],o=this.getNewElement("div");this.renderer.addClass(o,`${s.RE}__hands-column-${n+2}`);const a=this.getNewElement("div");if(this.renderer.setProperty(a,"innerHTML",i),this.renderer.appendChild(o,a),null!==r){const t=(0,s.SW)(r);for(let e=0;e<(null==t?void 0:t.length);e++){const n=(0,s.zi)(t[e]),r=this.getNewElement("div");this.renderer.setProperty(r,"innerHTML",n),this.renderer.appendChild(o,r)}}this.renderer.appendChild(e,o)}return e}flattenTable(t,e){if(!t)return null;const n=this.getNewElement("div"),r=t.children;for(let i=0;i<e;i++)for(let t=0;t<r.length;t++){const e=r[t].children,s=this.getNewElement("div");this.renderer.setProperty(s,"innerHTML",e[i].innerHTML),this.renderer.appendChild(n,s)}return this.renderer.addClass(n,`${s.RE}__hands-table`),n}getSuitColumn(){const t=this.renderer.createElement("div"),e=this.getNewElement("div");this.renderer.setProperty(e,"innerHTML","&nbsp"),this.renderer.addClass(t,`${s.RE}__hands-column-1`),this.renderer.appendChild(t,e);for(let n=0;n<s.s7.length;n++){const e=s.s7[n],r=this.getNewElement("div");this.renderer.setProperty(r,"innerHTML",e),this.renderer.appendChild(t,r)}return t}getNewElement(t){return this.renderer.createElement(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.Qsj),o.Y36(o.SBq),o.Y36(l.yh),o.Y36(m))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-deal-detail"]],hostVars:6,hostBindings:function(t,e){2&t&&o.ekj("deal-detail",e.classname)("deal-detail__failure",e.dealDetailFailure)("deal-detail__success",e.dealDetailSuccess)},inputs:{deal:"deal",dealIndex:"dealIndex",seating:"seating"},decls:29,vars:41,consts:[[1,"deal-detail__summary"],[4,"ngIf"],[3,"click"],[1,"deal-detail__hands"],[1,"deal-detail__bids"],[3,"innerHtml"]],template:function(t,e){1&t&&(o.TgZ(0,"div"),o.TgZ(1,"div",0),o.TgZ(2,"span"),o._uU(3),o.qZA(),o.TgZ(4,"div"),o.TgZ(5,"div"),o.YNc(6,Dh,2,1,"span",1),o.YNc(7,Rh,2,0,"span",1),o.YNc(8,Ih,5,3,"span",1),o.YNc(9,Nh,2,0,"span",1),o.TgZ(10,"span"),o._uU(11),o.qZA(),o.TgZ(12,"span"),o._uU(13),o.qZA(),o.YNc(14,kh,2,1,"span",1),o.TgZ(15,"span"),o._uU(16,":"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(17,"div"),o.TgZ(18,"button",2),o.NdJ("click",function(t){return e.onDetailClick(t)}),o._uU(19),o.qZA(),o.TgZ(20,"button",2),o.NdJ("click",function(t){return e.onWatchClick(t)}),o._uU(21," Watch Replay "),o.qZA(),o.qZA(),o.qZA(),o.TgZ(22,"div"),o.TgZ(23,"div",3),o.TgZ(24,"div"),o._uU(25,"Hands:"),o.qZA(),o.qZA(),o.TgZ(26,"div",4),o.TgZ(27,"div"),o._uU(28,"Bidding:"),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.Gre("",e.DEAL_DETAIL_CLASSNAME,"__details"),o.xp6(2),o.Gre("",e.DEAL_DETAIL_CLASSNAME,"__summary-number"),o.xp6(1),o.hij(" Deal ",null!==e.dealIndex?e.dealIndex+1:0,"): \xa0 "),o.xp6(1),o.Gre("",e.DEAL_DETAIL_CLASSNAME,"__summary-text-container"),o.xp6(1),o.Gre("",e.DEAL_DETAIL_CLASSNAME,"__summary-text"),o.xp6(1),o.Q6J("ngIf",e.dealSummaryUsername),o.xp6(1),o.Q6J("ngIf",e.dealSummaryUsername),o.xp6(1),o.Q6J("ngIf",e.dealSummaryUsername),o.xp6(1),o.Q6J("ngIf",e.dealSummaryUsername),o.xp6(2),o.Oqu(e.dealSummaryMessageSuffixPre),o.xp6(2),o.Oqu(e.dealSummaryMessageSuffixNumber),o.xp6(1),o.Q6J("ngIf",e.dealSummaryMessageSuffixPost),o.xp6(3),o.Gre("",e.DEAL_DETAIL_CLASSNAME,"__summary-buttons"),o.xp6(1),o.Gre("ui button color-1 hover-color-4 bg-color-4 hover-bg-color-1 ",e.DEAL_DETAIL_CLASSNAME,"__view-button"),o.xp6(1),o.hij(" ",e.buttonChoices[0]," "),o.xp6(1),o.Gre("ui button color-1 hover-color-4 bg-color-4 hover-bg-color-1 ",e.DEAL_DETAIL_CLASSNAME,"__watch-button"),o.uIk("data-deal",e.deal),o.xp6(2),o.MT6("",e.DISPLAY_NONE_CLASSNAME," ",e.DEAL_DETAIL_CLASSNAME,"__tables"),o.xp6(2),o.Gre("",e.DEAL_DETAIL_CLASSNAME,"__tables-header"),o.xp6(3),o.Gre("",e.DEAL_DETAIL_CLASSNAME,"__tables-header"))},directives:[r.O5],styles:[""]}),t})();function Bh(t,e){1&t&&(o.TgZ(0,"div"),o._uU(1," Fetching... "),o._UZ(2,"i",4),o.qZA())}function jh(t,e){if(1&t&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.buttonChoicesDeals[0])}}function Uh(t,e){if(1&t&&o._UZ(0,"nx-bridge-deal-detail",5),2&t){const t=e.$implicit,n=e.index,r=o.oxw();o.Q6J("deal",t)("dealIndex",n)("seating",r.seating)}}let Vh=(()=>{class t{constructor(t,e,n,r){this.elRef=t,this.http=e,this.store=n,this.replayViewerDealService=r,this.seating=null,this.dealsAsStrings=[],this.DEALS_LIST_CLASSNAME=s.Rb,this.DISPLAY_NONE_CLASSNAME=s.ze,this.DEAL_DETAIL_CLASSNAME=s.RE,this.deals=[],this.dealsListItems=null,this.isLoading=!1,this.dealCountMessage="DealRelevant Count Here",this.buttonChoicesDeals=s.xD,this.buttonChoicesDetails=s.Qo,this.northSouthPlayers=[],this.eastWestPlayers=[],this.isAllowedToClose=!1}get classname(){return!0}ngOnInit(){}onDealsButtonClick(t){if(this.replayViewerDealService.getIsGameAlreadyOpen()&&!this.isAllowedToClose)return;const e=t.currentTarget||t.target;this.handleDealsButtonLogic(e),this.dispatchIsViewingGame(e)}onShowDetails(t){this.toggleDealButtonsBorderBottoms(t),this.toggleDealItems(t),(0,s.X7)((null==t?void 0:t.currentTarget)||(null==t?void 0:t.target),this.buttonChoicesDetails)}dispatchIsViewingGame(t){this.toggleDeals(t)?(this.store.dispatch(new u.ND(!0)),setTimeout(()=>{this.isAllowedToClose=!0},2*s.zn)):(this.isAllowedToClose=!1,this.store.dispatch(new u.ND(!1)))}handleDealsButtonLogic(t){var e,n,r,i;if(t.innerHTML.match(s.xD[0])){const t=this.elRef.nativeElement.closest(`.${s.uS}`),o=null===(n=null===(e=null==t?void 0:t.querySelector(`.${s.uS}__header-room`))||void 0===e?void 0:e.innerHTML)||void 0===n?void 0:n.trim(),a=null===(i=null===(r=null==t?void 0:t.querySelector(`.${s.uS}__header-date`))||void 0===r?void 0:r.innerHTML)||void 0===i?void 0:i.trim();this.store.dispatch(new u.K9({seating:this.seating,name:o,date:a,deals:this.dealsAsStrings})),this.replayViewerDealService.setGameDetailBorderToBlack()}else this.replayViewerDealService.setGameDetailBorderToNormal(),this.store.dispatch(new u.K9({seating:{},name:"",date:-1,deals:[]}));this.toggleGameDetailScoreBorder()}loadRelevantDeals(){this.deals=this.replayViewerDealService.getDealsToGet(this.dealsAsStrings),this.setTeams();const t=this.replayViewerDealService.getDealsWonCounts(this.deals,this.seating);this.dealCountMessage=this.replayViewerDealService.getDealCountMessage(this.dealsAsStrings?this.dealsAsStrings[this.dealsAsStrings.length-1]:s.i1,t),this.isLoading=!1}setTeams(){if(!this.seating)throw new Error("Problem with this.seating in deals-list");this.northSouthPlayers=[this.seating.north,this.seating.south],this.eastWestPlayers=[this.seating.east,this.seating.west]}toggleDealButtonsBorderBottoms(t){var e;const n=!(t.currentTarget||t.target).innerHTML.match(/show/i),r=null===(e=this.elRef.nativeElement)||void 0===e?void 0:e.closest(`.${s.uS}`),i=null==r?void 0:r.querySelectorAll(`.${s.RE}__view-button`),o=null==r?void 0:r.querySelectorAll(`.${s.RE}__watch-button`);this.replayViewerDealService.toggleButtonBottomBorder([...i,...o],n?h.OF.open:h.OF.close)}toggleDealItems(t){const e=this.elRef.nativeElement.querySelectorAll(`.${s.RE}__tables`);let n=!1;(t.currentTarget||t.target).innerHTML.trim()===this.buttonChoicesDetails[0]&&(n=!0);for(let r=0;r<e.length;r++){const t=e[r];t.classList.remove(s.ze);const i=t.parentNode.querySelector("button");n?i.innerHTML=s.LS[1]:(t.classList.add(s.ze),i.innerHTML=s.LS[0])}}toggleDeals(t){(0,s.X7)(t,this.buttonChoicesDeals);const e=this.elRef.nativeElement.querySelectorAll(`.${s.RE}`);!e||e.length<=0?this.loadRelevantDeals():(0,s.ER)(e,s.ze);const n=this.elRef.nativeElement.querySelector(`.${s.Rb}__summary`);return(0,s.ER)([n],s.ze),(0,s.ER)([this.elRef.nativeElement.closest(`.${s.uS}`)],s.Nn)}toggleGameDetailScoreBorder(){const t=this.elRef.nativeElement.closest(`.${s.uS}`).querySelector(`.${s.uS}__score`);(0,s.ER)([t],s._Q)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(o.SBq),o.Y36(a.eN),o.Y36(l.yh),o.Y36(m))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-deals-list"]],hostVars:2,hostBindings:function(t,e){2&t&&o.ekj("deals-list",e.classname)},inputs:{seating:"seating",dealsAsStrings:"dealsAsStrings"},decls:9,vars:18,consts:[["type","button",3,"click"],[4,"ngIf"],[3,"click"],[3,"deal","dealIndex","seating",4,"ngFor","ngForOf"],[1,"notched","circle","loading","icon"],[3,"deal","dealIndex","seating"]],template:function(t,e){1&t&&(o.TgZ(0,"button",0),o.NdJ("click",function(t){return e.onDealsButtonClick(t)}),o.YNc(1,Bh,3,0,"div",1),o.YNc(2,jh,2,1,"div",1),o.qZA(),o.TgZ(3,"div"),o.TgZ(4,"span"),o._uU(5),o.qZA(),o.TgZ(6,"button",2),o.NdJ("click",function(t){return e.onShowDetails(t)}),o._uU(7),o.qZA(),o.qZA(),o.YNc(8,Uh,1,3,"nx-bridge-deal-detail",3)),2&t&&(o.Gre("ui button color-4 bg-color-1 ",e.DEALS_LIST_CLASSNAME,"__button-deals"),o.xp6(1),o.Q6J("ngIf",e.isLoading),o.xp6(1),o.Q6J("ngIf",!e.isLoading),o.xp6(1),o.MT6("",e.DISPLAY_NONE_CLASSNAME," ",e.DEALS_LIST_CLASSNAME,"__summary"),o.xp6(1),o.Gre("",e.DEALS_LIST_CLASSNAME,"__deal-count"),o.xp6(1),o.hij(" Result: ",e.dealCountMessage," "),o.xp6(1),o.Gre("ui button color-1 hover-color-4 bg-color-4 hover-bg-color-1 ",e.DEALS_LIST_CLASSNAME,"__button-details"),o.xp6(1),o.hij(" ",e.buttonChoicesDetails[0]," "),o.xp6(1),o.Q6J("ngForOf",e.deals))},directives:[r.O5,r.sg,Fh],styles:[""]}),t})();function zh(t,e){if(1&t&&(o.ynx(0),o.TgZ(1,"b"),o.TgZ(2,"span"),o._uU(3),o.qZA(),o.qZA(),o.BQk()),2&t){const t=o.oxw();o.xp6(3),o.hij("",t.northSouthScore,"pts.")}}function $h(t,e){if(1&t&&(o.ynx(0),o.TgZ(1,"span"),o._uU(2),o.qZA(),o.BQk()),2&t){const t=o.oxw();o.xp6(2),o.hij("",t.northSouthScore,"pts.")}}function Hh(t,e){if(1&t&&(o.ynx(0),o.TgZ(1,"b"),o.TgZ(2,"span"),o._uU(3),o.qZA(),o.qZA(),o.BQk()),2&t){const t=o.oxw();o.xp6(3),o.hij("",t.eastWestScore,"pts.")}}function Gh(t,e){if(1&t&&(o.ynx(0),o.TgZ(1,"span"),o._uU(2),o.qZA(),o.BQk()),2&t){const t=o.oxw();o.xp6(2),o.hij("",t.eastWestScore,"pts.")}}let Wh=(()=>{class t{constructor(t){this.store=t,this.game=null,this.usernames=null,this.userIds=null,this.GAME_DETAIL_CLASSNAME=s.uS,this.seating=null,this.summaryScoreMessage="Score Summary Here",this.northSouthScore=-1,this.eastWestScore=-1,this.nsScoreGreater=-1,this.teams=s.fo}get className(){return!0}ngOnInit(){var t,e;this.usernames=this.getUsersnamesFromGame(this.game),this.userIds=this.getUserIdsFromGame(this.game),this.seating=null===(t=this.game)||void 0===t?void 0:t.room.seating;const n=null===(e=this.game)||void 0===e?void 0:e.deals[this.game.deals.length-1];this.store.select(h.zW.deals).subscribe(t=>{const e=t.fetchedDeals[n];e&&this.setWinnerAndScores(e)})}getUserIdsFromGame(t){return t?t.players:null}getUsersnamesFromGame(t){return t?Object.values(t.room.seating):[]}setWinnerAndScores(t){if(!t)return this.eastWestScore=u.oc,void(this.northSouthScore=u.oc);t.northSouth&&t.eastWest&&(this.northSouthScore=t.northSouth.aboveTheLine+t.northSouth.totalBelowTheLineScore,this.eastWestScore=t.eastWest.aboveTheLine+t.eastWest.totalBelowTheLineScore),void 0!==this.northSouthScore&&void 0!==this.eastWestScore&&(this.nsScoreGreater=this.northSouthScore>this.eastWestScore)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(l.yh))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-game-detail"]],hostVars:2,hostBindings:function(t,e){2&t&&o.ekj("game-detail",e.className)},inputs:{game:"game"},decls:35,vars:47,consts:[[4,"ngIf"],[3,"seating","dealsAsStrings"]],template:function(t,e){1&t&&(o.TgZ(0,"div"),o.TgZ(1,"div"),o.TgZ(2,"h4"),o._uU(3),o.qZA(),o.TgZ(4,"h5"),o._uU(5),o.ALo(6,"date"),o.qZA(),o.qZA(),o.TgZ(7,"div"),o.TgZ(8,"span"),o._uU(9),o.qZA(),o.TgZ(10,"span"),o._uU(11),o.qZA(),o.qZA(),o.TgZ(12,"div"),o.TgZ(13,"div"),o.TgZ(14,"span"),o._uU(15),o.qZA(),o.TgZ(16,"span"),o._uU(17,"+\xa0"),o.qZA(),o.TgZ(18,"span"),o._uU(19),o.qZA(),o.qZA(),o.TgZ(20,"span"),o._uU(21,"vs."),o.qZA(),o.TgZ(22,"div"),o.TgZ(23,"span"),o._uU(24),o.qZA(),o.TgZ(25,"span"),o._uU(26,"\xa0+"),o.qZA(),o.TgZ(27,"span"),o._uU(28),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(29,"div"),o.YNc(30,zh,4,1,"ng-container",0),o.YNc(31,$h,3,1,"ng-container",0),o.YNc(32,Hh,4,1,"ng-container",0),o.YNc(33,Gh,3,1,"ng-container",0),o.qZA(),o._UZ(34,"nx-bridge-deals-list",1)),2&t&&(o.Gre("",e.GAME_DETAIL_CLASSNAME,"__summary"),o.xp6(1),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__header"),o.xp6(1),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__header-room"),o.xp6(1),o.hij(" '",null==e.game||null==e.game.room?null:e.game.room.name,"' "),o.xp6(1),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__header-date"),o.xp6(1),o.hij(" ",o.xi3(6,44,null==e.game?null:e.game.completionDate,"short")," "),o.xp6(2),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__players-labels"),o.xp6(2),o.hij("",e.teams[0],":"),o.xp6(2),o.hij("",e.teams[1],":"),o.xp6(1),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__players"),o.xp6(1),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__players-ns"),o.xp6(2),o.hij("'",null==e.seating?null:e.seating.north,"'"),o.xp6(4),o.hij("'",null==e.seating?null:e.seating.south,"'"),o.xp6(1),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__vs"),o.xp6(2),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__players-ew"),o.xp6(2),o.hij("'",null==e.seating?null:e.seating.east,"'"),o.xp6(4),o.hij("'",null==e.seating?null:e.seating.west,"'"),o.xp6(1),o.Gre("",e.GAME_DETAIL_CLASSNAME,"__score"),o.xp6(1),o.Q6J("ngIf",!0===e.nsScoreGreater),o.xp6(1),o.Q6J("ngIf",!1===e.nsScoreGreater),o.xp6(1),o.Q6J("ngIf",!1===e.nsScoreGreater),o.xp6(1),o.Q6J("ngIf",!0===e.nsScoreGreater),o.xp6(1),o.Q6J("seating",e.seating)("dealsAsStrings",null==e.game?null:e.game.deals))},directives:[r.O5,Vh],pipes:[r.uU],styles:[""]}),t})();function qh(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"nx-bridge-game-detail",1),o.NdJ("click",function(e){return o.CHM(t),o.oxw().onClick(e)}),o.qZA()}2&t&&o.Q6J("game",e.$implicit)}let Zh=(()=>{class t{constructor(t,e,n,r,i){this.dealPlayerService=t,this.store=e,this.renderer=n,this.replayViewerDealService=r,this.filterManagerService=i,this.games=[],this.maxDisplayedPerPage=25,this.displayedMultiple=0,this.isLoaded=!1}get classname(){return!0}get toggleHidden(){return!this.isLoaded}ngOnInit(){this.store.select(h.zW.games).subscribe(t=>{this.games=t.currentlyDisplayingGames?t.currentlyDisplayingGames:[]}),this.store.select(h.zW.deals).subscribe(t=>{this.isLoaded=Object.keys(t.fetchedDeals).length>0})}onClick(t){var e;const n=document.querySelector(`.${s.g5}`),r=t.target;if(null===(e=r)||void 0===e?void 0:e.classList.contains(s.Nn)){this.replayViewerDealService.setGameDetailBorderToNormal();const t=r.querySelectorAll(`.${s.RE}`);t&&t.length>0&&(0,s.ER)(t,s.ze);const e=r.querySelector(`.${s.Rb}__summary`);(0,s.ER)([e],s.ze);const i=r.querySelector(`.${s.Rb}__button-deals`);(0,s.X7)(i,s.xD),r.classList.remove(s.Nn),this.store.dispatch(new u.ND(!1)),this.dealPlayerService.setCardsRotationAndPosition(),this.renderer.removeClass(n,s.rf)}else setTimeout(()=>{this.renderer.addClass(n,s.rf)},1.5*s.zn)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(Ph),o.Y36(l.yh),o.Y36(o.Qsj),o.Y36(m),o.Y36(g))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-games-list"]],hostVars:4,hostBindings:function(t,e){2&t&&o.ekj("games-list",e.classname)("hidden",e.toggleHidden)},decls:1,vars:1,consts:[[3,"game","click",4,"ngFor","ngForOf"],[3,"game","click"]],template:function(t,e){1&t&&o.YNc(0,qh,1,1,"nx-bridge-game-detail",0),2&t&&o.Q6J("ngForOf",e.games)},directives:[r.sg,Wh],styles:[""]}),t})(),Yh=(()=>{class t{transform(t,e,n,r=!1){let i=t||"";const s=Array.isArray(e),o=Array.isArray(n);if(s||o){if(s&&!o)if(r)for(let a=0;a<e.length;a++){const t=e[a];for(;i.includes(t);)i=this.replaceMultipleWithOne(i,e,n)}else i=this.replaceMultipleWithOne(t,e,n);else if(s&&o)if(r)for(let a=0;a<e.length;a++){const t=e[a];for(;i.includes(t);)i=this.replaceMultipleWithMultiple(i,e,n)}else i=this.replaceMultipleWithMultiple(t,e,n)}else if(r)for(;i.includes(e);)i=this.replaceOne(i,e,n);else i=this.replaceOne(i,e,n);return i}replaceOne(t,e,n){return t.replace(e,n)}replaceMultipleWithOne(t,e,n){let r=t;for(let i=0;i<e.length;i++)r=this.replaceOne(r,e[i],n),console.log("result =",r);return r}replaceMultipleWithMultiple(t,e,n){if(e.length!==n.length)throw new Error("toReplace and replaceWith arrays must be the same length to use replaceMultipleWithMultiple()");let r=t;for(let i=0;i<e.length;i++)r=this.replaceOne(r,e[i],n[i]);return r}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Yjl({name:"replace",type:t,pure:!0}),t})();function Jh(t,e){if(1&t&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.summaryPre.toLowerCase())}}function Kh(t,e){if(1&t&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.summaryNumber)}}function Xh(t,e){if(1&t&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.summaryPost)}}function Qh(t,e){if(1&t&&(o.TgZ(0,"div"),o.TgZ(1,"span"),o._uU(2),o.qZA(),o.qZA()),2&t){const t=o.oxw();o.Gre("",t.DEAL_PLAYER_CLASSNAME,"__trick"),o.xp6(1),o.Gre("",t.DEAL_PLAYER_CLASSNAME,"__trick-number"),o.xp6(1),o.hij("T",t.trickNumber,"")}}function td(t,e){if(1&t){const t=o.EpF();o.O4$(),o.TgZ(0,"svg",0),o.NdJ("click",function(){return o.CHM(t),o.oxw().onPlay()}),o._UZ(1,"use",13),o.qZA()}}function ed(t,e){if(1&t){const t=o.EpF();o.O4$(),o.TgZ(0,"svg",0),o.NdJ("click",function(){return o.CHM(t),o.oxw().onPause()}),o._UZ(1,"use",14),o.qZA()}}function nd(t,e){if(1&t&&o._UZ(0,"img",16),2&t){const t=e.index;o.MGl("id","card-",t,""),o.MGl("src","/assets/deal-player/cards-full/",t,".png",o.LSH)}}const rd=function(){return[]};function id(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,nd,1,2,"img",15),o.qZA()),2&t){const t=o.oxw();o.MT6("",t.DEAL_PLAYER_CLASSNAME,"__images ",t.DISPLAY_NONE_CLASSNAME,""),o.xp6(1),o.Q6J("ngForOf",o.DdM(5,rd).constructor(52))}}function sd(t,e){if(1&t&&o._UZ(0,"img",16),2&t){const t=e.index;o.MGl("id","card-",t,""),o.MGl("src","/assets/deal-player/cards-mobile/",t,".png",o.LSH)}}function od(t,e){if(1&t&&(o.TgZ(0,"div"),o.YNc(1,sd,1,2,"img",15),o.qZA()),2&t){const t=o.oxw();o.MT6("",t.DEAL_PLAYER_CLASSNAME,"__images ",t.DISPLAY_NONE_CLASSNAME,""),o.xp6(1),o.Q6J("ngForOf",o.DdM(5,rd).constructor(52))}}let ad=(()=>{class t{constructor(t,e,n,r){this.store=t,this.elRef=e,this.renderer=n,this.dealPlayerService=r,this.DEAL_PLAYER_CLASSNAME=s.uV,this.DISPLAY_NONE_CLASSNAME=s.ze,this.dealNumber=-1,this.contract=null,this.declarer="",this.trickNumber=0,this.keepCardsCentered=!1,this.cardPlayWaitDuration=2500,this.seating=null,this.name=null,this.date=null,this.biddingTable="",this.summaryPre="",this.summaryNumber="",this.summaryPost="",this.error="",this.hasLoadedDeal=!1,this.shouldChangePlaySpeed=!1,this.isMobile=window.innerWidth<=s.jH,this.isPlaying=!1}onClick(t){this.onHostClick(t)}get classname(){return!0}ngOnInit(){window.addEventListener("resize",this.dealPlayerService.onResize.bind(this.dealPlayerService)),this.store.select(h.zW.games).subscribe(t=>{this.handleGamesUpdates(t)}),this.store.select(h.zW.deals).subscribe(t=>{this.handleDealsUpdates(t),this.addHeightAuto()})}onCenteredChange(t){const e=(t.currentTarget||t.target).checked;this.keepCardsCentered=e,this.dealPlayerService.keepCardsCentered=e}onHostClick(t){const e=t.target;let n=!0;"svg"!==e.localName&&"use"!==e.localName&&(n=(0,s.kH)(e,"nx-bridge-deal-player",s.uV)),n||this.closeWindow()}onClose(){this.closeWindow()}onNext(){this.resetTable(),this.playCard(),this.onPause()}onNextFour(){this.resetTable();const t=this.dealPlayerService.playCount+3;this.playCard(t>=51?51:t),this.onPause()}onPause(){this.isPlaying=!1,clearInterval(this.dealPlayerService.playInterval)}onPlay(){this.isPlaying=!0,this.playCard(),this.dealPlayerService.playInterval=setInterval(()=>{if(this.shouldChangePlaySpeed)return clearInterval(this.dealPlayerService.playInterval),this.onPlay();this.playCard(),this.dealPlayerService.playCount===s.W8&&clearInterval(this.dealPlayerService.playInterval)},this.cardPlayWaitDuration)}onPrevious(){this.onPause(),this.resetTable(),this.playCard(this.dealPlayerService.playCount-2)}onPreviousFour(){this.onPause(),this.resetTable(),this.playCard(this.dealPlayerService.playCount-5)}onSpeedChange(t){var e;this.cardPlayWaitDuration=1e3*+(null===(e=t.target)||void 0===e?void 0:e.value),console.log("this.cardPlayWaitDuration =",this.cardPlayWaitDuration),this.isPlaying&&(this.shouldChangePlaySpeed=!0)}onRestart(){this.resetTable(),this.onPause(),this.dealPlayerService.resetCardsPlayed(),this.trickNumber=0,this.playCard(-1)}addHeightAuto(){const t=this.elRef.nativeElement;t.classList.contains(s.$E)&&this.renderer.addClass(t,s.dq)}changeContractColor(){var t,e;const n=document.querySelector(`.${s.uV}__contract`);let r=s.eF;(null===(t=this.contract)||void 0===t?void 0:t.htmlEntity)!==s.s7[1]&&(null===(e=this.contract)||void 0===e?void 0:e.htmlEntity)!==s.s7[2]||(r=s.Nk),(null==n?void 0:n.children[1])&&(this.renderer.removeClass(n.children[1],s.eF),this.renderer.removeClass(n.children[1],s.Nk),this.renderer.addClass(n.children[1],r))}closeWindow(){this.hasLoadedDeal=!1,this.onPause(),this.dealPlayerService.resetCardsPlayed(),this.resetTable(),this.renderer.removeClass(this.elRef.nativeElement,s.$E),this.dealPlayerService.setCardsRotationAndPosition(),this.store.dispatch(new u.KS({})),this.resetVariables(),this.removeHeightAuto()}displayCardInTable(t){var e;let n=s.i1,r="";if(t!==s.i1){n=(0,s.Wb)(t),r=(0,s.gd)(t);const i=(0,s.Eg)(null===(e=this.dealPlayerService.deal)||void 0===e?void 0:e.hands,t),o=(0,s.ut)(this.seating,i);return this.setDirectionContent(n,r,o)}for(let i=0;i<s.tv.length;i++)this.setDirectionContent(n,r,s.tv[i])}displayCardsInTable(){this.dealPlayerService.setFirstCardPlayedAndPlayer(),this.dealPlayerService.setCardPlayOrderAsDirections(),this.renderRoundWinnersTable(),(this.dealPlayerService.cardsPlayed.length-1)%4==0&&this.resetTable();const t=this.getCurrentTrick();let e=0;for(let n=t.length-1;n>=0&&4!==e;n--)this.displayCardInTable(t[n]),e++}getCurrentTrick(){const t=this.dealPlayerService.cardsPlayed.length;this.trickNumber=Math.floor((t-1)/4)+1;const e=4*(this.trickNumber-1),n=e+4;return n>t-1?this.dealPlayerService.cardsPlayed.slice(e):this.dealPlayerService.cardsPlayed.slice(e,n)}handleGamesUpdates(t){this.seating=t.currentlyViewingGame.seating,this.dealPlayerService.seating=t.currentlyViewingGame.seating,this.name=t.currentlyViewingGame.name,this.date=t.currentlyViewingGame.date}handleDealsUpdates(t){var e,n,r,i;if((null===(e=t.currentlyViewingDeal)||void 0===e?void 0:e.bids)&&!this.hasLoadedDeal){if(this.dealPlayerService.deal=t.currentlyViewingDeal,this.declarer=t.currentlyViewingDeal.declarer,this.dealNumber=t.currentlyViewingDeal.dealNumber,this.biddingTable=t.currentlyViewingDeal.biddingTable,this.summaryPre=t.currentlyViewingDeal.summaryPre,this.summaryNumber=t.currentlyViewingDeal.summaryNumber,this.summaryPost=t.currentlyViewingDeal.summaryPost,Object.keys(this.dealPlayerService.deal).length<=0)return;this.dealPlayerService.handsToRender=null===(n=this.dealPlayerService.deal)||void 0===n?void 0:n.hands,this.dealPlayerService.setupProject(),this.dealPlayerService.cards.length<s.W8?this.dealPlayerService.loadCards():this.dealPlayerService.positionHands(),this.renderer.addClass(this.elRef.nativeElement,s.$E),this.hasLoadedDeal=!0,this.renderRoundWinnersTable()}else(null===(r=t.currentlyViewingDeal)||void 0===r?void 0:r.bids)&&(this.dealPlayerService.setCardsRotationAndPosition(),this.renderer.addClass(this.elRef.nativeElement,s.$E));(null===(i=t.currentlyViewingDealContract)||void 0===i?void 0:i.prefix)&&(this.contract=t.currentlyViewingDealContract,this.changeContractColor())}playCard(t=this.dealPlayerService.playCount){var e;const n=null===(e=this.dealPlayerService.deal)||void 0===e?void 0:e.cardPlayOrder;if(this.dealPlayerService.deal&&n&&!(n.length<s.W8)){if(t>=s.W8)return this.onPause();this.dealPlayerService.cardsPlayed=(0,s.xH)(-2===t||51===t?n:n.slice(0,t<-2?t+2:t+1)),this.dealPlayerService.playCount=t+1,this.displayCardsInTable(),this.dealPlayerService.updateHands()}}removeHeightAuto(){this.renderer.removeClass(this.elRef.nativeElement,s.dq)}resetTable(){for(let t=0;t<s.tv.length;t++)this.setDirectionContent("","",s.tv[t])}resetVariables(){}renderRoundWinnersTable(){var t;const e=document.querySelector(`.${s.uV}__round-winners`),n=Math.floor(this.dealPlayerService.cardsPlayed.length/4);this.renderer.setProperty(e,"innerHTML","");const r=this.renderer.createElement("div"),i=this.renderer.createElement("div"),o=this.renderer.createElement("div"),a=this.renderer.createElement("div");this.renderer.addClass(r,`${s.uV}__round-winners-table`),this.renderer.addClass(i,`${s.uV}__round-winners-header`),this.renderer.setProperty(i,"innerHTML","Trick Takers:"),this.renderer.setProperty(o,"innerHTML","Trick #"),this.renderer.setProperty(a,"innerHTML","Taker"),this.renderer.appendChild(e,i),this.renderer.appendChild(r,o),this.renderer.appendChild(r,a);for(let s=0;s<13;s++){const e=(null===(t=this.dealPlayerService.deal)||void 0===t?void 0:t.roundWinners)[s],i=this.renderer.createElement("div"),o=this.renderer.createElement("div");this.renderer.setProperty(i,"innerHTML",s+1),this.renderer.setProperty(o,"innerHTML",s+1<=n?e[0]:""),this.renderer.appendChild(r,i),this.renderer.appendChild(r,o)}this.renderer.appendChild(e,r)}setDirectionContent(t,e,n){const r=document.querySelector(`.${s.uV}__${n}-suit-number`),i=document.querySelector(`.${s.uV}__${n}-suit-entity`);if(!r||!i)return;let o=s.Nk;e!==s.s7[0]&&e!==s.s7[3]||(o=s.eF),this.renderer.removeClass(r,s.eF),this.renderer.removeClass(i,s.eF),this.renderer.removeClass(r,s.Nk),this.renderer.removeClass(i,s.Nk),this.renderer.addClass(r,o),this.renderer.addClass(i,o),this.renderer.setProperty(r,"innerHTML","10"===t||10===t?"T":t),this.renderer.setProperty(i,"innerHTML",e)}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(l.yh),o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(Ph))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-deal-player"]],hostVars:2,hostBindings:function(t,e){1&t&&o.NdJ("click",function(t){return e.onClick(t)}),2&t&&o.ekj("deal-player",e.classname)},decls:78,vars:123,consts:[[3,"click"],[3,"innerHTML"],[4,"ngIf"],[3,"class",4,"ngIf"],[3,"id"],["type","number","step",".5","min",".5","max","10",3,"value","change"],["type","checkbox",3,"value","change"],[0,"xlink","href","assets/deal-player/sprite.svg#icon-previous-five"],[0,"xlink","href","assets/deal-player/sprite.svg#icon-previous"],[3,"click",4,"ngIf"],[0,"xlink","href","assets/deal-player/sprite.svg#icon-restart"],[0,"xlink","href","assets/deal-player/sprite.svg#icon-next"],[0,"xlink","href","assets/deal-player/sprite.svg#icon-next-five"],[0,"xlink","href","assets/deal-player/sprite.svg#icon-play"],[0,"xlink","href","assets/deal-player/sprite.svg#icon-pause"],[3,"id","src",4,"ngFor","ngForOf"],[3,"id","src"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.NdJ("click",function(){return e.onClose()}),o._uU(1," \u2716\n"),o.qZA(),o.TgZ(2,"section"),o.TgZ(3,"article"),o.TgZ(4,"div"),o._uU(5),o.qZA(),o.TgZ(6,"div"),o._uU(7),o.qZA(),o.TgZ(8,"div"),o._uU(9),o.qZA(),o.qZA(),o.TgZ(10,"div"),o.TgZ(11,"div"),o.TgZ(12,"span"),o._uU(13),o.qZA(),o._UZ(14,"span",1),o.qZA(),o.TgZ(15,"div"),o.TgZ(16,"span"),o._uU(17,"Declarer:\xa0\xa0"),o.qZA(),o.TgZ(18,"span"),o._uU(19),o.qZA(),o.qZA(),o.TgZ(20,"div"),o.TgZ(21,"span"),o._uU(22,"Result:\xa0\xa0"),o.qZA(),o.YNc(23,Jh,2,1,"span",2),o.YNc(24,Kh,2,1,"span",2),o.YNc(25,Xh,2,1,"span",2),o.qZA(),o.qZA(),o.TgZ(26,"div"),o.YNc(27,Qh,3,7,"div",3),o.TgZ(28,"div"),o._UZ(29,"span"),o._UZ(30,"span"),o.qZA(),o.TgZ(31,"div"),o._uU(32),o.qZA(),o.TgZ(33,"div"),o._UZ(34,"span"),o._UZ(35,"span"),o.qZA(),o.TgZ(36,"div"),o._uU(37),o.qZA(),o.TgZ(38,"div"),o._UZ(39,"span"),o._UZ(40,"span"),o.qZA(),o.TgZ(41,"div"),o._uU(42),o.qZA(),o.TgZ(43,"div"),o._UZ(44,"span"),o._UZ(45,"span"),o.qZA(),o.TgZ(46,"div"),o._uU(47),o.qZA(),o.qZA(),o._UZ(48,"canvas",4),o.qZA(),o.TgZ(49,"section"),o.TgZ(50,"div"),o.TgZ(51,"span"),o._uU(52,"Play every\xa0"),o.qZA(),o.TgZ(53,"input",5),o.NdJ("change",function(t){return e.onSpeedChange(t)}),o.qZA(),o.TgZ(54,"span"),o._uU(55,"\xa0seconds."),o.qZA(),o.qZA(),o.TgZ(56,"div"),o.TgZ(57,"span"),o._uU(58,"Center cards?\xa0"),o.qZA(),o.TgZ(59,"input",6),o.NdJ("change",function(t){return e.onCenteredChange(t)}),o.qZA(),o.qZA(),o.qZA(),o.TgZ(60,"section"),o.O4$(),o.TgZ(61,"svg",0),o.NdJ("click",function(){return e.onPreviousFour()}),o._UZ(62,"use",7),o.qZA(),o.TgZ(63,"svg",0),o.NdJ("click",function(){return e.onPrevious()}),o._UZ(64,"use",8),o.qZA(),o.YNc(65,td,2,0,"svg",9),o.YNc(66,ed,2,0,"svg",9),o.TgZ(67,"svg",0),o.NdJ("click",function(){return e.onRestart()}),o._UZ(68,"use",10),o.qZA(),o.TgZ(69,"svg",0),o.NdJ("click",function(){return e.onNext()}),o._UZ(70,"use",11),o.qZA(),o.TgZ(71,"svg",0),o.NdJ("click",function(){return e.onNextFour()}),o._UZ(72,"use",12),o.qZA(),o.qZA(),o.kcU(),o._UZ(73,"section"),o._UZ(74,"section",1),o.ALo(75,"replace"),o.YNc(76,id,2,6,"div",3),o.YNc(77,od,2,6,"div",3)),2&t&&(o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__close"),o.xp6(2),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__canvas"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__summary"),o.xp6(2),o.Oqu(e.name),o.xp6(2),o.Oqu(e.date),o.xp6(2),o.hij("Deal #:\xa0\xa0",e.dealNumber,""),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__deal-info"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__contract"),o.xp6(2),o.hij("Contract:\xa0\xa0",null==e.contract?null:e.contract.prefix,""),o.xp6(1),o.Q6J("innerHTML",null==e.contract?null:e.contract.htmlEntity,o.oJD),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__declarer"),o.xp6(4),o.hij("'",e.declarer,"'"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__result"),o.xp6(3),o.Q6J("ngIf","overtrick"!==e.summaryPost),o.xp6(1),o.Q6J("ngIf",e.summaryNumber),o.xp6(1),o.Q6J("ngIf",e.summaryPost),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__played"),o.xp6(1),o.Q6J("ngIf",e.trickNumber),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__north-suit"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__north-suit-number"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__north-suit-entity"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__north-name"),o.xp6(1),o.hij(" ",null==e.seating?null:e.seating.north," "),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__east-suit"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__east-suit-number"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__east-suit-entity"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__east-name"),o.xp6(1),o.hij(" ",null==e.seating?null:e.seating.east," "),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__south-suit"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__south-suit-number"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__south-suit-entity"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__south-name"),o.xp6(1),o.hij(" ",null==e.seating?null:e.seating.south," "),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__west-suit"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__west-suit-number"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__west-suit-entity"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__west-name"),o.xp6(1),o.hij(" ",null==e.seating?null:e.seating.west," "),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__canvas-element"),o.MGl("id","",e.DEAL_PLAYER_CLASSNAME,"-canvas"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__play"),o.xp6(4),o.Gre("ui input ",e.DEAL_PLAYER_CLASSNAME,"__play-duration"),o.s9C("value",e.cardPlayWaitDuration/1e3),o.xp6(6),o.Gre("ui input ",e.DEAL_PLAYER_CLASSNAME,"__play-centered"),o.Q6J("value",e.keepCardsCentered),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__controls"),o.xp6(5),o.Q6J("ngIf",!e.isPlaying),o.xp6(1),o.Q6J("ngIf",e.isPlaying),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__restart"),o.xp6(6),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__round-winners"),o.xp6(1),o.Gre("",e.DEAL_PLAYER_CLASSNAME,"__bidding"),o.Q6J("innerHTML",o.gM2(75,118,e.biddingTable,"'","",!0),o.oJD),o.xp6(2),o.Q6J("ngIf",!e.isMobile),o.xp6(1),o.Q6J("ngIf",e.isMobile))},directives:[r.O5,r.sg],pipes:[Yh],styles:[""]}),t})(),ld=(()=>{class t{constructor(t){this.searchService=t}get getAreDealsLoaded(){return!this.searchService.getIsLoading()}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(y))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-line-spinner"]],hostVars:2,hostBindings:function(t,e){2&t&&o.ekj("hidden",e.getAreDealsLoaded)},decls:5,vars:0,consts:[[1,"lds-ellipsis"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o._UZ(1,"div"),o._UZ(2,"div"),o._UZ(3,"div"),o._UZ(4,"div"),o.qZA())},styles:[".lds-ellipsis[_ngcontent-%COMP%]{display:inline-block;position:relative;width:80px;height:80px}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:33px;width:13px;height:13px;border-radius:50%;background:#fff;animation-timing-function:cubic-bezier(0,1,1,0)}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{left:8px;animation:lds-ellipsis1 .6s infinite}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){left:8px;animation:lds-ellipsis2 .6s infinite}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(3){left:32px;animation:lds-ellipsis2 .6s infinite}.lds-ellipsis[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(4){left:56px;animation:lds-ellipsis3 .6s infinite}@keyframes lds-ellipsis1{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes lds-ellipsis3{0%{transform:scale(1)}to{transform:scale(0)}}@keyframes lds-ellipsis2{0%{transform:translate(0)}to{transform:translate(24px)}}"]}),t})();const cd=["size"],ud=["sort"],hd=["results"],dd=["currentPage"];function fd(t,e){if(1&t&&(o.TgZ(0,"option",6),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.Q6J("value",t),o.xp6(1),o.hij(" ",t," ")}}function pd(t,e){if(1&t&&(o.TgZ(0,"option",6),o._uU(1),o.qZA()),2&t){const t=e.index;o.Q6J("value",t),o.xp6(1),o.hij(" ",t+1," ")}}function md(t,e){if(1&t&&(o.TgZ(0,"span"),o.TgZ(1,"span"),o.TgZ(2,"b"),o._uU(3),o.qZA(),o._uU(4," out of "),o.TgZ(5,"b"),o._uU(6),o.qZA(),o._uU(7," deals from "),o.qZA(),o.qZA()),2&t){const t=o.oxw(2);o.xp6(3),o.Oqu(t.numberOfDealsMatchingFilters),o.xp6(3),o.Oqu(t.totalNumberOfDeals)}}function gd(t,e){if(1&t&&(o.TgZ(0,"div",17),o.YNc(1,md,8,2,"span",18),o.TgZ(2,"span"),o._uU(3," \xa0"),o.TgZ(4,"b"),o._uU(5),o.qZA(),o._uU(6),o.qZA(),o.TgZ(7,"span"),o._uU(8,"\xa0found:"),o.qZA(),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",-1!==t.numberOfDealsMatchingFilters),o.xp6(4),o.Oqu(t.totalGames),o.xp6(1),o.hij(" matching ",1===t.totalGames?"game was":"games were"," ")}}let yd=(()=>{class t{constructor(t,e,n,r,i,o){this.store=t,this.localStorageManager=e,this.searchService=n,this.elRef=r,this.renderer=i,this.replayerViewerGameService=o,this.DEFAULT_RESULTS_PER_PAGE=100,this.currentlyViewingUser={},this.NOT_AVAILABLE_STRING=s.i1,this.sizeOptions=s.lx,this.sortOptions=s.aP,this.resultsPerPageOptions=s.Ad,this.resultsPerPage=this.DEFAULT_RESULTS_PER_PAGE,this.totalNumberOfPages=-1,this.totalNumberOfDeals=-1,this.currentBatch=0,this.totalGames=-1,this.preferences={},this.numberOfDealsMatchingFilters=-1}get classname(){return!0}getArrayUpToNumber(t){if(t&&!(t<=0))return Array(t).map((t,e)=>e+1)}ngOnInit(){this.store.select(h.zW.deals).subscribe(t=>{var e;this.totalNumberOfDeals=null===(e=t.dealsAsStrings)||void 0===e?void 0:e.length}),this.store.select(h.zW.users).subscribe(t=>{this.currentlyViewingUser=t.currentlyViewingUser}),this.store.select(h.zW.games).subscribe(t=>{var e;this.totalGames=null===(e=t.filteredGames)||void 0===e?void 0:e.length,this.totalNumberOfPages=Math.ceil(this.totalGames/this.resultsPerPage)}),this.store.select(h.zW.filters).subscribe(t=>{this.numberOfDealsMatchingFilters=t.dealsThatMatchFilters.includes(`${u.oc}`)?-1:t.dealsThatMatchFilters.length}),this.replayerViewerGameService.setDefaultResultsPerPage(this.resultsElement),this.preferences=this.localStorageManager.getPreferences(),this.setOptionElementsPerPreferences(),this.replayerViewerGameService.changeGameSize(this.preferences.size),this.replayerViewerGameService.showSearchHideButton(this.elRef)}onCurrentPageChange(t){this.currentBatch=+(t.currentTarget||t.target).value,this.store.dispatch(new u.Mm(this.currentBatch)),this.searchService.setCurrentlyDisplayingGames()}onHide(){const t=this.elRef.nativeElement,e=t.querySelector(`.${s.g5}__size`),n=t.querySelector(`.${s.g5}__results`),r=t.querySelector(`.${s.g5}__hide`);e.classList.contains(s.u$)?(e&&(this.renderer.removeClass(e,s.ze),setTimeout(()=>{this.renderer.removeClass(e,s.u$),this.renderer.removeClass(e,s.AJ)},s.zn/128)),n&&(this.renderer.removeClass(n,s.ze),setTimeout(()=>{this.renderer.removeClass(n,s.u$),this.renderer.removeClass(n,s.zL)},s.zn/128)),r.innerHTML="Hide"):(e&&(this.renderer.addClass(e,s.AJ),this.renderer.addClass(e,s.u$),setTimeout(()=>{this.renderer.addClass(e,s.ze)},s.zn/4)),n&&(this.renderer.addClass(n,s.zL),this.renderer.addClass(n,s.u$),setTimeout(()=>{this.renderer.addClass(n,s.ze)},s.zn/4)),r.innerHTML="Show")}onResultsPerPageChange(t,e=!0){const n=t.currentTarget||t.target;e&&this.localStorageManager.saveResultsPerPagePreference(n.value),this.currentBatch=(0,s.Ah)(this.currentBatch,this.resultsPerPage,+n.value,this.totalGames),this.store.dispatch(new u.Mm(this.currentBatch)),this.replayerViewerGameService.setResultsPerPagePreference(n.value),this.resultsPerPage=+n.value,this.searchService.setCurrentlyDisplayingGames(),this.totalNumberOfPages=(0,s.N_)(+n.value,this.totalGames),this.replayerViewerGameService.selectCurrentPage(this.currentBatch,this.currentPageElement)}onSizeChange(t,e=!0){const n=t.currentTarget||t.target;e&&this.localStorageManager.saveSizePreference(n.value),this.replayerViewerGameService.changeGameSize(n.value)}onSortChange(t,e=!0){const n=t.currentTarget||t.target;e&&this.localStorageManager.saveSortPreference(n.value),this.replayerViewerGameService.setSortPreference(n.value),this.currentBatch=this.currentBatch<=0?this.totalNumberOfPages-1:this.totalNumberOfPages-1-this.currentBatch,this.store.dispatch(new u.Mm(this.currentBatch)),this.searchService.setCurrentlyDisplayingGames(),this.replayerViewerGameService.selectCurrentPage(this.currentBatch,this.currentPageElement)}setOptionElementsPerPreferences(){var t,e,n;const r=null===(t=this.sortElement)||void 0===t?void 0:t.nativeElement,i=null===(e=this.sizeElement)||void 0===e?void 0:e.nativeElement,s=null===(n=this.resultsElement)||void 0===n?void 0:n.nativeElement;if(r){let t=0;this.preferences.sort===this.sortOptions.descending&&(t=1);const e=r.children[t];e.selected=!0,this.onSortChange({target:e},!1);let n=this.sortOptions.ascending;1===t&&(n=this.sortOptions.descending),this.replayerViewerGameService.setSortPreference(n)}if(i){let t=0,e=this.sizeOptions.small;this.preferences.size===this.sizeOptions.medium?(t=1,e=this.sizeOptions.medium):this.preferences.size===this.sizeOptions.large&&(t=2,e=this.sizeOptions.large),i.children[t].selected=!0,this.onSizeChange({target:{value:e}},!1)}if(s){const t=this.resultsPerPageOptions.findIndex(t=>t===+this.preferences.resultsPerPage),e=this.resultsPerPageOptions[t];setTimeout(()=>{const n=s.children[t];n&&(n.selected=!0),this.onResultsPerPageChange({target:{value:e||this.DEFAULT_RESULTS_PER_PAGE}},!1)},50)}}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(l.yh),o.Y36(d),o.Y36(y),o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(Mh))},t.\u0275cmp=o.Xpm({type:t,selectors:[["nx-bridge-games-list-view"]],viewQuery:function(t,e){if(1&t&&(o.Gf(cd,7),o.Gf(ud,7),o.Gf(hd,7),o.Gf(dd,5)),2&t){let t;o.iGM(t=o.CRH())&&(e.sizeElement=t.first),o.iGM(t=o.CRH())&&(e.sortElement=t.first),o.iGM(t=o.CRH())&&(e.resultsElement=t.first),o.iGM(t=o.CRH())&&(e.currentPageElement=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&o.ekj("games-list-view",e.classname)},decls:52,vars:37,consts:[[1,"games-view"],[1,"games-view__title"],[1,"ui","button","bg-color-1","color-white","games-view__hide",3,"click"],[1,"ui","field","games-view__size"],[1,"ui","input",3,"change"],["size",""],[3,"value"],[1,"ui","field","games-view__results"],[3,"change"],["results",""],[3,"value",4,"ngFor","ngForOf"],[1,"ui","field","games-view__sort"],["sort",""],[1,"ui","field","games-view__page"],["currentPage",""],["class","games-view__summary",4,"ngIf"],[1,"page-load__spinner"],[1,"games-view__summary"],[4,"ngIf"]],template:function(t,e){1&t&&(o.TgZ(0,"nx-bridge-grid"),o._UZ(1,"nx-bridge-search"),o.TgZ(2,"section",0),o.TgZ(3,"div",1),o.TgZ(4,"h2"),o._uU(5," Username: \xa0"),o.TgZ(6,"span"),o._uU(7),o.qZA(),o.qZA(),o.TgZ(8,"button",2),o.NdJ("click",function(){return e.onHide()}),o._uU(9," Hide "),o.qZA(),o.TgZ(10,"label",3),o._uU(11," Size:\xa0 "),o.TgZ(12,"select",4,5),o.NdJ("change",function(t){return e.onSizeChange(t)}),o.TgZ(14,"option",6),o._uU(15),o.ALo(16,"titlecase"),o.ALo(17,"slice"),o.qZA(),o.TgZ(18,"option",6),o._uU(19),o.ALo(20,"titlecase"),o.ALo(21,"slice"),o.qZA(),o.TgZ(22,"option",6),o._uU(23),o.ALo(24,"titlecase"),o.ALo(25,"slice"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(26,"label",7),o._uU(27," Results / page:\xa0 "),o.TgZ(28,"select",8,9),o.NdJ("change",function(t){return e.onResultsPerPageChange(t)}),o.YNc(30,fd,2,2,"option",10),o.qZA(),o.qZA(),o.TgZ(31,"label",11),o._uU(32," Sort:\xa0 "),o.TgZ(33,"select",4,12),o.NdJ("change",function(t){return e.onSortChange(t)}),o.TgZ(35,"option",6),o._uU(36),o.ALo(37,"titlecase"),o.qZA(),o.TgZ(38,"option",6),o._uU(39),o.ALo(40,"titlecase"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(41,"label",13),o._uU(42," Page:\xa0 "),o.TgZ(43,"select",8,14),o.NdJ("change",function(t){return e.onCurrentPageChange(t)}),o.YNc(45,pd,2,2,"option",10),o.qZA(),o.TgZ(46,"span"),o._uU(47),o.qZA(),o.qZA(),o.qZA(),o.YNc(48,gd,9,3,"div",15),o._UZ(49,"nx-bridge-games-list"),o.qZA(),o.qZA(),o._UZ(50,"nx-bridge-deal-player"),o._UZ(51,"nx-bridge-line-spinner",16)),2&t&&(o.xp6(7),o.hij("'",e.currentlyViewingUser.username?e.currentlyViewingUser.username:"Player","'"),o.xp6(7),o.s9C("value",e.sizeOptions.small),o.xp6(1),o.hij(" ",o.lcZ(16,15,o.Dn7(17,17,e.sizeOptions.small,0,1))," "),o.xp6(3),o.s9C("value",e.sizeOptions.medium),o.xp6(1),o.hij(" ",o.lcZ(20,21,o.Dn7(21,23,e.sizeOptions.medium,0,1))," "),o.xp6(3),o.s9C("value",e.sizeOptions.large),o.xp6(1),o.hij(" ",o.lcZ(24,27,o.Dn7(25,29,e.sizeOptions.large,0,1))," "),o.xp6(7),o.Q6J("ngForOf",e.resultsPerPageOptions),o.xp6(5),o.s9C("value",e.sortOptions.ascending),o.xp6(1),o.hij(" ",o.lcZ(37,33,e.sortOptions.ascending)," "),o.xp6(2),o.s9C("value",e.sortOptions.descending),o.xp6(1),o.hij(" ",o.lcZ(40,35,e.sortOptions.descending)," "),o.xp6(6),o.Q6J("ngForOf",e.getArrayUpToNumber(e.totalNumberOfPages)),o.xp6(2),o.hij("\xa0of ",e.totalNumberOfPages?e.totalNumberOfPages:e.NOT_AVAILABLE_STRING,""),o.xp6(1),o.Q6J("ngIf",e.totalGames))},directives:[v,sn,It,Bt,r.sg,r.O5,Zh,ad,ld],pipes:[r.rS,r.OU],styles:[""]}),t})(),_d=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez,Th]]}),t})(),vd=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez]]}),t})(),bd=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez]]}),t})(),wd=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[r.ez,bd]]}),t})(),xd=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[zt,r.ez,i.Bz.forChild([{path:"",component:Ah},{path:"games",component:yd}]),Th,_d,vd,bd,wd]]}),t})()},4812:(t,e,n)=>{"use strict";n.d(e,{cd:()=>U,Q2:()=>V,nX:()=>z,HS:()=>$,oJ:()=>H,Mm:()=>lt,pf:()=>G,f1:()=>W,i5:()=>g,KS:()=>c,lL:()=>u,K9:()=>m,G1:()=>x,XL:()=>q,Pm:()=>a,cE:()=>Z,zJ:()=>Y,Ex:()=>J,Fb:()=>l,Ao:()=>y,fm:()=>K,Ms:()=>X,Bn:()=>ct,ND:()=>_,sd:()=>ut,k7:()=>Q,dQ:()=>tt,G4:()=>et,SB:()=>ht,tC:()=>dt,JH:()=>w,SJ:()=>nt,m5:()=>bt,oc:()=>gt});const r="[Deals] SET_DEALS_AS_STRINGS",i="[Deals] SET_FETCHED_DEALS",s="[Deals] SET_CURRENTLY_VIEWING_DEAL",o="[Deals] SET_CURRENTLY_VIEWING_DEAL_CONTRACT";class a{constructor(t){this.payload=t,this.type=r}}class l{constructor(t){this.payload=t,this.type=i}}class c{constructor(t){this.payload=t,this.type=s}}class u{constructor(t){this.payload=t,this.type=o}}const h="[Games] SET_CURRENTLY_VIEWING_GAME",d="[Games] SET_FILTERED_GAMES",f="[Games] SET_CURRENTLY_DISPLAYING_GAMES",p="[Games] SET_IS_VIEWING_GAME";class m{constructor(t){this.payload=t,this.type=h}}class g{constructor(t){this.payload=t,this.type=f}}class y{constructor(t){this.payload=t,this.type=d}}class _{constructor(t){this.payload=t,this.type=p}}const v="[Users] SET_USERS",b="[Users] SET_CURRENTLY_VIEWING_USER";class w{constructor(t){this.payload=t,this.type=v}}class x{constructor(t){this.payload=t,this.type=b}}const S="[Filter] ADD_PLAYER_HAS_CARD",E="[Filter] ADD_PLAYER_IN_GAME_FILTER",A="[Filter] REMOVE_PLAYER_HAS_CARD",T="[Filter] REMOVE_PLAYER_IN_GAME_FILTER",C="[Filter] SET_AFTER_DATE",M="[Filter] SET_BEFORE_DATE",O="[Filter] SET_CONTRACT_FILTER",P="[Filter] SET_DEAL_RESULT_FILTER",D="[Filter] SET_DEALS_THAT_MATCH_FILTERS",R="[Filter] SET_DECLARER_FILTER",L="[Filter] SET_DOUBLE_FILTER",I="[Filter] SET_GAME_NAME_FILTER",N="[Filter] SET_IS_FILTER_SAME",k="[Filter] SET_OPENING_BID_FILTER",F="[Filter] SET_PLAYER_IN_GAME_FILTER",B="[Filter] SET_PLAYER_HAS_CARD",j="[Filter] SET_WON_BY_FILTER";class U{constructor(t){this.payload=t,this.type=S}}class V{constructor(t){this.payload=t,this.type=E}}class z{constructor(t){this.payload=t,this.type=A}}class ${constructor(t){this.payload=t,this.type=T}}class H{constructor(t){this.payload=t,this.type=C}}class G{constructor(t){this.payload=t,this.type=M}}class W{constructor(t){this.payload=t,this.type=O}}class q{constructor(t){this.payload=t,this.type=P}}class Z{constructor(t){this.payload=t,this.type=D}}class Y{constructor(t){this.payload=t,this.type=R}}class J{constructor(t){this.payload=t,this.type=L}}class K{constructor(t){this.payload=t,this.type=I}}class X{constructor(t){this.payload=t,this.type=N}}class Q{constructor(t){this.payload=t,this.type=k}}class tt{constructor(t){this.payload=t,this.type=B}}class et{constructor(t){this.payload=t,this.type=F}}class nt{constructor(t){this.payload=t,this.type=j}}const rt="[General] SET_BATCH_NUMBER",it="[General] SET_IS_LOADING",st="[General] SET_LOADING_ERROR",ot="[General] SET_SORTING_PREFERENCE",at="[General] SET_RESULTS_PER_PAGE_PREFERENCE";class lt{constructor(t){this.payload=t,this.type=rt}}class ct{constructor(t){this.payload=t,this.type=it}}class ut{constructor(t){this.payload=t,this.type=st}}class ht{constructor(t){this.payload=t,this.type=at}}class dt{constructor(t){this.payload=t,this.type=ot}}const ft={dealsAsStrings:[],fetchedDeals:{},currentlyViewingDeal:{},currentlyViewingDealContract:{prefix:"",htmlEntity:"",doubleMultiplier:1}},pt={games:[],currentlyDisplayingGames:[],filteredGames:[],currentlyViewingGame:{},isViewingGame:!1},mt={userIds:{},currentlyViewingUser:{}},gt=-1,yt={afterDate:0,beforeDate:0,contract:`${gt}`,dealResult:{amount:gt,type:`${gt}`},dealsThatMatchFilters:[`${gt}`],declarer:`${gt}`,double:gt,gameName:`${gt}`,isFilterSame:!1,openingBid:`${gt}`,playerHasCard:{initial:[]},playerInGame:[`${gt}`],wonBy:{amount:gt,type:`${gt}`}},_t={batchNumber:0,isLoading:!1,loadingError:"",resultsPerPagePreference:"",sortingPreference:""};var vt=n(2569);const bt={[vt.zW.deals]:function(t=ft,e){switch(e.type){case r:return Object.assign(Object.assign({},t),{dealsAsStrings:e.payload});case i:return Object.assign(Object.assign({},t),{fetchedDeals:e.payload});case"[Deals] ADD_FETCHED_DEALS":return Object.assign(Object.assign({},t),{fetchedDeals:Object.assign(Object.assign({},t.fetchedDeals),e.payload)});case s:return Object.assign(Object.assign({},t),{currentlyViewingDeal:e.payload});case o:return Object.assign(Object.assign({},t),{currentlyViewingDealContract:e.payload});default:return t}},[vt.zW.games]:function(t=pt,e){switch(e.type){case"[Games] SET_GAMES":return Object.assign(Object.assign({},t),{games:e.payload});case h:return Object.assign(Object.assign({},t),{currentlyViewingGame:e.payload});case f:return Object.assign(Object.assign({},t),{currentlyDisplayingGames:e.payload});case d:return Object.assign(Object.assign({},t),{filteredGames:e.payload});case p:return Object.assign(Object.assign({},t),{isViewingGame:e.payload});default:return t}},[vt.zW.users]:(t=mt,e)=>{switch(e.type){case v:return Object.assign(Object.assign({},t),{userIds:e.payload});case b:return Object.assign(Object.assign({},t),{currentlyViewingUser:e.payload});default:return t}},[vt.zW.filters]:function(t=yt,e){switch(e.type){case E:const n=[...t.playerInGame],r=n.findIndex(t=>t===`${gt}`);return-1!==r&&n.splice(r,1),Object.assign(Object.assign({},t),{playerInGame:[...n,e.payload]});case S:const i=Object.assign({},e.payload),s=Object.keys(i)[0],o=t.playerHasCard[s];if(o){const t=[...o];t.push(...i[s]),i[s]=[...t]}return Object.assign(Object.assign({},t),{playerHasCard:Object.assign(Object.assign({},t.playerHasCard),i)});case A:const{username:a,card:l}=e.payload,c=t.playerHasCard[a],u=c.findIndex(t=>t===l),h={[a]:[...c]};if(h[a].splice(u,1),0===h[a].length){const e=Object.assign({},t.playerHasCard);return delete e[a],Object.assign(Object.assign({},t),{playerHasCard:e})}return Object.assign(Object.assign({},t),{playerHasCard:Object.assign(Object.assign({},t.playerHasCard),h)});case T:const d=[...t.playerInGame],f=d.findIndex(t=>e.payload===t);return-1!==f&&d.splice(f,1),Object.assign(Object.assign({},t),{playerInGame:d});case C:return Object.assign(Object.assign({},t),{afterDate:e.payload});case M:return Object.assign(Object.assign({},t),{beforeDate:e.payload});case O:return Object.assign(Object.assign({},t),{contract:e.payload});case P:const p=e.payload;return Object.assign(Object.assign({},t),{dealResult:isNaN(p.amount)?{amount:gt,type:`${gt}`}:p});case D:return Object.assign(Object.assign({},t),{dealsThatMatchFilters:e.payload});case R:return Object.assign(Object.assign({},t),{declarer:e.payload});case L:return Object.assign(Object.assign({},t),{double:e.payload});case I:return Object.assign(Object.assign({},t),{gameName:e.payload});case N:return Object.assign(Object.assign({},t),{isFilterSame:e.payload});case k:return Object.assign(Object.assign({},t),{openingBid:e.payload});case B:return Object.assign(Object.assign({},t),{playerHasCard:e.payload});case F:return Object.assign(Object.assign({},t),{playerInGame:e.payload});case j:const m=e.payload;return Object.assign(Object.assign({},t),{wonBy:isNaN(m.amount)?{amount:gt,type:`${gt}`}:m});default:return t}},[vt.zW.general]:function(t=_t,e){switch(e.type){case rt:return isNaN(e.payload)?t:Object.assign(Object.assign({},t),{batchNumber:e.payload});case it:return Object.assign(Object.assign({},t),{isLoading:e.payload});case st:return Object.assign(Object.assign({},t),{loadingError:e.payload});case at:return Object.assign(Object.assign({},t),{resultsPerPagePreference:e.payload});case ot:return Object.assign(Object.assign({},t),{sortingPreference:e.payload});default:return t}}}},1116:(t,e,n)=>{"use strict";n.d(e,{mr:()=>b,ez:()=>xt,K0:()=>l,uU:()=>_t,Do:()=>x,Nd:()=>vt,V_:()=>h,Ye:()=>S,S$:()=>_,mk:()=>lt,sg:()=>ut,O5:()=>dt,b0:()=>w,lw:()=>c,OU:()=>wt,rS:()=>yt,EM:()=>Et,JF:()=>Ct,w_:()=>a,bD:()=>St,q:()=>s,Mx:()=>at,HT:()=>o});var r=n(5366);let i=null;function s(){return i}function o(t){i||(i=t)}class a{}const l=new r.OlP("DocumentToken");let c=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,r.Yz7)({factory:u,token:t,providedIn:"platform"}),t})();function u(){return(0,r.LFG)(d)}const h=new r.OlP("Location Initialized");let d=(()=>{class t extends c{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return s().getBaseHref(this._doc)}onPopState(t){const e=s().getGlobalEventTarget(this._doc,"window");return e.addEventListener("popstate",t,!1),()=>e.removeEventListener("popstate",t)}onHashChange(t){const e=s().getGlobalEventTarget(this._doc,"window");return e.addEventListener("hashchange",t,!1),()=>e.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){f()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){f()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(l))},t.\u0275prov=(0,r.Yz7)({factory:p,token:t,providedIn:"platform"}),t})();function f(){return!!window.history.pushState}function p(){return new d((0,r.LFG)(l))}function m(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function g(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function y(t){return t&&"?"!==t[0]?"?"+t:t}let _=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,r.Yz7)({factory:v,token:t,providedIn:"root"}),t})();function v(t){const e=(0,r.LFG)(l).location;return new w((0,r.LFG)(c),e&&e.origin||"")}const b=new r.OlP("appBaseHref");let w=(()=>{class t extends _{constructor(t,e){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return m(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+y(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+y(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+y(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformLocation).historyGo)||void 0===n||n.call(e,t)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(c),r.LFG(b,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),x=(()=>{class t extends _{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=e&&(this._baseHref=e)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=m(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+y(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+y(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformLocation).historyGo)||void 0===n||n.call(e,t)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(c),r.LFG(b,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),S=(()=>{class t{constructor(t,e){this._subject=new r.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=g(A(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+y(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,A(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+y(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+y(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformStrategy).historyGo)||void 0===n||n.call(e,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(_),r.LFG(c))},t.normalizeQueryParams=y,t.joinWithSlash=m,t.stripTrailingSlash=g,t.\u0275prov=(0,r.Yz7)({factory:E,token:t,providedIn:"root"}),t})();function E(){return new S((0,r.LFG)(_),(0,r.LFG)(c))}function A(t){return t.replace(/\/index.html$/,"")}var T=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({}),C=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}({}),M=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}({}),O=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}({}),P=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t[1/0]=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}({});function D(t,e){return F((0,r.cg1)(t)[r.wAp.DateFormat],e)}function R(t,e){return F((0,r.cg1)(t)[r.wAp.TimeFormat],e)}function L(t,e){return F((0,r.cg1)(t)[r.wAp.DateTimeFormat],e)}function I(t,e){const n=(0,r.cg1)(t),i=n[r.wAp.NumberSymbols][e];if(void 0===i){if(e===P.CurrencyDecimal)return n[r.wAp.NumberSymbols][P.Decimal];if(e===P.CurrencyGroup)return n[r.wAp.NumberSymbols][P.Group]}return i}const N=r.kL8;function k(t){if(!t[r.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[r.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function F(t,e){for(let n=e;n>-1;n--)if(void 0!==t[n])return t[n];throw new Error("Locale data API: locale data undefined")}function B(t){const[e,n]=t.split(":");return{hours:+e,minutes:+n}}const j=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,U={},V=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var z=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}({}),$=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}({}),H=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}({});function G(t,e,n,r){let i=function(t){if(it(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[e,n=1,r=1]=t.split("-").map(t=>+t);return W(e,n-1,r)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let n;if(n=t.match(j))return function(t){const e=new Date(0);let n=0,r=0;const i=t[8]?e.setUTCFullYear:e.setFullYear,s=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=Number(t[9]+t[10]),r=Number(t[9]+t[11])),i.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));const o=Number(t[4]||0)-n,a=Number(t[5]||0)-r,l=Number(t[6]||0),c=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return s.call(e,o,a,l,c),e}(n)}const e=new Date(t);if(!it(e))throw new Error(`Unable to convert "${t}" into a date`);return e}(t);e=q(n,e)||e;let s,o=[];for(;e;){if(s=V.exec(e),!s){o.push(e);break}{o=o.concat(s.slice(1));const t=o.pop();if(!t)break;e=t}}let a=i.getTimezoneOffset();r&&(a=rt(r,a),i=function(t,e,n){const r=t.getTimezoneOffset();return function(t,e){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+e),t}(t,-1*(rt(e,r)-r))}(i,r));let l="";return o.forEach(t=>{const e=function(t){if(nt[t])return nt[t];let e;switch(t){case"G":case"GG":case"GGG":e=K(H.Eras,M.Abbreviated);break;case"GGGG":e=K(H.Eras,M.Wide);break;case"GGGGG":e=K(H.Eras,M.Narrow);break;case"y":e=J($.FullYear,1,0,!1,!0);break;case"yy":e=J($.FullYear,2,0,!0,!0);break;case"yyy":e=J($.FullYear,3,0,!1,!0);break;case"yyyy":e=J($.FullYear,4,0,!1,!0);break;case"Y":e=et(1);break;case"YY":e=et(2,!0);break;case"YYY":e=et(3);break;case"YYYY":e=et(4);break;case"M":case"L":e=J($.Month,1,1);break;case"MM":case"LL":e=J($.Month,2,1);break;case"MMM":e=K(H.Months,M.Abbreviated);break;case"MMMM":e=K(H.Months,M.Wide);break;case"MMMMM":e=K(H.Months,M.Narrow);break;case"LLL":e=K(H.Months,M.Abbreviated,C.Standalone);break;case"LLLL":e=K(H.Months,M.Wide,C.Standalone);break;case"LLLLL":e=K(H.Months,M.Narrow,C.Standalone);break;case"w":e=tt(1);break;case"ww":e=tt(2);break;case"W":e=tt(1,!0);break;case"d":e=J($.Date,1);break;case"dd":e=J($.Date,2);break;case"c":case"cc":e=J($.Day,1);break;case"ccc":e=K(H.Days,M.Abbreviated,C.Standalone);break;case"cccc":e=K(H.Days,M.Wide,C.Standalone);break;case"ccccc":e=K(H.Days,M.Narrow,C.Standalone);break;case"cccccc":e=K(H.Days,M.Short,C.Standalone);break;case"E":case"EE":case"EEE":e=K(H.Days,M.Abbreviated);break;case"EEEE":e=K(H.Days,M.Wide);break;case"EEEEE":e=K(H.Days,M.Narrow);break;case"EEEEEE":e=K(H.Days,M.Short);break;case"a":case"aa":case"aaa":e=K(H.DayPeriods,M.Abbreviated);break;case"aaaa":e=K(H.DayPeriods,M.Wide);break;case"aaaaa":e=K(H.DayPeriods,M.Narrow);break;case"b":case"bb":case"bbb":e=K(H.DayPeriods,M.Abbreviated,C.Standalone,!0);break;case"bbbb":e=K(H.DayPeriods,M.Wide,C.Standalone,!0);break;case"bbbbb":e=K(H.DayPeriods,M.Narrow,C.Standalone,!0);break;case"B":case"BB":case"BBB":e=K(H.DayPeriods,M.Abbreviated,C.Format,!0);break;case"BBBB":e=K(H.DayPeriods,M.Wide,C.Format,!0);break;case"BBBBB":e=K(H.DayPeriods,M.Narrow,C.Format,!0);break;case"h":e=J($.Hours,1,-12);break;case"hh":e=J($.Hours,2,-12);break;case"H":e=J($.Hours,1);break;case"HH":e=J($.Hours,2);break;case"m":e=J($.Minutes,1);break;case"mm":e=J($.Minutes,2);break;case"s":e=J($.Seconds,1);break;case"ss":e=J($.Seconds,2);break;case"S":e=J($.FractionalSeconds,1);break;case"SS":e=J($.FractionalSeconds,2);break;case"SSS":e=J($.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=X(z.Short);break;case"ZZZZZ":e=X(z.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=X(z.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=X(z.Long);break;default:return null}return nt[t]=e,e}(t);l+=e?e(i,n,a):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function W(t,e,n){const r=new Date(0);return r.setFullYear(t,e,n),r.setHours(0,0,0),r}function q(t,e){const n=function(t){return(0,r.cg1)(t)[r.wAp.LocaleId]}(t);if(U[n]=U[n]||{},U[n][e])return U[n][e];let i="";switch(e){case"shortDate":i=D(t,O.Short);break;case"mediumDate":i=D(t,O.Medium);break;case"longDate":i=D(t,O.Long);break;case"fullDate":i=D(t,O.Full);break;case"shortTime":i=R(t,O.Short);break;case"mediumTime":i=R(t,O.Medium);break;case"longTime":i=R(t,O.Long);break;case"fullTime":i=R(t,O.Full);break;case"short":const e=q(t,"shortTime"),n=q(t,"shortDate");i=Z(L(t,O.Short),[e,n]);break;case"medium":const r=q(t,"mediumTime"),s=q(t,"mediumDate");i=Z(L(t,O.Medium),[r,s]);break;case"long":const o=q(t,"longTime"),a=q(t,"longDate");i=Z(L(t,O.Long),[o,a]);break;case"full":const l=q(t,"fullTime"),c=q(t,"fullDate");i=Z(L(t,O.Full),[l,c])}return i&&(U[n][e]=i),i}function Z(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),t}function Y(t,e,n="-",r,i){let s="";(t<0||i&&t<=0)&&(i?t=1-t:(t=-t,s=n));let o=String(t);for(;o.length<e;)o="0"+o;return r&&(o=o.substr(o.length-e)),s+o}function J(t,e,n=0,r=!1,i=!1){return function(s,o){let a=function(t,e){switch(t){case $.FullYear:return e.getFullYear();case $.Month:return e.getMonth();case $.Date:return e.getDate();case $.Hours:return e.getHours();case $.Minutes:return e.getMinutes();case $.Seconds:return e.getSeconds();case $.FractionalSeconds:return e.getMilliseconds();case $.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,s);if((n>0||a>-n)&&(a+=n),t===$.Hours)0===a&&-12===n&&(a=12);else if(t===$.FractionalSeconds)return l=e,Y(a,3).substr(0,l);var l;const c=I(o,P.MinusSign);return Y(a,e,c,r,i)}}function K(t,e,n=C.Format,i=!1){return function(s,o){return function(t,e,n,i,s,o){switch(n){case H.Months:return function(t,e,n){const i=(0,r.cg1)(t),s=F([i[r.wAp.MonthsFormat],i[r.wAp.MonthsStandalone]],e);return F(s,n)}(e,s,i)[t.getMonth()];case H.Days:return function(t,e,n){const i=(0,r.cg1)(t),s=F([i[r.wAp.DaysFormat],i[r.wAp.DaysStandalone]],e);return F(s,n)}(e,s,i)[t.getDay()];case H.DayPeriods:const a=t.getHours(),l=t.getMinutes();if(o){const t=function(t){const e=(0,r.cg1)(t);return k(e),(e[r.wAp.ExtraData][2]||[]).map(t=>"string"==typeof t?B(t):[B(t[0]),B(t[1])])}(e),n=function(t,e,n){const i=(0,r.cg1)(t);k(i);const s=F([i[r.wAp.ExtraData][0],i[r.wAp.ExtraData][1]],e)||[];return F(s,n)||[]}(e,s,i),o=t.findIndex(t=>{if(Array.isArray(t)){const[e,n]=t,r=a>=e.hours&&l>=e.minutes,i=a<n.hours||a===n.hours&&l<n.minutes;if(e.hours<n.hours){if(r&&i)return!0}else if(r||i)return!0}else if(t.hours===a&&t.minutes===l)return!0;return!1});if(-1!==o)return n[o]}return function(t,e,n){const i=(0,r.cg1)(t),s=F([i[r.wAp.DayPeriodsFormat],i[r.wAp.DayPeriodsStandalone]],e);return F(s,n)}(e,s,i)[a<12?0:1];case H.Eras:return function(t,e){return F((0,r.cg1)(t)[r.wAp.Eras],e)}(e,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(s,o,t,e,n,i)}}function X(t){return function(e,n,r){const i=-1*r,s=I(n,P.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case z.Short:return(i>=0?"+":"")+Y(o,2,s)+Y(Math.abs(i%60),2,s);case z.ShortGMT:return"GMT"+(i>=0?"+":"")+Y(o,1,s);case z.Long:return"GMT"+(i>=0?"+":"")+Y(o,2,s)+":"+Y(Math.abs(i%60),2,s);case z.Extended:return 0===r?"Z":(i>=0?"+":"")+Y(o,2,s)+":"+Y(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}function Q(t){return W(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function tt(t,e=!1){return function(n,r){let i;if(e){const t=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,e=n.getDate();i=1+Math.floor((e+t)/7)}else{const t=Q(n),e=function(t){const e=W(t,0,1).getDay();return W(t,0,1+(e<=4?4:11)-e)}(t.getFullYear()),r=t.getTime()-e.getTime();i=1+Math.round(r/6048e5)}return Y(i,t,I(r,P.MinusSign))}}function et(t,e=!1){return function(n,r){return Y(Q(n).getFullYear(),t,I(r,P.MinusSign),e)}}const nt={};function rt(t,e){t=t.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(n)?e:n}function it(t){return t instanceof Date&&!isNaN(t.valueOf())}class st{}let ot=(()=>{class t extends st{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(N(e||this.locale)(t)){case T.Zero:return"zero";case T.One:return"one";case T.Two:return"two";case T.Few:return"few";case T.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(r.soG))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();function at(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}let lt=(()=>{class t{constructor(t,e,n,r){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&((0,r.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,r.AaK)(t.item)}`);this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(r.ZZ4),r.Y36(r.aQg),r.Y36(r.SBq),r.Y36(r.Qsj))},t.\u0275dir=r.lG2({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class ct{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ut=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new ct(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new ht(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const s=new ht(t,i);e.push(s)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(r.s_b),r.Y36(r.Rgc),r.Y36(r.ZZ4))},t.\u0275dir=r.lG2({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class ht{constructor(t,e){this.record=t,this.view=e}}let dt=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new ft,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){pt("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){pt("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(r.s_b),r.Y36(r.Rgc))},t.\u0275dir=r.lG2({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class ft{constructor(){this.$implicit=null,this.ngIf=null}}function pt(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${(0,r.AaK)(e)}'.`)}function mt(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${(0,r.AaK)(t)}'`)}const gt=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])\S*/g;let yt=(()=>{class t{transform(e){if(null==e)return null;if("string"!=typeof e)throw mt(t,e);return e.replace(gt,t=>t[0].toUpperCase()+t.substr(1).toLowerCase())}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=r.Yjl({name:"titlecase",type:t,pure:!0}),t})(),_t=(()=>{class t{constructor(t){this.locale=t}transform(e,n="mediumDate",r,i){if(null==e||""===e||e!=e)return null;try{return G(e,n,i||this.locale,r)}catch(s){throw mt(t,s.message)}}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(r.soG,16))},t.\u0275pipe=r.Yjl({name:"date",type:t,pure:!0}),t})(),vt=(()=>{class t{constructor(t){this.differs=t,this.keyValues=[]}transform(t,e=bt){if(!t||!(t instanceof Map)&&"object"!=typeof t)return null;this.differ||(this.differ=this.differs.find(t).create());const n=this.differ.diff(t);return n&&(this.keyValues=[],n.forEachItem(t=>{this.keyValues.push({key:t.key,value:t.currentValue})}),this.keyValues.sort(e)),this.keyValues}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(r.aQg,16))},t.\u0275pipe=r.Yjl({name:"keyvalue",type:t,pure:!1}),t})();function bt(t,e){const n=t.key,r=e.key;if(n===r)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(null===n)return 1;if(null===r)return-1;if("string"==typeof n&&"string"==typeof r)return n<r?-1:1;if("number"==typeof n&&"number"==typeof r)return n-r;if("boolean"==typeof n&&"boolean"==typeof r)return n<r?-1:1;const i=String(n),s=String(r);return i==s?0:i<s?-1:1}let wt=(()=>{class t{transform(e,n,r){if(null==e)return null;if(!this.supports(e))throw mt(t,e);return e.slice(n,r)}supports(t){return"string"==typeof t||Array.isArray(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=r.Yjl({name:"slice",type:t,pure:!1}),t})(),xt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({providers:[{provide:st,useClass:ot}]}),t})();const St="browser";let Et=(()=>{class t{}return t.\u0275prov=(0,r.Yz7)({token:t,providedIn:"root",factory:()=>new At((0,r.LFG)(l),window)}),t})();class At{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const n=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const t=r.shadowRoot;if(t){const n=t.getElementById(e)||t.querySelector(`[name="${e}"]`);if(n)return n}r=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),this.attemptFocus(e))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=Tt(this.window.history)||Tt(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function Tt(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class Ct{}},2693:(t,e,n)=>{"use strict";n.d(e,{eN:()=>M,JF:()=>V});var r=n(1116),i=n(5366),s=n(878),o=n(8318),a=n(436),l=n(3835),c=n(9996);class u{}class h{}class d{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),r=n.toLowerCase(),i=t.slice(e+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof d?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new d;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof d?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const i=t.value;if(i){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===i.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class f{encodeKey(t){return p(t)}encodeValue(t){return p(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function p(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}function m(t){return`${t}`}class g{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new f,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(t=>{const r=t.indexOf("="),[i,s]=-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],o=n.get(i)||[];o.push(s),n.set(i,o)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const r=t[n];Array.isArray(r)?r.forEach(t=>{e.push({param:n,value:t,op:"a"})}):e.push({param:n,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new g({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(m(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(m(t.value));-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class y{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}keys(){return this.map.keys()}}function _(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function v(t){return"undefined"!=typeof Blob&&t instanceof Blob}function b(t){return"undefined"!=typeof FormData&&t instanceof FormData}class w{constructor(t,e,n,r){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new d),this.context||(this.context=new y),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new g,this.urlWithParams=e}serializeBody(){return null===this.body?null:_(this.body)||v(this.body)||b(this.body)||"string"==typeof this.body?this.body:this.body instanceof g?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||b(this.body)?null:v(this.body)?this.body.type||null:_(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof g?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var e;const n=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let l=t.headers||this.headers,c=t.params||this.params;const u=null!==(e=t.context)&&void 0!==e?e:this.context;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),l)),t.setParams&&(c=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),c)),new w(n,r,s,{params:c,headers:l,context:u,reportProgress:a,responseType:i,withCredentials:o})}}var x=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class S{constructor(t,e=200,n="OK"){this.headers=t.headers||new d,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class E extends S{constructor(t={}){super(t),this.type=x.ResponseHeader}clone(t={}){return new E({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class A extends S{constructor(t={}){super(t),this.type=x.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new A({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class T extends S{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function C(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let M=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let r;if(t instanceof w)r=t;else{let i,s;i=n.headers instanceof d?n.headers:new d(n.headers),n.params&&(s=n.params instanceof g?n.params:new g({fromObject:n.params})),r=new w(t,e,void 0!==n.body?n.body:null,{headers:i,context:n.context,params:s,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=(0,s.of)(r).pipe((0,a.b)(t=>this.handler.handle(t)));if(t instanceof w||"events"===n.observe)return i;const o=i.pipe((0,l.h)(t=>t instanceof A));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return o.pipe((0,c.U)(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return o.pipe((0,c.U)(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return o.pipe((0,c.U)(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return o.pipe((0,c.U)(t=>t.body))}case"response":return o;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new g).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,C(n,e))}post(t,e,n={}){return this.request("POST",t,C(n,e))}put(t,e,n={}){return this.request("PUT",t,C(n,e))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(u))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class O{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const P=new i.OlP("HTTP_INTERCEPTORS");let D=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const R=/^\)\]\}',?\n/;let L=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new o.y(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const r=t.serializeBody();let i=null;const s=()=>{if(null!==i)return i;const e=1223===n.status?204:n.status,r=n.statusText||"OK",s=new d(n.getAllResponseHeaders()),o=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return i=new E({headers:s,status:e,statusText:r,url:o}),i},o=()=>{let{headers:r,status:i,statusText:o,url:a}=s(),l=null;204!==i&&(l=void 0===n.response?n.responseText:n.response),0===i&&(i=l?200:0);let c=i>=200&&i<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(R,"");try{l=""!==l?JSON.parse(l):null}catch(u){l=t,c&&(c=!1,l={error:u,text:l})}}c?(e.next(new A({body:l,headers:r,status:i,statusText:o,url:a||void 0})),e.complete()):e.error(new T({error:l,headers:r,status:i,statusText:o,url:a||void 0}))},a=t=>{const{url:r}=s(),i=new T({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});e.error(i)};let l=!1;const c=r=>{l||(e.next(s()),l=!0);let i={type:x.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===t.responseType&&n.responseText&&(i.partialText=n.responseText),e.next(i)},u=t=>{let n={type:x.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",o),n.addEventListener("error",a),n.addEventListener("timeout",a),n.addEventListener("abort",a),t.reportProgress&&(n.addEventListener("progress",c),null!==r&&n.upload&&n.upload.addEventListener("progress",u)),n.send(r),e.next({type:x.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("abort",a),n.removeEventListener("load",o),n.removeEventListener("timeout",a),t.reportProgress&&(n.removeEventListener("progress",c),null!==r&&n.upload&&n.upload.removeEventListener("progress",u)),n.readyState!==n.DONE&&n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(r.JF))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const I=new i.OlP("XSRF_COOKIE_NAME"),N=new i.OlP("XSRF_HEADER_NAME");class k{}let F=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,r.Mx)(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(r.K0),i.LFG(i.Lbi),i.LFG(I))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),B=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const r=this.tokenService.getToken();return null===r||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,r)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(k),i.LFG(N))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),j=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(P,[]);this.chain=t.reduceRight((t,e)=>new O(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(h),i.LFG(i.zs3))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),U=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:B,useClass:D}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:I,useValue:e.cookieName}:[],e.headerName?{provide:N,useValue:e.headerName}:[]]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[B,{provide:P,useExisting:B,multi:!0},{provide:k,useClass:F},{provide:I,useValue:"XSRF-TOKEN"},{provide:N,useValue:"X-XSRF-TOKEN"}]}),t})(),V=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[M,{provide:u,useClass:j},L,{provide:h,useExisting:L}],imports:[[U.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})()},5366:(t,e,n)=>{"use strict";n.d(e,{deG:()=>an,tb:()=>ql,AFp:()=>zl,ip1:()=>Ul,CZH:()=>Vl,hGG:()=>Uc,z2F:()=>Pc,sBO:()=>Na,Sil:()=>ic,_Vd:()=>sa,EJc:()=>Jl,SBq:()=>ca,qLn:()=>Tr,vpe:()=>bl,gxx:()=>hs,tBr:()=>Cn,XFs:()=>O,OlP:()=>on,zs3:()=>Ts,ZZ4:()=>Ma,aQg:()=>Pa,soG:()=>Yl,YKP:()=>Ga,v3s:()=>Rc,h0i:()=>Ha,PXZ:()=>Ac,R0b:()=>ac,FiY:()=>Mn,Lbi:()=>Wl,g9A:()=>Gl,Qsj:()=>da,FYo:()=>ha,JOm:()=>Or,Tiy:()=>pa,q3G:()=>yr,tp0:()=>On,EAV:()=>Nc,Rgc:()=>Ua,dDg:()=>pc,DyG:()=>ln,GfV:()=>ma,s_b:()=>qa,ifc:()=>N,eFA:()=>Tc,G48:()=>Sc,Gpc:()=>f,X6Q:()=>xc,_c5:()=>Bc,VLi:()=>yc,c2e:()=>Zl,zSh:()=>fs,wAp:()=>Go,vHH:()=>g,EiD:()=>mr,mCW:()=>Xn,qzn:()=>Vn,JVY:()=>$n,pB0:()=>qn,eBb:()=>Gn,L6k:()=>Hn,LAX:()=>Wn,cg1:()=>zo,Tjo:()=>Fc,kL8:()=>$o,yhl:()=>zn,dqk:()=>U,sIi:()=>ks,CqO:()=>ro,QGY:()=>eo,F4k:()=>no,RDi:()=>At,AaK:()=>u,z3N:()=>Un,qOj:()=>Ms,TTD:()=>_t,_Bn:()=>na,xp6:()=>gi,uIk:()=>Vs,Tol:()=>xo,Gre:()=>ko,MT6:()=>Fo,ekj:()=>wo,Suo:()=>Il,Xpm:()=>K,lG2:()=>it,Yz7:()=>b,cJS:()=>w,oAB:()=>et,Yjl:()=>st,Y36:()=>Ws,_UZ:()=>Ks,BQk:()=>Qs,ynx:()=>Xs,qZA:()=>Js,TgZ:()=>Ys,EpF:()=>to,n5z:()=>tn,Ikx:()=>Bo,LFG:()=>En,$8M:()=>nn,NdJ:()=>io,CRH:()=>Nl,kcU:()=>_e,O4$:()=>ye,oxw:()=>ao,ALo:()=>dl,lcZ:()=>fl,xi3:()=>pl,Dn7:()=>ml,gM2:()=>gl,Hsn:()=>uo,F$t:()=>co,Q6J:()=>qs,s9C:()=>ho,MGl:()=>fo,hYB:()=>po,DdM:()=>ll,WLB:()=>cl,iGM:()=>Rl,MAs:()=>Gs,CHM:()=>Ht,oJD:()=>_r,LSH:()=>vr,kYT:()=>nt,YNc:()=>Hs,W1O:()=>jl,_uU:()=>Lo,Oqu:()=>Io,hij:()=>No,Gf:()=>Ll});var r=n(5959),i=n(7570),s=n(8318),o=n(1906),a=n(1055);function l(t){for(let e in t)if(t[e]===l)return e;throw Error("Could not find renamed property on target object.")}function c(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function u(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(u).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function h(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const d=l({__forward_ref__:l});function f(t){return t.__forward_ref__=f,t.toString=function(){return u(this())},t}function p(t){return m(t)?t():t}function m(t){return"function"==typeof t&&t.hasOwnProperty(d)&&t.__forward_ref__===f}class g extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function y(t){return"string"==typeof t?t:null==t?"":String(t)}function _(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():y(t)}function v(t,e){const n=e?` in ${e}`:"";throw new g("201",`No provider for ${_(t)} found${n}`)}function b(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function w(t){return{providers:t.providers||[],imports:t.imports||[]}}function x(t){return S(t,A)||S(t,C)}function S(t,e){return t.hasOwnProperty(e)?t[e]:null}function E(t){return t&&(t.hasOwnProperty(T)||t.hasOwnProperty(M))?t[T]:null}const A=l({"\u0275prov":l}),T=l({"\u0275inj":l}),C=l({ngInjectableDef:l}),M=l({ngInjectorDef:l});var O=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});let P;function D(t){const e=P;return P=t,e}function R(t,e,n){const r=x(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&O.Optional?null:void 0!==e?e:void v(u(t),"Injector")}function L(t){return{toString:t}.toString()}var I=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),N=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const k="undefined"!=typeof globalThis&&globalThis,F="undefined"!=typeof window&&window,B="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,j="undefined"!=typeof global&&global,U=k||j||F||B,V={},z=[],$=l({"\u0275cmp":l}),H=l({"\u0275dir":l}),G=l({"\u0275pipe":l}),W=l({"\u0275mod":l}),q=l({"\u0275loc":l}),Z=l({"\u0275fac":l}),Y=l({__NG_ELEMENT_ID__:l});let J=0;function K(t){return L(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===I.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||z,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||N.Emulated,id:"c",styles:t.styles||z,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,i=t.features,s=t.pipes;return n.id+=J++,n.inputs=rt(t.inputs,e),n.outputs=rt(t.outputs),i&&i.forEach(t=>t(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(X):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map(Q):null,n})}function X(t){return ot(t)||function(t){return t[H]||null}(t)}function Q(t){return function(t){return t[G]||null}(t)}const tt={};function et(t){return L(()=>{const e={type:t.type,bootstrap:t.bootstrap||z,declarations:t.declarations||z,imports:t.imports||z,exports:t.exports||z,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(tt[t.id]=t.type),e})}function nt(t,e){return L(()=>{const n=at(t,!0);n.declarations=e.declarations||z,n.imports=e.imports||z,n.exports=e.exports||z})}function rt(t,e){if(null==t)return V;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}const it=K;function st(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function ot(t){return t[$]||null}function at(t,e){const n=t[W]||null;if(!n&&!0===e)throw new Error(`Type ${u(t)} does not have '\u0275mod' property.`);return n}const lt=20,ct=10;function ut(t){return Array.isArray(t)&&"object"==typeof t[1]}function ht(t){return Array.isArray(t)&&!0===t[1]}function dt(t){return 0!=(8&t.flags)}function ft(t){return 2==(2&t.flags)}function pt(t){return 1==(1&t.flags)}function mt(t){return null!==t.template}function gt(t,e){return t.hasOwnProperty(Z)?t[Z]:null}class yt{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function _t(){return vt}function vt(t){return t.type.prototype.ngOnChanges&&(t.setInput=wt),bt}function bt(){const t=xt(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===V)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function wt(t,e,n,r){const i=xt(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:V,current:null}),s=i.current||(i.current={}),o=i.previous,a=this.declaredInputs[n],l=o[a];s[a]=new yt(l&&l.currentValue,e,o===V),t[r]=e}function xt(t){return t.__ngSimpleChanges__||null}_t.ngInherit=!0;const St="http://www.w3.org/2000/svg";let Et;function At(t){Et=t}function Tt(){return void 0!==Et?Et:"undefined"!=typeof document?document:void 0}function Ct(t){return!!t.listen}const Mt={createRenderer:(t,e)=>Tt()};function Ot(t){for(;Array.isArray(t);)t=t[0];return t}function Pt(t,e){return Ot(e[t])}function Dt(t,e){return Ot(e[t.index])}function Rt(t,e){return t.data[e]}function Lt(t,e){return t[e]}function It(t,e){const n=e[t];return ut(n)?n:n[0]}function Nt(t){return 4==(4&t[2])}function kt(t){return 128==(128&t[2])}function Ft(t,e){return null==e?null:t[e]}function Bt(t){t[18]=0}function jt(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Ut={lFrame:ue(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Vt(){return Ut.bindingsEnabled}function zt(){return Ut.lFrame.lView}function $t(){return Ut.lFrame.tView}function Ht(t){return Ut.lFrame.contextLView=t,t[8]}function Gt(){let t=Wt();for(;null!==t&&64===t.type;)t=t.parent;return t}function Wt(){return Ut.lFrame.currentTNode}function qt(t,e){const n=Ut.lFrame;n.currentTNode=t,n.isParent=e}function Zt(){return Ut.lFrame.isParent}function Yt(){Ut.lFrame.isParent=!1}function Jt(){return Ut.isInCheckNoChangesMode}function Kt(t){Ut.isInCheckNoChangesMode=t}function Xt(){const t=Ut.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function Qt(){return Ut.lFrame.bindingIndex}function te(){return Ut.lFrame.bindingIndex++}function ee(t){const e=Ut.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function ne(t,e){const n=Ut.lFrame;n.bindingIndex=n.bindingRootIndex=t,re(e)}function re(t){Ut.lFrame.currentDirectiveIndex=t}function ie(){return Ut.lFrame.currentQueryIndex}function se(t){Ut.lFrame.currentQueryIndex=t}function oe(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function ae(t,e,n){if(n&O.SkipSelf){let r=e,i=t;for(;r=r.parent,!(null!==r||n&O.Host||(r=oe(i),null===r)||(i=i[15],10&r.type)););if(null===r)return!1;e=r,t=i}const r=Ut.lFrame=ce();return r.currentTNode=e,r.lView=t,!0}function le(t){const e=ce(),n=t[1];Ut.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function ce(){const t=Ut.lFrame,e=null===t?null:t.child;return null===e?ue(t):e}function ue(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function he(){const t=Ut.lFrame;return Ut.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const de=he;function fe(){const t=he();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function pe(){return Ut.lFrame.selectedIndex}function me(t){Ut.lFrame.selectedIndex=t}function ge(){const t=Ut.lFrame;return Rt(t.tView,t.selectedIndex)}function ye(){Ut.lFrame.currentNamespace=St}function _e(){Ut.lFrame.currentNamespace=null}function ve(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=e;r&&(t.contentHooks||(t.contentHooks=[])).push(-n,r),i&&((t.contentHooks||(t.contentHooks=[])).push(n,i),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,i)),s&&(t.viewHooks||(t.viewHooks=[])).push(-n,s),o&&((t.viewHooks||(t.viewHooks=[])).push(n,o),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,o)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(n,a)}}function be(t,e,n){Se(t,e,3,n)}function we(t,e,n,r){(3&t[2])===n&&Se(t,e,n,r)}function xe(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function Se(t,e,n,r){const i=null!=r?r:-1,s=e.length-1;let o=0;for(let a=void 0!==r?65535&t[18]:0;a<s;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=r&&o>=r)break}else e[a]<0&&(t[18]+=65536),(o<i||-1==i)&&(Ee(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function Ee(t,e,n,r){const i=n[r]<0,s=n[r+1],o=t[i?-n[r]:n[r]];if(i){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}const Ae=-1;class Te{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function Ce(t,e,n){const r=Ct(t);let i=0;for(;i<n.length;){const s=n[i];if("number"==typeof s){if(0!==s)break;i++;const o=n[i++],a=n[i++],l=n[i++];r?t.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=n[++i];Oe(o)?r&&t.setProperty(e,o,a):r?t.setAttribute(e,o,a):e.setAttribute(o,a),i++}}return i}function Me(t){return 3===t||4===t||6===t}function Oe(t){return 64===t.charCodeAt(0)}function Pe(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||De(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function De(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const n=t[s++];if("number"==typeof n){if(n===e){o=-1;break}if(n>e){o=s-1;break}}}for(;s<t.length;){const e=t[s];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}function Re(t){return t!==Ae}function Le(t){return 32767&t}function Ie(t,e){let n=t>>16,r=e;for(;n>0;)r=r[15],n--;return r}let Ne=!0;function ke(t){const e=Ne;return Ne=t,e}let Fe=0;function Be(t,e){const n=Ue(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,je(r.data,t),je(e,null),je(r.blueprint,null));const i=Ve(t,e),s=t.injectorIndex;if(Re(i)){const t=Le(i),n=Ie(i,e),r=n[1].data;for(let i=0;i<8;i++)e[s+i]=n[t+i]|r[t+i]}return e[s+8]=i,s}function je(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Ue(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Ve(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){const t=i[1],e=t.type;if(r=2===e?t.declTNode:1===e?i[6]:null,null===r)return Ae;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return Ae}function ze(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Y)&&(r=n[Y]),null==r&&(r=n[Y]=Fe++);const i=255&r;e.data[t+(i>>5)]|=1<<i}(t,e,n)}function $e(t,e,n){if(n&O.Optional)return t;v(e,"NodeInjector")}function He(t,e,n,r){if(n&O.Optional&&void 0===r&&(r=null),0==(n&(O.Self|O.Host))){const i=t[9],s=D(void 0);try{return i?i.get(e,r,n&O.Optional):R(e,r,n&O.Optional)}finally{D(s)}}return $e(r,e,n)}function Ge(t,e,n,r=O.Default,i){if(null!==t){const s=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Y)?t[Y]:void 0;return"number"==typeof e?e>=0?255&e:qe:e}(n);if("function"==typeof s){if(!ae(e,t,r))return r&O.Host?$e(i,n,r):He(e,n,r,i);try{const t=s(r);if(null!=t||r&O.Optional)return t;v(n)}finally{de()}}else if("number"==typeof s){let i=null,o=Ue(t,e),a=Ae,l=r&O.Host?e[16][6]:null;for((-1===o||r&O.SkipSelf)&&(a=-1===o?Ve(t,e):e[o+8],a!==Ae&&Xe(r,!1)?(i=e[1],o=Le(a),e=Ie(a,e)):o=-1);-1!==o;){const t=e[1];if(Ke(s,o,t.data)){const t=Ze(o,e,n,i,r,l);if(t!==We)return t}a=e[o+8],a!==Ae&&Xe(r,e[1].data[o+8]===l)&&Ke(s,o,e)?(i=t,o=Le(a),e=Ie(a,e)):o=-1}}}return He(e,n,r,i)}const We={};function qe(){return new Qe(Gt(),zt())}function Ze(t,e,n,r,i,s){const o=e[1],a=o.data[t+8],l=Ye(a,o,n,null==r?ft(a)&&Ne:r!=o&&0!=(3&a.type),i&O.Host&&s===a);return null!==l?Je(e,o,l,a):We}function Ye(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,c=s>>20,u=i?a+c:t.directiveEnd;for(let h=r?a:a+c;h<u;h++){const t=o[h];if(h<l&&n===t||h>=l&&t.type===n)return h}if(i){const t=o[l];if(t&&mt(t)&&t.type===n)return l}return null}function Je(t,e,n,r){let i=t[n];const s=e.data;if(i instanceof Te){const o=i;o.resolving&&function(t,e){throw new g("200",`Circular dependency in DI detected for ${t}`)}(_(s[n]));const a=ke(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?D(o.injectImpl):null;ae(t,r,O.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const r=vt(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==l&&D(l),ke(a),o.resolving=!1,de()}}return i}function Ke(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function Xe(t,e){return!(t&O.Self||t&O.Host&&e)}class Qe{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Ge(this._tNode,this._lView,t,void 0,e)}}function tn(t){return L(()=>{const e=t.prototype.constructor,n=e[Z]||en(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const t=i[Z]||en(i);if(t&&t!==n)return t;i=Object.getPrototypeOf(i)}return t=>new t})}function en(t){return m(t)?()=>{const e=en(p(t));return e&&e()}:gt(t)}function nn(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let r=0;for(;r<t;){const i=n[r];if(Me(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<t&&"string"==typeof n[r];)r++;else{if(i===e)return n[r+1];r+=2}}}return null}(Gt(),t)}const rn="__parameters__";function sn(t,e,n){return L(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty(rn)?t[rn]:Object.defineProperty(t,rn,{value:[]})[rn];for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class on{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=b({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const an=new on("AnalyzeForEntryComponents"),ln=Function;function cn(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?(e===t&&(e=t.slice(0,n)),cn(r,e)):e!==t&&e.push(r)}return e}function un(t,e){t.forEach(t=>Array.isArray(t)?un(t,e):e(t))}function hn(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function dn(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function fn(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function pn(t,e,n){let r=gn(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function mn(t,e){const n=gn(t,e);if(n>=0)return t[1|n]}function gn(t,e){return function(t,e,n){let r=0,i=t.length>>1;for(;i!==r;){const n=r+(i-r>>1),s=t[n<<1];if(e===s)return n<<1;s>e?i=n:r=n+1}return~(i<<1)}(t,e)}const yn={},_n=/\n/gm,vn="__source",bn=l({provide:String,useValue:l});let wn;function xn(t){const e=wn;return wn=t,e}function Sn(t,e=O.Default){if(void 0===wn)throw new Error("inject() must be called from an injection context");return null===wn?R(t,void 0,e):wn.get(t,e&O.Optional?null:void 0,e)}function En(t,e=O.Default){return(P||Sn)(p(t),e)}function An(t){const e=[];for(let n=0;n<t.length;n++){const r=p(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t,n=O.Default;for(let e=0;e<r.length;e++){const i=r[e],s=i.__NG_DI_FLAG__;"number"==typeof s?-1===s?t=i.token:n|=s:t=i}e.push(En(t,n))}else e.push(En(r))}return e}function Tn(t,e){return t.__NG_DI_FLAG__=e,t.prototype.__NG_DI_FLAG__=e,t}const Cn=Tn(sn("Inject",t=>({token:t})),-1),Mn=Tn(sn("Optional"),8),On=Tn(sn("SkipSelf"),4);let Pn,Dn;function Rn(t){var e;return(null===(e=function(){if(void 0===Pn&&(Pn=null,U.trustedTypes))try{Pn=U.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(e){}return Pn}())||void 0===e?void 0:e.createHTML(t))||t}function Ln(t){var e;return(null===(e=function(){if(void 0===Dn&&(Dn=null,U.trustedTypes))try{Dn=U.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(e){}return Dn}())||void 0===e?void 0:e.createHTML(t))||t}class In{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Nn extends In{getTypeName(){return"HTML"}}class kn extends In{getTypeName(){return"Style"}}class Fn extends In{getTypeName(){return"Script"}}class Bn extends In{getTypeName(){return"URL"}}class jn extends In{getTypeName(){return"ResourceURL"}}function Un(t){return t instanceof In?t.changingThisBreaksApplicationSecurity:t}function Vn(t,e){const n=zn(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}function zn(t){return t instanceof In&&t.getTypeName()||null}function $n(t){return new Nn(t)}function Hn(t){return new kn(t)}function Gn(t){return new Fn(t)}function Wn(t){return new Bn(t)}function qn(t){return new jn(t)}class Zn{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Rn(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class Yn{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const e=this.inertDocument.createElement("body");t.appendChild(e)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Rn(t),e;const n=this.inertDocument.createElement("body");return n.innerHTML=Rn(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Jn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Kn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Xn(t){return(t=String(t)).match(Jn)||t.match(Kn)?t:"unsafe:"+t}function Qn(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function tr(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const er=Qn("area,br,col,hr,img,wbr"),nr=Qn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),rr=Qn("rp,rt"),ir=tr(rr,nr),sr=tr(er,tr(nr,Qn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),tr(rr,Qn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ir),or=Qn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ar=Qn("srcset"),lr=tr(or,ar,Qn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Qn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),cr=Qn("script,style,template");class ur{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!sr.hasOwnProperty(e))return this.sanitizedSomething=!0,!cr.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,s=e.toLowerCase();if(!lr.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let o=t.value;or[s]&&(o=Xn(o)),ar[s]&&(r=o,o=(r=String(r)).split(",").map(t=>Xn(t.trim())).join(", ")),this.buf.push(" ",e,'="',fr(o),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();sr.hasOwnProperty(e)&&!er.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(fr(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const hr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,dr=/([^\#-~ |!])/g;function fr(t){return t.replace(/&/g,"&amp;").replace(hr,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(dr,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let pr;function mr(t,e){let n=null;try{pr=pr||function(t){const e=new Yn(t);return function(){try{return!!(new window.DOMParser).parseFromString(Rn(""),"text/html")}catch(t){return!1}}()?new Zn(e):e}(t);let r=e?String(e):"";n=pr.getInertBodyElement(r);let i=5,s=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=n.innerHTML,n=pr.getInertBodyElement(r)}while(r!==s);return Rn((new ur).sanitizeChildren(gr(n)||n))}finally{if(n){const t=gr(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}function gr(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var yr=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function _r(t){const e=br();return e?Ln(e.sanitize(yr.HTML,t)||""):Vn(t,"HTML")?Ln(Un(t)):mr(Tt(),y(t))}function vr(t){const e=br();return e?e.sanitize(yr.URL,t)||"":Vn(t,"URL")?Un(t):Xn(y(t))}function br(){const t=zt();return t&&t[12]}function wr(t,e){t.__ngContext__=e}function xr(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Sr(t){return t.ngDebugContext}function Er(t){return t.ngOriginalError}function Ar(t,...e){t.error(...e)}class Tr{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||Ar}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?Sr(t)?Sr(t):this._findContext(Er(t)):null}_findOriginalError(t){let e=Er(t);for(;e&&Er(e);)e=Er(e);return e}}const Cr=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(U))();function Mr(t){return t instanceof Function?t():t}var Or=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});function Pr(t,e){return(void 0)(t,e)}function Dr(t){const e=t[3];return ht(e)?e[3]:e}function Rr(t){return Ir(t[13])}function Lr(t){return Ir(t[4])}function Ir(t){for(;null!==t&&!ht(t);)t=t[4];return t}function Nr(t,e,n,r,i){if(null!=r){let s,o=!1;ht(r)?s=r:ut(r)&&(o=!0,r=r[0]);const a=Ot(r);0===t&&null!==n?null==i?$r(e,n,a):zr(e,n,a,i||null,!0):1===t&&null!==n?zr(e,n,a,i||null,!0):2===t?function(t,e,n){const r=Gr(t,e);r&&function(t,e,n,r){Ct(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function(t,e,n,r,i){const s=n[7];s!==Ot(n)&&Nr(e,t,r,s,i);for(let o=ct;o<n.length;o++){const i=n[o];Qr(i[1],i,t,e,r,s)}}(e,t,s,n,i)}}function kr(t,e,n){return Ct(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Fr(t,e){const n=t[9],r=n.indexOf(e),i=e[3];1024&e[2]&&(e[2]&=-1025,jt(i,-1)),n.splice(r,1)}function Br(t,e){if(t.length<=ct)return;const n=ct+e,r=t[n];if(r){const s=r[17];null!==s&&s!==t&&Fr(s,r),e>0&&(t[n-1][4]=r[4]);const o=dn(t,ct+e);Qr(r[1],i=r,i[11],2,null,null),i[0]=null,i[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}var i;return r}function jr(t,e){if(!(256&e[2])){const n=e[11];Ct(n)&&n.destroyNode&&Qr(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Ur(t[1],t);for(;e;){let n=null;if(ut(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)ut(e)&&Ur(e[1],e),e=e[3];null===e&&(e=t),ut(e)&&Ur(e[1],e),n=e&&e[4]}e=n}}(e)}}function Ur(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];if(!(t instanceof Te)){const e=n[r+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2){const r=t[e[n]],i=e[n+1];try{i.call(r)}finally{}}else try{e.call(t)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,r=e[7];let i=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const t=n[s+1],o="function"==typeof t?t(e):Ot(e[t]),a=r[i=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],a,l):l>=0?r[i=l]():r[i=-l].unsubscribe(),s+=2}else{const t=r[i=n[s+1]];n[s].call(t)}if(null!==r){for(let t=i+1;t<r.length;t++)(0,r[t])();e[7]=null}}(t,e),1===e[1].type&&Ct(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&ht(e[3])){n!==e[3]&&Fr(n,e);const r=e[19];null!==r&&r.detachView(t)}}}function Vr(t,e,n){return function(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[0];if(2&r.flags){const e=t.data[r.directiveStart].encapsulation;if(e===N.None||e===N.Emulated)return null}return Dt(r,n)}(t,e.parent,n)}function zr(t,e,n,r,i){Ct(t)?t.insertBefore(e,n,r,i):e.insertBefore(n,r,i)}function $r(t,e,n){Ct(t)?t.appendChild(e,n):e.appendChild(n)}function Hr(t,e,n,r,i){null!==r?zr(t,e,n,r,i):$r(t,e,n)}function Gr(t,e){return Ct(t)?t.parentNode(e):e.parentNode}function Wr(t,e,n){return qr(t,e,n)}let qr=function(t,e,n){return 40&t.type?Dt(t,n):null};function Zr(t,e,n,r){const i=Vr(t,r,e),s=e[11],o=Wr(r.parent||e[6],r,e);if(null!=i)if(Array.isArray(n))for(let a=0;a<n.length;a++)Hr(s,i,n[a],o,!1);else Hr(s,i,n,o,!1)}function Yr(t,e){if(null!==e){const n=e.type;if(3&n)return Dt(e,t);if(4&n)return Kr(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return Yr(t,n);{const n=t[e.index];return ht(n)?Kr(-1,n):Ot(n)}}if(32&n)return Pr(e,t)()||Ot(t[e.index]);{const n=Jr(t,e);return null!==n?Array.isArray(n)?n[0]:Yr(Dr(t[16]),n):Yr(t,e.next)}}return null}function Jr(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Kr(t,e){const n=ct+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return Yr(t,r)}return e[7]}function Xr(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],l=n.type;if(o&&0===e&&(a&&wr(Ot(a),r),n.flags|=4),64!=(64&n.flags))if(8&l)Xr(t,e,n.child,r,i,s,!1),Nr(e,t,i,a,s);else if(32&l){const o=Pr(n,r);let l;for(;l=o();)Nr(e,t,i,l,s);Nr(e,t,i,a,s)}else 16&l?ti(t,e,r,n,i,s):Nr(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Qr(t,e,n,r,i,s){Xr(n,r,t.firstChild,e,i,s,!1)}function ti(t,e,n,r,i,s){const o=n[16],a=o[6].projection[r.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Nr(e,t,i,a[l],s);else Xr(t,e,a,o[3],i,s,!0)}function ei(t,e,n){Ct(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function ni(t,e,n){Ct(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function ri(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const n=e.length;if(i+n===r||t.charCodeAt(i+n)<=32)return i}n=i+1}}const ii="ng-template";function si(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==ri(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function oi(t){return 4===t.type&&t.value!==ii}function ai(t,e,n){return e===(4!==t.type||n?t.value:ii)}function li(t,e,n){let r=4;const i=t.attrs||[],s=function(t){for(let e=0;e<t.length;e++)if(Me(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&r){if(r=2|1&r,""!==l&&!ai(t,l,n)||""===l&&1===e.length){if(ci(r))return!1;o=!0}}else{const c=8&r?l:e[++a];if(8&r&&null!==t.attrs){if(!si(t.attrs,c,n)){if(ci(r))return!1;o=!0}continue}const u=ui(8&r?"class":l,i,oi(t),n);if(-1===u){if(ci(r))return!1;o=!0;continue}if(""!==c){let t;t=u>s?"":i[u+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==ri(e,c,0)||2&r&&c!==t){if(ci(r))return!1;o=!0}}}}else{if(!o&&!ci(r)&&!ci(l))return!1;if(o&&ci(l))continue;o=!1,r=l|1&r}}return ci(r)||o}function ci(t){return 0==(1&t)}function ui(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let n=!1;for(;i<e.length;){const r=e[i];if(r===t)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++i];for(;"string"==typeof t;)t=e[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function hi(t,e,n=!1){for(let r=0;r<e.length;r++)if(li(t,e[r],n))return!0;return!1}function di(t,e){t:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let e=0;e<t.length;e++)if(t[e]!==r[e])continue t;return!0}}return!1}function fi(t,e){return t?":not("+e.trim()+")":e}function pi(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const e=t[++n];i+="["+o+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""===i||ci(o)||(e+=fi(s,i),i=""),r=o,s=s||!ci(r);n++}return""!==i&&(e+=fi(s,i)),e}const mi={};function gi(t){yi($t(),zt(),pe()+t,Jt())}function yi(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&be(e,r,n)}else{const r=t.preOrderHooks;null!==r&&we(e,r,0,n)}me(n)}function _i(t,e){return t<<17|e<<2}function vi(t){return t>>17&32767}function bi(t){return 2|t}function wi(t){return(131068&t)>>2}function xi(t,e){return-131069&t|e<<2}function Si(t){return 1|t}function Ei(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],s=n[r+1];if(-1!==s){const n=t.data[s];se(i),n.contentQueries(2,e[s],s)}}}function Ai(t,e,n,r,i,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=i,u[2]=140|r,Bt(u),u[3]=u[15]=t,u[8]=n,u[10]=o||t&&t[10],u[11]=a||t&&t[11],u[12]=l||t&&t[12]||null,u[9]=c||t&&t[9]||null,u[6]=s,u[16]=2==e.type?t[16]:u,u}function Ti(t,e,n,r,i){let s=t.data[e];if(null===s)s=function(t,e,n,r,i){const s=Wt(),o=Zt(),a=t.data[e]=function(t,e,n,r,i,s){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}(t,e,n,r,i),Ut.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const t=function(){const t=Ut.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===t?-1:t.injectorIndex}return qt(s,!0),s}function Ci(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Mi(t,e,n){le(e);try{const r=t.viewQuery;null!==r&&is(1,r,n);const i=t.template;null!==i&&Di(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Ei(t,e),t.staticViewQueries&&is(2,t.viewQuery,n);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)Qi(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),r}finally{e[2]&=-5,fe()}}function Oi(t,e,n,r){const i=e[2];if(256==(256&i))return;le(e);const s=Jt();try{Bt(e),Ut.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Di(t,e,n,2,r);const o=3==(3&i);if(!s)if(o){const n=t.preOrderCheckHooks;null!==n&&be(e,n,null)}else{const n=t.preOrderHooks;null!==n&&we(e,n,0,null),xe(e,0)}if(function(t){for(let e=Rr(t);null!==e;e=Lr(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],r=n[3];0==(1024&n[2])&&jt(r,1),n[2]|=1024}}}(e),function(t){for(let e=Rr(t);null!==e;e=Lr(e))for(let t=ct;t<e.length;t++){const n=e[t],r=n[1];kt(n)&&Oi(r,n,r.template,n[8])}}(e),null!==t.contentQueries&&Ei(t,e),!s)if(o){const n=t.contentCheckHooks;null!==n&&be(e,n)}else{const n=t.contentHooks;null!==n&&we(e,n,1),xe(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const r=n[t];if(r<0)me(~r);else{const i=r,s=n[++t],o=n[++t];ne(s,i),o(2,e[i])}}}finally{me(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)Ki(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&is(2,l,r),!s)if(o){const n=t.viewCheckHooks;null!==n&&be(e,n)}else{const n=t.viewHooks;null!==n&&we(e,n,2),xe(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,jt(e[3],-1))}finally{fe()}}function Pi(t,e,n,r){const i=e[10],s=!Jt(),o=Nt(e);try{s&&!o&&i.begin&&i.begin(),o&&Mi(t,e,r),Oi(t,e,n,r)}finally{s&&!o&&i.end&&i.end()}}function Di(t,e,n,r,i){const s=pe(),o=2&r;try{me(-1),o&&e.length>lt&&yi(t,e,lt,Jt()),n(r,i)}finally{me(s)}}function Ri(t,e,n){if(dt(e)){const r=e.directiveEnd;for(let i=e.directiveStart;i<r;i++){const e=t.data[i];e.contentQueries&&e.contentQueries(1,n[i],i)}}}function Li(t,e,n){Vt()&&(function(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||Be(n,e),wr(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const r=t.data[a],s=mt(r);s&&qi(e,n,r);const l=Je(e,t,a,n);wr(l,e),null!==o&&Zi(0,a-i,l,r,0,o),s&&(It(n.index,e)[8]=l)}}(t,e,n,Dt(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=Ut.lFrame.currentDirectiveIndex;try{me(s);for(let n=r;n<i;n++){const r=t.data[n],i=e[n];re(n),null===r.hostBindings&&0===r.hostVars&&null===r.hostAttrs||zi(r,i)}}finally{me(-1),re(o)}}(t,e,n))}function Ii(t,e,n=Dt){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}function Ni(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=ki(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function ki(t,e,n,r,i,s,o,a,l,c){const u=lt+r,h=u+i,d=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:mi);return n}(u,h),f="function"==typeof c?c():c;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function Fi(t,e,n,r){const i=os(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&as(t).push(r,i.length-1))}function Bi(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function ji(t,e,n,r,i,s,o,a){const l=Dt(e,n);let c,u=e.inputs;var h;!a&&null!=u&&(c=u[r])?(cs(t,n,c,r,i),ft(e)&&function(t,e){const n=It(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,i=null!=o?o(i,e.value||"",r):i,Ct(s)?s.setProperty(l,r,i):Oe(r)||(l.setProperty?l.setProperty(r,i):l[r]=i))}function Ui(t,e,n,r){let i=!1;if(Vt()){const s=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let s=0;s<r.length;s++){const o=r[s];hi(n,o.selectors,!1)&&(i||(i=[]),ze(Be(n,e),t,o.type),mt(o)?($i(t,n),i.unshift(o)):i.push(o))}return i}(t,e,n),o=null===r?null:{"":-1};if(null!==s){i=!0,Gi(n,t.data.length,s.length);for(let t=0;t<s.length;t++){const e=s[t];e.providersResolver&&e.providersResolver(e)}let r=!1,a=!1,l=Ci(t,e,s.length,null);for(let i=0;i<s.length;i++){const c=s[i];n.mergedAttrs=Pe(n.mergedAttrs,c.hostAttrs),Wi(t,n,e,l,c),Hi(l,c,o),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const u=c.type.prototype;!r&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),r=!0),a||!u.ngOnChanges&&!u.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(t,e){const n=e.directiveEnd,r=t.data,i=e.attrs,s=[];let o=null,a=null;for(let l=e.directiveStart;l<n;l++){const t=r[l],n=t.inputs,c=null===i||oi(e)?null:Yi(n,i);s.push(c),o=Bi(n,l,o),a=Bi(t.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=o,e.outputs=a}(t,n)}o&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const i=n[e[t+1]];if(null==i)throw new g("301",`Export of name '${e[t+1]}' not found!`);r.push(e[t],i)}}}(n,r,o)}return n.mergedAttrs=Pe(n.mergedAttrs,n.attrs),i}function Vi(t,e,n,r,i,s){const o=s.hostBindings;if(o){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const s=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(r,i,o)}}function zi(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function $i(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Hi(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;mt(e)&&(n[""]=t)}}function Gi(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Wi(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=gt(i.type)),o=new Te(s,mt(i),null);t.blueprint[r]=o,n[r]=o,Vi(t,e,0,r,Ci(t,n,i.hostVars,mi),i)}function qi(t,e,n){const r=Dt(e,t),i=Ni(n),s=t[10],o=ts(t,Ai(t,i,null,n.onPush?64:16,r,e,s,s.createRenderer(r,n),null,null));t[e.index]=o}function Zi(t,e,n,r,i,s){const o=s[e];if(null!==o){const t=r.setInput;for(let e=0;e<o.length;){const i=o[e++],s=o[e++],a=o[e++];null!==t?r.setInput(n,a,i,s):n[s]=a}}}function Yi(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function Ji(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function Ki(t,e){const n=It(e,t);if(kt(n)){const t=n[1];80&n[2]?Oi(t,n,t.template,n[8]):n[5]>0&&Xi(n)}}function Xi(t){for(let n=Rr(t);null!==n;n=Lr(n))for(let t=ct;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];Oi(t,e,t.template,e[8])}else e[5]>0&&Xi(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const r=It(e[n],t);kt(r)&&r[5]>0&&Xi(r)}}function Qi(t,e){const n=It(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),Mi(r,n,n[8])}function ts(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function es(t){for(;t;){t[2]|=64;const e=Dr(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function ns(t,e,n){const r=e[10];r.begin&&r.begin();try{Oi(t,e,t.template,n)}catch(i){throw ls(e,i),i}finally{r.end&&r.end()}}function rs(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=xr(n),i=r[1];Pi(i,r,i.template,n)}}(t[8])}function is(t,e,n){se(0),e(t,n)}const ss=(()=>Promise.resolve(null))();function os(t){return t[7]||(t[7]=[])}function as(t){return t.cleanup||(t.cleanup=[])}function ls(t,e){const n=t[9],r=n?n.get(Tr,null):null;r&&r.handleError(e)}function cs(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=e[o],c=t.data[o];null!==c.setInput?c.setInput(l,i,r,a):l[a]=i}}function us(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?s=t:1==s?i=h(i,t):2==s&&(r=h(r,t+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}const hs=new on("INJECTOR",-1);class ds{get(t,e=yn){if(e===yn){const e=new Error(`NullInjectorError: No provider for ${u(t)}!`);throw e.name="NullInjectorError",e}return e}}const fs=new on("Set Injector scope."),ps={},ms={};let gs;function ys(){return void 0===gs&&(gs=new ds),gs}function _s(t,e=null,n=null,r){return new vs(t,n,e||ys(),r)}class vs{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];e&&un(e,n=>this.processProvider(n,t,e)),un([t],t=>this.processInjectorType(t,[],i)),this.records.set(hs,xs(void 0,this));const s=this.records.get(fs);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof t?null:u(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=yn,n=O.Default){this.assertNotDestroyed();const r=xn(this);try{if(!(n&O.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(i=t)||"object"==typeof i&&i instanceof on)&&x(t);e=n&&this.injectableDefInScope(n)?xs(bs(t),ps):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&O.Self?ys():this.parent).get(t,e=n&O.Optional&&e===yn?null:e)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(u(t)),r)throw s;return function(t,e,n,r){const i=t.ngTempTokenPath;throw e[vn]&&i.unshift(e[vn]),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=u(e);if(Array.isArray(e))i=e.map(u).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):u(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(_n,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(s,t,"R3InjectorError",this.source)}throw s}finally{xn(r)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(u(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=p(t)))return!1;let r=E(t);const i=null==r&&t.ngModule||void 0,s=void 0===i?t:i,o=-1!==n.indexOf(s);if(void 0!==i&&(r=E(i)),null==r)return!1;if(null!=r.imports&&!o){let t;n.push(s);try{un(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];un(r,t=>this.processProvider(t,n,r||z))}}this.injectorDefTypes.add(s);const a=gt(s)||(()=>new s);this.records.set(s,xs(a,ps));const l=r.providers;if(null!=l&&!o){const e=t;un(l,t=>this.processProvider(t,e,l))}return void 0!==i&&void 0!==t.providers}processProvider(t,e,n){let r=Es(t=p(t))?t:p(t&&t.provide);const i=function(t,e,n){return Ss(t)?xs(void 0,t.useValue):xs(ws(t),ps)}(t);if(Es(t)||!0!==t.multi)this.records.get(r);else{let e=this.records.get(r);e||(e=xs(void 0,ps,!0),e.factory=()=>An(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,i)}hydrate(t,e){var n;return e.value===ps&&(e.value=ms,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=p(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function bs(t){const e=x(t),n=null!==e?e.factory:gt(t);if(null!==n)return n;if(t instanceof on)throw new Error(`Token ${u(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=fn(e,"?");throw new Error(`Can't resolve all parameters for ${u(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[A]||t[C]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function ws(t,e,n){let r;if(Es(t)){const e=p(t);return gt(e)||bs(e)}if(Ss(t))r=()=>p(t.useValue);else if((i=t)&&i.useFactory)r=()=>t.useFactory(...An(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>En(p(t.useExisting));else{const e=p(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return gt(e)||bs(e);r=()=>new e(...An(t.deps))}var i;return r}function xs(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Ss(t){return null!==t&&"object"==typeof t&&bn in t}function Es(t){return"function"==typeof t}const As=function(t,e,n){return function(t,e=null,n=null,r){const i=_s(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};let Ts=(()=>{class t{static create(t,e){return Array.isArray(t)?As(t,e,""):As(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=yn,t.NULL=new ds,t.\u0275prov=b({token:t,providedIn:"any",factory:()=>En(hs)}),t.__NG_ELEMENT_ID__=-1,t})();function Cs(t,e){ve(xr(t)[1],Gt())}function Ms(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const r=[t];for(;e;){let i;if(mt(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(n){r.push(i);const e=t;e.inputs=Os(t.inputs),e.declaredInputs=Os(t.declaredInputs),e.outputs=Os(t.outputs);const n=i.hostBindings;n&&Rs(t,n);const s=i.viewQuery,o=i.contentQueries;if(s&&Ps(t,s),o&&Ds(t,o),c(t.inputs,i.inputs),c(t.declaredInputs,i.declaredInputs),c(t.outputs,i.outputs),mt(i)&&i.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(i.data.animation)}}const e=i.features;if(e)for(let r=0;r<e.length;r++){const i=e[r];i&&i.ngInherit&&i(t),i===Ms&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Pe(i.hostAttrs,n=Pe(n,i.hostAttrs))}}(r)}function Os(t){return t===V?{}:t===z?[]:t}function Ps(t,e){const n=t.viewQuery;t.viewQuery=n?(t,r)=>{e(t,r),n(t,r)}:e}function Ds(t,e){const n=t.contentQueries;t.contentQueries=n?(t,r,i)=>{e(t,r,i),n(t,r,i)}:e}function Rs(t,e){const n=t.hostBindings;t.hostBindings=n?(t,r)=>{e(t,r),n(t,r)}:e}let Ls=null;function Is(){if(!Ls){const t=U.Symbol;if(t&&t.iterator)Ls=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Ls=n)}}}return Ls}class Ns{constructor(t){this.wrapped=t}static wrap(t){return new Ns(t)}static unwrap(t){return Ns.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Ns}}function ks(t){return!!Fs(t)&&(Array.isArray(t)||!(t instanceof Map)&&Is()in t)}function Fs(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Bs(t,e,n){return t[e]=n}function js(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Us(t,e,n,r){const i=js(t,e,n);return js(t,e+1,r)||i}function Vs(t,e,n,r){const i=zt();return js(i,te(),e)&&($t(),function(t,e,n,r,i,s){const o=Dt(t,e);!function(t,e,n,r,i,s,o){if(null==s)Ct(t)?t.removeAttribute(e,i,n):e.removeAttribute(i);else{const a=null==o?y(s):o(s,r||"",i);Ct(t)?t.setAttribute(e,i,a,n):n?e.setAttributeNS(n,i,a):e.setAttribute(i,a)}}(e[11],o,s,t.value,n,r,i)}(ge(),i,t,e,n,r)),Vs}function zs(t,e,n,r){return js(t,te(),n)?e+y(n)+r:mi}function $s(t,e,n,r,i,s){const o=Us(t,Qt(),n,i);return ee(2),o?e+y(n)+r+y(i)+s:mi}function Hs(t,e,n,r,i,s,o,a){const l=zt(),c=$t(),u=t+lt,h=c.firstCreatePass?function(t,e,n,r,i,s,o,a,l){const c=e.consts,u=Ti(e,t,4,o||null,Ft(c,a));Ui(e,n,u,Ft(c,l)),ve(e,u);const h=u.tViews=ki(2,u,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,n,r,i,s,o):c.data[u];qt(h,!1);const d=l[11].createComment("");Zr(c,l,d,h),wr(d,l),ts(l,l[u]=Ji(d,l,d,h)),pt(h)&&Li(c,l,h),null!=o&&Ii(l,h,a)}function Gs(t){return Lt(Ut.lFrame.contextLView,lt+t)}function Ws(t,e=O.Default){const n=zt();return null===n?En(t,e):Ge(Gt(),n,p(t),e)}function qs(t,e,n){const r=zt();return js(r,te(),e)&&ji($t(),ge(),r,t,e,r[11],n,!1),qs}function Zs(t,e,n,r,i){const s=i?"class":"style";cs(t,n,e.inputs[s],s,r)}function Ys(t,e,n,r){const i=zt(),s=$t(),o=lt+t,a=i[11],l=i[o]=kr(a,e,Ut.lFrame.currentNamespace),c=s.firstCreatePass?function(t,e,n,r,i,s,o){const a=e.consts,l=Ti(e,t,2,i,Ft(a,s));return Ui(e,n,l,Ft(a,o)),null!==l.attrs&&us(l,l.attrs,!1),null!==l.mergedAttrs&&us(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,i,0,e,n,r):s.data[o];qt(c,!0);const u=c.mergedAttrs;null!==u&&Ce(a,l,u);const h=c.classes;null!==h&&ni(a,l,h);const d=c.styles;null!==d&&ei(a,l,d),64!=(64&c.flags)&&Zr(s,i,l,c),0===Ut.lFrame.elementDepthCount&&wr(l,i),Ut.lFrame.elementDepthCount++,pt(c)&&(Li(s,i,c),Ri(s,c,i)),null!==r&&Ii(i,c)}function Js(){let t=Gt();Zt()?Yt():(t=t.parent,qt(t,!1));const e=t;Ut.lFrame.elementDepthCount--;const n=$t();n.firstCreatePass&&(ve(n,t),dt(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Zs(n,e,zt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Zs(n,e,zt(),e.stylesWithoutHost,!1)}function Ks(t,e,n,r){Ys(t,e,n,r),Js()}function Xs(t,e,n){const r=zt(),i=$t(),s=t+lt,o=i.firstCreatePass?function(t,e,n,r,i){const s=e.consts,o=Ft(s,r),a=Ti(e,t,8,"ng-container",o);return null!==o&&us(a,o,!0),Ui(e,n,a,Ft(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,r,e,n):i.data[s];qt(o,!0);const a=r[s]=r[11].createComment("");Zr(i,r,a,o),wr(a,r),pt(o)&&(Li(i,r,o),Ri(i,o,r)),null!=n&&Ii(r,o)}function Qs(){let t=Gt();const e=$t();Zt()?Yt():(t=t.parent,qt(t,!1)),e.firstCreatePass&&(ve(e,t),dt(t)&&e.queries.elementEnd(t))}function to(){return zt()}function eo(t){return!!t&&"function"==typeof t.then}function no(t){return!!t&&"function"==typeof t.subscribe}const ro=no;function io(t,e,n,r){const i=zt(),s=$t(),o=Gt();return function(t,e,n,r,i,s,o,a){const l=pt(r),c=t.firstCreatePass&&as(t),u=os(e);let h=!0;if(3&r.type||a){const d=Dt(r,e),f=a?a(d):d,p=u.length,m=a?t=>a(Ot(t[r.index])):r.index;if(Ct(n)){let o=null;if(!a&&l&&(o=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const t=i[s];if(t===n&&i[s+1]===r){const t=e[7],n=i[s+2];return t.length>n?t[n]:null}"string"==typeof t&&(s+=2)}return null}(t,e,i,r.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,h=!1;else{s=oo(r,e,0,s,!1);const t=n.listen(f,i,s);u.push(s,t),c&&c.push(i,m,p,p+1)}}else s=oo(r,e,0,s,!0),f.addEventListener(i,s,o),u.push(s),c&&c.push(i,m,p,o)}else s=oo(r,e,0,s,!1);const d=r.outputs;let f;if(h&&null!==d&&(f=d[i])){const t=f.length;if(t)for(let n=0;n<t;n+=2){const t=e[f[n]][f[n+1]].subscribe(s),o=u.length;u.push(s,t),c&&c.push(i,r.index,o,-(o+1))}}}(s,i,i[11],o,t,e,!!n,r),io}function so(t,e,n,r){try{return!1!==n(r)}catch(i){return ls(t,i),!1}}function oo(t,e,n,r,i){return function n(s){if(s===Function)return r;const o=2&t.flags?It(t.index,e):e;0==(32&e[2])&&es(o);let a=so(e,0,r,s),l=n.__ngNextListenerFn__;for(;l;)a=so(e,0,l,s)&&a,l=l.__ngNextListenerFn__;return i&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function ao(t=1){return function(t){return(Ut.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Ut.lFrame.contextLView))[8]}(t)}function lo(t,e){let n=null;const r=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===r?hi(t,s,!0):di(r,s))return i}else n=i}return n}function co(t){const e=zt()[16][6];if(!e.projection){const n=e.projection=fn(t?t.length:1,null),r=n.slice();let i=e.child;for(;null!==i;){const e=t?lo(i,t):0;null!==e&&(r[e]?r[e].projectionNext=i:n[e]=i,r[e]=i),i=i.next}}}function uo(t,e=0,n){const r=zt(),i=$t(),s=Ti(i,lt+t,16,null,n||null);null===s.projection&&(s.projection=e),Yt(),64!=(64&s.flags)&&function(t,e,n){ti(e[11],0,e,n,Vr(t,n,e),Wr(n.parent||e[6],n,e))}(i,r,s)}function ho(t,e,n){return fo(t,"",e,"",n),ho}function fo(t,e,n,r,i){const s=zt(),o=zs(s,e,n,r);return o!==mi&&ji($t(),ge(),s,t,o,s[11],i,!1),fo}function po(t,e,n,r,i,s,o){const a=zt(),l=$s(a,e,n,r,i,s);return l!==mi&&ji($t(),ge(),a,t,l,a[11],o,!1),po}function mo(t,e,n,r,i){const s=t[n+1],o=null===e;let a=r?vi(s):wi(s),l=!1;for(;0!==a&&(!1===l||o);){const n=t[a+1];go(t[a],e)&&(l=!0,t[a+1]=r?Si(n):bi(n)),a=r?vi(n):wi(n)}l&&(t[n+1]=r?bi(s):Si(s))}function go(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&gn(t,e)>=0}const yo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function _o(t){return t.substring(yo.key,yo.keyEnd)}function vo(t,e){const n=yo.textEnd;return n===e?-1:(e=yo.keyEnd=function(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,yo.key=e,n),bo(t,e,n))}function bo(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function wo(t,e){return function(t,e,n,r){const i=zt(),s=$t(),o=ee(2);s.firstUpdatePass&&To(s,t,o,true),e!==mi&&js(i,o,e)&&Oo(s,s.data[pe()],i,i[11],t,i[o+1]=function(t,e){return null==t||"object"==typeof t&&(t=u(Un(t))),t}(e),true,o)}(t,e),wo}function xo(t){Eo(pn,So,t,!0)}function So(t,e){for(let n=function(t){return function(t){yo.key=0,yo.keyEnd=0,yo.value=0,yo.valueEnd=0,yo.textEnd=t.length}(t),vo(t,bo(t,0,yo.textEnd))}(e);n>=0;n=vo(e,n))pn(t,_o(e),!0)}function Eo(t,e,n,r){const i=$t(),s=ee(2);i.firstUpdatePass&&To(i,null,s,r);const o=zt();if(n!==mi&&js(o,s,n)){const a=i.data[pe()];if(Ro(a,r)&&!Ao(i,s)){let t=r?a.classesWithoutHost:a.stylesWithoutHost;null!==t&&(n=h(t,n||"")),Zs(i,a,o,n,r)}else!function(t,e,n,r,i,s,o,a){i===mi&&(i=z);let l=0,c=0,u=0<i.length?i[0]:null,h=0<s.length?s[0]:null;for(;null!==u||null!==h;){const d=l<i.length?i[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let p,m=null;u===h?(l+=2,c+=2,d!==f&&(m=h,p=f)):null===h||null!==u&&u<h?(l+=2,m=u):(c+=2,m=h,p=f),null!==m&&Oo(t,e,n,r,m,p,o,a),u=l<i.length?i[l]:null,h=c<s.length?s[c]:null}}(i,a,o,o[11],o[s+1],o[s+1]=function(t,e,n){if(null==n||""===n)return z;const r=[],i=Un(n);if(Array.isArray(i))for(let s=0;s<i.length;s++)t(r,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&t(r,s,i[s]);else"string"==typeof i&&e(r,i);return r}(t,e,n),r,s)}}function Ao(t,e){return e>=t.expandoStartIndex}function To(t,e,n,r){const i=t.data;if(null===i[n+1]){const s=i[pe()],o=Ao(t,n);Ro(s,r)&&null===e&&!o&&(e=!1),e=function(t,e,n,r){const i=function(t){const e=Ut.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=Mo(n=Co(null,t,e,n,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==i)if(n=Co(i,t,e,n,r),null===s){let n=function(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==wi(r))return t[vi(r)]}(t,e,r);void 0!==n&&Array.isArray(n)&&(n=Co(null,t,e,n[1],r),n=Mo(n,e.attrs,r),function(t,e,n,r){t[vi(n?e.classBindings:e.styleBindings)]=r}(t,e,r,n))}else s=function(t,e,n){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=Mo(r,t[s].hostAttrs,n);return Mo(r,e.attrs,n)}(t,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),n}(i,s,e,r),function(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=vi(o),l=wi(o);t[r]=n;let c,u=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||gn(t,c)>0)&&(u=!0)}else c=n;if(i)if(0!==l){const e=vi(t[a+1]);t[r+1]=_i(e,a),0!==e&&(t[e+1]=xi(t[e+1],r)),t[a+1]=131071&t[a+1]|r<<17}else t[r+1]=_i(a,0),0!==a&&(t[a+1]=xi(t[a+1],r)),a=r;else t[r+1]=_i(l,0),0===a?a=r:t[l+1]=xi(t[l+1],r),l=r;u&&(t[r+1]=bi(t[r+1])),mo(t,c,r,!0),mo(t,c,r,!1),function(t,e,n,r,i){const s=i?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&gn(s,e)>=0&&(n[r+1]=Si(n[r+1]))}(e,c,t,r,s),o=_i(a,l),s?e.classBindings=o:e.styleBindings=o}(i,s,e,n,o,r)}}function Co(t,e,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],r=Mo(r,s.hostAttrs,i),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function Mo(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),pn(t,o,!!n||e[++s]))}return void 0===t?null:t}function Oo(t,e,n,r,i,s,o,a){if(!(3&e.type))return;const l=t.data,c=l[a+1];Do(1==(1&c)?Po(l,e,n,i,wi(c),o):void 0)||(Do(s)||2==(2&c)&&(s=Po(l,null,n,i,a,o)),function(t,e,n,r,i){const s=Ct(t);if(e)i?s?t.addClass(n,r):n.classList.add(r):s?t.removeClass(n,r):n.classList.remove(r);else{let e=-1===r.indexOf("-")?void 0:Or.DashCase;if(null==i)s?t.removeStyle(n,r,e):n.style.removeProperty(r);else{const o="string"==typeof i&&i.endsWith("!important");o&&(i=i.slice(0,-10),e|=Or.Important),s?t.setStyle(n,r,i,e):n.style.setProperty(r,i,o?"important":"")}}}(r,o,Pt(pe(),n),i,s))}function Po(t,e,n,r,i,s){const o=null===e;let a;for(;i>0;){const e=t[i],s=Array.isArray(e),l=s?e[1]:e,c=null===l;let u=n[i+1];u===mi&&(u=c?z:void 0);let h=c?mn(u,r):l===r?u:void 0;if(s&&!Do(h)&&(h=mn(e,r)),Do(h)&&(a=h,o))return a;const d=t[i+1];i=o?vi(d):wi(d)}if(null!==e){let t=s?e.residualClasses:e.residualStyles;null!=t&&(a=mn(t,r))}return a}function Do(t){return void 0!==t}function Ro(t,e){return 0!=(t.flags&(e?16:32))}function Lo(t,e=""){const n=zt(),r=$t(),i=t+lt,s=r.firstCreatePass?Ti(r,i,1,e,null):r.data[i],o=n[i]=function(t,e){return Ct(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Zr(r,n,o,s),qt(s,!1)}function Io(t){return No("",t,""),Io}function No(t,e,n){const r=zt(),i=zs(r,t,e,n);return i!==mi&&function(t,e,n){const r=Pt(e,t);!function(t,e,n){Ct(t)?t.setValue(e,n):e.textContent=n}(t[11],r,n)}(r,pe(),i),No}function ko(t,e,n){Eo(pn,So,zs(zt(),t,e,n),!0)}function Fo(t,e,n,r,i){Eo(pn,So,$s(zt(),t,e,n,r,i),!0)}function Bo(t,e,n){const r=zt();return js(r,te(),e)&&ji($t(),ge(),r,t,e,r[11],n,!0),Bo}const jo=void 0;var Uo=["en",[["a","p"],["AM","PM"],jo],[["AM","PM"],jo,jo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],jo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],jo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",jo,"{1} 'at' {0}",jo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Vo={};function zo(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=Ho(e);if(n)return n;const r=e.split("-")[0];if(n=Ho(r),n)return n;if("en"===r)return Uo;throw new Error(`Missing locale data for the locale "${t}".`)}function $o(t){return zo(t)[Go.PluralCase]}function Ho(t){return t in Vo||(Vo[t]=U.ng&&U.ng.common&&U.ng.common.locales&&U.ng.common.locales[t]),Vo[t]}var Go=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});const Wo="en-US";let qo=Wo;function Zo(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t} [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(qo=t.toLowerCase().replace(/_/g,"-"))}function Yo(t,e,n,r,i){if(t=p(t),Array.isArray(t))for(let s=0;s<t.length;s++)Yo(t[s],e,n,r,i);else{const s=$t(),o=zt();let a=Es(t)?t:p(t.provide),l=ws(t);const c=Gt(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(Es(t)||!t.multi){const r=new Te(l,i,Ws),f=Xo(a,e,i?u:u+d,h);-1===f?(ze(Be(c,o),s,a),Jo(s,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(r),o.push(r)):(n[f]=r,o[f]=r)}else{const f=Xo(a,e,u+d,h),p=Xo(a,e,u,u+d),m=f>=0&&n[f],g=p>=0&&n[p];if(i&&!g||!i&&!m){ze(Be(c,o),s,a);const u=function(t,e,n,r,i){const s=new Te(t,n,Ws);return s.multi=[],s.index=e,s.componentProviders=0,Ko(s,i,r&&!n),s}(i?ta:Qo,n.length,i,r,l);!i&&g&&(n[p].providerFactory=u),Jo(s,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(u),o.push(u)}else Jo(s,t,f>-1?f:p,Ko(n[i?p:f],l,!i&&r));!i&&r&&g&&n[p].componentProviders++}}}function Jo(t,e,n,r){const i=Es(e);if(i||e.useClass){const s=(e.useClass||e).prototype.ngOnDestroy;if(s){const o=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const t=o.indexOf(n);-1===t?o.push(n,[r,s]):o[t+1].push(r,s)}else o.push(n,s)}}}function Ko(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Xo(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function Qo(t,e,n,r){return ea(this.multi,[])}function ta(t,e,n,r){const i=this.multi;let s;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Je(n,n[1],this.providerFactory.index,r);s=e.slice(0,t),ea(i,s);for(let n=t;n<e.length;n++)s.push(e[n])}else s=[],ea(i,s);return s}function ea(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function na(t,e=[]){return n=>{n.providersResolver=(n,r)=>function(t,e,n){const r=$t();if(r.firstCreatePass){const i=mt(t);Yo(n,r.data,r.blueprint,i,!0),Yo(e,r.data,r.blueprint,i,!1)}}(n,r?r(t):t,e)}}class ra{}class ia{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${u(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let sa=(()=>{class t{}return t.NULL=new ia,t})();function oa(...t){}function aa(t,e){return new ca(Dt(t,e))}const la=function(){return aa(Gt(),zt())};let ca=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=la,t})();function ua(t){return t instanceof ca?t.nativeElement:t}class ha{}let da=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>fa(),t})();const fa=function(){const t=zt(),e=It(Gt().index,t);return function(t){return t[11]}(ut(e)?e:t)};let pa=(()=>{class t{}return t.\u0275prov=b({token:t,providedIn:"root",factory:()=>null}),t})();class ma{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const ga=new ma("12.0.5");class ya{constructor(){}supports(t){return ks(t)}create(t){return new va(t)}}const _a=(t,e)=>e;class va{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||_a}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const s=!n||e&&e.currentIndex<Sa(n,r,i)?e:n,o=Sa(s,r,i),a=s.currentIndex;if(s===n)r--,n=n._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{i||(i=[]);const t=o-r,e=a-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,s=r+n;e<=s&&s<t&&(i[n]=r+1)}i[s.previousIndex]=e-t}}o!==a&&t(s,o,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ks(t))throw new Error(`Error trying to diff '${u(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,n,r,e)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),s=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Is()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&Object.is(i.trackById,r)?(s&&(i=this._verifyReinsertion(i,t,r,e)),Object.is(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),s=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):t=this._addAfter(new ba(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new xa),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new xa),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class ba{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class wa{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class xa{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new wa,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Sa(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Ea{constructor(){}supports(t){return t instanceof Map||Fs(t)}create(){return new Aa}}class Aa{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Fs(t)))throw new Error(`Error trying to diff '${u(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new Ta(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Ta{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Ca(){return new Ma([new ya])}let Ma=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||Ca()),deps:[[t,new On,new Mn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=b({token:t,providedIn:"root",factory:Ca}),t})();function Oa(){return new Pa([new Ea])}let Pa=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||Oa()),deps:[[t,new On,new Mn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=b({token:t,providedIn:"root",factory:Oa}),t})();function Da(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&r.push(Ot(s)),ht(s))for(let t=ct;t<s.length;t++){const e=s[t],n=e[1].firstChild;null!==n&&Da(e[1],e,n,r)}const o=n.type;if(8&o)Da(t,e,n.child,r);else if(32&o){const t=Pr(n,e);let i;for(;i=t();)r.push(i)}else if(16&o){const t=Jr(e,n);if(Array.isArray(t))r.push(...t);else{const n=Dr(e[16]);Da(n[1],n,t,r,!0)}}n=i?n.projectionNext:n.next}return r}class Ra{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Da(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(ht(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(Br(t,n),dn(e,n))}this._attachedToViewContainer=!1}jr(this._lView[1],this._lView)}onDestroy(t){Fi(this._lView[1],this._lView,null,t)}markForCheck(){es(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){ns(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Kt(!0);try{ns(t,e,n)}finally{Kt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,Qr(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class La extends Ra{constructor(t){super(t),this._view=t}detectChanges(){rs(this._view)}checkNoChanges(){!function(t){Kt(!0);try{rs(t)}finally{Kt(!1)}}(this._view)}get context(){return null}}const Ia=function(t){return function(t,e,n){if(ft(t)&&!n){const n=It(t.index,e);return new Ra(n,n)}return 47&t.type?new Ra(e[16],e):null}(Gt(),zt(),16==(16&t))};let Na=(()=>{class t{}return t.__NG_ELEMENT_ID__=Ia,t})();const ka=[new Ea],Fa=new Ma([new ya]),Ba=new Pa(ka),ja=function(){return $a(Gt(),zt())};let Ua=(()=>{class t{}return t.__NG_ELEMENT_ID__=ja,t})();const Va=Ua,za=class extends Va{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=Ai(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(e)),Mi(e,n,t),new Ra(n)}};function $a(t,e){return 4&t.type?new za(e,t,aa(t,e)):null}class Ha{}class Ga{}const Wa=function(){return Xa(Gt(),zt())};let qa=(()=>{class t{}return t.__NG_ELEMENT_ID__=Wa,t})();const Za=qa,Ya=class extends Za{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return aa(this._hostTNode,this._hostLView)}get injector(){return new Qe(this._hostTNode,this._hostLView)}get parentInjector(){const t=Ve(this._hostTNode,this._hostLView);if(Re(t)){const e=Ie(t,this._hostLView),n=Le(t);return new Qe(e[1].data[n+8],e)}return new Qe(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=Ja(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-ct}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const s=n||this.parentInjector;if(!i&&null==t.ngModule&&s){const t=s.get(Ha,null);t&&(i=t)}const o=t.create(s,r,void 0,i);return this.insert(o.hostView,e),o}insert(t,e){const n=t._lView,r=n[1];if(ht(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new Ya(e,e[6],e[3]);r.detach(r.indexOf(t))}}const i=this._adjustIndex(e),s=this._lContainer;!function(t,e,n,r){const i=ct+r,s=n.length;r>0&&(n[i-1][4]=e),r<s-ct?(e[4]=n[i],hn(n,ct+r,e)):(n.push(e),e[4]=null),e[3]=n;const o=e[17];null!==o&&n!==o&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(r,n,s,i);const o=Kr(i,s),a=n[11],l=Gr(a,s[7]);return null!==l&&function(t,e,n,r,i,s){r[0]=i,r[6]=e,Qr(t,r,n,1,i,s)}(r,s[6],a,n,l,o),t.attachToViewContainerRef(),hn(Ka(s),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=Ja(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Br(this._lContainer,e);n&&(dn(Ka(this._lContainer),e),jr(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=Br(this._lContainer,e);return n&&null!=dn(Ka(this._lContainer),e)?new Ra(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function Ja(t){return t[8]}function Ka(t){return t[8]||(t[8]=[])}function Xa(t,e){let n;const r=e[t.index];if(ht(r))n=r;else{let i;if(8&t.type)i=Ot(r);else{const n=e[11];i=n.createComment("");const r=Dt(t,e);zr(n,Gr(n,r),i,function(t,e){return Ct(t)?t.nextSibling(e):e.nextSibling}(n,r),!1)}e[t.index]=n=Ji(r,e,i,t),ts(e,n)}return new Ya(n,t,e)}const Qa={};class tl extends sa{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=ot(t);return new rl(e,this.ngModule)}}function el(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const nl=new on("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Cr});class rl extends ra{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(pi).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return el(this.componentDef.inputs)}get outputs(){return el(this.componentDef.outputs)}create(t,e,n,r){const i=(r=r||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const s=t.get(n,Qa,i);return s!==Qa||r===Qa?s:e.get(n,r,i)}}}(t,r.injector):t,s=i.get(ha,Mt),o=i.get(pa,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(Ct(t))return t.selectRootElement(e,n===N.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(a,n,this.componentDef.encapsulation):kr(s.createRenderer(null,this.componentDef),l,function(t){const e=t.toLowerCase();return"svg"===e?St:"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),u=this.componentDef.onPush?576:528,h={components:[],scheduler:Cr,clean:ss,playerHandler:null,flags:0},d=ki(0,null,null,1,0,null,null,null,null,null),f=Ai(null,d,h,u,null,null,s,a,o,i);let p,m;le(f);try{const t=function(t,e,n,r,i,s){const o=n[1];n[20]=t;const a=Ti(o,20,2,"#host",null),l=a.mergedAttrs=e.hostAttrs;null!==l&&(us(a,l,!0),null!==t&&(Ce(i,t,l),null!==a.classes&&ni(i,t,a.classes),null!==a.styles&&ei(i,t,a.styles)));const c=r.createRenderer(t,e),u=Ai(n,Ni(e),null,e.onPush?64:16,n[20],a,r,c,null,null);return o.firstCreatePass&&(ze(Be(a,n),o,e.type),$i(o,a),Gi(a,n.length,1)),ts(n,u),n[20]=u}(c,this.componentDef,f,s,a);if(c)if(n)Ce(a,c,["ng-version",ga.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!ci(i))break;i=s}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&Ce(a,c,t),e&&e.length>0&&ni(a,c,e.join(" "))}if(m=Rt(d,lt),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=e[n];t.push(null!=r?Array.from(r):null)}}p=function(t,e,n,r,i){const s=n[1],o=function(t,e,n){const r=Gt();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Wi(t,r,e,Ci(t,e,1,null),n));const i=Je(e,t,r.directiveStart,r);wr(i,e);const s=Dt(r,e);return s&&wr(s,e),i}(s,n,e);if(r.components.push(o),t[8]=o,i&&i.forEach(t=>t(o,e)),e.contentQueries){const t=Gt();e.contentQueries(1,o,t.directiveStart)}const a=Gt();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(me(a.index),Vi(n[1],a,0,a.directiveStart,a.directiveEnd,e),zi(e,o)),o}(t,this.componentDef,f,h,[Cs]),Mi(d,f,null)}finally{fe()}return new il(this.componentType,p,aa(m,f),f,m)}}class il extends class{}{constructor(t,e,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new La(r),this.componentType=t}get injector(){return new Qe(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const sl=new Map;class ol extends Ha{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new tl(this);const n=at(t),r=t[q]||null;r&&Zo(r),this._bootstrapComponents=Mr(n.bootstrap),this._r3Injector=_s(t,e,[{provide:Ha,useValue:this},{provide:sa,useValue:this.componentFactoryResolver}],u(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Ts.THROW_IF_NOT_FOUND,n=O.Default){return t===Ts||t===Ha||t===hs?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class al extends Ga{constructor(t){super(),this.moduleType=t,null!==at(t)&&function(t){const e=new Set;!function t(n){const r=at(n,!0),i=r.id;null!==i&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${u(e)} vs ${u(e.name)}`)}(i,sl.get(i),n),sl.set(i,n));const s=Mr(r.imports);for(const o of s)e.has(o)||(e.add(o),t(o))}(t)}(t)}create(t){return new ol(this.moduleType,t)}}function ll(t,e,n){const r=Xt()+t,i=zt();return i[r]===mi?Bs(i,r,n?e.call(n):e()):function(t,e){return t[e]}(i,r)}function cl(t,e,n,r,i){return hl(zt(),Xt(),t,e,n,r,i)}function ul(t,e){const n=t[e];return n===mi?void 0:n}function hl(t,e,n,r,i,s,o){const a=e+n;return Us(t,a,i,s)?Bs(t,a+2,o?r.call(o,i,s):r(i,s)):ul(t,a+2)}function dl(t,e){const n=$t();let r;const i=t+lt;n.firstCreatePass?(r=function(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}throw new g("302",`The pipe '${t}' could not be found!`)}(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const s=r.factory||(r.factory=gt(r.type)),o=D(Ws);try{const t=ke(!1),e=s();return ke(t),function(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}(n,zt(),i,e),e}finally{D(o)}}function fl(t,e,n){const r=t+lt,i=zt(),s=Lt(i,r);return _l(i,yl(i,r)?function(t,e,n,r,i,s){const o=e+n;return js(t,o,i)?Bs(t,o+1,s?r.call(s,i):r(i)):ul(t,o+1)}(i,Xt(),e,s.transform,n,s):s.transform(n))}function pl(t,e,n,r){const i=t+lt,s=zt(),o=Lt(s,i);return _l(s,yl(s,i)?hl(s,Xt(),e,o.transform,n,r,o):o.transform(n,r))}function ml(t,e,n,r,i){const s=t+lt,o=zt(),a=Lt(o,s);return _l(o,yl(o,s)?function(t,e,n,r,i,s,o,a){const l=e+n;return function(t,e,n,r,i){const s=Us(t,e,n,r);return js(t,e+2,i)||s}(t,l,i,s,o)?Bs(t,l+3,a?r.call(a,i,s,o):r(i,s,o)):ul(t,l+3)}(o,Xt(),e,a.transform,n,r,i,a):a.transform(n,r,i))}function gl(t,e,n,r,i,s){const o=t+lt,a=zt(),l=Lt(a,o);return _l(a,yl(a,o)?function(t,e,n,r,i,s,o,a,l){const c=e+n;return function(t,e,n,r,i,s){const o=Us(t,e,n,r);return Us(t,e+2,i,s)||o}(t,c,i,s,o,a)?Bs(t,c+4,l?r.call(l,i,s,o,a):r(i,s,o,a)):ul(t,c+4)}(a,Xt(),e,l.transform,n,r,i,s,l):l.transform(n,r,i,s))}function yl(t,e){return t[1].data[e].pure}function _l(t,e){return Ns.isWrapped(e)&&(e=Ns.unwrap(e),t[Qt()]=mi),e}function vl(t){return e=>{setTimeout(t,void 0,e)}}const bl=class extends r.xQ{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){var r,s,o;let a=t,l=e||(()=>null),c=n;if(t&&"object"==typeof t){const e=t;a=null===(r=e.next)||void 0===r?void 0:r.bind(e),l=null===(s=e.error)||void 0===s?void 0:s.bind(e),c=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}this.__isAsync&&(l=vl(l),a&&(a=vl(a)),c&&(c=vl(c)));const u=super.subscribe({next:a,error:l,complete:c});return t instanceof i.w&&t.add(u),u}};function wl(){return this._results[Is()]()}class xl{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Is(),n=xl.prototype;n[e]||(n[e]=wl)}get changes(){return this._changes||(this._changes=new bl)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const r=cn(t);(this._changesDetected=!function(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(n._results,r,e))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Sl{constructor(t){this.queryList=t,this.matches=null}clone(){return new Sl(this.queryList)}setDirty(){this.queryList.setDirty()}}class El{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);r.push(this.queries[n.indexInDeclarationView].clone())}return new El(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==Bl(t,e).matches&&this.queries[e].setDirty()}}class Al{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class Tl{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,i=this.getByIndex(n).embeddedTView(t,r);i&&(i.indexInDeclarationView=n,null!==e?e.push(i):e=[i])}return null!==e?new Tl(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Cl{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Cl(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];this.matchTNodeWithReadOption(t,e,Ml(e,i)),this.matchTNodeWithReadOption(t,e,Ye(e,t,i,!1,!1))}else n===Ua?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Ye(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===ca||r===qa||r===Ua&&4&e.type)this.addMatch(e.index,-2);else{const n=Ye(e,t,r,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Ml(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function Ol(t,e,n,r){return-1===n?function(t,e){return 11&t.type?aa(t,e):4&t.type?$a(t,e):null}(e,t):-2===n?function(t,e,n){return n===ca?aa(e,t):n===Ua?$a(e,t):n===qa?Xa(e,t):void 0}(t,e,r):Je(t,t[1],n,e)}function Pl(t,e,n,r){const i=e[19].queries[r];if(null===i.matches){const r=t.data,s=n.matches,o=[];for(let t=0;t<s.length;t+=2){const i=s[t];o.push(i<0?null:Ol(e,r[i],s[t+1],n.metadata.read))}i.matches=o}return i.matches}function Dl(t,e,n,r){const i=t.queries.getByIndex(n),s=i.matches;if(null!==s){const o=Pl(t,e,i,n);for(let t=0;t<s.length;t+=2){const n=s[t];if(n>0)r.push(o[t/2]);else{const i=s[t+1],o=e[-n];for(let t=ct;t<o.length;t++){const e=o[t];e[17]===e[3]&&Dl(e[1],e,i,r)}if(null!==o[9]){const t=o[9];for(let e=0;e<t.length;e++){const n=t[e];Dl(n[1],n,i,r)}}}}}return r}function Rl(t){const e=zt(),n=$t(),r=ie();se(r+1);const i=Bl(n,r);if(t.dirty&&Nt(e)===(2==(2&i.metadata.flags))){if(null===i.matches)t.reset([]);else{const s=i.crossesNgTemplate?Dl(n,e,r,[]):Pl(n,e,i,r);t.reset(s,ua),t.notifyOnChanges()}return!0}return!1}function Ll(t,e,n){const r=$t();r.firstCreatePass&&(Fl(r,new Al(t,e,n),-1),2==(2&e)&&(r.staticViewQueries=!0)),kl(r,zt(),e)}function Il(t,e,n,r){const i=$t();if(i.firstCreatePass){const s=Gt();Fl(i,new Al(e,n,r),s.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(i,t),2==(2&n)&&(i.staticContentQueries=!0)}kl(i,zt(),n)}function Nl(){return t=zt(),e=ie(),t[19].queries[e].queryList;var t,e}function kl(t,e,n){const r=new xl(4==(4&n));Fi(t,e,r,r.destroy),null===e[19]&&(e[19]=new El),e[19].queries.push(new Sl(r))}function Fl(t,e,n){null===t.queries&&(t.queries=new Tl),t.queries.track(new Cl(e,n))}function Bl(t,e){return t.queries.getByIndex(e)}function jl(t,e){return $a(t,e)}const Ul=new on("Application Initializer");let Vl=(()=>{class t{constructor(t){this.appInits=t,this.resolve=oa,this.reject=oa,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();if(eo(e))t.push(e);else if(ro(e)){const n=new Promise((t,n)=>{e.subscribe({complete:t,error:n})});t.push(n)}}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(En(Ul,8))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();const zl=new on("AppId"),$l={provide:zl,useFactory:function(){return`${Hl()}${Hl()}${Hl()}`},deps:[]};function Hl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Gl=new on("Platform Initializer"),Wl=new on("Platform ID"),ql=new on("appBootstrapListener");let Zl=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();const Yl=new on("LocaleId"),Jl=new on("DefaultCurrencyCode");class Kl{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Xl=function(t){return new al(t)},Ql=Xl,tc=function(t){return Promise.resolve(Xl(t))},ec=function(t){const e=Xl(t),n=Mr(at(t).declarations).reduce((t,e)=>{const n=ot(e);return n&&t.push(new rl(n)),t},[]);return new Kl(e,n)},nc=ec,rc=function(t){return Promise.resolve(ec(t))};let ic=(()=>{class t{constructor(){this.compileModuleSync=Ql,this.compileModuleAsync=tc,this.compileModuleAndAllComponentsSync=nc,this.compileModuleAndAllComponentsAsync=rc}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();const sc=(()=>Promise.resolve(0))();function oc(t){"undefined"==typeof Zone?sc.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class ac{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new bl(!1),this.onMicrotaskEmpty=new bl(!1),this.onStable=new bl(!1),this.onError=new bl(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&e,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let t=U.requestAnimationFrame,e=U.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(U,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,uc(t),t.isCheckStableRunning=!0,cc(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),uc(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return hc(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),dc(t)}},onInvoke:(n,r,i,s,o,a,l)=>{try{return hc(t),n.invoke(i,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),dc(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,uc(t),cc(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ac.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(ac.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+r,t,lc,oa,oa);try{return i.runTask(s,e,n)}finally{i.cancelTask(s)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const lc={};function cc(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function uc(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function hc(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function dc(t){t._nesting--,cc(t)}class fc{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new bl,this.onMicrotaskEmpty=new bl,this.onStable=new bl,this.onError=new bl}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let pc=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ac.assertNotInAngularZone(),oc(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())oc(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(En(ac))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})(),mc=(()=>{class t{constructor(){this._applications=new Map,vc.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return vc.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();class gc{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}function yc(t){vc=t}let _c,vc=new gc,bc=!0,wc=!1;function xc(){return wc=!0,bc}function Sc(){if(wc)throw new Error("Cannot enable prod mode after platform setup.");bc=!1}const Ec=new on("AllowMultipleToken");class Ac{constructor(t,e){this.name=t,this.token=e}}function Tc(t,e,n=[]){const r=`Platform: ${e}`,i=new on(r);return(e=[])=>{let s=Cc();if(!s||s.injector.get(Ec,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0},{provide:fs,useValue:"platform"});!function(t){if(_c&&!_c.destroyed&&!_c.injector.get(Ec,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");_c=t.get(Mc);const e=t.get(Gl,null);e&&e.forEach(t=>t())}(Ts.create({providers:t,name:r}))}return function(t){const e=Cc();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function Cc(){return _c&&!_c.destroyed?_c:null}let Mc=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new fc:("zone.js"===t?void 0:t)||new ac({enableLongStackTrace:xc(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(e?e.ngZone:void 0,{ngZoneEventCoalescing:e&&e.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:e&&e.ngZoneRunCoalescing||!1}),r=[{provide:ac,useValue:n}];return n.run(()=>{const e=Ts.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),s=i.injector.get(Tr,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{s.handleError(t)}});i.onDestroy(()=>{Dc(this._modules,i),t.unsubscribe()})}),function(t,e,n){try{const r=n();return eo(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(s,n,()=>{const t=i.injector.get(Vl);return t.runInitializers(),t.donePromise.then(()=>(Zo(i.injector.get(Yl,Wo)||Wo),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=Oc({},e);return function(t,e,n){const r=new al(n);return Promise.resolve(r)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(Pc);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${u(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(En(Ts))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();function Oc(t,e){return Array.isArray(e)?e.reduce(Oc,t):Object.assign(Object.assign({},t),e)}let Pc=(()=>{class t{constructor(t,e,n,r,i){this._zone=t,this._injector=e,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const l=new s.y(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),c=new s.y(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{ac.assertNotInAngularZone(),oc(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{ac.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=(0,o.T)(l,c.pipe((0,a.B)()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof ra?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(Ha),i=n.create(Ts.NULL,[],e||n.selector,r),s=i.location.nativeElement,o=i.injector.get(pc,null),a=o&&i.injector.get(mc);return o&&a&&a.registerApplication(s,o),i.onDestroy(()=>{this.detachView(i.hostView),Dc(this.components,i),a&&a.unregisterApplication(s)}),this._loadComponent(i),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Dc(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(ql,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(En(ac),En(Ts),En(Tr),En(sa),En(Vl))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();function Dc(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Rc{}class Lc{}const Ic={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Nc=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||Ic}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n(4928)(e).then(t=>t[r]).then(t=>kc(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n(4928)(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>kc(t,e,r))}}return t.\u0275fac=function(e){return new(e||t)(En(ic),En(Lc,8))},t.\u0275prov=b({token:t,factory:t.\u0275fac}),t})();function kc(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const Fc=function(t){return null},Bc=Tc(null,"core",[{provide:Wl,useValue:"unknown"},{provide:Mc,deps:[Ts]},{provide:mc,deps:[]},{provide:Zl,deps:[]}]),jc=[{provide:Pc,useClass:Pc,deps:[ac,Ts,Tr,sa,Vl]},{provide:nl,deps:[ac],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Vl,useClass:Vl,deps:[[new Mn,Ul]]},{provide:ic,useClass:ic,deps:[]},$l,{provide:Ma,useFactory:function(){return Fa},deps:[]},{provide:Pa,useFactory:function(){return Ba},deps:[]},{provide:Yl,useFactory:function(t){return Zo(t=t||"undefined"!=typeof $localize&&$localize.locale||Wo),t},deps:[[new Cn(Yl),new Mn,new On]]},{provide:Jl,useValue:"USD"}];let Uc=(()=>{class t{constructor(t){}}return t.\u0275fac=function(e){return new(e||t)(En(Pc))},t.\u0275mod=et({type:t}),t.\u0275inj=w({providers:jc}),t})()},3714:(t,e,n)=>{"use strict";n.d(e,{gz:()=>le,gk:()=>it,m2:()=>rt,Q3:()=>st,OD:()=>nt,wm:()=>Nn,F0:()=>Dn,Bz:()=>$n,lC:()=>Rn,R9:()=>ot});var r=n(1116),i=n(5366),s=n(6163),o=n(8470),a=n(9829),l=n(7e3),c=n(9342);const u={};class h{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new d(t,this.resultSelector))}}class d extends a.L{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(u),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++)this.add((0,l.D)(this,t[n],void 0,n))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n){const r=this.values,i=this.toRespond?r[n]===u?--this.toRespond:this.toRespond:0;r[n]=e,0===i&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const f=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();var p=n(878),m=n(7471);function g(...t){return(0,m.J)(1)((0,p.of)(...t))}var y=n(8318),_=n(9764),v=n(653);function b(t){return new y.y(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?(0,_.D)(n):(0,v.c)()).subscribe(e)})}var w=n(8512),x=n(2875),S=n(5959),E=n(3835),A=n(6673),T=n(8402);function C(t){return function(e){return 0===t?(0,v.c)():e.lift(new M(t))}}class M{constructor(t){if(this.total=t,this.total<0)throw new T.W}call(t,e){return e.subscribe(new O(t,this.total))}}class O extends A.L{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function P(t=L){return e=>e.lift(new D(t))}class D{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new R(t,this.errorFactory))}}class R extends A.L{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function L(){return new f}function I(t=null){return e=>e.lift(new N(t))}class N{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new k(t,this.defaultValue))}}class k extends A.L{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var F=n(3392),B=n(611);function j(t,e){const n=arguments.length>=2;return r=>r.pipe(t?(0,E.h)((e,n)=>t(e,n,r)):F.y,(0,B.q)(1),n?I(e):P(()=>new f))}function U(){}var V=n(5024);function z(t,e,n){return function(r){return r.lift(new $(t,e,n))}}class ${constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new H(t,this.nextOrObserver,this.error,this.complete))}}class H extends A.L{constructor(t,e,n,r){super(t),this._tapNext=U,this._tapError=U,this._tapComplete=U,this._tapError=n||U,this._tapComplete=r||U,(0,V.m)(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||U,this._tapError=e.error||U,this._tapComplete=e.complete||U)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}var G=n(7570);class W{constructor(t){this.callback=t}call(t,e){return e.subscribe(new q(t,this.callback))}}class q extends A.L{constructor(t,e){super(t),this.add(new G.w(e))}}var Z=n(9996),Y=n(4689),J=n(2023),K=n(7727),X=n(436),Q=n(3982),tt=n(1564);class et{constructor(t,e){this.id=t,this.url=e}}class nt extends et{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class rt extends et{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class it extends et{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class st extends et{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ot extends et{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class at extends et{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lt extends et{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ct extends et{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ut extends et{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ht{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class dt{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ft{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class pt{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mt{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gt{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yt{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const _t="primary";class vt{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function bt(t){return new vt(t)}function wt(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function xt(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let s=0;s<r.length;s++){const e=r[s],n=t[s];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function St(t,e){const n=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!Et(t[i],e[i]))return!1;return!0}function Et(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((t,e)=>r[e]===t)}return t===e}function At(t){return Array.prototype.concat.apply([],t)}function Tt(t){return t.length>0?t[t.length-1]:null}function Ct(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Mt(t){return(0,i.CqO)(t)?t:(0,i.QGY)(t)?(0,_.D)(Promise.resolve(t)):(0,p.of)(t)}const Ot={exact:function t(e,n,r){if(!Bt(e.segments,n.segments))return!1;if(!It(e.segments,n.segments,r))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children){if(!e.children[i])return!1;if(!t(e.children[i],n.children[i],r))return!1}return!0},subset:Rt},Pt={exact:function(t,e){return St(t,e)},subset:function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>Et(t[n],e[n]))},ignored:()=>!0};function Dt(t,e,n){return Ot[n.paths](t.root,e.root,n.matrixParams)&&Pt[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function Rt(t,e,n){return Lt(t,e,e.segments,n)}function Lt(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!!Bt(i,n)&&!e.hasChildren()&&!!It(i,n,r)}if(t.segments.length===n.length){if(!Bt(t.segments,n))return!1;if(!It(t.segments,n,r))return!1;for(const n in e.children){if(!t.children[n])return!1;if(!Rt(t.children[n],e.children[n],r))return!1}return!0}{const i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!Bt(t.segments,i)&&!!It(t.segments,i,r)&&!!t.children.primary&&Lt(t.children.primary,e,s,r)}}function It(t,e,n){return e.every((e,r)=>Pt[n](t[r].parameters,e.parameters))}class Nt{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=bt(this.queryParams)),this._queryParamMap}toString(){return Vt.serialize(this)}}class kt{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Ct(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zt(this)}}class Ft{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=bt(this.parameters)),this._parameterMap}toString(){return Yt(this)}}function Bt(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}class jt{}class Ut{parse(t){const e=new te(t);return new Nt(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`/${$t(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${Gt(e)}=${Gt(t)}`).join("&"):`${Gt(e)}=${Gt(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Vt=new Ut;function zt(t){return t.segments.map(t=>Yt(t)).join("/")}function $t(t,e){if(!t.hasChildren())return zt(t);if(e){const e=t.children.primary?$t(t.children.primary,!1):"",n=[];return Ct(t.children,(t,e)=>{e!==_t&&n.push(`${e}:${$t(t,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function(t,e){let n=[];return Ct(t.children,(t,r)=>{r===_t&&(n=n.concat(e(t,r)))}),Ct(t.children,(t,r)=>{r!==_t&&(n=n.concat(e(t,r)))}),n}(t,(e,n)=>n===_t?[$t(t.children.primary,!1)]:[`${n}:${$t(e,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children.primary?`${zt(t)}/${e[0]}`:`${zt(t)}/(${e.join("//")})`}}function Ht(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Gt(t){return Ht(t).replace(/%3B/gi,";")}function Wt(t){return Ht(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function qt(t){return decodeURIComponent(t)}function Zt(t){return qt(t.replace(/\+/g,"%20"))}function Yt(t){return`${Wt(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Wt(t)}=${Wt(e[t])}`).join("")}`;var e}const Jt=/^[^\/()?;=#]+/;function Kt(t){const e=t.match(Jt);return e?e[0]:""}const Xt=/^[^=?&#]+/,Qt=/^[^?&#]+/;class te{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new kt([],{}):new kt([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new kt(t,e)),n}parseSegment(){const t=Kt(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Ft(qt(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Kt(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=Kt(this.remaining);t&&(n=t,this.capture(n))}t[qt(e)]=qt(n)}parseQueryParam(t){const e=function(t){const e=t.match(Xt);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Qt);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const r=Zt(e),i=Zt(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(e=[e],t[r]=e),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Kt(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=_t);const s=this.parseChildren();e[i]=1===Object.keys(s).length?s.primary:new kt([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class ee{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=ne(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=ne(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=re(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return re(t,this._root).map(t=>t.value)}}function ne(t,e){if(t===e.value)return e;for(const n of e.children){const e=ne(t,n);if(e)return e}return null}function re(t,e){if(t===e.value)return[e];for(const n of e.children){const r=re(t,n);if(r.length)return r.unshift(e),r}return[]}class ie{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function se(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class oe extends ee{constructor(t,e){super(t),this.snapshot=e,de(this,t)}toString(){return this.snapshot.toString()}}function ae(t,e){const n=function(t,e){const n=new ue([],{},{},"",{},_t,e,null,t.root,-1,{});return new he("",new ie(n,[]))}(t,e),r=new w.X([new Ft("",{})]),i=new w.X({}),s=new w.X({}),o=new w.X({}),a=new w.X(""),l=new le(r,i,o,a,s,_t,e,n.root);return l.snapshot=n.root,new oe(new ie(l,[]),n)}class le{constructor(t,e,n,r,i,s,o,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Z.U)(t=>bt(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Z.U)(t=>bt(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ce(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class ue{constructor(t,e,n,r,i,s,o,a,l,c,u){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=bt(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=bt(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class he extends ee{constructor(t,e){super(e),this.url=t,de(this,e)}toString(){return fe(this._root)}}function de(t,e){e.value._routerState=t,e.children.forEach(e=>de(t,e))}function fe(t){const e=t.children.length>0?` { ${t.children.map(fe).join(", ")} } `:"";return`${t.value}${e}`}function pe(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,St(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),St(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!St(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),St(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function me(t,e){var n,r;return St(t.params,e.params)&&Bt(n=t.url,r=e.url)&&n.every((t,e)=>St(t.parameters,r[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||me(t.parent,e.parent))}function ge(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function(t,e,n){return e.children.map(e=>{for(const r of n.children)if(t.shouldReuseRoute(e.value,r.value.snapshot))return ge(t,e,r);return ge(t,e)})}(t,e,n);return new ie(r,i)}{if(t.shouldAttach(e.value)){const n=t.retrieve(e.value);if(null!==n){const t=n.route;return ye(e,t),t}}const n=new le(new w.X((r=e.value).url),new w.X(r.params),new w.X(r.queryParams),new w.X(r.fragment),new w.X(r.data),r.outlet,r.component,r),i=e.children.map(e=>ge(t,e));return new ie(n,i)}var r}function ye(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)ye(t.children[n],e.children[n])}function _e(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function ve(t){return"object"==typeof t&&null!=t&&t.outlets}function be(t,e,n,r,i){let s={};return r&&Ct(r,(t,e)=>{s[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new Nt(n.root===t?e:we(n.root,t,e),s,i)}function we(t,e,n){const r={};return Ct(t.children,(t,i)=>{r[i]=t===e?n:we(t,e,n)}),new kt(t.segments,r)}class xe{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&_e(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(ve);if(r&&r!==Tt(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Se{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function Ee(t,e,n){if(t||(t=new kt([],{})),0===t.segments.length&&t.hasChildren())return Ae(t,e,n);const r=function(t,e,n){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;const e=t.segments[i],o=n[r];if(ve(o))break;const a=`${o}`,l=r<n.length-1?n[r+1]:null;if(i>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!Oe(a,l,e))return s;r+=2}else{if(!Oe(a,{},e))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new kt(t.segments.slice(0,r.pathIndex),{});return e.children.primary=new kt(t.segments.slice(r.pathIndex),t.children),Ae(e,0,i)}return r.match&&0===i.length?new kt(t.segments,{}):r.match&&!t.hasChildren()?Te(t,e,n):r.match?Ae(t,0,i):Te(t,e,n)}function Ae(t,e,n){if(0===n.length)return new kt(t.segments,{});{const r=function(t){return ve(t[0])?t[0].outlets:{[_t]:t}}(n),i={};return Ct(r,(n,r)=>{"string"==typeof n&&(n=[n]),null!==n&&(i[r]=Ee(t.children[r],e,n))}),Ct(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new kt(t.segments,i)}}function Te(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const s=n[i];if(ve(s)){const t=Ce(s.outlets);return new kt(r,t)}if(0===i&&_e(n[0])){r.push(new Ft(t.segments[e].path,Me(n[0]))),i++;continue}const o=ve(s)?s.outlets.primary:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&_e(a)?(r.push(new Ft(o,Me(a))),i+=2):(r.push(new Ft(o,{})),i++)}return new kt(r,{})}function Ce(t){const e={};return Ct(t,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=Te(new kt([],{}),0,t))}),e}function Me(t){const e={};return Ct(t,(t,n)=>e[n]=`${t}`),e}function Oe(t,e,n){return t==n.path&&St(e,n.parameters)}class Pe{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),pe(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=se(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),Ct(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),r=n&&t.value.component?n.children:e,i=se(t);for(const s of Object.keys(i))this.deactivateRouteAndItsChildren(i[s],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(t,e,n){const r=se(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new gt(t.value.snapshot))}),t.children.length&&this.forwardEvent(new pt(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(pe(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),De(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function De(t){pe(t.value),t.children.forEach(De)}class Re{constructor(t,e){this.routes=t,this.module=e}}function Le(t){return"function"==typeof t}function Ie(t){return t instanceof Nt}const Ne=Symbol("INITIAL_VALUE");function ke(){return(0,Y.w)(t=>function(...t){let e,n;return(0,s.K)(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&(0,o.k)(t[0])&&(t=t[0]),(0,c.n)(t,n).lift(new h(e))}(t.map(t=>t.pipe((0,B.q)(1),function(...t){const e=t[t.length-1];return(0,s.K)(e)?(t.pop(),n=>g(t,n,e)):e=>g(t,e)}(Ne)))).pipe((0,J.R)((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==Ne)return t;if(r===Ne&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Ie(r))return r}return t},t)},Ne),(0,E.h)(t=>t!==Ne),(0,Z.U)(t=>Ie(t)?t:!0===t),(0,B.q)(1)))}let Fe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&i._UZ(0,"router-outlet")},directives:function(){return[Rn]},encapsulation:2}),t})();function Be(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];je(r,Ue(e,r))}}function je(t,e){t.children&&Be(t.children,e)}function Ue(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Ve(t){const e=t.children&&t.children.map(Ve),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==_t&&(n.component=Fe),n}function ze(t){return t.outlet||_t}function $e(t,e){const n=t.filter(t=>ze(t)===e);return n.push(...t.filter(t=>ze(t)!==e)),n}const He={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Ge(t,e,n){var r;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},He):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const i=(e.matcher||xt)(n,t,e);if(!i)return Object.assign({},He);const s={};Ct(i.posParams,(t,e)=>{s[e]=t.path});const o=i.consumed.length>0?Object.assign(Object.assign({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function We(t,e,n,r,i="corrected"){if(n.length>0&&function(t,e,n){return n.some(n=>qe(t,e,n)&&ze(n)!==_t)}(t,n,r)){const i=new kt(e,function(t,e,n,r){const i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&ze(s)!==_t){const n=new kt([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[ze(s)]=n}return i}(t,e,r,new kt(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>qe(t,e,n))}(t,n,r)){const s=new kt(t.segments,function(t,e,n,r,i,s){const o={};for(const a of r)if(qe(t,n,a)&&!i[ze(a)]){const n=new kt([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===s?t.segments.length:e.length,o[ze(a)]=n}return Object.assign(Object.assign({},i),o)}(t,e,n,r,t.children,i));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}const s=new kt(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function qe(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function Ze(t,e,n,r){return!!(ze(t)===r||r!==_t&&qe(e,n,t))&&("**"===t.path||Ge(e,t,n).matched)}function Ye(t,e,n){return 0===e.length&&!t.children[n]}class Je{constructor(t){this.segmentGroup=t||null}}class Ke{constructor(t){this.urlTree=t}}function Xe(t){return new y.y(e=>e.error(new Je(t)))}function Qe(t){return new y.y(e=>e.error(new Ke(t)))}function tn(t){return new y.y(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class en{constructor(t,e,n,r,s){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(i.h0i)}apply(){const t=We(this.urlTree.root,[],[],this.config).segmentGroup,e=new kt(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,_t).pipe((0,Z.U)(t=>this.createUrlTree(nn(t),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,K.K)(t=>{if(t instanceof Ke)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof Je)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,_t).pipe((0,Z.U)(e=>this.createUrlTree(nn(e),t.queryParams,t.fragment))).pipe((0,K.K)(t=>{if(t instanceof Je)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new kt([],{[_t]:t}):t;return new Nt(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe((0,Z.U)(t=>new kt([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){const r=[];for(const i of Object.keys(n.children))"primary"===i?r.unshift(i):r.push(i);return(0,_.D)(r).pipe((0,X.b)(r=>{const i=n.children[r],s=$e(e,r);return this.expandSegmentGroup(t,s,i,r).pipe((0,Z.U)(t=>({segment:t,outlet:r})))}),(0,J.R)((t,e)=>(t[e.outlet]=e.segment,t),{}),function(t,e){const n=arguments.length>=2;return r=>r.pipe(t?(0,E.h)((e,n)=>t(e,n,r)):F.y,C(1),n?I(e):P(()=>new f))}())}expandSegment(t,e,n,r,i,s){return(0,_.D)(n).pipe((0,X.b)(o=>this.expandSegmentAgainstRoute(t,e,n,o,r,i,s).pipe((0,K.K)(t=>{if(t instanceof Je)return(0,p.of)(null);throw t}))),j(t=>!!t),(0,K.K)((t,n)=>{if(t instanceof f||"EmptyError"===t.name){if(Ye(e,r,i))return(0,p.of)(new kt([],{}));throw new Je(e)}throw t}))}expandSegmentAgainstRoute(t,e,n,r,i,s,o){return Ze(r,e,i,s)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,s):Xe(e):Xe(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,s){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Qe(i):this.lineralizeSegments(n,i).pipe((0,Q.zg)(n=>{const i=new kt(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Ge(e,r,i);if(!o)return Xe(e);const u=this.applyRedirectCommands(a,r.redirectTo,c);return r.redirectTo.startsWith("/")?Qe(u):this.lineralizeSegments(r,u).pipe((0,Q.zg)(r=>this.expandSegment(t,e,n,r.concat(i.slice(l)),s,!1)))}matchSegmentAgainstRoute(t,e,n,r,i){if("**"===n.path)return n.loadChildren?(n._loadedConfig?(0,p.of)(n._loadedConfig):this.configLoader.load(t.injector,n)).pipe((0,Z.U)(t=>(n._loadedConfig=t,new kt(r,{})))):(0,p.of)(new kt(r,{}));const{matched:s,consumedSegments:o,lastChild:a}=Ge(e,n,r);if(!s)return Xe(e);const l=r.slice(a);return this.getChildConfig(t,n,r).pipe((0,Q.zg)(t=>{const r=t.module,s=t.routes,{segmentGroup:a,slicedSegments:c}=We(e,o,l,s),u=new kt(a.segments,a.children);if(0===c.length&&u.hasChildren())return this.expandChildren(r,s,u).pipe((0,Z.U)(t=>new kt(o,t)));if(0===s.length&&0===c.length)return(0,p.of)(new kt(o,{}));const h=ze(n)===i;return this.expandSegment(r,u,s,c,h?_t:i,!0).pipe((0,Z.U)(t=>new kt(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?(0,p.of)(new Re(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?(0,p.of)(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe((0,Q.zg)(n=>n?this.configLoader.load(t.injector,e).pipe((0,Z.U)(t=>(e._loadedConfig=t,t))):function(t){return new y.y(e=>e.error(wt(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):(0,p.of)(new Re([],t))}runCanLoadGuards(t,e,n){const r=e.canLoad;if(!r||0===r.length)return(0,p.of)(!0);const i=r.map(r=>{const i=t.get(r);let s;if(function(t){return t&&Le(t.canLoad)}(i))s=i.canLoad(e,n);else{if(!Le(i))throw new Error("Invalid CanLoad guard");s=i(e,n)}return Mt(s)});return(0,p.of)(i).pipe(ke(),z(t=>{if(!Ie(t))return;const e=wt(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),(0,Z.U)(t=>!0===t))}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return(0,p.of)(n);if(r.numberOfChildren>1||!r.children.primary)return tn(t.redirectTo);r=r.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new Nt(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Ct(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let s={};return Ct(e.children,(e,i)=>{s[i]=this.createSegmentGroup(t,e,n,r)}),new kt(i,s)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function nn(t){const e={};for(const n of Object.keys(t.children)){const r=nn(t.children[n]);(r.segments.length>0||r.hasChildren())&&(e[n]=r)}return function(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new kt(t.segments.concat(e.segments),e.children)}return t}(new kt(t.segments,e))}class rn{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class sn{constructor(t,e){this.component=t,this.route=e}}function on(t,e,n){const r=t._root;return ln(r,e?e._root:null,n,[r.value])}function an(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function ln(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=se(e);return t.children.forEach(t=>{!function(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Bt(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Bt(t.url,e.url)||!St(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!me(t,e)||!St(t.queryParams,e.queryParams);case"paramsChange":default:return!me(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new rn(r)):(s.data=o.data,s._resolvedData=o._resolvedData),ln(t,e,s.component?a?a.children:null:n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new sn(a.outlet.component,o))}else o&&cn(e,a,i),i.canActivateChecks.push(new rn(r)),ln(t,null,s.component?a?a.children:null:n,r,i)}(t,s[t.value.outlet],n,r.concat([t.value]),i),delete s[t.value.outlet]}),Ct(s,(t,e)=>cn(t,n.getContext(e),i)),i}function cn(t,e,n){const r=se(t),i=t.value;Ct(r,(t,r)=>{cn(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new sn(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class un{}function hn(t){return new y.y(e=>e.error(t))}class dn{constructor(t,e,n,r,i,s){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=s}recognize(){const t=We(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,_t);if(null===e)return null;const n=new ue([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},_t,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new ie(n,e),i=new he(this.url,r);return this.inheritParamsAndData(i._root),i}inheritParamsAndData(t){const e=t.value,n=ce(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=[];for(const i of Object.keys(e.children)){const r=e.children[i],s=$e(t,i),o=this.processSegmentGroup(s,r,i);if(null===o)return null;n.push(...o)}const r=pn(n);return r.sort((t,e)=>t.value.outlet===_t?-1:e.value.outlet===_t?1:t.value.outlet.localeCompare(e.value.outlet)),r}processSegment(t,e,n,r){for(const i of t){const t=this.processSegmentAgainstRoute(i,e,n,r);if(null!==t)return t}return Ye(e,n,r)?[]:null}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo||!Ze(t,e,n,r))return null;let i,s=[],o=[];if("**"===t.path){const r=n.length>0?Tt(n).parameters:{};i=new ue(n,r,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,yn(t),ze(t),t.component,t,mn(e),gn(e)+n.length,_n(t))}else{const r=Ge(e,t,n);if(!r.matched)return null;s=r.consumedSegments,o=n.slice(r.lastChild),i=new ue(s,r.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,yn(t),ze(t),t.component,t,mn(e),gn(e)+s.length,_n(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:c}=We(e,s,o,a.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution);if(0===c.length&&l.hasChildren()){const t=this.processChildren(a,l);return null===t?null:[new ie(i,t)]}if(0===a.length&&0===c.length)return[new ie(i,[])];const u=ze(t)===r,h=this.processSegment(a,l,c,u?_t:r);return null===h?null:[new ie(i,h)]}}function fn(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function pn(t){const e=[],n=new Set;for(const r of t){if(!fn(r)){e.push(r);continue}const t=e.find(t=>r.value.routeConfig===t.value.routeConfig);void 0!==t?(t.children.push(...r.children),n.add(t)):e.push(r)}for(const r of n){const t=pn(r.children);e.push(new ie(r.value,t))}return e.filter(t=>!n.has(t))}function mn(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function gn(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function yn(t){return t.data||{}}function _n(t){return t.resolve||{}}function vn(t){return(0,Y.w)(e=>{const n=t(e);return n?(0,_.D)(n).pipe((0,Z.U)(()=>e)):(0,p.of)(e)})}class bn extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const wn=new i.OlP("ROUTES");class xn{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const n=this.loadModuleFactory(e.loadChildren).pipe((0,Z.U)(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new Re(At(r.injector.get(wn,void 0,i.XFs.Self|i.XFs.Optional)).map(Ve),r)}),(0,K.K)(t=>{throw e._loader$=void 0,t}));return e._loader$=new x.c(n,()=>new S.xQ).pipe((0,tt.x)()),e._loader$}loadModuleFactory(t){return"string"==typeof t?(0,_.D)(this.loader.load(t)):Mt(t()).pipe((0,Q.zg)(t=>t instanceof i.YKP?(0,p.of)(t):(0,_.D)(this.compiler.compileModuleAsync(t))))}}class Sn{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new En,this.attachRef=null}}class En{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new Sn,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class An{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function Tn(t){throw t}function Cn(t,e,n){return e.parse("/")}function Mn(t,e){return(0,p.of)(null)}const On={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Pn={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Dn=(()=>{class t{constructor(t,e,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new S.xQ,this.errorHandler=Tn,this.malformedUriErrorHandler=Cn,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Mn,afterPreactivation:Mn},this.urlHandlingStrategy=new An,this.routeReuseStrategy=new bn,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=s.get(i.h0i),this.console=s.get(i.c2e);const c=s.get(i.R0b);this.isNgZoneEnabled=c instanceof i.R0b&&i.R0b.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=new Nt(new kt([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new xn(o,a,t=>this.triggerEvent(new ht(t)),t=>this.triggerEvent(new dt(t))),this.routerState=ae(this.currentUrlTree,this.rootComponentType),this.transitions=new w.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe((0,E.h)(t=>0!==t.id),(0,Z.U)(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),(0,Y.w)(t=>{let n=!1,r=!1;return(0,p.of)(t).pipe(z(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,Y.w)(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return(0,p.of)(t).pipe((0,Y.w)(t=>{const n=this.transitions.getValue();return e.next(new nt(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?v.E:Promise.resolve(t)}),(r=this.ngModule.injector,i=this.configLoader,s=this.urlSerializer,o=this.config,(0,Y.w)(t=>function(t,e,n,r,i){return new en(t,e,n,r,i).apply()}(r,i,s,t.extractedUrl,o).pipe((0,Z.U)(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e}))))),z(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return(0,Q.zg)(s=>function(t,e,n,r,i="emptyOnly",s="legacy"){try{const o=new dn(t,e,n,r,i,s).recognize();return null===o?hn(new un):(0,p.of)(o)}catch(o){return hn(o)}}(t,e,s.urlAfterRedirects,n(s.urlAfterRedirects),r,i).pipe((0,Z.U)(t=>Object.assign(Object.assign({},s),{targetSnapshot:t}))))}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),z(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,t),this.browserUrlTree=t.urlAfterRedirects);const n=new ot(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var r,i,s,o;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:s,extras:o}=t,a=new nt(n,this.serializeUrl(r),i,s);e.next(a);const l=ae(r,this.rootComponentType).snapshot;return(0,p.of)(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:r,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),v.E}),vn(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!o})}),z(t=>{const e=new at(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),(0,Z.U)(t=>Object.assign(Object.assign({},t),{guards:on(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return(0,Q.zg)(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?(0,p.of)(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return(0,_.D)(t).pipe((0,Q.zg)(t=>function(t,e,n,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||0===s.length)return(0,p.of)(!0);const o=s.map(s=>{const o=an(s,e,i);let a;if(function(t){return t&&Le(t.canDeactivate)}(o))a=Mt(o.canDeactivate(t,e,n,r));else{if(!Le(o))throw new Error("Invalid CanDeactivate guard");a=Mt(o(t,e,n,r))}return a.pipe(j())});return(0,p.of)(o).pipe(ke())}(t.component,t.route,n,e,r)),j(t=>!0!==t,!0))}(o,r,i,t).pipe((0,Q.zg)(n=>n&&"boolean"==typeof n?function(t,e,n,r){return(0,_.D)(e).pipe((0,X.b)(e=>g(function(t,e){return null!==t&&e&&e(new ft(t)),(0,p.of)(!0)}(e.route.parent,r),function(t,e){return null!==t&&e&&e(new mt(t)),(0,p.of)(!0)}(e.route,r),function(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>b(()=>{const i=e.guards.map(i=>{const s=an(i,e.node,n);let o;if(function(t){return t&&Le(t.canActivateChild)}(s))o=Mt(s.canActivateChild(r,t));else{if(!Le(s))throw new Error("Invalid CanActivateChild guard");o=Mt(s(r,t))}return o.pipe(j())});return(0,p.of)(i).pipe(ke())}));return(0,p.of)(i).pipe(ke())}(t,e.path,n),function(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return(0,p.of)(!0);const i=r.map(r=>b(()=>{const i=an(r,e,n);let s;if(function(t){return t&&Le(t.canActivate)}(i))s=Mt(i.canActivate(e,t));else{if(!Le(i))throw new Error("Invalid CanActivate guard");s=Mt(i(e,t))}return s.pipe(j())}));return(0,p.of)(i).pipe(ke())}(t,e.route,n))),j(t=>!0!==t,!0))}(r,s,t,e):(0,p.of)(n)),(0,Z.U)(t=>Object.assign(Object.assign({},n),{guardsResult:t})))})}(this.ngModule.injector,t=>this.triggerEvent(t)),z(t=>{if(Ie(t.guardsResult)){const e=wt(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}const e=new lt(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),(0,E.h)(t=>!!t.guardsResult||(this.cancelNavigationTransition(t,""),!1)),vn(t=>{if(t.guards.canActivateChecks.length)return(0,p.of)(t).pipe(z(t=>{const e=new ct(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),(0,Y.w)(t=>{let e=!1;return(0,p.of)(t).pipe((n=this.paramsInheritanceStrategy,r=this.ngModule.injector,(0,Q.zg)(t=>{const{targetSnapshot:e,guards:{canActivateChecks:i}}=t;if(!i.length)return(0,p.of)(t);let s=0;return(0,_.D)(i).pipe((0,X.b)(t=>function(t,e,n,r){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return(0,p.of)({});const s={};return(0,_.D)(i).pipe((0,Q.zg)(i=>function(t,e,n,r){const i=an(t,e,r);return Mt(i.resolve?i.resolve(e,n):i(e,n))}(t[i],e,n,r).pipe(z(t=>{s[i]=t}))),C(1),(0,Q.zg)(()=>Object.keys(s).length===i.length?(0,p.of)(s):v.E))}(t._resolve,t,e,r).pipe((0,Z.U)(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),ce(t,n).resolve),null)))}(t.route,e,n,r)),z(()=>s++),C(1),(0,Q.zg)(e=>s===i.length?(0,p.of)(t):v.E))})),z({next:()=>e=!0,complete:()=>{e||this.cancelNavigationTransition(t,"At least one route resolver didn't emit any value.")}}));var n,r}),z(t=>{const e=new ut(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),vn(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!o})}),(0,Z.U)(t=>{const e=function(t,e,n){const r=ge(t,e._root,n?n._root:void 0);return new oe(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),z(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,t),this.browserUrlTree=t.urlAfterRedirects)}),(s=this.rootContexts,o=this.routeReuseStrategy,a=t=>this.triggerEvent(t),(0,Z.U)(t=>(new Pe(o,t.targetRouterState,t.currentRouterState,a).activate(s),t))),z({next(){n=!0},complete(){n=!0}}),(i=()=>{n||r||this.cancelNavigationTransition(t,`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation=null},t=>t.lift(new W(i))),(0,K.K)(n=>{if(r=!0,(i=n)&&i.ngNavigationCancelingError){const r=Ie(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new it(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),r?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new st(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(s){t.reject(s)}}var i;return v.E}));var i,s,o,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:n,urlTree:r}=e,i={replaceUrl:!0};if(n){const t=Object.assign({},n);delete t.navigationId,delete t.\u0275routerPageId,0!==Object.keys(t).length&&(i.state=t)}this.scheduleNavigation(r,t,n,i)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const n=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&n&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Be(t),this.config=t.map(Ve),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,queryParamsHandling:s,preserveFragment:o}=e,a=n||this.routerState.root,l=o?this.currentUrlTree.fragment:i;let c=null;switch(s){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return be(e.root,e.root,e,r,i);const s=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new xe(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return Ct(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new xe(n,e,r)}(n);if(s.toRoot())return be(e.root,new kt([],{}),e,r,i);const o=function(t,e,n){if(t.isAbsolute)return new Se(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new Se(t,t===e.root,0)}const r=_e(t.commands[0])?0:1;return function(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new Se(r,!1,i-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(s,e,t),a=o.processChildren?Ae(o.segmentGroup,o.index,s.commands):Ee(o.segmentGroup,o.index,s.commands);return be(o.segmentGroup,a,e,r,i)}(a,this.currentUrlTree,t,c,null!=l?l:null)}navigateByUrl(t,e={skipLocationChange:!1}){const n=Ie(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);let i=null;return"computed"===this.canceledNavigationResolution&&(0===this.currentPageId||e.skipLocationChange||e.replaceUrl)&&(i=this.location.getState()),this.scheduleNavigation(r,"imperative",i,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){let n;if(n=!0===e?Object.assign({},On):!1===e?Object.assign({},Pn):e,Ie(t))return Dt(this.currentUrlTree,t,n);const r=this.parseUrl(t);return Dt(this.currentUrlTree,r,n)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new rt(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r,i){if(this.disposed)return Promise.resolve(!1);const s=this.getTransition(),o="imperative"!==e&&"imperative"===(null==s?void 0:s.source),a=(this.lastSuccessfulId===s.id||this.currentNavigation?s.rawUrl:s.urlAfterRedirects).toString()===t.toString();if(o&&a)return Promise.resolve(!0);let l,c,u;i?(l=i.resolve,c=i.reject,u=i.promise):u=new Promise((t,e)=>{l=t,c=e});const h=++this.navigationId;let d;return d="computed"===this.canceledNavigationResolution?n&&n.\u0275routerPageId?n.\u0275routerPageId:this.currentPageId+1:0,this.setTransition({id:h,targetPageId:d,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e){const n=this.urlSerializer.serialize(t),r=Object.assign(Object.assign({},e.extras.state),this.generateNgRouterState(e.id,e.targetPageId));this.location.isCurrentPathEqualTo(n)||e.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,e){"computed"===this.canceledNavigationResolution?"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy||this.location.historyGo(this.currentPageId-t.targetPageId):this.resetUrlToCurrentUrlTree();const n=new it(t.id,this.serializeUrl(t.extractedUrl),e);this.triggerEvent(n),t.resolve(!1)}generateNgRouterState(t,e){return"computed"===this.canceledNavigationResolution?{navigationId:t,"\u0275routerPageId":e}:{navigationId:t}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.DyG),i.LFG(jt),i.LFG(En),i.LFG(r.Ye),i.LFG(i.zs3),i.LFG(i.v3s),i.LFG(i.Sil),i.LFG(void 0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Rn=(()=>{class t{constructor(t,e,n,r,s){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new i.vpe,this.deactivateEvents=new i.vpe,this.name=r||_t,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new Ln(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(En),i.Y36(i.s_b),i.Y36(i._Vd),i.$8M("name"),i.Y36(i.sBO))},t.\u0275dir=i.lG2({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class Ln{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===le?this.route:t===En?this.childContexts:this.parent.get(t,e)}}class In{}class Nn{preload(t,e){return e().pipe((0,K.K)(()=>(0,p.of)(null)))}}class kn{preload(t,e){return(0,p.of)(null)}}let Fn=(()=>{class t{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new xn(e,n,e=>t.triggerEvent(new ht(e)),e=>t.triggerEvent(new dt(e)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,E.h)(t=>t instanceof rt),(0,X.b)(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(i.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return(0,_.D)(n).pipe((0,m.J)(),(0,Z.U)(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>(e._loadedConfig?(0,p.of)(e._loadedConfig):this.loader.load(t.injector,e)).pipe((0,Q.zg)(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Dn),i.LFG(i.v3s),i.LFG(i.Sil),i.LFG(i.zs3),i.LFG(In))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Bn=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof nt?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof rt&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof yt&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new yt(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Dn),i.LFG(r.EM),i.LFG(void 0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const jn=new i.OlP("ROUTER_CONFIGURATION"),Un=new i.OlP("ROUTER_FORROOT_GUARD"),Vn=[r.Ye,{provide:jt,useClass:Ut},{provide:Dn,useFactory:function(t,e,n,r,i,s,o,a={},l,c){const u=new Dn(null,t,e,n,r,i,s,At(o));return l&&(u.urlHandlingStrategy=l),c&&(u.routeReuseStrategy=c),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(a,u),a.enableTracing&&u.events.subscribe(t=>{var e,n;null===(e=console.group)||void 0===e||e.call(console,`Router Event: ${t.constructor.name}`),console.log(t.toString()),console.log(t),null===(n=console.groupEnd)||void 0===n||n.call(console)}),u},deps:[jt,En,r.Ye,i.zs3,i.v3s,i.Sil,wn,jn,[class{},new i.FiY],[class{},new i.FiY]]},En,{provide:le,useFactory:function(t){return t.routerState.root},deps:[Dn]},{provide:i.v3s,useClass:i.EAV},Fn,kn,Nn,{provide:jn,useValue:{enableTracing:!1}}];function zn(){return new i.PXZ("Router",Dn)}let $n=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[Vn,qn(e),{provide:Un,useFactory:Wn,deps:[[Dn,new i.FiY,new i.tp0]]},{provide:jn,useValue:n||{}},{provide:r.S$,useFactory:Gn,deps:[r.lw,[new i.tBr(r.mr),new i.FiY],jn]},{provide:Bn,useFactory:Hn,deps:[Dn,r.EM,jn]},{provide:In,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:kn},{provide:i.PXZ,multi:!0,useFactory:zn},[Zn,{provide:i.ip1,multi:!0,useFactory:Yn,deps:[Zn]},{provide:Kn,useFactory:Jn,deps:[Zn]},{provide:i.tb,multi:!0,useExisting:Kn}]]}}static forChild(e){return{ngModule:t,providers:[qn(e)]}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Un,8),i.LFG(Dn,8))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();function Hn(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Bn(t,e,n)}function Gn(t,e,n={}){return n.useHash?new r.Do(t,e):new r.b0(t,e)}function Wn(t){return"guarded"}function qn(t){return[{provide:i.deG,multi:!0,useValue:t},{provide:wn,multi:!0,useValue:t}]}let Zn=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new S.xQ}appInitializer(){return this.injector.get(r.V_,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(Dn),r=this.injector.get(jn);return"disabled"===r.initialNavigation?(n.setUpLocationChangeListener(),t(!0)):"enabled"===r.initialNavigation||"enabledBlocking"===r.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?(0,p.of)(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()):t(!0),e})}bootstrapListener(t){const e=this.injector.get(jn),n=this.injector.get(Fn),r=this.injector.get(Bn),s=this.injector.get(Dn),o=this.injector.get(i.z2F);t===o.components[0]&&("enabledNonBlocking"!==e.initialNavigation&&void 0!==e.initialNavigation||s.initialNavigation(),n.setUpPreloading(),r.init(),s.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.zs3))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function Yn(t){return t.appInitializer.bind(t)}function Jn(t){return t.bootstrapListener.bind(t)}const Kn=new i.OlP("Router Initializer")},9474:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{FT:()=>StoreDevtoolsModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5366),_ngrx_store__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9878),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(653),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8318),rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(878),rxjs__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1906),rxjs__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(8489),rxjs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(6019),rxjs_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1055),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3835),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9996),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(436),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2707),rxjs_operators__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(7701),rxjs_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(7727),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(611),rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(5416),rxjs_operators__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(4689),rxjs_operators__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(4698),rxjs_operators__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(9971),rxjs_operators__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(2728),rxjs_operators__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(2023);class StoreDevtoolsConfig{constructor(){this.maxAge=!1}}const STORE_DEVTOOLS_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Options"),INITIAL_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Initial Config");function noMonitor(){return null}const DEFAULT_NAME="NgRx Store DevTools";function createConfig(t){const e={maxAge:!1,monitor:noMonitor,actionSanitizer:void 0,stateSanitizer:void 0,name:DEFAULT_NAME,serialize:!1,logOnly:!1,autoPause:!1,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0}},n="function"==typeof t?t():t,r=Object.assign({},e,{features:n.features||!!n.logOnly&&{pause:!0,export:!0,test:!0}||e.features},n);if(r.maxAge&&r.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${r.maxAge}`);return r}const PERFORM_ACTION="PERFORM_ACTION",REFRESH="REFRESH",RESET="RESET",ROLLBACK="ROLLBACK",COMMIT="COMMIT",SWEEP="SWEEP",TOGGLE_ACTION="TOGGLE_ACTION",SET_ACTIONS_ACTIVE="SET_ACTIONS_ACTIVE",JUMP_TO_STATE="JUMP_TO_STATE",JUMP_TO_ACTION="JUMP_TO_ACTION",IMPORT_STATE="IMPORT_STATE",LOCK_CHANGES="LOCK_CHANGES",PAUSE_RECORDING="PAUSE_RECORDING";class PerformAction{constructor(t,e){if(this.action=t,this.timestamp=e,this.type=PERFORM_ACTION,void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}}class Refresh{constructor(){this.type=REFRESH}}class Reset{constructor(t){this.timestamp=t,this.type=RESET}}class Rollback{constructor(t){this.timestamp=t,this.type=ROLLBACK}}class Commit{constructor(t){this.timestamp=t,this.type=COMMIT}}class Sweep{constructor(){this.type=SWEEP}}class ToggleAction{constructor(t){this.id=t,this.type=TOGGLE_ACTION}}class SetActionsActive{constructor(t,e,n=!0){this.start=t,this.end=e,this.active=n,this.type=SET_ACTIONS_ACTIVE}}class JumpToState{constructor(t){this.index=t,this.type=JUMP_TO_STATE}}class JumpToAction{constructor(t){this.actionId=t,this.type=JUMP_TO_ACTION}}class ImportState{constructor(t){this.nextLiftedState=t,this.type=IMPORT_STATE}}class LockChanges{constructor(t){this.status=t,this.type=LOCK_CHANGES}}class PauseRecording{constructor(t){this.status=t,this.type=PAUSE_RECORDING}}let DevtoolsDispatcher=(()=>{class t extends _ngrx_store__WEBPACK_IMPORTED_MODULE_1__.UO{}return t.\u0275fac=function(){let e;return function(n){return(e||(e=_angular_core__WEBPACK_IMPORTED_MODULE_0__.n5z(t)))(n||t)}}(),t.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:t,factory:t.\u0275fac}),t})();function difference(t,e){return t.filter(t=>e.indexOf(t)<0)}function unliftState(t){const{computedStates:e,currentStateIndex:n}=t;if(n>=e.length){const{state:t}=e[e.length-1];return t}const{state:r}=e[n];return r}function unliftAction(t){return t.actionsById[t.nextActionId-1]}function liftAction(t){return new PerformAction(t,+Date.now())}function sanitizeActions(t,e){return Object.keys(e).reduce((n,r)=>{const i=Number(r);return n[i]=sanitizeAction(t,e[i],i),n},{})}function sanitizeAction(t,e,n){return Object.assign(Object.assign({},e),{action:t(e.action,n)})}function sanitizeStates(t,e){return e.map((e,n)=>({state:sanitizeState(t,e.state,n),error:e.error}))}function sanitizeState(t,e,n){return t(e,n)}function shouldFilterActions(t){return t.predicate||t.actionsSafelist||t.actionsBlocklist}function filterLiftedState(t,e,n,r){const i=[],s={},o=[];return t.stagedActionIds.forEach((a,l)=>{const c=t.actionsById[a];c&&(l&&isActionFiltered(t.computedStates[l],c,e,n,r)||(s[a]=c,i.push(a),o.push(t.computedStates[l])))}),Object.assign(Object.assign({},t),{stagedActionIds:i,actionsById:s,computedStates:o})}function isActionFiltered(t,e,n,r,i){const s=n&&!n(t,e.action),o=r&&!e.action.type.match(r.map(t=>escapeRegExp(t)).join("|")),a=i&&e.action.type.match(i.map(t=>escapeRegExp(t)).join("|"));return s||o||a}function escapeRegExp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const ExtensionActionTypes={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},REDUX_DEVTOOLS_EXTENSION=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Redux Devtools Extension");let DevtoolsExtension=(()=>{class DevtoolsExtension{constructor(t,e,n){this.config=e,this.dispatcher=n,this.devtoolsExtension=t,this.createActionStreams()}notify(t,e){if(this.devtoolsExtension)if(t.type===PERFORM_ACTION){if(e.isLocked||e.isPaused)return;const n=unliftState(e);if(shouldFilterActions(this.config)&&isActionFiltered(n,t,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;const r=this.config.stateSanitizer?sanitizeState(this.config.stateSanitizer,n,e.currentStateIndex):n,i=this.config.actionSanitizer?sanitizeAction(this.config.actionSanitizer,t,e.nextActionId):t;this.sendToReduxDevtools(()=>this.extensionConnection.send(i,r))}else{const t=Object.assign(Object.assign({},e),{stagedActionIds:e.stagedActionIds,actionsById:this.config.actionSanitizer?sanitizeActions(this.config.actionSanitizer,e.actionsById):e.actionsById,computedStates:this.config.stateSanitizer?sanitizeStates(this.config.stateSanitizer,e.computedStates):e.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,t,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new rxjs__WEBPACK_IMPORTED_MODULE_3__.y(t=>{const e=this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=e,e.init(),e.subscribe(e=>t.next(e)),e.unsubscribe}):rxjs__WEBPACK_IMPORTED_MODULE_2__.E}createActionStreams(){const t=this.createChangesObservable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.B)()),e=t.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(t=>t.type===ExtensionActionTypes.START)),n=t.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(t=>t.type===ExtensionActionTypes.STOP)),r=t.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(t=>t.type===ExtensionActionTypes.DISPATCH),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(t=>this.unwrapAction(t.payload)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.b)(t=>t.type===IMPORT_STATE?this.dispatcher.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(t=>t.type===_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.wb),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.V)(1e3),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_9__.b)(1e3),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(()=>t),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.K)(()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)(t)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.q)(1)):(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.of)(t))),i=t.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.h)(t=>t.type===ExtensionActionTypes.ACTION),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(t=>this.unwrapAction(t.payload))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.R)(n)),s=r.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.R)(n));this.start$=e.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.R)(n)),this.actions$=this.start$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.w)(()=>i)),this.liftedActions$=this.start$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.w)(()=>s))}unwrapAction(action){return"string"==typeof action?eval(`(${action})`):action}getExtensionConfig(t){var e;const n={name:t.name,features:t.features,serialize:t.serialize,autoPause:null!==(e=t.autoPause)&&void 0!==e&&e};return!1!==t.maxAge&&(n.maxAge=t.maxAge),n}sendToReduxDevtools(t){try{t()}catch(e){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",e)}}}return DevtoolsExtension.\u0275fac=function(t){return new(t||DevtoolsExtension)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(REDUX_DEVTOOLS_EXTENSION),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(STORE_DEVTOOLS_CONFIG),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(DevtoolsDispatcher))},DevtoolsExtension.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:DevtoolsExtension,factory:DevtoolsExtension.\u0275fac}),DevtoolsExtension})();const INIT_ACTION={type:_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.qg},RECOMPUTE="@ngrx/store-devtools/recompute",RECOMPUTE_ACTION={type:RECOMPUTE};function computeNextEntry(t,e,n,r,i){if(r)return{state:n,error:"Interrupted by an error up the chain"};let s,o=n;try{o=t(n,e)}catch(a){s=a.toString(),i.handleError(a)}return{state:o,error:s}}function recomputeStates(t,e,n,r,i,s,o,a,l){if(e>=t.length&&t.length===s.length)return t;const c=t.slice(0,e),u=s.length-(l?1:0);for(let h=e;h<u;h++){const t=s[h],e=i[t].action,l=c[h-1],u=l?l.state:r,d=l?l.error:void 0,f=o.indexOf(t)>-1?l:computeNextEntry(n,e,u,d,a);c.push(f)}return l&&c.push(t[t.length-1]),c}function liftInitialState(t,e){return{monitorState:e(void 0,{}),nextActionId:1,actionsById:{0:liftAction(INIT_ACTION)},stagedActionIds:[0],skippedActionIds:[],committedState:t,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function liftReducerWith(t,e,n,r,i={}){return s=>(o,a)=>{let{monitorState:l,actionsById:c,nextActionId:u,stagedActionIds:h,skippedActionIds:d,committedState:f,currentStateIndex:p,computedStates:m,isLocked:g,isPaused:y}=o||e;function _(t){let e=t,n=h.slice(1,e+1);for(let r=0;r<n.length;r++){if(m[r+1].error){e=r,n=h.slice(1,e+1);break}delete c[n[r]]}d=d.filter(t=>-1===n.indexOf(t)),h=[0,...h.slice(e+1)],f=m[e].state,m=m.slice(e),p=p>e?p-e:0}function v(){c={0:liftAction(INIT_ACTION)},u=1,h=[0],d=[],f=m[p].state,p=0,m=[]}o||(c=Object.create(c));let b=0;switch(a.type){case LOCK_CHANGES:g=a.status,b=1/0;break;case PAUSE_RECORDING:y=a.status,y?(h=[...h,u],c[u]=new PerformAction({type:"@ngrx/devtools/pause"},+Date.now()),u++,b=h.length-1,m=m.concat(m[m.length-1]),p===h.length-2&&p++,b=1/0):v();break;case RESET:c={0:liftAction(INIT_ACTION)},u=1,h=[0],d=[],f=t,p=0,m=[];break;case COMMIT:v();break;case ROLLBACK:c={0:liftAction(INIT_ACTION)},u=1,h=[0],d=[],p=0,m=[];break;case TOGGLE_ACTION:{const{id:t}=a,e=d.indexOf(t);d=-1===e?[t,...d]:d.filter(e=>e!==t),b=h.indexOf(t);break}case SET_ACTIONS_ACTIVE:{const{start:t,end:e,active:n}=a,r=[];for(let i=t;i<e;i++)r.push(i);d=n?difference(d,r):[...d,...r],b=h.indexOf(t);break}case JUMP_TO_STATE:p=a.index,b=1/0;break;case JUMP_TO_ACTION:{const t=h.indexOf(a.actionId);-1!==t&&(p=t),b=1/0;break}case SWEEP:h=difference(h,d),d=[],p=Math.min(p,h.length-1);break;case PERFORM_ACTION:{if(g)return o||e;if(y||o&&isActionFiltered(o.computedStates[p],a,i.predicate,i.actionsSafelist,i.actionsBlocklist)){const t=m[m.length-1];m=[...m.slice(0,-1),computeNextEntry(s,a.action,t.state,t.error,n)],b=1/0;break}i.maxAge&&h.length===i.maxAge&&_(1),p===h.length-1&&p++;const t=u++;c[t]=a,h=[...h,t],b=h.length-1;break}case IMPORT_STATE:({monitorState:l,actionsById:c,nextActionId:u,stagedActionIds:h,skippedActionIds:d,committedState:f,currentStateIndex:p,computedStates:m,isLocked:g,isPaused:y}=a.nextLiftedState);break;case _ngrx_store__WEBPACK_IMPORTED_MODULE_1__.qg:b=0,i.maxAge&&h.length>i.maxAge&&(m=recomputeStates(m,b,s,f,c,h,d,n,y),_(h.length-i.maxAge),b=1/0);break;case _ngrx_store__WEBPACK_IMPORTED_MODULE_1__.wb:if(m.filter(t=>t.error).length>0)b=0,i.maxAge&&h.length>i.maxAge&&(m=recomputeStates(m,b,s,f,c,h,d,n,y),_(h.length-i.maxAge),b=1/0);else{if(!y&&!g){p===h.length-1&&p++;const t=u++;c[t]=new PerformAction(a,+Date.now()),h=[...h,t],b=h.length-1,m=recomputeStates(m,b,s,f,c,h,d,n,y)}m=m.map(t=>Object.assign(Object.assign({},t),{state:s(t.state,RECOMPUTE_ACTION)})),p=h.length-1,i.maxAge&&h.length>i.maxAge&&_(h.length-i.maxAge),b=1/0}break;default:b=1/0}return m=recomputeStates(m,b,s,f,c,h,d,n,y),l=r(l,a),{monitorState:l,actionsById:c,nextActionId:u,stagedActionIds:h,skippedActionIds:d,committedState:f,currentStateIndex:p,computedStates:m,isLocked:g,isPaused:y}}}let StoreDevtools=(()=>{class t{constructor(t,e,n,r,i,s,o,a){const l=liftInitialState(o,a.monitor),c=liftReducerWith(o,l,s,a.monitor,a),u=(0,rxjs__WEBPACK_IMPORTED_MODULE_15__.T)((0,rxjs__WEBPACK_IMPORTED_MODULE_15__.T)(e.asObservable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.T)(1)),r.actions$).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(liftAction)),t,r.liftedActions$).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.QV)(rxjs__WEBPACK_IMPORTED_MODULE_18__.N)),h=n.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(c)),d=new rxjs__WEBPACK_IMPORTED_MODULE_19__.t(1),f=u.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_20__.M)(h),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.R)(({state:t},[e,n])=>{let i=n(t,e);return e.type!==PERFORM_ACTION&&shouldFilterActions(a)&&(i=filterLiftedState(i,a.predicate,a.actionsSafelist,a.actionsBlocklist)),r.notify(e,i),{state:i,action:e}},{state:l,action:null})).subscribe(({state:t,action:e})=>{d.next(t),e.type===PERFORM_ACTION&&i.next(e.action)}),p=r.start$.subscribe(()=>{this.refresh()}),m=d.asObservable(),g=m.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.U)(unliftState));this.extensionStartSubscription=p,this.stateSubscription=f,this.dispatcher=t,this.liftedState=m,this.state=g}dispatch(t){this.dispatcher.next(t)}next(t){this.dispatcher.next(t)}error(t){}complete(){}performAction(t){this.dispatch(new PerformAction(t,+Date.now()))}refresh(){this.dispatch(new Refresh)}reset(){this.dispatch(new Reset(+Date.now()))}rollback(){this.dispatch(new Rollback(+Date.now()))}commit(){this.dispatch(new Commit(+Date.now()))}sweep(){this.dispatch(new Sweep)}toggleAction(t){this.dispatch(new ToggleAction(t))}jumpToAction(t){this.dispatch(new JumpToAction(t))}jumpToState(t){this.dispatch(new JumpToState(t))}importState(t){this.dispatch(new ImportState(t))}lockChanges(t){this.dispatch(new LockChanges(t))}pauseRecording(t){this.dispatch(new PauseRecording(t))}}return t.\u0275fac=function(e){return new(e||t)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(DevtoolsDispatcher),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.UO),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.n$),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(DevtoolsExtension),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.Y$),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_angular_core__WEBPACK_IMPORTED_MODULE_0__.qLn),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.Y6),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(STORE_DEVTOOLS_CONFIG))},t.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:t,factory:t.\u0275fac}),t})();const IS_EXTENSION_OR_MONITOR_PRESENT=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function createIsExtensionOrMonitorPresent(t,e){return Boolean(t)||e.monitor!==noMonitor}function createReduxDevtoolsExtension(){const t="__REDUX_DEVTOOLS_EXTENSION__";return"object"==typeof window&&void 0!==window[t]?window[t]:null}function createStateObservable(t){return t.state}let StoreDevtoolsModule=(()=>{class t{static instrument(e={}){return{ngModule:t,providers:[DevtoolsExtension,DevtoolsDispatcher,StoreDevtools,{provide:INITIAL_OPTIONS,useValue:e},{provide:IS_EXTENSION_OR_MONITOR_PRESENT,deps:[REDUX_DEVTOOLS_EXTENSION,STORE_DEVTOOLS_CONFIG],useFactory:createIsExtensionOrMonitorPresent},{provide:REDUX_DEVTOOLS_EXTENSION,useFactory:createReduxDevtoolsExtension},{provide:STORE_DEVTOOLS_CONFIG,deps:[INITIAL_OPTIONS],useFactory:createConfig},{provide:_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.FR,deps:[StoreDevtools],useFactory:createStateObservable},{provide:_ngrx_store__WEBPACK_IMPORTED_MODULE_1__.mK,useExisting:DevtoolsDispatcher}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:t}),t.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({}),t})()},9878:(t,e,n)=>{"use strict";n.d(e,{hg:()=>V,UO:()=>b,qg:()=>v,Y6:()=>E,mK:()=>q,n$:()=>W,Y$:()=>K,FR:()=>Q,yh:()=>rt,Aw:()=>Tt,wb:()=>Z,PH:()=>g,rM:()=>dt,Ky:()=>y,Ys:()=>st});var r=n(5366),i=n(8512),s=n(8318),o=n(5959),a=n(8489),l=n(9996),c=n(6673);class u{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new h(t,this.compare,this.keySelector))}}class h extends c.L{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(r){return this.destination.error(r)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(r){return this.destination.error(r)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}var d=n(9971),f=n(2728),p=n(2023);const m={};function g(t,e){if(m[t]=(m[t]||0)+1,"function"==typeof e)return _(t,(...n)=>Object.assign(Object.assign({},e(...n)),{type:t}));switch(e?e._as:"empty"){case"empty":return _(t,()=>({type:t}));case"props":return _(t,e=>Object.assign(Object.assign({},e),{type:t}));default:throw new Error("Unexpected config.")}}function y(){return{_as:"props",_p:void 0}}function _(t,e){return Object.defineProperty(e,"type",{value:t,writable:!1})}const v="@ngrx/store/init";let b=(()=>{class t extends i.X{constructor(){super({type:v})}next(t){if("function"==typeof t)throw new TypeError("\n        Dispatch expected an object, instead it received a function.\n        If you're using the createAction function, make sure to invoke the function\n        before dispatching the action. For example, someAction should be someAction().");if(void 0===t)throw new TypeError("Actions must be objects");if(void 0===t.type)throw new TypeError("Actions must have a type property");super.next(t)}complete(){}ngOnDestroy(){super.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();const w=[b],x=new r.OlP("@ngrx/store Internal Root Guard"),S=new r.OlP("@ngrx/store Internal Initial State"),E=new r.OlP("@ngrx/store Initial State"),A=new r.OlP("@ngrx/store Reducer Factory"),T=new r.OlP("@ngrx/store Internal Reducer Factory Provider"),C=new r.OlP("@ngrx/store Initial Reducers"),M=new r.OlP("@ngrx/store Internal Initial Reducers"),O=new r.OlP("@ngrx/store Store Features"),P=new r.OlP("@ngrx/store Internal Store Reducers"),D=new r.OlP("@ngrx/store Internal Feature Reducers"),R=new r.OlP("@ngrx/store Internal Feature Configs"),L=new r.OlP("@ngrx/store Internal Store Features"),I=new r.OlP("@ngrx/store Internal Feature Reducers Token"),N=new r.OlP("@ngrx/store Feature Reducers"),k=new r.OlP("@ngrx/store User Provided Meta Reducers"),F=new r.OlP("@ngrx/store Meta Reducers"),B=new r.OlP("@ngrx/store Internal Resolved Meta Reducers"),j=new r.OlP("@ngrx/store User Runtime Checks Config"),U=new r.OlP("@ngrx/store Internal User Runtime Checks Config"),V=new r.OlP("@ngrx/store Internal Runtime Checks"),z=new r.OlP("@ngrx/store Check if Action types are unique");function $(t,e={}){const n=Object.keys(t),r={};for(let s=0;s<n.length;s++){const e=n[s];"function"==typeof t[e]&&(r[e]=t[e])}const i=Object.keys(r);return function(t,n){t=void 0===t?e:t;let s=!1;const o={};for(let e=0;e<i.length;e++){const a=i[e],l=t[a],c=(0,r[a])(l,n);o[a]=c,s=s||c!==l}return s?o:t}}function H(...t){return function(e){if(0===t.length)return e;const n=t[t.length-1];return t.slice(0,-1).reduceRight((t,e)=>e(t),n(e))}}function G(t,e){return Array.isArray(e)&&e.length>0&&(t=H.apply(null,[...e,t])),(e,n)=>{const r=t(e);return(t,e)=>r(t=void 0===t?n:t,e)}}class W extends s.y{}class q extends b{}const Z="@ngrx/store/update-reducers";let Y=(()=>{class t extends i.X{constructor(t,e,n,r){super(r(n,e)),this.dispatcher=t,this.initialState=e,this.reducers=n,this.reducerFactory=r}addFeature(t){this.addFeatures([t])}addFeatures(t){const e=t.reduce((t,{reducers:e,reducerFactory:n,metaReducers:r,initialState:i,key:s})=>{const o="function"==typeof e?function(t){const e=Array.isArray(t)&&t.length>0?H(...t):t=>t;return(t,n)=>(t=e(t),(e,r)=>t(e=void 0===e?n:e,r))}(r)(e,i):G(n,r)(e,i);return t[s]=o,t},{});this.addReducers(e)}removeFeature(t){this.removeFeatures([t])}removeFeatures(t){this.removeReducers(t.map(t=>t.key))}addReducer(t,e){this.addReducers({[t]:e})}addReducers(t){this.reducers=Object.assign(Object.assign({},this.reducers),t),this.updateReducers(Object.keys(t))}removeReducer(t){this.removeReducers([t])}removeReducers(t){t.forEach(t=>{var e,n;this.reducers=(e=this.reducers,n=t,Object.keys(e).filter(t=>t!==n).reduce((t,n)=>Object.assign(t,{[n]:e[n]}),{}))}),this.updateReducers(t)}updateReducers(t){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:Z,features:t})}ngOnDestroy(){this.complete()}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(q),r.LFG(E),r.LFG(C),r.LFG(A))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();const J=[Y,{provide:W,useExisting:Y},{provide:q,useExisting:b}];let K=(()=>{class t extends o.xQ{ngOnDestroy(){this.complete()}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=r.n5z(t)))(n||t)}}(),t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();const X=[K];class Q extends s.y{}let tt=(()=>{class t extends i.X{constructor(t,e,n,r){super(r);const i=t.pipe((0,d.QV)(a.N)).pipe((0,f.M)(e)).pipe((0,p.R)(et,{state:r}));this.stateSubscription=i.subscribe(({state:t,action:e})=>{this.next(t),n.next(e)})}ngOnDestroy(){this.stateSubscription.unsubscribe(),this.complete()}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(b),r.LFG(W),r.LFG(K),r.LFG(E))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t.INIT=v,t})();function et(t={state:void 0},[e,n]){const{state:r}=t;return{state:n(r,e),action:e}}const nt=[tt,{provide:Q,useExisting:tt}];let rt=(()=>{class t extends s.y{constructor(t,e,n){super(),this.actionsObserver=e,this.reducerManager=n,this.source=t}select(t,...e){return st.call(null,t,...e)(this)}lift(e){const n=new t(this,this.actionsObserver,this.reducerManager);return n.operator=e,n}dispatch(t){this.actionsObserver.next(t)}next(t){this.actionsObserver.next(t)}error(t){this.actionsObserver.error(t)}complete(){this.actionsObserver.complete()}addReducer(t,e){this.reducerManager.addReducer(t,e)}removeReducer(t){this.reducerManager.removeReducer(t)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(Q),r.LFG(b),r.LFG(Y))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();const it=[rt];function st(t,e,...n){return function(r){let i;if("string"==typeof t){const s=[e,...n].filter(Boolean);i=r.pipe(function(...t){const e=t.length;if(0===e)throw new Error("list of properties cannot be empty.");return n=>(0,l.U)(function(t,e){return n=>{let r=n;for(let i=0;i<e;i++){const e=null!=r?r[t[i]]:void 0;if(void 0===e)return;r=e}return r}}(t,e))(n)}(t,...s))}else{if("function"!=typeof t)throw new TypeError(`Unexpected type '${typeof t}' in select operator, expected 'string' or 'function'`);i=r.pipe((0,l.U)(n=>t(n,e)))}return i.pipe(t=>t.lift(new u(void 0,void 0)))}}const ot="https://ngrx.io/guide/store/configuration/runtime-checks";function at(t){return void 0===t}function lt(t){return null===t}function ct(t){return Array.isArray(t)}function ut(t){return"object"==typeof t&&null!==t}function ht(t){return"function"==typeof t}function dt(){return!1}function ft(t){Object.freeze(t);const e=ht(t);return Object.getOwnPropertyNames(t).forEach(n=>{if(!n.startsWith("\u0275")&&function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(t,n)&&(!e||"caller"!==n&&"callee"!==n&&"arguments"!==n)){const e=t[n];!ut(e)&&!ht(e)||Object.isFrozen(e)||ft(e)}}),t}function pt(t,e=[]){return(at(t)||lt(t))&&0===e.length?{path:["root"],value:t}:Object.keys(t).reduce((n,r)=>{if(n)return n;const i=t[r];return function(t){return ht(t)&&t.hasOwnProperty("\u0275cmp")}(i)?n:!(at(i)||lt(i)||function(t){return"number"==typeof t}(i)||function(t){return"boolean"==typeof t}(i)||function(t){return"string"==typeof t}(i)||ct(i))&&(function(t){if(!function(t){return ut(t)&&!ct(t)}(t))return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}(i)?pt(i,[...e,r]):{path:[...e,r],value:i})},!1)}function mt(t,e){if(!1===t)return;const n=t.path.join("."),r=new Error(`Detected unserializable ${e} at "${n}". ${ot}#strict${e}serializability`);throw r.value=t.value,r.unserializablePath=n,r}function gt(t){return(0,r.X6Q)()?Object.assign({strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!0,strictActionImmutability:!0,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1},t):{strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!1,strictActionImmutability:!1,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1}}function yt({strictActionSerializability:t,strictStateSerializability:e}){return n=>t||e?function(t,e){return function(n,r){e.action(r)&&mt(pt(r),"action");const i=t(n,r);return e.state()&&mt(pt(i),"state"),i}}(n,{action:e=>t&&!vt(e),state:()=>e}):n}function _t({strictActionImmutability:t,strictStateImmutability:e}){return n=>t||e?function(t,e){return function(n,r){const i=e.action(r)?ft(r):r,s=t(n,i);return e.state()?ft(s):s}}(n,{action:e=>t&&!vt(e),state:()=>e}):n}function vt(t){return t.type.startsWith("@ngrx")}function bt({strictActionWithinNgZone:t}){return e=>t?function(t,e){return function(n,i){if(e.action(i)&&!r.R0b.isInAngularZone())throw new Error(`Action '${i.type}' running outside NgZone. ${ot}#strictactionwithinngzone`);return t(n,i)}}(e,{action:e=>t&&!vt(e)}):e}function wt(){return[{provide:z,multi:!0,deps:[V],useFactory:St}]}function xt(t){return t}function St(t){if(!t.strictActionTypeUniqueness)return;const e=Object.entries(m).filter(([,t])=>t>1).map(([t])=>t);if(e.length)throw new Error(`Action types are registered more than once, ${e.map(t=>`"${t}"`).join(", ")}. ${ot}#strictactiontypeuniqueness`)}let Et=(()=>{class t{constructor(t,e,n,r,i,s){}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(b),r.LFG(W),r.LFG(K),r.LFG(rt),r.LFG(x,8),r.LFG(z,8))},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})(),At=(()=>{class t{constructor(t,e,n,r,i){this.features=t,this.featureReducers=e,this.reducerManager=n;const s=t.map((t,n)=>{const r=e.shift()[n];return Object.assign(Object.assign({},t),{reducers:r,initialState:Pt(t.initialState)})});n.addFeatures(s)}ngOnDestroy(){this.reducerManager.removeFeatures(this.features)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(L),r.LFG(N),r.LFG(Y),r.LFG(Et),r.LFG(z,8))},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})(),Tt=(()=>{class t{static forRoot(t,e={}){return{ngModule:Et,providers:[{provide:x,useFactory:Rt,deps:[[rt,new r.FiY,new r.tp0]]},{provide:S,useValue:e.initialState},{provide:E,useFactory:Pt,deps:[S]},{provide:M,useValue:t},{provide:P,useExisting:t instanceof r.OlP?t:M},{provide:C,deps:[r.zs3,M,[new r.tBr(P)]],useFactory:Ct},{provide:k,useValue:e.metaReducers?e.metaReducers:[]},{provide:B,deps:[F,k],useFactory:Dt},{provide:T,useValue:e.reducerFactory?e.reducerFactory:$},{provide:A,deps:[T,B],useFactory:G},w,J,X,nt,it,(n=e.runtimeChecks,[{provide:U,useValue:n},{provide:j,useFactory:xt,deps:[U]},{provide:V,deps:[j],useFactory:gt},{provide:F,multi:!0,deps:[V],useFactory:_t},{provide:F,multi:!0,deps:[V],useFactory:yt},{provide:F,multi:!0,deps:[V],useFactory:bt}]),wt()]};var n}static forFeature(t,e,n={}){return{ngModule:At,providers:[{provide:R,multi:!0,useValue:t instanceof Object?{}:n},{provide:O,multi:!0,useValue:{key:t instanceof Object?t.name:t,reducerFactory:n instanceof r.OlP||!n.reducerFactory?$:n.reducerFactory,metaReducers:n instanceof r.OlP||!n.metaReducers?[]:n.metaReducers,initialState:n instanceof r.OlP||!n.initialState?void 0:n.initialState}},{provide:L,deps:[r.zs3,R,O],useFactory:Mt},{provide:D,multi:!0,useValue:t instanceof Object?t.reducer:e},{provide:I,multi:!0,useExisting:e instanceof r.OlP?e:D},{provide:N,multi:!0,deps:[r.zs3,D,[new r.tBr(I)]],useFactory:Ot},wt()]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})();function Ct(t,e){return e instanceof r.OlP?t.get(e):e}function Mt(t,e,n){return n.map((n,i)=>{if(e[i]instanceof r.OlP){const r=t.get(e[i]);return{key:n.key,reducerFactory:r.reducerFactory?r.reducerFactory:$,metaReducers:r.metaReducers?r.metaReducers:[],initialState:r.initialState}}return n})}function Ot(t,e){return e.map(e=>e instanceof r.OlP?t.get(e):e)}function Pt(t){return"function"==typeof t?t():t}function Dt(t,e){return t.concat(e)}function Rt(t){if(t)throw new TypeError("StoreModule.forRoot() called twice. Feature modules should use StoreModule.forFeature() instead.");return"guarded"}},1399:function(module){var e;"undefined"!=typeof self&&self,e=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,(function(e){return t[e]}).bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=95)}([function(t,e,n){"use strict";e.arrayAtomicsSymbol=Symbol("mongoose#Array#_atomics"),e.arrayParentSymbol=Symbol("mongoose#Array#_parent"),e.arrayPathSymbol=Symbol("mongoose#Array#_path"),e.arraySchemaSymbol=Symbol("mongoose#Array#_schema"),e.documentArrayParent=Symbol("mongoose:documentArrayParent"),e.documentIsSelected=Symbol("mongoose#Document#isSelected"),e.documentIsModified=Symbol("mongoose#Document#isModified"),e.documentModifiedPaths=Symbol("mongoose#Document#modifiedPaths"),e.documentSchemaSymbol=Symbol("mongoose#Document#schema"),e.getSymbol=Symbol("mongoose#Document#get"),e.modelSymbol=Symbol("mongoose#Model"),e.objectIdSymbol=Symbol("mongoose#ObjectId"),e.populateModelSymbol=Symbol("mongoose.PopulateOptions#Model"),e.schemaTypeSymbol=Symbol("mongoose#schemaType"),e.sessionNewDocuments=Symbol("mongoose:ClientSession#newDocuments"),e.scopeSymbol=Symbol("mongoose#Document#scope"),e.validatorErrorSymbol=Symbol("mongoose:validatorError")},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o,a=n(113),l=n(49),c=n(62),u=n(63).Buffer,h=n(20),d=n(7),f=n(116),p=n(29),m=n(22),g=n(21),y=n(66),_=n(65),v=n(30),b=n(25),w=n(71),x=n(50);function S(t){if(Array.isArray(t.populate)){var n=[];t.populate.forEach(function(t){if(/[\s]/.test(t.path)){var r=Object.assign({},t);r.path.split(" ").forEach(function(t){r.path=t,n.push(e.populate(r)[0])})}else n.push(e.populate(t)[0])}),t.populate=e.populate(n)}else null!=t.populate&&"object"===s(t.populate)&&(t.populate=e.populate(t.populate));var i=[],o=t.path.split(" ");null!=t.options&&(t.options=e.clone(t.options));var a,l=r(o);try{for(l.s();!(a=l.n()).done;)i.push(new f(Object.assign({},t,{path:a.value})))}catch(t){l.e(t)}finally{l.f()}return i}e.specialProperties=x,e.toCollectionName=function(t,e){return"system.profile"===t||"system.indexes"===t?t:"function"==typeof e?e(t):t},e.deepEqual=function t(n,r){if(n===r)return!0;if("object"!==s(n)&&"object"!==s(r))return n===r;if(n instanceof Date&&r instanceof Date)return n.getTime()===r.getTime();if(y(n,"ObjectID")&&y(r,"ObjectID")||y(n,"Decimal128")&&y(r,"Decimal128"))return n.toString()===r.toString();if(n instanceof RegExp&&r instanceof RegExp)return n.source===r.source&&n.ignoreCase===r.ignoreCase&&n.multiline===r.multiline&&n.global===r.global;if(null==n||null==r)return!1;if(n.prototype!==r.prototype)return!1;if(n instanceof Map&&r instanceof Map)return t(Array.from(n.keys()),Array.from(r.keys()))&&t(Array.from(n.values()),Array.from(r.values()));if(n instanceof Number&&r instanceof Number)return n.valueOf()===r.valueOf();if(u.isBuffer(n))return e.buffer.areEqual(n,r);if(Array.isArray(n)&&Array.isArray(r)){var i=n.length;if(i!==r.length)return!1;for(var o=0;o<i;++o)if(!t(n[o],r[o]))return!1;return!0}null!=n.$__?n=n._doc:v(n)&&(n=n.toObject()),null!=r.$__?r=r._doc:v(r)&&(r=r.toObject());var a=Object.keys(n),l=Object.keys(r),c=a.length;if(c!==l.length)return!1;a.sort(),l.sort();for(var h=c-1;h>=0;h--)if(a[h]!==l[h])return!1;for(var d=0,f=a;d<f.length;d++){var p=f[d];if(!t(n[p],r[p]))return!1}return!0},e.last=function(t){if(t.length>0)return t[t.length-1]},e.clone=p,e.promiseOrCallback=b,e.omit=function(t,e){if(null==e)return Object.assign({},t);Array.isArray(e)||(e=[e]);var n,i=Object.assign({},t),s=r(e);try{for(s.s();!(n=s.n()).done;)delete i[n.value]}catch(t){s.e(t)}finally{s.f()}return i},e.options=function(t,e){var n,r=Object.keys(t),i=r.length;for(e=e||{};i--;)(n=r[i])in e||(e[n]=t[n]);return e},e.random=function(){return Math.random().toString().substr(3)},e.merge=function t(n,r,i,s){i=i||{};var o,a=Object.keys(r),l=0,c=a.length;s=s||"";for(var u=i.omitNested||{};l<c;)if(o=a[l++],!(i.omit&&i.omit[o]||u[s]||x.has(o)))if(null==n[o])n[o]=r[o];else if(e.isObject(r[o])){if(e.isObject(n[o])||(n[o]={}),null!=r[o]){if(i.isDiscriminatorSchemaMerge&&r[o].$isSingleNested&&n[o].$isMongooseDocumentArray||r[o].$isMongooseDocumentArray&&n[o].$isSingleNested)continue;if(r[o].instanceOfSchema){n[o].instanceOfSchema?w(n[o],r[o].clone(),i.isDiscriminatorSchemaMerge):n[o]=r[o].clone();continue}if(r[o]instanceof d){n[o]=new d(r[o]);continue}}t(n[o],r[o],i,s?s+"."+o:o)}else i.overwrite&&(n[o]=r[o])},e.toObject=function t(i){var s;if(o||(o=n(12)),null==i)return i;if(i instanceof o)return i.toObject();if(Array.isArray(i)){s=[];var a,l=r(i);try{for(l.s();!(a=l.n()).done;)s.push(t(a.value))}catch(t){l.e(t)}finally{l.f()}return s}if(e.isPOJO(i)){s={};for(var c=0,u=Object.keys(i);c<u.length;c++){var h=u[c];x.has(h)||(s[h]=t(i[h]))}return s}return i},e.isObject=g,e.isPOJO=function(t){if(null==t||"object"!==s(t))return!1;var e=Object.getPrototypeOf(t);return!e||"Object"===e.constructor.name},e.isNativeObject=function(t){return Array.isArray(t)||t instanceof Date||t instanceof Boolean||t instanceof Number||t instanceof String},e.isEmptyObject=function(t){return null!=t&&"object"===s(t)&&0===Object.keys(t).length},e.hasKey=function(t,n){for(var r=0,i=Object.keys(t);r<i.length;r++){var s=i[r];if(s===n)return!0;if(e.isPOJO(t[s])&&e.hasKey(t[s],n))return!0}return!1},e.args=c,e.tick=function(t){if("function"==typeof t)return function(){try{t.apply(this,arguments)}catch(t){m(function(){throw t})}}},e.isMongooseType=function(t){return t instanceof d||t instanceof h||t instanceof u},e.isMongooseObject=v,e.expires=function(t){var e;t&&"Object"===t.constructor.name&&"expires"in t&&(e="string"!=typeof t.expires?t.expires:Math.round(a(t.expires)/1e3),t.expireAfterSeconds=e,delete t.expires)},e.populate=function(t,n,r,i,o,a,l,c){var u=null;if(1===arguments.length){if(t instanceof f)return[t];if(Array.isArray(t)){var h=d(t);return h.map(function(t){return e.populate(t)[0]})}u=e.isObject(t)?Object.assign({},t):{path:t}}else u="object"===s(r)?{path:t,select:n,match:r,options:i}:{path:t,select:n,model:r,match:i,options:o,populate:a,justOne:l,count:c};if("string"!=typeof u.path)throw new TypeError("utils.populate: invalid path. Expected string. Got typeof `"+s(t)+"`");return S(u);function d(t){var e=[];return t.forEach(function(t){/[\s]/.test(t.path)?t.path.split(" ").forEach(function(n){var r=Object.assign({},t);r.path=n,e.push(r)}):e.push(t)}),e}},e.getValue=function(t,e,n){return l.get(t,e,"_doc",n)},e.setValue=function(t,e,n,r,i){l.set(t,e,n,"_doc",r,i)},e.object={},e.object.vals=function(t){for(var e=Object.keys(t),n=e.length,r=[];n--;)r.push(t[e[n]]);return r},e.object.shallowCopy=e.options;var E=Object.prototype.hasOwnProperty;e.object.hasOwnProperty=function(t,e){return E.call(t,e)},e.isNullOrUndefined=function(t){return null==t},e.array={},e.array.flatten=function t(e,n,r){return r||(r=[]),e.forEach(function(e){Array.isArray(e)?t(e,n,r):n&&!n(e)||r.push(e)}),r};var A=Object.prototype.hasOwnProperty;e.hasUserDefinedProperty=function(t,n){if(null==t)return!1;if(Array.isArray(n)){var i,o=r(n);try{for(o.s();!(i=o.n()).done;)if(e.hasUserDefinedProperty(t,i.value))return!0}catch(t){o.e(t)}finally{o.f()}return!1}if(A.call(t,n))return!0;if("object"===s(t)&&n in t){var a=t[n];return a!==Object.prototype[n]&&a!==Array.prototype[n]}return!1};var T=Math.pow(2,32)-1;e.isArrayIndex=function(t){return"number"==typeof t?t>=0&&t<=T:"string"==typeof t&&!!/^\d+$/.test(t)&&(t=+t)>=0&&t<=T},e.array.unique=function(t){var e,n=new Set,i=new Set,s=[],o=r(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;if("number"==typeof a||"string"==typeof a||null==a){if(n.has(a))continue;s.push(a),n.add(a)}else if(a instanceof d){if(i.has(a.toString()))continue;s.push(a),i.add(a.toString())}else s.push(a)}}catch(t){o.e(t)}finally{o.f()}return s},e.buffer={},e.buffer.areEqual=function(t,e){if(!u.isBuffer(t))return!1;if(!u.isBuffer(e))return!1;if(t.length!==e.length)return!1;for(var n=0,r=t.length;n<r;++n)if(t[n]!==e[n])return!1;return!0},e.getFunctionName=_,e.decorate=function(t,e){for(var n in e)x.has(n)||(t[n]=e[n])},e.mergeClone=function(t,n){v(n)&&(n=n.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1}));for(var r,i=Object.keys(n),s=i.length,o=0;o<s;)if(r=i[o++],!x.has(r))if(void 0===t[r])t[r]=e.clone(n[r],{transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1});else{var a=n[r];if(null==a||!a.valueOf||a instanceof Date||(a=a.valueOf()),e.isObject(a)){var l=a;v(a)&&!a.isMongooseBuffer&&(l=l.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1})),a.isMongooseBuffer&&(l=u.from(l)),e.mergeClone(t[r],l)}else t[r]=e.clone(a,{flattenDecimals:!1})}},e.each=function(t,e){var n,i=r(t);try{for(i.s();!(n=i.n()).done;)e(n.value)}catch(t){i.e(t)}finally{i.f()}},e.getOption=function(t){var e,n=Array.prototype.slice.call(arguments,1),i=r(n);try{for(i.s();!(e=i.n()).done;){var s=e.value;if(null!=s[t])return s[t]}}catch(t){i.e(t)}finally{i.f()}return null},e.noop=function(){},e.errorToPOJO=function(t){if(!(t instanceof Error))throw new Error("`error` must be `instanceof Error`.");var e,n={},i=r(Object.getOwnPropertyNames(t));try{for(i.s();!(e=i.n()).done;){var s=e.value;n[s]=t[s]}}catch(t){i.e(t)}finally{i.f()}return n}},function(t,e,n){"use strict";(function(t){var r=n(97),i=n(98),s=n(99);function o(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=d(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=a(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n=0|f(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(u(e),t=a(t,e<0?0:0|f(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return M(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:_(t,e,n,r,i);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):_(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function _(t,e,n,r,i){var s,o=1,a=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,l/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var u=-1;for(s=n;s<a;s++)if(c(t,s)===c(e,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(n+l>a&&(n=a-l),s=n;s>=0;s--){for(var h=!0,d=0;d<l;d++)if(c(t,s+d)!==c(e,d)){h=!1;break}if(h)return s}return-1}function v(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function b(t,e,n,r){return z(U(e,t.length-n),t,n,r)}function w(t,e,n,r){return z(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return w(t,e,n,r)}function S(t,e,n,r){return z(V(e),t,n,r)}function E(t,e,n,r){return z(function(t,e){for(var n,r,i=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i.push(n%256),i.push(r);return i}(e,t.length-n),t,n,r)}function A(t,e,n){return r.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var s,o,a,l,c=t[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(s=t[i+1]))&&(l=(31&c)<<6|63&s)>127&&(u=l);break;case 3:o=t[i+2],128==(192&(s=t[i+1]))&&128==(192&o)&&(l=(15&c)<<12|(63&s)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=t[i+2],a=t[i+3],128==(192&(s=t[i+1]))&&128==(192&o)&&128==(192&a)&&(l=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(r.push((u-=65536)>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function M(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function O(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=e;s<n;++s)i+=j(t[s]);return i}function P(t,e,n){for(var r=t.slice(e,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,n,r,i,s){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function L(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-n,2);i<s;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-n,4);i<s;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function N(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(t,e,n,r,s){return s||N(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,s){return s||N(t,0,n,8),i.write(t,e,n,r,52,8),n+8}e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return c(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return function(t,e,n,r){return u(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):m.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,r,i){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),c=this.slice(r,i),u=t.slice(e,n),h=0;h<a;++h)if(c[h]!==u[h]){s=c[h],o=u[h];break}return s<o?-1:o<s?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var i=e-t;n=new l(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},l.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||D(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},l.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||R(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||R(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return k(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return k(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=l.isBuffer(t)?t:U(new l(t,r).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function j(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function V(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(10))},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){return null==t?t:t instanceof Map?t.get(e):t[e]}t.exports=function(t,e,n){var i,o=!1;if("string"==typeof e){if(-1===e.indexOf(".")){var a=s(t,e);return null==a?n:a}i=e.split(".")}else if(o=!0,1===(i=e).length){var l=s(t,i[0]);return null==l?n:l}var c,u=e,h=t,d=r(i);try{for(d.s();!(c=d.n()).done;){var f=c.value;if(null==h)return n;if(!o&&null!=h[u])return h[u];h=s(h,f),o||(u=u.substr(f.length+1))}}catch(t){d.e(t)}finally{d.f()}return null==h?n:h}},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},s=/%[sdj%]/g;e.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(l(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,o=String(t).replace(s,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];n<i;a=r[++n])g(a)||!w(a)?o+=" "+a:o+=" "+l(a);return o},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function l(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&e._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),h(r,t,r.depth)}function c(t,e){var n=l.styles[e];return n?"\x1b["+l.colors[n][0]+"m"+t+"\x1b["+l.colors[n][1]+"m":t}function u(t,e){return t}function h(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return _(i)||(i=h(t,i,r)),i}var s=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}(t,n);if(s)return s;var o=Object.keys(n),a=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(n)),S(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return d(n);if(0===o.length){if(E(n))return t.stylize("[Function"+(n.name?": "+n.name:"")+"]","special");if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return d(n)}var l,c="",u=!1,w=["{","}"];return p(n)&&(u=!0,w=["[","]"]),E(n)&&(c=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(c=" "+RegExp.prototype.toString.call(n)),x(n)&&(c=" "+Date.prototype.toUTCString.call(n)),S(n)&&(c=" "+d(n)),0!==o.length||u&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=u?function(t,e,n,r,i){for(var s=[],o=0,a=e.length;o<a;++o)O(e,String(o))?s.push(f(t,e,n,r,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(f(t,e,n,r,i,!0))}),s}(t,n,r,a,o):o.map(function(e){return f(t,n,r,a,e,u)}),t.seen.pop(),function(t,e,n){return t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(l,c,w)):w[0]+c+w[1]}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i,s){var o,a,l;if((l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=t.stylize(l.set?"[Getter/Setter]":"[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),O(r,i)||(o="["+i+"]"),a||(t.seen.indexOf(l.value)<0?(a=g(n)?h(t,l.value,null):h(t,l.value,n-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),v(o)){if(s&&i.match(/^\d+$/))return a;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function p(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return"number"==typeof t}function _(t){return"string"==typeof t}function v(t){return void 0===t}function b(t){return w(t)&&"[object RegExp]"===A(t)}function w(t){return"object"===r(t)&&null!==t}function x(t){return w(t)&&"[object Date]"===A(t)}function S(t){return w(t)&&("[object Error]"===A(t)||t instanceof Error)}function E(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function T(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(v(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=m,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=_,e.isSymbol=function(t){return"symbol"===r(t)},e.isUndefined=v,e.isRegExp=b,e.isObject=w,e.isDate=x,e.isError=S,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===r(t)||void 0===t},e.isBuffer=n(102);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var t=new Date,e=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":");return[t.getDate(),C[t.getMonth()],e].join(" ")}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",M(),e.format.apply(e,arguments))},e.inherits=n(103),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function D(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(P&&t[P]){var e;if("function"!=typeof(e=t[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,P,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise(function(t,r){e=t,n=r}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(t,r){t?n(t):e(r)});try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),P&&Object.defineProperty(e,P,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=P,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return i.apply(s,arguments)};e.apply(this,n).then(function(e){t.nextTick(o,null,e)},function(e){t.nextTick(D,e,o)})}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,i(e)),n}}).call(this,n(11))},function(t,e,n){"use strict";var r=n(14);t.exports=r,r.messages=n(129),r.Messages=r.messages,r.DocumentNotFoundError=n(130),r.CastError=n(13),r.ValidationError=n(32),r.ValidatorError=n(72),r.VersionError=n(131),r.ParallelSaveError=n(132),r.OverwriteModelError=n(133),r.MissingSchemaError=n(134),r.DivergentArrayError=n(135),r.StrictModeError=n(33)},function(t,e,n){"use strict";(function(r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=n(5),o=n(8),a=n(51),l=n(73),c=n(3),u=n(136),h=n(22),d=n(0).schemaTypeSymbol,f=n(4),p=n(1),m=n(0).validatorErrorSymbol,g=n(0).documentIsModified,y=n(0).populateModelSymbol,_=s.CastError,v=s.ValidatorError;function b(t,e,n){this[d]=!0,this.path=t,this.instance=n,this.validators=[],this.getters=this.constructor.hasOwnProperty("getters")?this.constructor.getters.slice():[],this.setters=[],this.splitPath(),e=e||{};for(var r=this.constructor.defaultOptions||{},s=0,a=Object.keys(r);s<a.length;s++){var l=a[s];r.hasOwnProperty(l)&&!e.hasOwnProperty(l)&&(e[l]=r[l])}null==e.select&&delete e.select,this.options=new(this.OptionsConstructor||o)(e),this._index=null,p.hasUserDefinedProperty(this.options,"immutable")&&(this.$immutable=this.options.immutable,u(this));for(var c=0,h=Object.keys(this.options);c<h.length;c++){var f=h[c];if("cast"!==f){if(p.hasUserDefinedProperty(this.options,f)&&"function"==typeof this[f]){if("index"===f&&this._index){if(!1===e.index){var m=this._index;if("object"===i(m)&&null!=m){if(m.unique)throw new Error('Path "'+this.path+'" may not have `index` set to false and `unique` set to true');if(m.sparse)throw new Error('Path "'+this.path+'" may not have `index` set to false and `sparse` set to true')}this._index=!1}continue}var g=e[f];if("default"===f){this.default(g);continue}var y=Array.isArray(g)?g:[g];this[f].apply(this,y)}}else this.castFunction(this.options[f])}Object.defineProperty(this,"$$context",{enumerable:!1,configurable:!1,writable:!0,value:null})}b.prototype.OptionsConstructor=o,b.prototype.splitPath=function(){return null!=this._presplitPath?this._presplitPath:null!=this.path?(this._presplitPath=-1===this.path.indexOf(".")?[this.path]:this.path.split("."),this._presplitPath):void 0},b.cast=function(t){return 0===arguments.length||(!1===t&&(t=function(t){return t}),this._cast=t),this._cast},b.prototype.castFunction=function(t){return 0===arguments.length||(!1===t&&(t=this.constructor._defaultCaster||function(t){return t}),this._castFunction=t),this._castFunction},b.prototype.cast=function(){throw new Error("Base SchemaType class does not implement a `cast()` function")},b.set=function(t,e){this.hasOwnProperty("defaultOptions")||(this.defaultOptions=Object.assign({},this.defaultOptions)),this.defaultOptions[t]=e},b.get=function(t){this.getters=this.hasOwnProperty("getters")?this.getters:[],this.getters.push(t)},b.prototype.default=function(t){if(1===arguments.length){if(void 0===t)return void(this.defaultValue=void 0);if(null!=t&&t.instanceOfSchema)throw new s("Cannot set default value of path `"+this.path+"` to a mongoose Schema instance.");return this.defaultValue=t,this.defaultValue}return arguments.length>1&&(this.defaultValue=p.args(arguments)),this.defaultValue},b.prototype.index=function(t){return this._index=t,p.expires(this._index),this},b.prototype.unique=function(t){if(!1===this._index){if(!t)return;throw new Error('Path "'+this.path+'" may not have `index` set to false and `unique` set to true')}return null==this._index||!0===this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.unique=t,this},b.prototype.text=function(t){if(!1===this._index){if(!t)return;throw new Error('Path "'+this.path+'" may not have `index` set to false and `text` set to true')}return null==this._index||"boolean"==typeof this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.text=t,this},b.prototype.sparse=function(t){if(!1===this._index){if(!t)return;throw new Error('Path "'+this.path+'" may not have `index` set to false and `sparse` set to true')}return null==this._index||"boolean"==typeof this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.sparse=t,this},b.prototype.immutable=function(t){return this.$immutable=t,u(this),this},b.prototype.transform=function(t){return this.options.transform=t,this},b.prototype.set=function(t){if("function"!=typeof t)throw new TypeError("A setter must be a function.");return this.setters.push(t),this},b.prototype.get=function(t){if("function"!=typeof t)throw new TypeError("A getter must be a function.");return this.getters.push(t),this},b.prototype.validate=function(t,e,n){var r,o,a,l;if("function"==typeof t||t&&"RegExp"===p.getFunctionName(t.constructor))return"function"==typeof e?(r={validator:t,message:e}).type=n||"user defined":e instanceof Object&&!n?((r=p.clone(e)).message||(r.message=r.msg),r.validator=t,r.type=r.type||"user defined"):(null==e&&(e=s.messages.general.default),n||(n="user defined"),r={message:e,type:n,validator:t}),r.isAsync&&w(),this.validators.push(r),this;for(o=0,a=arguments.length;o<a;o++){if(!p.isPOJO(l=arguments[o])){var c="Invalid validator. Received ("+i(l)+") "+l+". See http://mongoosejs.com/docs/api.html#schematype_SchemaType-validate";throw new Error(c)}this.validate(l.validator,l)}return this};var w=f.deprecate(function(){},"Mongoose: the `isAsync` option for custom validators is deprecated. Make your async validators return a promise instead: https://mongoosejs.com/docs/validation.html#async-custom-validators");function x(t){return this.castForQuery(t)}function S(t){var e=this;return Array.isArray(t)?t.map(function(t){return Array.isArray(t)&&0===t.length?t:e.castForQuery(t)}):[this.castForQuery(t)]}b.prototype.required=function(t,e){var n={};if(arguments.length>0&&null==t)return this.validators=this.validators.filter(function(t){return t.validator!==this.requiredValidator},this),this.isRequired=!1,delete this.originalRequiredValue,this;if("object"===i(t)&&(e=(n=t).message||e,t=t.isRequired),!1===t)return this.validators=this.validators.filter(function(t){return t.validator!==this.requiredValidator},this),this.isRequired=!1,delete this.originalRequiredValue,this;var r=this;this.isRequired=!0,this.requiredValidator=function(e){var n=c(this,"$__.cachedRequired");if(null!=n&&!this.$__isSelected(r.path)&&!this[g](r.path))return!0;if(null!=n&&r.path in n){var i=!n[r.path]||r.checkRequired(e,this);return delete n[r.path],i}return"function"==typeof t&&!t.apply(this)||r.checkRequired(e,this)},this.originalRequiredValue=t,"string"==typeof t&&(e=t,t=void 0);var o=e||s.messages.general.required;return this.validators.unshift(Object.assign({},n,{validator:this.requiredValidator,message:o,type:"required"})),this},b.prototype.ref=function(t){return this.options.ref=t,this},b.prototype.getDefault=function(t,e){var n="function"==typeof this.defaultValue?this.defaultValue.call(t):this.defaultValue;if(null!=n){"object"!==i(n)||this.options&&this.options.shared||(n=p.clone(n));var r=this.applySetters(n,t,e);return r&&r.$isSingleNested&&(r.$__parent=t),r}return n},b.prototype._applySetters=function(t,e,n){var r=t;if(n)return r;for(var i=this.setters,s=i.length-1;s>=0;s--)r=i[s].call(e,r,this);return r},b.prototype._castNullish=function(t){return t},b.prototype.applySetters=function(t,e,n,r,i){var s=this._applySetters(t,e,n,r,i);return null==s?this._castNullish(s):s=this.cast(s,e,n,r,i)},b.prototype.applyGetters=function(t,e){var n=t,r=this.getters,i=r.length;if(0===i)return n;for(var s=0;s<i;++s)n=r[s].call(e,n,this);return n},b.prototype.select=function(t){return this.selected=!!t,this},b.prototype.doValidate=function(t,e,n,r){var s=!1,o=this.path,a=this.validators.filter(function(t){return null!=t&&"object"===i(t)}),l=a.length;if(!l)return e(null);var c=this;function u(t,n){s||(void 0===t||t?--l<=0&&h(function(){e(null)}):((s=new(n.ErrorConstructor||v)(n))[m]=!0,h(function(){e(s)})))}a.forEach(function(e){if(!s){var i,a=e.validator,l=p.clone(e);if(l.path=r&&r.path?r.path:o,l.value=t,a instanceof RegExp)u(a.test(t),l);else if("function"==typeof a)if(void 0!==t||a===c.requiredValidator)if(l.isAsync)!function(t,e,n,r,i){var s=!1,o=t.call(e,n,function(t,e){s||(s=!0,e&&(r.message=e),i(t,r))});"boolean"==typeof o?(s=!0,i(o,r)):o&&"function"==typeof o.then&&o.then(function(t){s||(s=!0,i(t,r))},function(t){s||(s=!0,r.reason=t,r.message=t.message,i(!1,r))})}(a,n,t,l,u);else{try{i=l.propsParameter?a.call(n,t,l):a.call(n,t)}catch(t){i=!1,l.reason=t,t.message&&(l.message=t.message)}null!=i&&"function"==typeof i.then?i.then(function(t){u(t,l)},function(t){l.reason=t,l.message=t.message,u(i=!1,l)}):u(i,l)}else u(!0,l)}})},b.prototype.doValidateSync=function(t,e,n){var r=this.path;if(!this.validators.length)return null;var s=this.validators;if(void 0===t){if(!(this.validators.length>0&&"required"===this.validators[0].type))return null;s=[this.validators[0]]}var o=null;return s.forEach(function(s){if(!o&&null!=s&&"object"===i(s)){var l,c=s.validator,u=p.clone(s);if(u.path=n&&n.path?n.path:r,u.value=t,!c.isAsync)if(c instanceof RegExp)a(c.test(t),u);else if("function"==typeof c){try{l=u.propsParameter?c.call(e,t,u):c.call(e,t)}catch(t){l=!1,u.reason=t}null!=l&&"function"==typeof l.then||a(l,u)}}}),o;function a(t,e){o||void 0===t||t||((o=new(e.ErrorConstructor||v)(e))[m]=!0)}},b._isRef=function(t,e,n,i){var s=i&&t.options&&(t.options.ref||t.options.refPath);if(!s&&n&&null!=n.$__){var o=n.$__fullPath(t.path);s=(n.ownerDocument?n.ownerDocument():n).populated(o)||n.populated(t.path)}return!!s&&(null==e||!(r.isBuffer(e)||"Binary"===e._bsontype||!p.isObject(e))||i)},b.prototype._castRef=function(t,e,n){if(null==t)return t;if(null!=t.$__)return t.$__.wasPopulated=!0,t;if(r.isBuffer(t)||!p.isObject(t)){if(n)return t;throw new _(this.instance,t,this.path,null,this)}var i=e.$__fullPath(this.path),s=(e.ownerDocument?e.ownerDocument():e).populated(i,!0),o=t;return e.$__.populated&&e.$__.populated[i]&&e.$__.populated[i].options&&e.$__.populated[i].options.options&&e.$__.populated[i].options.options.lean||((o=new s.options[y](t)).$__.wasPopulated=!0),o},b.prototype.$conditionalHandlers={$all:function(t){var e=this;return Array.isArray(t)?t.map(function(t){return e.castForQuery(t)}):[this.castForQuery(t)]},$eq:x,$in:S,$ne:x,$nin:S,$exists:a,$type:l},b.prototype.castForQueryWrapper=function(t){if(this.$$context=t.context,"$conditional"in t){var e=this.castForQuery(t.$conditional,t.val);return this.$$context=null,e}if(t.$skipQueryCastForUpdate||t.$applySetters){var n=this._castForQuery(t.val);return this.$$context=null,n}var r=this.castForQuery(t.val);return this.$$context=null,r},b.prototype.castForQuery=function(t,e){var n;if(2===arguments.length){if(!(n=this.$conditionalHandlers[t]))throw new Error("Can't use "+t);return n.call(this,e)}return this._castForQuery(e=t)},b.prototype._castForQuery=function(t){return this.applySetters(t,this.$$context)},b.checkRequired=function(t){return arguments.length>0&&(this._checkRequired=t),this._checkRequired},b.prototype.checkRequired=function(t){return null!=t},b.prototype.clone=function(){var t=Object.assign({},this.options),e=new this.constructor(this.path,t,this.instance);return e.validators=this.validators.slice(),void 0!==this.requiredValidator&&(e.requiredValidator=this.requiredValidator),void 0!==this.defaultValue&&(e.defaultValue=this.defaultValue),void 0!==this.$immutable&&void 0===this.options.immutable&&(e.$immutable=this.$immutable,u(e)),void 0!==this._index&&(e._index=this._index),void 0!==this.selected&&(e.selected=this.selected),void 0!==this.isRequired&&(e.isRequired=this.isRequired),void 0!==this.originalRequiredValue&&(e.originalRequiredValue=this.originalRequiredValue),e.getters=this.getters.slice(),e.setters=this.setters.slice(),e},t.exports=e=b,e.CastError=_,e.ValidatorError=v}).call(this,n(2).Buffer)},function(t,e,n){"use strict";var r=n(15).get().ObjectId,i=n(0).objectIdSymbol;Object.defineProperty(r.prototype,"_id",{enumerable:!1,configurable:!0,get:function(){return this}}),r.prototype[i]=!0,t.exports=r},function(t,e,n){"use strict";var r=n(29),i=function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),null==e)return this;Object.assign(this,r(e))},s=n(9);Object.defineProperty(i.prototype,"type",s),Object.defineProperty(i.prototype,"validate",s),Object.defineProperty(i.prototype,"cast",s),Object.defineProperty(i.prototype,"required",s),Object.defineProperty(i.prototype,"default",s),Object.defineProperty(i.prototype,"ref",s),Object.defineProperty(i.prototype,"select",s),Object.defineProperty(i.prototype,"index",s),Object.defineProperty(i.prototype,"unique",s),Object.defineProperty(i.prototype,"immutable",s),Object.defineProperty(i.prototype,"sparse",s),Object.defineProperty(i.prototype,"text",s),Object.defineProperty(i.prototype,"transform",s),t.exports=i},function(t,e,n){"use strict";t.exports=Object.freeze({enumerable:!0,configurable:!0,writable:!0,value:void 0})},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}t.exports=r},function(t,e){var n,r,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var t=a(d);u=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)l&&l[h].run();h=-1,e=c.length}l=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";(function(e){function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a,l,c,u=n(19).EventEmitter,h=n(111),d=n(5),f=n(26),p=n(74),m=n(137),g=n(138),y=n(53),_=n(33),v=n(32),b=n(72),w=n(54),x=n(25),S=n(86),E=n(57).compile,A=n(57).defineKey,T=n(173).flatten,C=n(3),M=n(174),O=n(90),P=n(175),D=n(22),R=n(58),L=n(176),I=n(4).inspect,N=n(17).internalToObjectOptions,k=n(49),F=n(177),B=n(1),j=n(179),U=B.clone,V=B.deepEqual,z=B.isMongooseObject,$=Symbol("mongoose.Array#atomicsBackup"),H=n(0).arrayAtomicsSymbol,G=n(0).documentArrayParent,W=n(0).documentIsModified,q=n(0).documentModifiedPaths,Z=n(0).documentSchemaSymbol,Y=n(0).getSymbol,J=n(0).populateModelSymbol,K=n(0).scopeSymbol,X=n(34).schemaMixedSymbol,Q=B.specialProperties;function tt(t,e,n,r){var s=this;"object"===o(n)&&null!=n&&(n=(r=n).skipId),r=Object.assign({},r);var a=C(r,"defaults",!0);if(r.defaults=a,null==this.$__schema){var l=B.isObject(e)&&!e.instanceOfSchema?new y(e):e;this.$__setSchema(l),e=n,n=r,r=arguments[4]||{}}if(this.$__=new h,this.$__.emitter=new u,this.isNew=!("isNew"in r)||r.isNew,this.errors=void 0,this.$__.$options=r||{},this.$locals={},this.$op=null,null!=t&&"object"!==o(t))throw new m(t,"obj","Document");var c=this.$__schema;"boolean"==typeof e||"throw"===e?(this.$__.strictMode=e,e=void 0):(this.$__.strictMode=c.options.strict,this.$__.selected=e);var d,f=c.requiredPaths(!0),p=i(f);try{for(p.s();!(d=p.n()).done;){var g=d.value;this.$__.activePaths.require(g)}}catch(t){p.e(t)}finally{p.f()}this.$__.emitter.setMaxListeners(0);var _=null;B.isPOJO(e)&&(_=L(e));var v=!1===_&&e?nt(e):{};if(null==this._doc&&(this.$__buildDoc(t,e,n,_,v,!1),a&&rt(this,e,n,_,v,!0,{isNew:this.isNew})),t&&(this.$__original_set?this.$__original_set(t,void 0,!0):this.$set(t,void 0,!0),t instanceof tt&&(this.isNew=t.isNew)),r.willInit&&a?u.prototype.once.call(this,"init",function(){rt(s,e,n,_,v,!1,r.skipDefaults)}):a&&rt(this,e,n,_,v,!1,r.skipDefaults),this.$__._id=this._id,!this.$__.strictMode&&t){var b=this,w=Object.keys(this._doc);w.forEach(function(t){t in c.tree||A(t,null,b)})}at(this)}for(var et in B.each(["on","once","emit","listeners","removeListener","setMaxListeners","removeAllListeners","addListener"],function(t){tt.prototype[t]=function(){return this.$__.emitter[t].apply(this.$__.emitter,arguments)}}),tt.prototype.constructor=tt,u.prototype)tt[et]=u.prototype[et];function nt(t){for(var e={},n=0,r=Object.keys(t);n<r.length;n++){var s,o=[],a=i(r[n].split("."));try{for(a.s();!(s=a.n()).done;)o.push(s.value),e[o.join(".")]=1}catch(t){a.e(t)}finally{a.f()}}return e}function rt(t,e,n,r,i,s,o){for(var a=Object.keys(t.$__schema.paths),l=a.length,c=0;c<l;++c){var u=void 0,h="",d=a[c];if("_id"!==d||!n)for(var f=t.$__schema.paths[d],p=f.splitPath(),m=p.length,g=!1,y=t._doc,_=0;_<m&&null!=y;++_){var v=p[_];if(h+=(h.length?".":"")+v,!0===r){if(h in e)break}else if(!1===r&&e&&!g)if(h in e)g=!0;else if(!i[h])break;if(_===m-1){if(void 0!==y[v])break;if("function"==typeof f.defaultValue){if(!f.defaultValue.$runBeforeSetters&&s)break;if(f.defaultValue.$runBeforeSetters&&!s)break}else if(!s)continue;if(o&&o[h])break;if(e&&null!==r){if(!0===r){if(d in e)continue;try{u=f.getDefault(t,!1)}catch(e){t.invalidate(d,e);break}void 0!==u&&(y[v]=u,t.$__.activePaths.default(d))}else if(g){try{u=f.getDefault(t,!1)}catch(e){t.invalidate(d,e);break}void 0!==u&&(y[v]=u,t.$__.activePaths.default(d))}}else{try{u=f.getDefault(t,!1)}catch(e){t.invalidate(d,e);break}void 0!==u&&(y[v]=u,t.$__.activePaths.default(d))}}else y=y[v]}}}function it(t){if(null==t)return!0;if("object"!==o(t)||Array.isArray(t))return!1;for(var e=0,n=Object.keys(t);e<n.length;e++)if(!it(t[n[e]]))return!1;return!0}function st(t){var e={};!function(t){Object.keys(t.$__.activePaths.states.require).forEach(function(e){var n=t.$__schema.path(e);null!=n&&"function"==typeof n.originalRequiredValue&&(t.$__.cachedRequired[e]=n.originalRequiredValue.call(t,t))})}(t);var n=new Set(Object.keys(t.$__.activePaths.states.require).filter(function(e){return!(!t.$__isSelected(e)&&!t.isModified(e))&&(!(e in t.$__.cachedRequired)||t.$__.cachedRequired[e])}));function r(t){n.add(t)}Object.keys(t.$__.activePaths.states.init).forEach(r),Object.keys(t.$__.activePaths.states.modify).forEach(r),Object.keys(t.$__.activePaths.states.default).forEach(r);var s,o=t.$getAllSubdocs(),a=t.modifiedPaths(),l=i(o);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(c.$basePath){var u,h=i(n);try{for(h.s();!(u=h.n()).done;){var d=u.value;(null===d||d.startsWith(c.$basePath+"."))&&n.delete(d)}}catch(t){h.e(t)}finally{h.f()}!t.isModified(c.$basePath,a)||t.isDirectModified(c.$basePath)||t.$isDefault(c.$basePath)||(n.add(c.$basePath),e[c.$basePath]=!0)}}}catch(t){l.e(t)}finally{l.f()}var f,p=i(n);try{for(p.s();!(f=p.n()).done;){var m=f.value,g=t.$__schema.path(m);g&&g.$isMongooseArray&&(!g.$isMongooseDocumentArray||C(g,"schemaOptions.required"))&&y(t.$__getValue(m),n,m)}}catch(t){p.e(t)}finally{p.f()}function y(t,e,n){if(null!=t)for(var r=t.length,i=0;i<r;++i)Array.isArray(t[i])?y(t[i],e,n+"."+i):e.add(n+"."+i)}var _,v={skipArrays:!0},b=i(n);try{for(b.s();!(_=b.n()).done;){var w=_.value;if(t.$__schema.nested[w]){var x=t.$__getValue(w);z(x)&&(x=x.toObject({transform:!1}));var S=T(x,w,v,t.$__schema);Object.keys(S).forEach(r)}}}catch(t){b.e(t)}finally{b.f()}var E,A=i(n);try{for(A.s();!(E=A.n()).done;){var M=E.value;if(t.$__schema.singleNestedPaths.hasOwnProperty(M))n.delete(M);else{var O=t.$__schema.path(M);if(O&&O.$isSchemaMap){var P=t.$__getValue(M);if(null!=P){var D,R=i(P.keys());try{for(R.s();!(D=R.n()).done;)n.add(M+"."+D.value)}catch(t){R.e(t)}finally{R.f()}}}}}}catch(t){A.e(t)}finally{A.f()}return[n=Array.from(n),e]}function ot(t,e){var n,r=new Set(e),s=new Map([]),o=i(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(-1!==a.indexOf("."))for(var l=a.split("."),c=l[0],u=1;u<l.length;++u)s.set(c,a),c=c+"."+l[u]}}catch(t){o.e(t)}finally{o.f()}var h,d=[],f=i(t);try{for(f.s();!(h=f.n()).done;){var p=h.value;r.has(p)?d.push(p):s.has(p)&&d.push(s.get(p))}}catch(t){f.e(t)}finally{f.f()}return d}function at(t){var e=t.$__schema&&t.$__schema.callQueue;if(e.length){var n,r=i(e);try{for(r.s();!(n=r.n()).done;){var s=n.value;"pre"!==s[0]&&"post"!==s[0]&&"on"!==s[0]&&t[s[0]].apply(t,s[1])}}catch(t){r.e(t)}finally{r.f()}}}function lt(t,e,n,r){var i,s,o,a=t.$__schema,l=Object.keys(a.virtuals),c=l.length,u=c,h=t._doc,d=C(r,"aliases",!0);if(!h)return e;for(n=n||{},c=0;c<u;++c)if(i=l[c],d||!a.aliases.hasOwnProperty(i)){if(s=i,null!=n.path){if(!i.startsWith(n.path+"."))continue;s=i.substr(n.path.length+1)}var f=s.split(".");if(void 0!==(o=U(t.get(i),n))){var p=f.length;h=e;for(var m=0;m<p-1;++m)h[f[m]]=h[f[m]]||{},h=h[f[m]];h[f[p-1]]=o}}return e}function ct(t,e){if(j(e))throw new Error("`transform` function must be synchronous, but the transform on path `"+t+"` returned a promise.")}Object.defineProperty(tt.prototype,"$locals",{configurable:!1,enumerable:!1,writable:!0}),tt.prototype.$__buildDoc=function(t,e,n,r,i){for(var s={},o=Object.keys(this.$__schema.paths).filter(function(t){return!t.includes("$*")}),a=o.length,l=0;l<a;++l){var c=o[l];if("_id"===c){if(n)continue;if(t&&"_id"in t)continue}for(var u=this.$__schema.paths[c].splitPath(),h=u.length,d=h-1,f="",p=s,m=!1,g=0;g<h;++g){var y=u[g];if(f+=(f.length?".":"")+y,!0===r){if(f in e)break}else if(!1===r&&e&&!m)if(f in e)m=!0;else if(!i[f])break;g<d&&(p=p[y]||(p[y]={}))}}this._doc=s},tt.prototype.toBSON=function(){return this.toObject(N)},tt.prototype.init=function(t,e,n){return"function"==typeof e&&(n=e,e=null),this.$__init(t,e),n&&n(null,this),this},tt.prototype.$__init=function(t,e){if(this.isNew=!1,this.$init=!0,e=e||{},null!=t._id&&e.populated&&e.populated.length){var n,r=String(t._id),s=i(e.populated);try{for(s.s();!(n=s.n()).done;){var o=n.value;if(this.populated(o.path,o.isVirtual?B.getValue(o.path,t):o._docs[r],o),null!=o._childDocs){var a,l=i(o._childDocs);try{for(l.s();!(a=l.n()).done;){var c=a.value;null!=c&&null!=c.$__&&(c.$__.parent=this)}}catch(t){l.e(t)}finally{l.f()}o._childDocs=[]}}}catch(t){s.e(t)}finally{s.f()}}return function t(e,n,r,i,s){s=s||"";for(var o,a,l,c=Object.keys(n),u=c.length,h=0;h<u;)d(h++);function d(u){if(o=e.$__schema.path(a=s+(l=c[u])),!e.$__schema.$isRootDiscriminator||e.$__isSelected(a))if(!o&&B.isPOJO(n[l]))r[l]||(r[l]={}),t(e,n[l],r[l],i,a+".");else if(o){if(null===n[l])r[l]=o._castNullish(null);else if(void 0!==n[l])if(o&&!(n[l].$__||{}).wasPopulated)try{r[l]=o.cast(n[l],e,!0)}catch(t){e.invalidate(t.path,new b({path:t.path,message:t.message,type:"cast",value:t.value,reason:t}))}else r[l]=n[l];e.isModified(a)||e.$__.activePaths.init(a)}else r[l]=n[l]}}(this,t,this._doc,e),function(t,e){if(null!=t._id&&null!=e&&0!==e.length){var n,r=String(t._id),s=i(e);try{for(s.s();!(n=s.n()).done;){var o=n.value;if(!o.isVirtual)for(var a=o.path.split("."),l=0;l<a.length-1;++l){var c=a.slice(0,l+1).join("."),u=a.slice(l+1).join("."),h=t.get(c);if(null!=h&&h.isMongooseDocumentArray){for(var d=0;d<h.length;++d)h[d].populated(u,null==o._docs[r]?[]:o._docs[r][d],o);break}}}}catch(t){s.e(t)}finally{s.f()}}}(this,e.populated),this.emit("init",this),this.constructor.emit("init",this),this.$__._id=this._id,this},tt.prototype.update=function(){var t=B.args(arguments);t.unshift({_id:this._id});var e=this.constructor.update.apply(this.constructor,t);return null!=this.$session()&&("session"in e.options||(e.options.session=this.$session())),e},tt.prototype.updateOne=function(t,e,n){var r=this,i=this.constructor.updateOne({_id:this._id},t,e);return i.pre(function(t){r.constructor._middleware.execPre("updateOne",r,[r],t)}),i.post(function(t){r.constructor._middleware.execPost("updateOne",r,[r],{},t)}),null!=this.$session()&&("session"in i.options||(i.options.session=this.$session())),null!=n?i.exec(n):i},tt.prototype.replaceOne=function(){var t=B.args(arguments);return t.unshift({_id:this._id}),this.constructor.replaceOne.apply(this.constructor,t)},tt.prototype.$session=function(t){if(0===arguments.length)return this.$__.session;if(this.$__.session=t,!this.ownerDocument){var e,n=this.$getAllSubdocs(),r=i(n);try{for(r.s();!(e=r.n()).done;){var s=e.value;s.$session(t)}}catch(t){r.e(t)}finally{r.f()}}return t},tt.prototype.overwrite=function(t){for(var e=0,n=Array.from(new Set(Object.keys(this._doc).concat(Object.keys(t))));e<n.length;e++){var r=n[e];"_id"!==r&&(this.$__schema.options.versionKey&&r===this.$__schema.options.versionKey||this.$__schema.options.discriminatorKey&&r===this.$__schema.options.discriminatorKey||this.$set(r,t[r]))}return this},tt.prototype.set=tt.prototype.$set=function(t,e,n,s){var a=this;B.isPOJO(n)&&(s=n,n=void 0);var l,c,u,h,m=(s=s||{}).merge,g=!0===n,y=0,v="strict"in s?s.strict:this.$__.strictMode;if(n&&!0!==n&&((this.$__.adhocPaths||(this.$__.adhocPaths={}))[t]=this.$__schema.interpretAsType(t,n,this.$__schema.options)),null==t){var b=t;t=e,e=b}else{if("string"!=typeof t){if(t instanceof tt&&(t=t.$__isNested?t.toObject():t._doc),null==t){var w=t;t=e,e=w}h=e?e+".":"";var x=(l=Object.keys(t)).length,E=C(s,"_skipMinimizeTopLevel",!1);if(0===x&&E)return delete s._skipMinimizeTopLevel,e&&this.$set(e,{}),this;for(var A=0;A<x;++A){var T=h+(u=l[A]);if(c=this.$__schema.pathType(T),!0!==n||h||null==t[u]||"nested"!==c||null==this._doc[u]||0!==Object.keys(this._doc[u]).length||(delete this._doc[u],s=Object.assign({},s,{_skipMinimizeTopLevel:!0})),"object"!==o(t[u])||B.isNativeObject(t[u])||B.isMongooseType(t[u])||null==t[u]||"virtual"===c||"real"===c||"adhocOrUndefined"===c||this.$__path(T)instanceof f||this.$__schema.paths[T]&&this.$__schema.paths[T].options&&this.$__schema.paths[T].options.ref)if(v){if(g&&void 0===t[u]&&void 0!==this.get(T))continue;if("adhocOrUndefined"===c&&(c=M(this,T,{typeOnly:!0})),"real"===c||"virtual"===c){var P=t[u];this.$__schema.paths[T]&&this.$__schema.paths[T].$isSingleNested&&t[u]instanceof tt&&(P=P.toObject({virtuals:!1,transform:!1})),this.$set(h+u,P,g,s)}else if("nested"===c&&t[u]instanceof tt)this.$set(h+u,t[u].toObject({transform:!1}),g,s);else if("throw"===v)throw"nested"===c?new p(u,t[u]):new _(u)}else void 0!==t[u]&&this.$set(h+u,t[u],g,s);else this.$__.$setCalled.add(h+u),this.$set(t[u],h+u,g,s)}return this}this.$__.$setCalled.add(t)}var D,R=this.$__schema.pathType(t);if("adhocOrUndefined"===R&&(R=M(this,t,{typeOnly:!0})),e=O(e),"nested"===R&&e){if("object"===o(e)&&null!=e){var L=null!=this.$__.savedState&&this.$__.savedState.hasOwnProperty(t);if(null!=this.$__.savedState&&!this.isNew&&!this.$__.savedState.hasOwnProperty(t)){var I=this.$__getValue(t);this.$__.savedState[t]=I;for(var N=0,F=Object.keys(I||{});N<F.length;N++){var j=F[N];this.$__.savedState[t+"."+j]=I[j]}}if(m)return this.$set(e,t,g);this.$__setValue(t,null),S(this,t);var U=Object.keys(e);this.$__setValue(t,{});for(var V=0,z=U;V<z.length;V++){var $=z[V];this.$set(t+"."+$,e[$],g)}return L&&B.deepEqual(this.$__.savedState[t],e)?this.unmarkModified(t):this.markModified(t),S(this,t,{skipDocArrays:!0}),this}return this.invalidate(t,new d.CastError("Object",e,t)),this}var H=-1===t.indexOf(".")?[t]:t.split(".");if("string"==typeof this.$__schema.aliases[H[0]]&&(H[0]=this.$__schema.aliases[H[0]]),"adhocOrUndefined"===R&&v){var G;for(y=0;y<H.length;++y){var W=H.slice(0,y+1).join(".");if(y+1<H.length&&"virtual"===this.$__schema.pathType(W))return k.set(t,e,this),this;if(null!=(D=this.$__schema.path(W))&&D instanceof f){G=!0;break}}if(null==D&&(D=M(this,t)),!G&&!D){if("throw"===v)throw new _(t);return this}}else{if("virtual"===R)return(D=this.$__schema.virtualpath(t)).applySetters(e,this),this;D=this.$__path(t)}var q,Z=this._doc,Y="";for(y=0;y<H.length-1;++y)Y+=(Y.length>0?".":"")+H[y],(Z=Z[H[y]])||(this.$set(Y,{}),this.$__isSelected(Y)||this.unmarkModified(Y),Z=this.$__getValue(Y));if(H.length<=1)q=t;else{for(y=0;y<H.length;++y){var K=H.slice(0,y+1).join(".");if(null===this.get(K,null,{getters:!1})){q=K;break}}q||(q=t)}var X=null!=a.$__.$options.priorDoc?a.$__.$options.priorDoc.$__getValue(t):g?void 0:a.$__getValue(t);if(!D)return this.$__set(q,t,g,H,D,e,X),this;if((D.$isSingleNested||D.$isMongooseArray)&&function(t,e){if(t.$__.validationError){for(var n=0,r=Object.keys(t.$__.validationError.errors);n<r.length;n++){var i=r[n];i.startsWith(e+".")&&delete t.$__.validationError.errors[i]}0===Object.keys(t.$__.validationError.errors).length&&(t.$__.validationError=null)}}(this,t),D.$isSingleNested&&null!=e&&m){e instanceof tt&&(e=e.toObject({virtuals:!1,transform:!1}));for(var Q=0,et=Object.keys(e);Q<et.length;Q++){var nt=et[Q];this.$set(t+"."+nt,e[nt],g,s)}return this}var rt=!0;try{var it,st=function(){if(null==D.options)return!1;if(!(e instanceof tt))return!1;var t=e.constructor,n=D.options.ref;if(null!=n&&(n===t.modelName||n===t.baseModelName))return!0;var r=D.options.refPath;if(null==r)return!1;var i=e.get(r);return i===t.modelName||i===t.baseModelName}(),ot=!1;if(st&&e instanceof tt&&(this.populated(t,e._id,r({},J,e.constructor)),e.$__.wasPopulated=!0,ot=!0),D.options&&Array.isArray(D.options[this.$__schema.options.typeKey])&&D.options[this.$__schema.options.typeKey].length&&D.options[this.$__schema.options.typeKey][0].ref&&function(t,e){if(!Array.isArray(t))return!1;if(0===t.length)return!1;var n,r=i(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(!(s instanceof tt))return!1;if(null==s.constructor.modelName)return!1;if(s.constructor.modelName!=e&&s.constructor.baseModelName!=e)return!1}}catch(t){r.e(t)}finally{r.f()}return!0}(e,D.options[this.$__schema.options.typeKey][0].ref)){this.ownerDocument?(it=r({},J,e[0].constructor),this.ownerDocument().populated(this.$__fullPath(t),e.map(function(t){return t._id}),it)):(it=r({},J,e[0].constructor),this.populated(t,e.map(function(t){return t._id}),it));var at,lt=i(e);try{for(lt.s();!(at=lt.n()).done;)at.value.$__.wasPopulated=!0}catch(t){lt.e(t)}finally{lt.f()}ot=!0}if(null==this.$__schema.singleNestedPaths[t]&&(e=D.applySetters(e,this,!1,X)),D.$isMongooseDocumentArray&&Array.isArray(e)&&e.length>0&&null!=e[0]&&null!=e[0].$__&&null!=e[0].$__.populated){for(var ct=Object.keys(e[0].$__.populated),ut=function(){var n=dt[ht];a.populated(t+"."+n,e.map(function(t){return t.populated(n)}),e[0].$__.populated[n].options)},ht=0,dt=ct;ht<dt.length;ht++)ut();ot=!0}if(!ot&&this.$__.populated){if(Array.isArray(e)&&this.$__.populated[t])for(var ft=0;ft<e.length;++ft)e[ft]instanceof tt&&(e[ft]=e[ft]._id);delete this.$__.populated[t]}D.$isSingleNested&&null!=e&&function(t,e,n){var r=e.schema;if(null!=r)for(var i=0,s=Object.keys(r.paths);i<s.length;i++){var o=s[i],a=r.paths[o];if(null!=a.$immutableSetter){var l=null==n?void 0:n.$__getValue(o);a.$immutableSetter.call(t,l)}}}(e,D,X),this.$markValid(t)}catch(n){n instanceof d.StrictModeError&&n.isImmutableError?this.invalidate(t,n):n instanceof d.CastError?(this.invalidate(n.path,n),n.$originalErrorPath&&this.invalidate(t,new d.CastError(D.instance,e,t,n.$originalErrorPath))):this.invalidate(t,new d.CastError(D.instance,e,t,n)),rt=!1}return rt&&(this.$__set(q,t,g,H,D,e,X),null!=this.$__.savedState&&(this.isNew||this.$__.savedState.hasOwnProperty(t)?this.$__.savedState.hasOwnProperty(t)&&B.deepEqual(e,this.$__.savedState[t])&&this.unmarkModified(t):this.$__.savedState[t]=X)),D.$isSingleNested&&(this.isDirectModified(t)||null==e)&&S(this,t),this},tt.prototype.$__shouldModify=function(t,e,n,r,i,s,o){return!(!this.isNew&&(null!=this.$__schema.singleNestedPaths[e]||(void 0!==s||this.$__isSelected(e))&&(void 0===s&&e in this.$__.activePaths.states.default||this.populated(e)&&s instanceof tt&&V(s._id,o)||V(s,o||B.getValue(e,this))&&(n||null==s||!(e in this.$__.activePaths.states.default)||!V(s,i.getDefault(this,n))))))},tt.prototype.$__set=function(t,e,r,i,s,o,a){c=c||n(27);var u=this.$__shouldModify(t,e,r,i,s,o,a),h=this;u&&(this.markModified(t),l||(l=n(84)),o&&o.isMongooseArray&&(o._registerAtomic("$set",o),o.isMongooseDocumentArray&&o.forEach(function(t){t&&t.__parentArray&&(t.__parentArray=o)}),this.$__.activePaths.forEach(function(t){t.startsWith(e+".")&&h.$__.activePaths.ignore(t)})));for(var d=this._doc,f=0,p=i.length,m="";f<p;f++){var g=f+1===p;if(m+=m?"."+i[f]:i[f],Q.has(i[f]))return;g?d instanceof Map?d.set(i[f],o):d[i[f]]=o:(B.isPOJO(d[i[f]])||d[i[f]]&&d[i[f]]instanceof c||d[i[f]]&&d[i[f]].$isSingleNested||d[i[f]]&&Array.isArray(d[i[f]])||(d[i[f]]=d[i[f]]||{}),d=d[i[f]])}},tt.prototype.$__getValue=function(t){return B.getValue(t,this._doc)},tt.prototype.$__setValue=function(t,e){return B.setValue(t,e,this._doc),this},tt.prototype[Y]=tt.prototype.get=function(t,e,n){var r;n=n||{},e&&(r=this.$__schema.interpretAsType(t,e,this.$__schema.options));var i=this.$__path(t);if(null==i&&(i=this.$__schema.virtualpath(t)),i instanceof f){var s=this.$__schema.virtualpath(t);null!=s&&(i=s)}var o=-1===t.indexOf(".")?[t]:t.split("."),a=this._doc;if(i instanceof w)return i.applyGetters(void 0,this);"string"==typeof this.$__schema.aliases[o[0]]&&(o[0]=this.$__schema.aliases[o[0]]);for(var l=0,c=o.length;l<c;l++)a&&a._doc&&(a=a._doc),a=null==a?void 0:a instanceof Map?a.get(o[l],{getters:!1}):l===c-1?B.getValue(o[l],a):a[o[l]];if(r&&(a=r.cast(a)),null!=i&&!1!==n.getters)a=i.applyGetters(a,this);else if(this.$__schema.nested[t]&&n.virtuals)return lt(this,B.clone(a)||{},{path:t});return a},tt.prototype.$__path=function(t){var e=this.$__.adhocPaths;return(e&&e.hasOwnProperty(t)?e[t]:null)||this.$__schema.path(t)},tt.prototype.markModified=function(t,e){this.$__.activePaths.modify(t),null==e||this.ownerDocument||(this.$__.pathsToScopes[t]=e)},tt.prototype.unmarkModified=function(t){this.$__.activePaths.init(t),delete this.$__.pathsToScopes[t]},tt.prototype.$ignore=function(t){this.$__.activePaths.ignore(t)},tt.prototype.directModifiedPaths=function(){return Object.keys(this.$__.activePaths.states.modify)},tt.prototype.$isEmpty=function(t){var e={minimize:!0,virtuals:!1,getters:!1,transform:!1};if(arguments.length>0){var n=this.get(t);return null==n||"object"===o(n)&&(B.isPOJO(n)?it(n):0===Object.keys(n.toObject(e)).length)}return 0===Object.keys(this.toObject(e)).length},tt.prototype[q]=tt.prototype.modifiedPaths=function(t){t=t||{};var e=Object.keys(this.$__.activePaths.states.modify),n=this;return e.reduce(function(e,r){var s=r.split(".");if(e=e.concat(s.reduce(function(t,e,n){return t.concat(s.slice(0,n).concat(e).join("."))},[]).filter(function(t){return-1===e.indexOf(t)})),!t.includeChildren)return e;var a=n.get(r);if(null!=a&&"object"===o(a))if(a._doc&&(a=a._doc),Array.isArray(a)){for(var l=a.length,c=0;c<l;++c)if(-1===e.indexOf(r+"."+c)&&(e.push(r+"."+c),null!=a[c]&&a[c].$__)){var u,h=i(a[c].modifiedPaths());try{for(h.s();!(u=h.n()).done;)e.push(r+"."+c+"."+u.value)}catch(t){h.e(t)}finally{h.f()}}}else Object.keys(a).filter(function(t){return-1===e.indexOf(r+"."+t)}).forEach(function(t){e.push(r+"."+t)});return e},[])},tt.prototype[W]=tt.prototype.isModified=function(t,e){if(t){Array.isArray(t)||(t=t.split(" "));var n=e||this[q](),r=Object.keys(this.$__.activePaths.states.modify);return t.some(function(t){return!!~n.indexOf(t)})||t.some(function(t){return r.some(function(e){return e===t||t.startsWith(e+".")})})}return this.$__.activePaths.some("modify")},tt.prototype.$isDefault=function(t){var e=this;if(null==t)return this.$__.activePaths.some("default");if("string"==typeof t&&-1===t.indexOf(" "))return this.$__.activePaths.states.default.hasOwnProperty(t);var n=t;return Array.isArray(n)||(n=n.split(" ")),n.some(function(t){return e.$__.activePaths.states.default.hasOwnProperty(t)})},tt.prototype.$isDeleted=function(t){return 0===arguments.length?!!this.$__.isDeleted:(this.$__.isDeleted=!!t,this)},tt.prototype.isDirectModified=function(t){var e=this;if(null==t)return this.$__.activePaths.some("modify");if("string"==typeof t&&-1===t.indexOf(" "))return this.$__.activePaths.states.modify.hasOwnProperty(t);var n=t;return Array.isArray(n)||(n=n.split(" ")),n.some(function(t){return e.$__.activePaths.states.modify.hasOwnProperty(t)})},tt.prototype.isInit=function(t){var e=this;if(null==t)return this.$__.activePaths.some("init");if("string"==typeof t&&-1===t.indexOf(" "))return this.$__.activePaths.states.init.hasOwnProperty(t);var n=t;return Array.isArray(n)||(n=n.split(" ")),n.some(function(t){return e.$__.activePaths.states.init.hasOwnProperty(t)})},tt.prototype.$__isSelected=tt.prototype.isSelected=function(t){var e=this;if(null==this.$__.selected)return!0;if("_id"===t)return 0!==this.$__.selected._id;if(-1!==t.indexOf(" ")&&(t=t.split(" ")),Array.isArray(t))return t.some(function(t){return e.$__isSelected(t)});var n=Object.keys(this.$__.selected),r=null;if(1===n.length&&"_id"===n[0])return 0===this.$__.selected._id;for(var i=0,s=n;i<s.length;i++){var o=s[i];if("_id"!==o&&R(this.$__.selected[o])){r=!!this.$__.selected[o];break}}if(null===r)return!0;if(t in this.$__.selected)return r;for(var a=t+".",l=0,c=n;l<c.length;l++){var u=c[l];if("_id"!==u){if(u.startsWith(a))return r||u!==a;if(a.startsWith(u+"."))return r}}return!r},tt.prototype.isDirectSelected=function(t){var e=this;if(null==this.$__.selected)return!0;if("_id"===t)return 0!==this.$__.selected._id;if(-1!==t.indexOf(" ")&&(t=t.split(" ")),Array.isArray(t))return t.some(function(t){return e.isDirectSelected(t)});var n=Object.keys(this.$__.selected),r=null;if(1===n.length&&"_id"===n[0])return 0===this.$__.selected._id;for(var i=0,s=n;i<s.length;i++){var o=s[i];if("_id"!==o&&R(this.$__.selected[o])){r=!!this.$__.selected[o];break}}return null===r||(this.$__.selected.hasOwnProperty(t)?r:!r)},tt.prototype.validate=function(t,e,n){var r,i=this;return this.$op="validate",null!=this.ownerDocument||(this.$__.validating?r=new g(this,{parentStack:e&&e.parentStack,conflictStack:this.$__.validating.stack}):this.$__.validating=new g(this,{parentStack:e&&e.parentStack})),1===arguments.length?"object"!==o(arguments[0])||Array.isArray(arguments[0])?"function"==typeof arguments[0]&&(n=arguments[0],e=null,t=null):(e=arguments[0],n=null,t=null):"function"==typeof t?(n=t,e=null,t=null):"function"==typeof e&&(n=e,e=t,t=null),x(n,function(n){if(null!=r)return n(r);i.$__validate(t,e,function(t){i.$op=null,n(t)})},this.constructor.events)},tt.prototype.$__validate=function(t,e,n){var r=this;"function"==typeof t?(n=t,e=null,t=null):"function"==typeof e&&(n=e,e=null);var i,s=e&&"object"===o(e)&&"validateModifiedOnly"in e;i=s?!!e.validateModifiedOnly:this.$__schema.options.validateModifiedOnly;var a=this,l=function(){var t=r.$__.validationError;if(r.$__.validationError=void 0,i&&null!=t){for(var e=0,n=Object.keys(t.errors);e<n.length;e++){var s=n[e];r.isModified(s)||delete t.errors[s]}0===Object.keys(t.errors).length&&(t=void 0)}if(r.$__.cachedRequired={},r.emit("validate",a),r.constructor.emit("validate",a),r.$__.validating=null,t){for(var o in t.errors)!r[G]&&t.errors[o]instanceof d.CastError&&r.invalidate(o,t.errors[o]);return t}},c=st(this),u=i?c[0].filter(function(t){return r.isModified(t)}):c[0],h=c[1];if("string"==typeof t&&(t=t.split(" ")),Array.isArray(t)&&(u=ot(u,t)),0===u.length)return D(function(){var t=l();if(t)return a.$__schema.s.hooks.execPost("validate:error",a,[a],{error:t},function(t){n(t)});n(null,a)});for(var f={},p=0,m=function(){var t=l();if(t)return a.$__schema.s.hooks.execPost("validate:error",a,[a],{error:t},function(t){n(t)});n(null,a)},g=function(t){null==t||f[t]||(f[t]=!0,p++,D(function(){var e=a.$__schema.path(t);if(!e)return--p||m();if(a.$isValid(t)){if(null!=e[X]&&t!==e.path)return--p||m();var n,r=a.$__getValue(t);null==r&&(n=a.populated(t))&&(r=n),e.doValidate(r,function(n){if(n&&(!e.$isMongooseDocumentArray||n.$isArrayValidatorError)){if(e.$isSingleNested&&n instanceof v&&!1===e.schema.options.storeSubdocValidationError)return--p||m();a.invalidate(t,n,void 0,!0)}--p||m()},t in a.$__.pathsToScopes?a.$__.pathsToScopes[t]:a,{skipSchemaValidators:h[t],path:t,validateModifiedOnly:i})}else--p||m()}))},y=u.length,_=0;_<y;++_)g(u[_])},tt.prototype.validateSync=function(t,e){var n=this,r=this;1!==arguments.length||"object"!==o(arguments[0])||Array.isArray(arguments[0])||(e=arguments[0],t=null);var i,s=e&&"object"===o(e)&&"validateModifiedOnly"in e;i=s?!!e.validateModifiedOnly:this.$__schema.options.validateModifiedOnly,"string"==typeof t&&(t=t.split(" "));var a=st(this),l=i?a[0].filter(function(t){return n.isModified(t)}):a[0],c=a[1];"string"==typeof t&&(t=t.split(" ")),Array.isArray(t)&&(l=ot(l,t));var u={};l.forEach(function(t){if(!u[t]){u[t]=!0;var e=r.$__schema.path(t);if(e&&r.$isValid(t)){var n=r.$__getValue(t),s=e.doValidateSync(n,r,{skipSchemaValidators:c[t],path:t,validateModifiedOnly:i});if(s&&(!e.$isMongooseDocumentArray||s.$isArrayValidatorError)){if(e.$isSingleNested&&s instanceof v&&!1===e.schema.options.storeSubdocValidationError)return;r.invalidate(t,s,void 0,!0)}}}});var h=r.$__.validationError;if(r.$__.validationError=void 0,r.emit("validate",r),r.constructor.emit("validate",r),h)for(var f in h.errors)h.errors[f]instanceof d.CastError&&r.invalidate(f,h.errors[f]);return h},tt.prototype.invalidate=function(t,e,n,r){if(this.$__.validationError||(this.$__.validationError=new v(this)),!this.$__.validationError.errors[t])return e&&"string"!=typeof e||(e=new b({path:t,message:e,type:r||"user defined",value:n})),this.$__.validationError===e||this.$__.validationError.addError(t,e),this.$__.validationError},tt.prototype.$markValid=function(t){this.$__.validationError&&this.$__.validationError.errors[t]&&(delete this.$__.validationError.errors[t],0===Object.keys(this.$__.validationError.errors).length&&(this.$__.validationError=null))},tt.prototype.$isValid=function(t){var e=this;return null==this.$__.validationError||0===Object.keys(this.$__.validationError.errors).length||null!=t&&(-1!==t.indexOf(" ")&&(t=t.split(" ")),Array.isArray(t)?t.some(function(t){return null==e.$__.validationError.errors[t]}):null==this.$__.validationError.errors[t])},tt.prototype.$__reset=function(){var t=this;return a||(a=n(18)),this.$__.activePaths.map("init","modify",function(e){return t.$__getValue(e)}).filter(function(t){return t&&t instanceof Array&&t.isMongooseDocumentArray&&t.length}).forEach(function(e){for(var n=e.length;n--;){var r=e[n];r&&r.$__reset()}t.$__.activePaths.init(e.$path()),e[$]=e[H],e[H]={}}),this.$__.activePaths.map("init","modify",function(e){return t.$__getValue(e)}).filter(function(t){return t&&t.$isSingleNested}).forEach(function(e){e.$__reset(),e.$__parent===t?t.$__.activePaths.init(e.$basePath):null!=e.$__parent&&e.$__parent.ownerDocument&&e.$__parent.$__reset()}),this.$__dirty().forEach(function(t){var e=t.value;e&&e[H]&&(e[$]=e[H],e[H]={})}),this.$__.backup={},this.$__.backup.activePaths={modify:Object.assign({},this.$__.activePaths.states.modify),default:Object.assign({},this.$__.activePaths.states.default)},this.$__.backup.validationError=this.$__.validationError,this.$__.backup.errors=this.errors,this.$__.activePaths.clear("modify"),this.$__.activePaths.clear("default"),this.$__.validationError=void 0,this.errors=void 0,t=this,this.$__schema.requiredPaths().forEach(function(e){t.$__.activePaths.require(e)}),this},tt.prototype.$__undoReset=function(){if(null!=this.$__.backup&&null!=this.$__.backup.activePaths){this.$__.activePaths.states.modify=this.$__.backup.activePaths.modify,this.$__.activePaths.states.default=this.$__.backup.activePaths.default,this.$__.validationError=this.$__.backup.validationError,this.errors=this.$__.backup.errors;var t,e=i(this.$__dirty());try{for(e.s();!(t=e.n()).done;){var n=t.value.value;n&&n[H]&&n[$]&&(n[H]=n[$])}}catch(t){e.e(t)}finally{e.f()}var r,s=i(this.$getAllSubdocs());try{for(s.s();!(r=s.n()).done;)r.value.$__undoReset()}catch(t){s.e(t)}finally{s.f()}}},tt.prototype.$__dirty=function(){var t=this,e=this.$__.activePaths.map("modify",function(e){return{path:e,value:t.$__getValue(e),schema:t.$__path(e)}});(e=e.concat(this.$__.activePaths.map("default",function(e){if("_id"!==e&&null!=t.$__getValue(e))return{path:e,value:t.$__getValue(e),schema:t.$__path(e)}}))).sort(function(t,e){return t.path<e.path?-1:t.path>e.path?1:0});var n,r,i=[];return e.forEach(function(t){t&&(null==n||0!==t.path.indexOf(n)?(n=t.path+".",i.push(t),r=t):null!=r&&null!=r.value&&null!=r.value[H]&&r.value.hasAtomics()&&(r.value[H]={},r.value[H].$set=r.value))}),r=n=null,i},tt.prototype.$__setSchema=function(t){t.plugin(P,{deduplicate:!0}),E(t.tree,this,void 0,t.options);for(var e=0,n=Object.keys(t.virtuals);e<n.length;e++)t.virtuals[n[e]]._applyDefaultGetters();null==t.path("schema")&&(this.schema=t),this.$__schema=t,this[Z]=t},tt.prototype.$__getArrayPathsToValidate=function(){return a||(a=n(18)),this.$__.activePaths.map("init","modify",(function(t){return this.$__getValue(t)}).bind(this)).filter(function(t){return t&&t instanceof Array&&t.isMongooseDocumentArray&&t.length}).reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return t})},tt.prototype.$getAllSubdocs=function(){function t(e,n,r){var i=e,s=!1;if(r&&(e instanceof tt&&e[Z].paths[r]?i=e._doc[r]:e instanceof tt&&e[Z].nested[r]?(i=e._doc[r],s=!0):i=e[r]),i instanceof c)n.push(i);else if(i instanceof Map)n=Array.from(i.keys()).reduce(function(e,n){return t(i.get(n),e,null)},n);else if(i&&i.$isSingleNested)(n=Object.keys(i._doc).reduce(function(e,n){return t(i._doc,e,n)},n)).push(i);else if(i&&i.isMongooseDocumentArray)i.forEach(function(e){e&&e._doc&&(n=Object.keys(e._doc).reduce(function(n,r){return t(e._doc,n,r)},n),e instanceof c&&n.push(e))});else if(s&&null!=i)for(var o=0,a=Object.keys(i);o<a.length;o++)t(i,n,a[o]);return n}a||(a=n(18)),c=c||n(27);for(var e=[],r=0,i=Object.keys(this._doc);r<i.length;r++)t(this,e,i[r]);return e},tt.prototype.$__handleReject=function(t){this.listeners("error").length?this.emit("error",t):this.constructor.listeners&&this.constructor.listeners("error").length&&this.constructor.emit("error",t)},tt.prototype.$toObject=function(t,n){var r,i,s={transform:!0,flattenDecimals:!0},o=n?"toJSON":"toObject",a=C(this,"constructor.base.options."+o,{}),l=C(this,"$__schema.options",{});s=B.options(s,U(a)),s=B.options(s,U(l[o]||{})),(t=B.isPOJO(t)?U(t):{})._calledWithOptions=t._calledWithOptions||U(t),r=null!=t._calledWithOptions.minimize?t.minimize:null!=s.minimize?s.minimize:l.minimize,i=null!=t._calledWithOptions.flattenMaps?t.flattenMaps:null!=s.flattenMaps?s.flattenMaps:l.flattenMaps;var c=Object.assign(B.clone(t),{_isNested:!0,json:n,minimize:r,flattenMaps:i});if(B.hasUserDefinedProperty(t,"getters")&&(c.getters=t.getters),B.hasUserDefinedProperty(t,"virtuals")&&(c.virtuals=t.virtuals),(t.depopulate||C(t,"_parentOptions.depopulate",!1))&&t._isNested&&this.$__.wasPopulated)return U(this._id,c);(t=B.options(s,t))._isNested=!0,t.json=n,t.minimize=r,c._parentOptions=t,c._skipSingleNestedGetters=!0;var u=Object.assign({},c);u._skipSingleNestedGetters=!1;var h=t.transform,d=U(this._doc,c)||{};t.getters&&(function(t,e,n){var r,i,s=Object.keys(t.$__schema.paths),o=s.length,a=t._doc;if(!a)return e;for(;o--;){var l=(r=s[o]).split("."),c=l.length,u=c-1,h=e,d=void 0;if(a=t._doc,t.$__isSelected(r))for(var f=0;f<c;++f){if(i=a[d=l[f]],f===u){var p=t.get(r);h[d]=U(p,n)}else{if(null==i){d in a&&(h[d]=i);break}h=h[d]||(h[d]={})}a=i}}}(this,d,u),t.minimize&&(d=function t(n){for(var r,i,s,o=Object.keys(n),a=o.length;a--;)B.isObject(s=n[i=o[a]])&&!e.isBuffer(s)&&(n[i]=t(s)),void 0!==n[i]?r=!0:delete n[i];return r?n:void 0}(d)||{})),(t.virtuals||t.getters&&!1!==t.virtuals)&&lt(this,d,u,t),!1===t.versionKey&&this.$__schema.options.versionKey&&delete d[this.$__schema.options.versionKey];var f=t.transform;if(f&&function(t,e){var n=t.$__schema,r=Object.keys(n.paths||{});if(!t._doc)return e;for(var i=0,s=r;i<s.length;i++){var o=s[i],a=n.paths[o];if("function"==typeof a.options.transform){var l=t.get(o),c=a.options.transform.call(t,l);ct(o,c),B.setValue(o,c,e)}else if(null!=a.$embeddedSchemaType&&"function"==typeof a.$embeddedSchemaType.options.transform){for(var u=[].concat(t.get(o)),h=a.$embeddedSchemaType.options.transform,d=0;d<u.length;++d){var f=h.call(t,u[d]);u[d]=f,ct(o,f)}e[o]=u}}}(this,d),t.useProjection&&function(t,e){var n=t.$__schema,r=Object.keys(n.paths||{});if(!t._doc)return e;var i=t.$__.selected;if(void 0===i&&F.applyPaths(i={},n),null==i||0===Object.keys(i).length)return e;for(var s=0,o=r;s<o.length;s++){var a=o[s];null==i[a]||i[a]||delete e[a]}}(this,d),!0===f||l.toObject&&f){var p=t.json?l.toJSON:l.toObject;p&&(f="function"==typeof t.transform?t.transform:p.transform)}else t.transform=h;if("function"==typeof f){var m=f(this,d,t);void 0!==m&&(d=m)}return d},tt.prototype.toObject=function(t){return this.$toObject(t)},tt.prototype.toJSON=function(t){return this.$toObject(t,!0)},tt.prototype.$parent=tt.prototype.parent=function(){return this.$__.parent},tt.prototype.inspect=function(t){var e;B.isPOJO(t)&&((e=t).minimize=!1);var n=this.toObject(e);return null==n?"MongooseDocument { "+n+" }":n},I.custom&&(tt.prototype[I.custom]=tt.prototype.inspect),tt.prototype.toString=function(){var t=this.inspect();return"string"==typeof t?t:I(t)},tt.prototype.equals=function(t){if(!t)return!1;var e=this.$__getValue("_id"),n=null!=t.$__?t.$__getValue("_id"):t;return e||n?e&&e.equals?e.equals(n):e===n:V(this,t)},tt.prototype.populate=function(){if(0===arguments.length)return this;var t,e=this.$__.populate||(this.$__.populate={}),n=B.args(arguments);if("function"==typeof n[n.length-1]&&(t=n.pop()),n.length){var r,s=B.populate.apply(null,n),o=i(s);try{for(o.s();!(r=o.n()).done;){var a=r.value;e[a.path]=a}}catch(t){o.e(t)}finally{o.f()}}if(t){var l=B.object.vals(e);this.$__.populate=void 0;var c=this.constructor;if(this.$__isNested){c=this.$__[K].constructor;var u=this.$__.nestedPath;l.forEach(function(t){t.path=u+"."+t.path})}if(null!=this.$session()){var h=this.$session();l.forEach(function(t){null!=t.options?"session"in t.options||(t.options.session=h):t.options={session:h}})}c.populate(this,l,t)}return this},tt.prototype.$getPopulatedDocs=function(){var t=[];null!=this.$__.populated&&(t=t.concat(Object.keys(this.$__.populated))),null!=this.$$populatedVirtuals&&(t=t.concat(Object.keys(this.$$populatedVirtuals)));var e,n=[],r=i(t);try{for(r.s();!(e=r.n()).done;){var s=this.get(e.value);Array.isArray(s)?n=n.concat(s):s instanceof tt&&n.push(s)}}catch(t){r.e(t)}finally{r.f()}return n},tt.prototype.execPopulate=function(t){var e=this,n=null!=t&&"function"!=typeof t;return n?this.populate.apply(this,arguments).execPopulate():x(t,function(t){e.populate(t)},this.constructor.events)},tt.prototype.populated=function(t,e,n){if(null==e||!0===e){if(!this.$__.populated)return;var r=t.endsWith(".$*")?t.replace(/\.\$\*$/,""):t,i=this.$__.populated[r];return i?!0===e?i:i.value:void 0}this.$__.populated||(this.$__.populated={}),this.$__.populated[t]={value:e,options:n};for(var s=t.split("."),o=0;o<s.length-1;++o){var a=s.slice(0,o+1).join("."),l=this.get(a);if(null!=l&&null!=l.$__&&this.populated(a)){var c=s.slice(o+1).join(".");l.populated(c,e,n);break}}return e},tt.prototype.depopulate=function(t){var e;"string"==typeof t&&(t=t.split(" "));var n=this.$$populatedVirtuals?Object.keys(this.$$populatedVirtuals):[],r=C(this,"$__.populated",{});if(0===arguments.length){var s,o=i(n);try{for(o.s();!(s=o.n()).done;){var a=s.value;delete this.$$populatedVirtuals[a],delete this._doc[a],delete r[a]}}catch(t){o.e(t)}finally{o.f()}for(var l=Object.keys(r),c=0,u=l;c<u.length;c++){var h=u[c];(e=this.populated(h))&&(delete r[h],this.$set(h,e))}return this}var d,f=i(t);try{for(f.s();!(d=f.n()).done;){var p=d.value;e=this.populated(p),delete r[p],-1!==n.indexOf(p)?(delete this.$$populatedVirtuals[p],delete this._doc[p]):e&&this.$set(p,e)}}catch(t){f.e(t)}finally{f.f()}return this},tt.prototype.$__fullPath=function(t){return t||""},tt.prototype.getChanges=function(){var t=this.$__delta();return t?t[1]:{}},tt.ValidationError=v,t.exports=tt}).call(this,n(2).Buffer)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=l(t);if(e){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=n(14),u=n(3),h=n(4),d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(r,t);var e,n=o(r);function r(t,e,s,o,l){var c;if(i(this,r),arguments.length>0){var u=f(e),h=p(e),d=m(l),y=g(null,t,u,s,d,h);(c=n.call(this,y)).init(t,e,s,o,l)}else c=n.call(this,g());return a(c)}return(e=[{key:"toJSON",value:function(){return{stringValue:this.stringValue,valueType:this.valueType,kind:this.kind,value:this.value,path:this.path,reason:this.reason,name:this.name,message:this.message}}},{key:"init",value:function(t,e,n,r,i){this.stringValue=f(e),this.messageFormat=m(i),this.kind=t,this.value=e,this.path=n,this.reason=r,this.valueType=p(e)}},{key:"copy",value:function(t){this.messageFormat=t.messageFormat,this.stringValue=t.stringValue,this.kind=t.kind,this.value=t.value,this.path=t.path,this.reason=t.reason,this.message=t.message,this.valueType=t.valueType}},{key:"setModel",value:function(t){this.model=t,this.message=g(t,this.kind,this.stringValue,this.path,this.messageFormat,this.valueType)}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(r.prototype,e),r}(c);function f(t){var e=h.inspect(t);return(e=e.replace(/^'|'$/g,'"')).startsWith('"')||(e='"'+e+'"'),e}function p(t){if(null==t)return""+t;var e=r(t);return"object"!==e||"function"!=typeof t.constructor?e:t.constructor.name}function m(t){var e=u(t,"options.cast",null);if("string"==typeof e)return e}function g(t,e,n,r,i,s){if(null!=i){var o=i.replace("{KIND}",e).replace("{VALUE}",n).replace("{PATH}",r);return null!=t&&(o=o.replace("{MODEL}",t.modelName)),o}var a="Cast to "+e+" failed for value "+n+(s?" (type "+s+")":"")+' at path "'+r+'"';return null!=t&&(a+=' for model "'+t.modelName+'"'),a}Object.defineProperty(d.prototype,"name",{value:"CastError"}),t.exports=d},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){var e="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return a(t,arguments,u(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,t)})(t)}function a(t,e,n){return(a=l()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&c(i,n.prototype),i}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(o,t);var e,n,r=(e=o,n=l(),function(){var t,r=u(e);if(n){var i=u(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return s(this,t)});function o(){return i(this,o),r.apply(this,arguments)}return o}(o(Error));Object.defineProperty(h.prototype,"name",{value:"MongooseError"}),t.exports=h},function(t,e,n){"use strict";var r=null;t.exports.get=function(){return r},t.exports.set=function(t){r=t}},function(t,e,n){"use strict";(function(e){function n(t,n){return new e(t,n)}t.exports={normalizedFunctionString:function(t){return t.toString().replace(/function *\(/,"function (")},allocBuffer:"function"==typeof e.alloc?function(){return e.alloc.apply(e,arguments)}:n,toBuffer:"function"==typeof e.from?function(){return e.from.apply(e,arguments)}:n}}).call(this,n(2).Buffer)},function(t,e,n){"use strict";e.internalToObjectOptions={transform:!1,virtuals:!1,getters:!1,_skipDepopulateTopLevel:!0,depopulate:!0,flattenDecimals:!1,useProjection:!1}},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=n(85),d=n(12),f=n(7),p=n(88),m=n(36),g=n(17).internalToObjectOptions,y=n(4),_=n(1),v=n(0).arrayAtomicsSymbol,b=n(0).arrayParentSymbol,w=n(0).arrayPathSymbol,x=n(0).arraySchemaSymbol,S=n(0).documentArrayParent,E=Array.prototype.push,A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(r,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}(r);function r(){return o(this,r),n.apply(this,arguments)}return function(t,e,n){e&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e)}(r,[{key:"isMongooseDocumentArray",get:function(){return!0}},{key:"toBSON",value:function(){return this.toObject(g)}},{key:"map",value:function(){var t=a(u(r.prototype),"map",this).apply(this,arguments);return t[x]=null,t[w]=null,t[b]=null,t}},{key:"_cast",value:function(t,n){if(null==this[x])return t;var r=this[x].casterConstructor;if((r.$isMongooseDocumentArray?t&&t.isMongooseDocumentArray:t instanceof r)||t&&t.constructor&&t.constructor.baseCasterConstructor===r)return t[S]&&t.__parentArray||(t[S]=this[b],t.__parentArray=this),t.$setIndex(n),t;if(null==t)return null;if((e.isBuffer(t)||t instanceof f||!_.isObject(t))&&(t={_id:t}),t&&r.discriminators&&r.schema&&r.schema.options&&r.schema.options.discriminatorKey)if("string"==typeof t[r.schema.options.discriminatorKey]&&r.discriminators[t[r.schema.options.discriminatorKey]])r=r.discriminators[t[r.schema.options.discriminatorKey]];else{var i=m(r.discriminators,t[r.schema.options.discriminatorKey]);i&&(r=i)}return r.$isMongooseDocumentArray?r.cast(t,this,void 0,void 0,n):new r(t,this,void 0,void 0,n)}},{key:"id",value:function(t){var e,n,r;try{e=p(t).toString()}catch(t){e=null}var s,o=i(this);try{for(o.s();!(s=o.n()).done;){var a=s.value;if(a&&null!=(r=a.get("_id")))if(r instanceof d){if(n||(n=String(t)),n==r._id)return a}else if(t instanceof f||r instanceof f){if(e==r)return a}else if(t==r||_.deepEqual(t,r))return a}}catch(t){o.e(t)}finally{o.f()}return null}},{key:"toObject",value:function(t){return[].concat(this.map(function(e){return null==e?null:"function"!=typeof e.toObject?e:e.toObject(t)}))}},{key:"slice",value:function(){var t=a(u(r.prototype),"slice",this).apply(this,arguments);return t[b]=this[b],t[w]=this[w],t}},{key:"push",value:function(){var t=a(u(r.prototype),"push",this).apply(this,arguments);return T(this),t}},{key:"pull",value:function(){var t=a(u(r.prototype),"pull",this).apply(this,arguments);return T(this),t}},{key:"shift",value:function(){var t=a(u(r.prototype),"shift",this).apply(this,arguments);return T(this),t}},{key:"splice",value:function(){var t=a(u(r.prototype),"splice",this).apply(this,arguments);return T(this),t}},{key:"inspect",value:function(){return this.toObject()}},{key:"create",value:function(t){var e=this[x].casterConstructor;if(t&&e.discriminators&&e.schema&&e.schema.options&&e.schema.options.discriminatorKey)if("string"==typeof t[e.schema.options.discriminatorKey]&&e.discriminators[t[e.schema.options.discriminatorKey]])e=e.discriminators[t[e.schema.options.discriminatorKey]];else{var n=m(e.discriminators,t[e.schema.options.discriminatorKey]);n&&(e=n)}return new e(t,this)}},{key:"notify",value:function(t){var e=this;return function n(r,i){for(var s=(i=i||e).length;s--;)if(null!=i[s]){switch(t){case"save":r=e[s]}i[s].isMongooseArray?n(r,i[s]):i[s]&&i[s].emit(t,r)}}}},{key:"_markModified",value:function(t,e){var n,r=this[b];if(r){if(n=this[w],arguments.length)if(null!=e){var i=t.__index;n=n+"."+i+"."+e}else n=n+"."+t;if(null!=n&&n.endsWith(".$"))return this;r.markModified(n,arguments.length>0?t:r)}return this}}]),r}(h);function T(t){var e=t[b];if(e&&null!=e.$__.populated){var n,r=i(Object.keys(e.$__.populated).filter(function(e){return e.startsWith(t[w]+".")}));try{var s=function(){var r=n.value,i=r.slice((t[w]+".").length);if(!Array.isArray(e.$__.populated[r].value))return"continue";e.$__.populated[r].value=t.map(function(t){return t.populated(i)})};for(r.s();!(n=r.n()).done;)s()}catch(t){r.e(t)}finally{r.f()}}}y.inspect.custom&&(A.prototype[y.inspect.custom]=A.prototype.inspect),t.exports=function(t,e,n){var r=new A;if(r[v]={},r[x]=void 0,Array.isArray(t)&&(t[w]===e&&t[b]===n&&(r[v]=Object.assign({},t[v])),t.forEach(function(t){E.call(r,t)})),r[w]=e,n&&n instanceof d)for(r[b]=n,r[x]=n.schema.path(e);null!=r&&null!=r[x]&&r[x].$isMongooseArray&&!r[x].$isMongooseDocumentArray;)r[x]=r[x].casterConstructor;return r}}).call(this,n(2).Buffer)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i,s="object"===("undefined"==typeof Reflect?"undefined":r(Reflect))?Reflect:null,o=s&&"function"==typeof s.apply?s.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function l(){l.init.call(this)}t.exports=l,t.exports.once=function(t,e){return new Promise(function(n,r){function i(n){t.removeListener(e,s),r(n)}function s(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}_(t,e,s,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&_(t,"error",e,{once:!0})}(t,i)})},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(t))}function h(t){return void 0===t._maxListeners?l.defaultMaxListeners:t._maxListeners}function d(t,e,n,r){var i,s,o;if(u(n),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),void 0===o)o=s[e]=n,++t._eventsCount;else if("function"==typeof o?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=h(t))>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,console&&console.warn&&console.warn(a)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function m(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):y(i,i.length)}function g(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function _(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+r(t));t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)})}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),l.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=i[t];if(void 0===l)return!1;if("function"==typeof l)o(l,this,e);else{var c=l.length,u=y(l,c);for(n=0;n<c;++n)o(u[n],this,e)}return!0},l.prototype.on=l.prototype.addListener=function(t,e){return d(this,t,e,!1)},l.prototype.prependListener=function(t,e){return d(this,t,e,!0)},l.prototype.once=function(t,e){return u(e),this.on(t,p(this,t,e)),this},l.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,p(this,t,e)),this},l.prototype.off=l.prototype.removeListener=function(t,e){var n,r,i,s,o;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===e||n[s].listener===e){o=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,o||e)}return this},l.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},l.prototype.listeners=function(t){return m(this,t,!0)},l.prototype.rawListeners=function(t){return m(this,t,!1)},l.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},l.prototype.listenerCount=g,l.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(t,e,n){"use strict";t.exports=n(15).get().Decimal128},function(t,e,n){"use strict";(function(e){t.exports=function(t){return!!e.isBuffer(t)||"[object Object]"===Object.prototype.toString.call(t)}}).call(this,n(2).Buffer)},function(t,e,n){"use strict";(function(e){var n=e.nextTick.bind(e);t.exports=function(t){return n(t)}}).call(this,n(11))},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(117);function s(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n(4),l=Object.prototype.hasOwnProperty,c=Array.prototype.slice,u="foo"===(function(){}).name;function h(t){return Object.prototype.toString.call(t)}function d(t){return!o(t)&&"function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var f=t.exports=v,p=/\s*function\s+([^\(\s]*)\s*/;function m(t){if(a.isFunction(t)){if(u)return t.name;var e=t.toString().match(p);return e&&e[1]}}function g(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function y(t){if(u||!a.isFunction(t))return a.inspect(t);var e=m(t);return"[Function"+(e?": "+e:"")+"]"}function _(t,e,n,r,i){throw new f.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function v(t,e){t||_(t,!0,e,"==",f.ok)}function b(t,e,n,i){if(t===e)return!0;if(o(t)&&o(e))return 0===s(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"===r(t)||null!==e&&"object"===r(e)){if(d(t)&&d(e)&&h(t)===h(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===s(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var l=(i=i||{actual:[],expected:[]}).actual.indexOf(t);return-1!==l&&l===i.expected.indexOf(e)||(i.actual.push(t),i.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=w(t),s=w(e);if(i&&!s||!i&&s)return!1;if(i)return b(t=c.call(t),e=c.call(e),n);var o,l,u=E(t),h=E(e);if(u.length!==h.length)return!1;for(u.sort(),h.sort(),l=u.length-1;l>=0;l--)if(u[l]!==h[l])return!1;for(l=u.length-1;l>=0;l--)if(!b(t[o=u[l]],e[o],n,r))return!1;return!0}(t,e,n,i))}return n?t===e:t==e}function w(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function x(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function S(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&_(i,n,"Missing expected exception"+r);var s="string"==typeof r,o=!t&&i&&!n;if((!t&&a.isError(i)&&s&&x(i,n)||o)&&_(i,n,"Got unwanted exception"+r),t&&i&&n&&!x(i,n)||!t&&i)throw i}f.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return g(y(t.actual),128)+" "+t.operator+" "+g(y(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||_;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=m(e),s=r.indexOf("\n"+i);if(s>=0){var o=r.indexOf("\n",s+1);r=r.substring(o+1)}this.stack=r}}},a.inherits(f.AssertionError,Error),f.fail=_,f.ok=v,f.equal=function(t,e,n){t!=e&&_(t,e,n,"==",f.equal)},f.notEqual=function(t,e,n){t==e&&_(t,e,n,"!=",f.notEqual)},f.deepEqual=function(t,e,n){b(t,e,!1)||_(t,e,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(t,e,n){b(t,e,!0)||_(t,e,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(t,e,n){b(t,e,!1)&&_(t,e,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function t(e,n,r){b(e,n,!0)&&_(e,n,r,"notDeepStrictEqual",t)},f.strictEqual=function(t,e,n){t!==e&&_(t,e,n,"===",f.strictEqual)},f.notStrictEqual=function(t,e,n){t===e&&_(t,e,n,"!==",f.notStrictEqual)},f.throws=function(t,e,n){S(!0,t,e,n)},f.doesNotThrow=function(t,e,n){S(!1,t,e,n)},f.ifError=function(t){if(t)throw t},f.strict=i(function t(e,n){e||_(e,!0,n,"==",t)},f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var E=Object.keys||function(t){var e=[];for(var n in t)l.call(t,n)&&e.push(n);return e}}).call(this,n(10))},function(t,e){function n(t,e){if(!(this instanceof n))return new n(t,e);this._bsontype="Long",this.low_=0|t,this.high_=0|e}n.prototype.toInt=function(){return this.low_},n.prototype.toNumber=function(){return this.high_*n.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},n.prototype.toBigInt=function(){return BigInt(this.toString())},n.prototype.toJSON=function(){return this.toString()},n.prototype.toString=function(t){var e=t||10;if(e<2||36<e)throw Error("radix out of range: "+e);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(n.MIN_VALUE)){var r=n.fromNumber(e),i=this.div(r),s=i.multiply(r).subtract(this);return i.toString(e)+s.toInt().toString(e)}return"-"+this.negate().toString(e)}var o=n.fromNumber(Math.pow(e,6));s=this;for(var a="";!s.isZero();){var l=s.div(o),c=s.subtract(l.multiply(o)).toInt().toString(e);if((s=l).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},n.prototype.getHighBits=function(){return this.high_},n.prototype.getLowBits=function(){return this.low_},n.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:n.TWO_PWR_32_DBL_+this.low_},n.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(n.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!==this.high_?this.high_:this.low_,e=31;e>0&&0==(t&1<<e);e--);return 0!==this.high_?e+33:e+1},n.prototype.isZero=function(){return 0===this.high_&&0===this.low_},n.prototype.isNegative=function(){return this.high_<0},n.prototype.isOdd=function(){return 1==(1&this.low_)},n.prototype.equals=function(t){return this.high_===t.high_&&this.low_===t.low_},n.prototype.notEquals=function(t){return this.high_!==t.high_||this.low_!==t.low_},n.prototype.lessThan=function(t){return this.compare(t)<0},n.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},n.prototype.greaterThan=function(t){return this.compare(t)>0},n.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},n.prototype.compare=function(t){if(this.equals(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.subtract(t).isNegative()?-1:1},n.prototype.negate=function(){return this.equals(n.MIN_VALUE)?n.MIN_VALUE:this.not().add(n.ONE)},n.prototype.add=function(t){var e=0,r=0,i=0,s=0;return i+=(s+=(65535&this.low_)+(65535&t.low_))>>>16,r+=(i+=(this.low_>>>16)+(t.low_>>>16))>>>16,e+=(r+=(65535&this.high_)+(65535&t.high_))>>>16,e+=(this.high_>>>16)+(t.high_>>>16),n.fromBits((i&=65535)<<16|(s&=65535),(e&=65535)<<16|(r&=65535))},n.prototype.subtract=function(t){return this.add(t.negate())},n.prototype.multiply=function(t){if(this.isZero())return n.ZERO;if(t.isZero())return n.ZERO;if(this.equals(n.MIN_VALUE))return t.isOdd()?n.MIN_VALUE:n.ZERO;if(t.equals(n.MIN_VALUE))return this.isOdd()?n.MIN_VALUE:n.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(n.TWO_PWR_24_)&&t.lessThan(n.TWO_PWR_24_))return n.fromNumber(this.toNumber()*t.toNumber());var e=65535&this.high_,r=this.low_>>>16,i=65535&this.low_,s=65535&t.high_,o=t.low_>>>16,a=65535&t.low_,l=0,c=0,u=0,h=0;return u+=(h+=i*a)>>>16,c+=(u+=r*a)>>>16,u&=65535,c+=(u+=i*o)>>>16,l+=(c+=e*a)>>>16,c&=65535,l+=(c+=r*o)>>>16,c&=65535,l+=(c+=i*s)>>>16,l+=(this.high_>>>16)*a+e*o+r*s+i*(t.high_>>>16),n.fromBits((u&=65535)<<16|(h&=65535),(l&=65535)<<16|(c&=65535))},n.prototype.div=function(t){if(t.isZero())throw Error("division by zero");if(this.isZero())return n.ZERO;if(this.equals(n.MIN_VALUE)){if(t.equals(n.ONE)||t.equals(n.NEG_ONE))return n.MIN_VALUE;if(t.equals(n.MIN_VALUE))return n.ONE;var e=this.shiftRight(1).div(t).shiftLeft(1);if(e.equals(n.ZERO))return t.isNegative()?n.ONE:n.NEG_ONE;var r=this.subtract(t.multiply(e));return e.add(r.div(t))}if(t.equals(n.MIN_VALUE))return n.ZERO;if(this.isNegative())return t.isNegative()?this.negate().div(t.negate()):this.negate().div(t).negate();if(t.isNegative())return this.div(t.negate()).negate();var i=n.ZERO;for(r=this;r.greaterThanOrEqual(t);){e=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(e)/Math.LN2),o=s<=48?1:Math.pow(2,s-48),a=n.fromNumber(e),l=a.multiply(t);l.isNegative()||l.greaterThan(r);)l=(a=n.fromNumber(e-=o)).multiply(t);a.isZero()&&(a=n.ONE),i=i.add(a),r=r.subtract(l)}return i},n.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},n.prototype.not=function(){return n.fromBits(~this.low_,~this.high_)},n.prototype.and=function(t){return n.fromBits(this.low_&t.low_,this.high_&t.high_)},n.prototype.or=function(t){return n.fromBits(this.low_|t.low_,this.high_|t.high_)},n.prototype.xor=function(t){return n.fromBits(this.low_^t.low_,this.high_^t.high_)},n.prototype.shiftLeft=function(t){if(0==(t&=63))return this;var e=this.low_;return t<32?n.fromBits(e<<t,this.high_<<t|e>>>32-t):n.fromBits(0,e<<t-32)},n.prototype.shiftRight=function(t){if(0==(t&=63))return this;var e=this.high_;return t<32?n.fromBits(this.low_>>>t|e<<32-t,e>>t):n.fromBits(e>>t-32,e>=0?0:-1)},n.prototype.shiftRightUnsigned=function(t){if(0==(t&=63))return this;var e=this.high_;return t<32?n.fromBits(this.low_>>>t|e<<32-t,e>>>t):n.fromBits(32===t?e:e>>>t-32,0)},n.fromInt=function(t){if(-128<=t&&t<128){var e=n.INT_CACHE_[t];if(e)return e}var r=new n(0|t,t<0?-1:0);return-128<=t&&t<128&&(n.INT_CACHE_[t]=r),r},n.fromNumber=function(t){return isNaN(t)||!isFinite(t)?n.ZERO:t<=-n.TWO_PWR_63_DBL_?n.MIN_VALUE:t+1>=n.TWO_PWR_63_DBL_?n.MAX_VALUE:t<0?n.fromNumber(-t).negate():new n(t%n.TWO_PWR_32_DBL_|0,t/n.TWO_PWR_32_DBL_|0)},n.fromBigInt=function(t){return n.fromString(t.toString(10),10)},n.fromBits=function(t,e){return new n(t,e)},n.fromString=function(t,e){if(0===t.length)throw Error("number format error: empty string");var r=e||10;if(r<2||36<r)throw Error("radix out of range: "+r);if("-"===t.charAt(0))return n.fromString(t.substring(1),r).negate();if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+t);for(var i=n.fromNumber(Math.pow(r,8)),s=n.ZERO,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),r);if(a<8){var c=n.fromNumber(Math.pow(r,a));s=s.multiply(c).add(n.fromNumber(l))}else s=(s=s.multiply(i)).add(n.fromNumber(l))}return s},n.INT_CACHE_={},n.TWO_PWR_16_DBL_=65536,n.TWO_PWR_24_DBL_=1<<24,n.TWO_PWR_31_DBL_=(n.TWO_PWR_32_DBL_=n.TWO_PWR_16_DBL_*n.TWO_PWR_16_DBL_)/2,n.TWO_PWR_48_DBL_=n.TWO_PWR_32_DBL_*n.TWO_PWR_16_DBL_,n.TWO_PWR_63_DBL_=(n.TWO_PWR_64_DBL_=n.TWO_PWR_32_DBL_*n.TWO_PWR_32_DBL_)/2,n.ZERO=n.fromInt(0),n.ONE=n.fromInt(1),n.NEG_ONE=n.fromInt(-1),n.MAX_VALUE=n.fromBits(-1,2147483647),n.MIN_VALUE=n.fromBits(0,-2147483648),n.TWO_PWR_24_=n.fromInt(1<<24),t.exports=n,t.exports.Long=n},function(t,e,n){"use strict";var r=n(67),i=n(22),s=Symbol("mongoose:emitted");t.exports=function(t,e,n,o){return"function"==typeof t?e(function(e){if(null==e)t.apply(this,arguments);else{null!=n&&null!=n.listeners&&n.listeners("error").length>0&&!e[s]&&(e[s]=!0,n.emit("error",e));try{t(e)}catch(e){return i(function(){throw e})}}}):new(o=o||r.get())(function(t,r){e(function(e,i){return null!=e?(null!=n&&null!=n.listeners&&n.listeners("error").length>0&&!e[s]&&(e[s]=!0,n.emit("error",e)),r(e)):arguments.length>2?t(Array.prototype.slice.call(arguments,1)):void t(i)})})}},function(t,e,n){"use strict";var r=n(6),i=n(34),s=n(21),o=n(1);function a(t,e){if(e&&e.default){var n=e.default;Array.isArray(n)&&0===n.length?e.default=Array:!e.shared&&s(n)&&0===Object.keys(n).length&&(e.default=function(){return{}})}r.call(this,t,e,"Mixed"),this[i.schemaMixedSymbol]=!0}a.schemaName="Mixed",a.defaultOptions={},(a.prototype=Object.create(r.prototype)).constructor=a,a.get=r.get,a.set=r.set,a.prototype.cast=function(t){return t instanceof Error?o.errorToPOJO(t):t},a.prototype.castForQuery=function(t,e){return 2===arguments.length?e:t},t.exports=a},function(t,e,n){"use strict";var r=n(61)(),i=n(19).EventEmitter,s=n(32),o=n(22),a=n(17).internalToObjectOptions,l=n(3),c=n(25),u=n(4),h=n(0).documentArrayParent,d=n(0).validatorErrorSymbol;function f(t,e,n,i,s){var o={};null!=e&&e.isMongooseDocumentArray?(this.__parentArray=e,this[h]=e.$parent()):(this.__parentArray=void 0,this[h]=void 0),this.$setIndex(s),this.$isDocumentArrayElement=!0,null!=this[h]&&(o.defaults=this[h].$__.$options.defaults),r.call(this,t,i,n,o);var a=this;this.on("isNew",function(t){a.isNew=t}),a.on("save",function(){a.constructor.emit("save",a)})}for(var p in(f.prototype=Object.create(r.prototype)).constructor=f,i.prototype)f[p]=i.prototype[p];f.prototype.toBSON=function(){return this.toObject(a)},f.prototype.$setIndex=function(t){if(this.__index=t,null!=l(this,"$__.validationError",null))for(var e=0,n=Object.keys(this.$__.validationError.errors);e<n.length;e++){var r=n[e];this.invalidate(r,this.$__.validationError.errors[r])}},f.prototype.markModified=function(t){if(this.$__.activePaths.modify(t),this.__parentArray){var e=this.__parentArray.$path()+".0."+t;this.isNew&&this.ownerDocument().$__isSelected(e)?this.__parentArray._markModified():this.__parentArray._markModified(this,t)}},f.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.arr[0].populate("path")`, use `doc.populate("arr.0.path")`')},f.prototype.save=function(t,e){var n=this;return"function"==typeof t&&(e=t,t={}),(t=t||{}).suppressWarning||console.warn("mongoose: calling `save()` on a subdoc does **not** save the document to MongoDB, it only runs save middleware. Use `subdoc.save({ suppressWarning: true })` to hide this warning if you're sure this behavior is right for your app."),c(e,function(t){n.$__save(t)})},f.prototype.$__save=function(t){var e=this;return o(function(){return t(null,e)})},f.prototype.$__remove=function(t){if(null!=t)return t(null,this)},f.prototype.remove=function(t,e){if("function"!=typeof t||e||(e=t,t=void 0),!this.__parentArray||t&&t.noop)return this.$__remove(e),this;var n;if(!this.willRemove){if(!(n=this._doc._id))throw new Error("For your own good, Mongoose does not know how to remove an EmbeddedDocument that has no _id");this.__parentArray.pull({_id:n}),this.willRemove=!0,function(t){var e=t.ownerDocument();function n(){e.removeListener("save",n),e.removeListener("remove",n),t.emit("remove",t),t.constructor.emit("remove",t),e=t=null}e.on("save",n),e.on("remove",n)}(this)}return this.$__remove(e),this},f.prototype.update=function(){throw new Error("The #update method is not available on EmbeddedDocuments")},f.prototype.inspect=function(){return this.toObject({transform:!1,virtuals:!1,flattenDecimals:!1})},u.inspect.custom&&(f.prototype[u.inspect.custom]=f.prototype.inspect),f.prototype.invalidate=function(t,e,n){if(r.prototype.invalidate.call(this,t,e,n),!this[h]||null==this.__index){if(e[d]||e instanceof s)return this.ownerDocument().$__.validationError;throw e}var i=this.__index,o=[this.__parentArray.$path(),i,t].join(".");return this[h].invalidate(o,e,n),this.ownerDocument().$__.validationError},f.prototype.$markValid=function(t){if(this[h]){var e=this.__index;if(void 0!==e){var n=[this.__parentArray.$path(),e,t].join(".");this[h].$markValid(n)}}},f.prototype.$ignore=function(t){if(r.prototype.$ignore.call(this,t),this[h]){var e=this.__index;if(void 0!==e){var n=[this.__parentArray.$path(),e,t].join(".");this[h].$ignore(n)}}},f.prototype.$isValid=function(t){return void 0===this.__index||!this[h]||!this[h].$__.validationError||!this[h].$__.validationError.errors[this.$__fullPath(t)]},f.prototype.ownerDocument=function(){if(this.$__.ownerDocument)return this.$__.ownerDocument;var t=this[h];if(!t)return this;for(;t[h]||t.$__parent;)t=t[h]||t.$__parent;return this.$__.ownerDocument=t,this.$__.ownerDocument},f.prototype.$__fullPath=function(t){if(!this.$__.fullPath){var e=this;if(!e[h])return t;for(var n=[];e[h]||e.$__parent;)n.unshift(e[h]?e.__parentArray.$path():e.$basePath),e=e[h]||e.$__parent;this.$__.fullPath=n.join("."),this.$__.ownerDocument||(this.$__.ownerDocument=e)}return t?this.$__.fullPath+"."+t:this.$__.fullPath},f.prototype.$parent=f.prototype.parent=function(){return this[h]},f.prototype.parentArray=function(){return this.__parentArray},t.exports=f},function(t,e,n){(function(e){if(void 0!==e)var r=n(2).Buffer;var i=n(16);function s(t,e){if(!(this instanceof s))return new s(t,e);if(!(null==t||"string"==typeof t||r.isBuffer(t)||t instanceof Uint8Array||Array.isArray(t)))throw new Error("only String, Buffer, Uint8Array or Array accepted");if(this._bsontype="Binary",t instanceof Number?(this.sub_type=t,this.position=0):(this.sub_type=null==e?o:e,this.position=0),null==t||t instanceof Number)this.buffer=void 0!==r?i.allocBuffer(s.BUFFER_SIZE):"undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(s.BUFFER_SIZE)):new Array(s.BUFFER_SIZE),this.position=0;else{if("string"==typeof t)if(void 0!==r)this.buffer=i.toBuffer(t);else{if("undefined"==typeof Uint8Array&&"[object Array]"!==Object.prototype.toString.call(t))throw new Error("only String, Buffer, Uint8Array or Array accepted");this.buffer=a(t)}else this.buffer=t;this.position=t.length}}s.prototype.put=function(t){if(null!=t.length&&"number"!=typeof t&&1!==t.length)throw new Error("only accepts single character String, Uint8Array or Array");if("number"!=typeof t&&t<0||t>255)throw new Error("only accepts number in a valid unsigned byte range 0-255");var e;if(e="string"==typeof t?t.charCodeAt(0):null!=t.length?t[0]:t,this.buffer.length>this.position)this.buffer[this.position++]=e;else if(void 0!==r&&r.isBuffer(this.buffer)){var n=i.allocBuffer(s.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=e}else{n=null,n="[object Uint8Array]"===Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(s.BUFFER_SIZE+this.buffer.length)):new Array(s.BUFFER_SIZE+this.buffer.length);for(var o=0;o<this.buffer.length;o++)n[o]=this.buffer[o];this.buffer=n,this.buffer[this.position++]=e}},s.prototype.write=function(t,e){if(this.buffer.length<(e="number"==typeof e?e:this.position)+t.length){var n=null;if(void 0!==r&&r.isBuffer(this.buffer))n=i.allocBuffer(this.buffer.length+t.length),this.buffer.copy(n,0,0,this.buffer.length);else if("[object Uint8Array]"===Object.prototype.toString.call(this.buffer)){n=new Uint8Array(new ArrayBuffer(this.buffer.length+t.length));for(var s=0;s<this.position;s++)n[s]=this.buffer[s]}this.buffer=n}if(void 0!==r&&r.isBuffer(t)&&r.isBuffer(this.buffer))t.copy(this.buffer,e,0,t.length),this.position=e+t.length>this.position?e+t.length:this.position;else if(void 0!==r&&"string"==typeof t&&r.isBuffer(this.buffer))this.buffer.write(t,e,"binary"),this.position=e+t.length>this.position?e+t.length:this.position;else if("[object Uint8Array]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)&&"string"!=typeof t){for(s=0;s<t.length;s++)this.buffer[e++]=t[s];this.position=e>this.position?e:this.position}else if("string"==typeof t){for(s=0;s<t.length;s++)this.buffer[e++]=t.charCodeAt(s);this.position=e>this.position?e:this.position}},s.prototype.read=function(t,e){if(e=e&&e>0?e:this.position,this.buffer.slice)return this.buffer.slice(t,t+e);for(var n="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(e)):new Array(e),r=0;r<e;r++)n[r]=this.buffer[t++];return n},s.prototype.value=function(t){if((t=null!=t&&t)&&void 0!==r&&r.isBuffer(this.buffer)&&this.buffer.length===this.position)return this.buffer;if(void 0!==r&&r.isBuffer(this.buffer))return t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position);if(t){if(null!=this.buffer.slice)return this.buffer.slice(0,this.position);for(var e="[object Uint8Array]"===Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position),n=0;n<this.position;n++)e[n]=this.buffer[n];return e}return l(this.buffer,0,this.position)},s.prototype.length=function(){return this.position},s.prototype.toJSON=function(){return null!=this.buffer?this.buffer.toString("base64"):""},s.prototype.toString=function(t){return null!=this.buffer?this.buffer.slice(0,this.position).toString(t):""};var o=0,a=function(t){for(var e="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(t.length)):new Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e},l=function(t,e,n){for(var r="",i=e;i<n;i++)r+=String.fromCharCode(t[i]);return r};s.BUFFER_SIZE=256,s.SUBTYPE_DEFAULT=0,s.SUBTYPE_FUNCTION=1,s.SUBTYPE_BYTE_ARRAY=2,s.SUBTYPE_UUID_OLD=3,s.SUBTYPE_UUID=4,s.SUBTYPE_MD5=5,s.SUBTYPE_USER_DEFINED=128,t.exports=s,t.exports.Binary=s}).call(this,n(10))},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=n(64),o=n(20),a=n(7),l=n(50),c=n(30),u=n(65),h=n(66),d=n(21),f=n(0),p=n(1);function m(t,e,n){if(null==t)return t;if(Array.isArray(t))return function(t,e){var n,i=[],s=r(t);try{for(s.s();!(n=s.n()).done;)i.push(m(n.value,e,!0))}catch(t){s.e(t)}finally{s.f()}return i}(t,e);if(c(t))return e&&e._skipSingleNestedGetters&&t.$isSingleNested&&(e=Object.assign({},e,{getters:!1})),p.isPOJO(t)&&null!=t.$__&&null!=t._doc?t._doc:e&&e.json&&"function"==typeof t.toJSON?t.toJSON(e):t.toObject(e);if(t.constructor)switch(u(t.constructor)){case"Object":return g(t,e,n);case"Date":return new t.constructor(+t);case"RegExp":return s(t)}return t instanceof a?new a(t.id):h(t,"Decimal128")?e&&e.flattenDecimals?t.toJSON():o.fromString(t.toString()):!t.constructor&&d(t)?g(t,e,n):t[f.schemaTypeSymbol]?t.clone():e&&e.bson&&"function"==typeof t.toBSON?t:null!=t.valueOf?t.valueOf():g(t,e,n)}function g(t,e,n){for(var r,i=e&&e.minimize,s={},o=0,a=Object.keys(t);o<a.length;o++){var c=a[o];if(!l.has(c)){var u=m(t[c],e);i&&void 0===u||(!1===i&&void 0===u?delete s[c]:(r||(r=!0),s[c]=u))}}return i&&!n?r&&s:s}t.exports=m},function(t,e,n){"use strict";t.exports=function(t){return null!=t&&(null!=t.$__||t.isMongooseArray||t.isMongooseBuffer||t.$isMongooseMap)}},function(t,e,n){"use strict";var r=["find","findOne","update","updateMany","updateOne","replaceOne","remove","count","distinct","findAndModify","aggregate","findStream","deleteOne","deleteMany"];function i(){}for(var s=0,o=r.length;s<o;++s){var a=r[s];i.prototype[a]=l(a)}function l(t){return function(){throw new Error("collection."+t+" not implemented")}}t.exports=i,i.methods=r},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=n(14),c=n(4),u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(r,t);var e,n=s(r);function r(t){var e,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=n.call(this,i=t&&"model"===t.constructor.name?t.constructor.modelName+" validation failed":"Validation failed")).errors={},e._message=i,t&&(t.errors=e.errors),e}return(e=[{key:"toString",value:function(){return this.name+": "+h(this)}},{key:"inspect",value:function(){return Object.assign(new Error(this.message),this)}},{key:"addError",value:function(t,e){this.errors[t]=e,this.message=this._message+": "+h(this)}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(r.prototype,e),r}(l);function h(t){for(var e,n=Object.keys(t.errors||{}),r=n.length,i=[],s=0;s<r;++s)t!==t.errors[e=n[s]]&&i.push(e+": "+t.errors[e].message);return i.join(", ")}c.inspect.custom&&(u.prototype[c.inspect.custom]=u.prototype.inspect),Object.defineProperty(u.prototype,"toJSON",{enumerable:!1,writable:!1,configurable:!0,value:function(){return Object.assign({},this,{name:this.name,message:this.message})}}),Object.defineProperty(u.prototype,"name",{value:"ValidationError"}),t.exports=u},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t,r,i){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(s=e.call(this,r=r||"Field `"+t+"` is not in schema and strict mode is set to throw.")).isImmutableError=!!i,s.path=t,s}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"StrictModeError"}),t.exports=a},function(t,e,n){"use strict";e.schemaMixedSymbol=Symbol.for("mongoose:schema_mixed"),e.builtInMiddleware=Symbol.for("mongoose:built-in-middleware")},function(t,e,n){"use strict";var r=n(79);function i(t){return r.cast()(t)}e.castToNumber=i,e.castArraysOfNumbers=function t(e,n){e.forEach(function(r,s){Array.isArray(r)?t(r,n):e[s]=i.call(n,r)})}},function(t,e,n){"use strict";var r=n(81);t.exports=function(t,e){if(null==t)return null;for(var n=0,i=Object.keys(t);n<i.length;n++){var s=t[i[n]];if(s.schema&&s.schema.discriminatorMapping&&r(s.schema.discriminatorMapping.value,e))return s}return null}},function(t,e,n){"use strict";e.Array=n(84),e.Buffer=n(87),e.Document=e.Embedded=n(27),e.DocumentArray=n(18),e.Decimal128=n(20),e.ObjectId=n(7),e.Map=n(89),e.Subdocument=n(91)},function(t,e,n){"use strict";var r=n(59),i=n(24),s=n(39),o=n(40),a=n(41),l=n(42),c=n(43),u=n(60),h=n(44),d=n(45),f=n(46),p=n(47),m=n(48),g=n(28),y=n(104),_=n(105),v=n(107),b=n(16),w=b.allocBuffer(17825792),x=function(){};x.prototype.serialize=function(t,e){var n="boolean"==typeof(e=e||{}).checkKeys&&e.checkKeys,r="boolean"==typeof e.serializeFunctions&&e.serializeFunctions,i="boolean"!=typeof e.ignoreUndefined||e.ignoreUndefined,s="number"==typeof e.minInternalBufferSize?e.minInternalBufferSize:17825792;w.length<s&&(w=b.allocBuffer(s));var o=_(w,t,n,0,0,r,i,[]),a=b.allocBuffer(o);return w.copy(a,0,0,a.length),a},x.prototype.serializeWithBufferAndIndex=function(t,e,n){var r="boolean"==typeof(n=n||{}).checkKeys&&n.checkKeys;return _(e,t,r,("number"==typeof n.index?n.index:0)||0,0,"boolean"==typeof n.serializeFunctions&&n.serializeFunctions,"boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined)-1},x.prototype.deserialize=function(t,e){return y(t,e)},x.prototype.calculateObjectSize=function(t,e){var n="boolean"==typeof(e=e||{}).serializeFunctions&&e.serializeFunctions;return v(t,n,"boolean"!=typeof e.ignoreUndefined||e.ignoreUndefined)},x.prototype.deserializeStream=function(t,e,n,r,i,s){s=null!=s?s:{};for(var o=e,a=0;a<n;a++){var l=t[o]|t[o+1]<<8|t[o+2]<<16|t[o+3]<<24;s.index=o,r[i+a]=this.deserialize(t,s),o+=l}return o},x.BSON_INT32_MAX=2147483647,x.BSON_INT32_MIN=-2147483648,x.BSON_INT64_MAX=Math.pow(2,63)-1,x.BSON_INT64_MIN=-Math.pow(2,63),x.JS_INT_MAX=9007199254740992,x.JS_INT_MIN=-9007199254740992,x.BSON_DATA_NUMBER=1,x.BSON_DATA_STRING=2,x.BSON_DATA_OBJECT=3,x.BSON_DATA_ARRAY=4,x.BSON_DATA_BINARY=5,x.BSON_DATA_OID=7,x.BSON_DATA_BOOLEAN=8,x.BSON_DATA_DATE=9,x.BSON_DATA_NULL=10,x.BSON_DATA_REGEXP=11,x.BSON_DATA_CODE=13,x.BSON_DATA_SYMBOL=14,x.BSON_DATA_CODE_W_SCOPE=15,x.BSON_DATA_INT=16,x.BSON_DATA_TIMESTAMP=17,x.BSON_DATA_LONG=18,x.BSON_DATA_MIN_KEY=255,x.BSON_DATA_MAX_KEY=127,x.BSON_BINARY_SUBTYPE_DEFAULT=0,x.BSON_BINARY_SUBTYPE_FUNCTION=1,x.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,x.BSON_BINARY_SUBTYPE_UUID=3,x.BSON_BINARY_SUBTYPE_MD5=4,x.BSON_BINARY_SUBTYPE_USER_DEFINED=128,t.exports=x,t.exports.Code=h,t.exports.Map=r,t.exports.Symbol=c,t.exports.BSON=x,t.exports.DBRef=m,t.exports.Binary=g,t.exports.ObjectID=a,t.exports.Long=i,t.exports.Timestamp=o,t.exports.Double=s,t.exports.Int32=u,t.exports.MinKey=f,t.exports.MaxKey=p,t.exports.BSONRegExp=l,t.exports.Decimal128=d},function(t,e){function n(t){if(!(this instanceof n))return new n(t);this._bsontype="Double",this.value=t}n.prototype.valueOf=function(){return this.value},n.prototype.toJSON=function(){return this.value},t.exports=n,t.exports.Double=n},function(t,e){function n(t,e){if(!(this instanceof n))return new n(t,e);this._bsontype="Timestamp",this.low_=0|t,this.high_=0|e}n.prototype.toInt=function(){return this.low_},n.prototype.toNumber=function(){return this.high_*n.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},n.prototype.toJSON=function(){return this.toString()},n.prototype.toString=function(t){var e=t||10;if(e<2||36<e)throw Error("radix out of range: "+e);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(n.MIN_VALUE)){var r=n.fromNumber(e),i=this.div(r),s=i.multiply(r).subtract(this);return i.toString(e)+s.toInt().toString(e)}return"-"+this.negate().toString(e)}var o=n.fromNumber(Math.pow(e,6));s=this;for(var a="";!s.isZero();){var l=s.div(o),c=s.subtract(l.multiply(o)).toInt().toString(e);if((s=l).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},n.prototype.getHighBits=function(){return this.high_},n.prototype.getLowBits=function(){return this.low_},n.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:n.TWO_PWR_32_DBL_+this.low_},n.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(n.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!==this.high_?this.high_:this.low_,e=31;e>0&&0==(t&1<<e);e--);return 0!==this.high_?e+33:e+1},n.prototype.isZero=function(){return 0===this.high_&&0===this.low_},n.prototype.isNegative=function(){return this.high_<0},n.prototype.isOdd=function(){return 1==(1&this.low_)},n.prototype.equals=function(t){return this.high_===t.high_&&this.low_===t.low_},n.prototype.notEquals=function(t){return this.high_!==t.high_||this.low_!==t.low_},n.prototype.lessThan=function(t){return this.compare(t)<0},n.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},n.prototype.greaterThan=function(t){return this.compare(t)>0},n.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},n.prototype.compare=function(t){if(this.equals(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.subtract(t).isNegative()?-1:1},n.prototype.negate=function(){return this.equals(n.MIN_VALUE)?n.MIN_VALUE:this.not().add(n.ONE)},n.prototype.add=function(t){var e=0,r=0,i=0,s=0;return i+=(s+=(65535&this.low_)+(65535&t.low_))>>>16,r+=(i+=(this.low_>>>16)+(t.low_>>>16))>>>16,e+=(r+=(65535&this.high_)+(65535&t.high_))>>>16,e+=(this.high_>>>16)+(t.high_>>>16),n.fromBits((i&=65535)<<16|(s&=65535),(e&=65535)<<16|(r&=65535))},n.prototype.subtract=function(t){return this.add(t.negate())},n.prototype.multiply=function(t){if(this.isZero())return n.ZERO;if(t.isZero())return n.ZERO;if(this.equals(n.MIN_VALUE))return t.isOdd()?n.MIN_VALUE:n.ZERO;if(t.equals(n.MIN_VALUE))return this.isOdd()?n.MIN_VALUE:n.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(n.TWO_PWR_24_)&&t.lessThan(n.TWO_PWR_24_))return n.fromNumber(this.toNumber()*t.toNumber());var e=65535&this.high_,r=this.low_>>>16,i=65535&this.low_,s=65535&t.high_,o=t.low_>>>16,a=65535&t.low_,l=0,c=0,u=0,h=0;return u+=(h+=i*a)>>>16,c+=(u+=r*a)>>>16,u&=65535,c+=(u+=i*o)>>>16,l+=(c+=e*a)>>>16,c&=65535,l+=(c+=r*o)>>>16,c&=65535,l+=(c+=i*s)>>>16,l+=(this.high_>>>16)*a+e*o+r*s+i*(t.high_>>>16),n.fromBits((u&=65535)<<16|(h&=65535),(l&=65535)<<16|(c&=65535))},n.prototype.div=function(t){if(t.isZero())throw Error("division by zero");if(this.isZero())return n.ZERO;if(this.equals(n.MIN_VALUE)){if(t.equals(n.ONE)||t.equals(n.NEG_ONE))return n.MIN_VALUE;if(t.equals(n.MIN_VALUE))return n.ONE;var e=this.shiftRight(1).div(t).shiftLeft(1);if(e.equals(n.ZERO))return t.isNegative()?n.ONE:n.NEG_ONE;var r=this.subtract(t.multiply(e));return e.add(r.div(t))}if(t.equals(n.MIN_VALUE))return n.ZERO;if(this.isNegative())return t.isNegative()?this.negate().div(t.negate()):this.negate().div(t).negate();if(t.isNegative())return this.div(t.negate()).negate();var i=n.ZERO;for(r=this;r.greaterThanOrEqual(t);){e=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(e)/Math.LN2),o=s<=48?1:Math.pow(2,s-48),a=n.fromNumber(e),l=a.multiply(t);l.isNegative()||l.greaterThan(r);)l=(a=n.fromNumber(e-=o)).multiply(t);a.isZero()&&(a=n.ONE),i=i.add(a),r=r.subtract(l)}return i},n.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},n.prototype.not=function(){return n.fromBits(~this.low_,~this.high_)},n.prototype.and=function(t){return n.fromBits(this.low_&t.low_,this.high_&t.high_)},n.prototype.or=function(t){return n.fromBits(this.low_|t.low_,this.high_|t.high_)},n.prototype.xor=function(t){return n.fromBits(this.low_^t.low_,this.high_^t.high_)},n.prototype.shiftLeft=function(t){if(0==(t&=63))return this;var e=this.low_;return t<32?n.fromBits(e<<t,this.high_<<t|e>>>32-t):n.fromBits(0,e<<t-32)},n.prototype.shiftRight=function(t){if(0==(t&=63))return this;var e=this.high_;return t<32?n.fromBits(this.low_>>>t|e<<32-t,e>>t):n.fromBits(e>>t-32,e>=0?0:-1)},n.prototype.shiftRightUnsigned=function(t){if(0==(t&=63))return this;var e=this.high_;return t<32?n.fromBits(this.low_>>>t|e<<32-t,e>>>t):n.fromBits(32===t?e:e>>>t-32,0)},n.fromInt=function(t){if(-128<=t&&t<128){var e=n.INT_CACHE_[t];if(e)return e}var r=new n(0|t,t<0?-1:0);return-128<=t&&t<128&&(n.INT_CACHE_[t]=r),r},n.fromNumber=function(t){return isNaN(t)||!isFinite(t)?n.ZERO:t<=-n.TWO_PWR_63_DBL_?n.MIN_VALUE:t+1>=n.TWO_PWR_63_DBL_?n.MAX_VALUE:t<0?n.fromNumber(-t).negate():new n(t%n.TWO_PWR_32_DBL_|0,t/n.TWO_PWR_32_DBL_|0)},n.fromBits=function(t,e){return new n(t,e)},n.fromString=function(t,e){if(0===t.length)throw Error("number format error: empty string");var r=e||10;if(r<2||36<r)throw Error("radix out of range: "+r);if("-"===t.charAt(0))return n.fromString(t.substring(1),r).negate();if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+t);for(var i=n.fromNumber(Math.pow(r,8)),s=n.ZERO,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),r);if(a<8){var c=n.fromNumber(Math.pow(r,a));s=s.multiply(c).add(n.fromNumber(l))}else s=(s=s.multiply(i)).add(n.fromNumber(l))}return s},n.INT_CACHE_={},n.TWO_PWR_16_DBL_=65536,n.TWO_PWR_24_DBL_=1<<24,n.TWO_PWR_31_DBL_=(n.TWO_PWR_32_DBL_=n.TWO_PWR_16_DBL_*n.TWO_PWR_16_DBL_)/2,n.TWO_PWR_48_DBL_=n.TWO_PWR_32_DBL_*n.TWO_PWR_16_DBL_,n.TWO_PWR_63_DBL_=(n.TWO_PWR_64_DBL_=n.TWO_PWR_32_DBL_*n.TWO_PWR_32_DBL_)/2,n.ZERO=n.fromInt(0),n.ONE=n.fromInt(1),n.NEG_ONE=n.fromInt(-1),n.MAX_VALUE=n.fromBits(-1,2147483647),n.MIN_VALUE=n.fromBits(0,-2147483648),n.TWO_PWR_24_=n.fromInt(1<<24),t.exports=n,t.exports.Timestamp=n},function(t,e,n){(function(e,r){var i="inspect",s=n(16),o=parseInt(16777215*Math.random(),10),a=new RegExp("^[0-9a-fA-F]{24}$");try{if(e&&e.from){var l=!0;i=n(4).inspect.custom||"inspect"}}catch(t){l=!1}for(var c=function t(e){if(e instanceof t)return e;if(!(this instanceof t))return new t(e);if(this._bsontype="ObjectID",null==e||"number"==typeof e)return this.id=this.generate(e),void(t.cacheHexString&&(this.__id=this.toString("hex")));var n=t.isValid(e);if(!n&&null!=e)throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(n&&"string"==typeof e&&24===e.length&&l)return new t(s.toBuffer(e,"hex"));if(n&&"string"==typeof e&&24===e.length)return t.createFromHexString(e);if(null==e||12!==e.length){if(null!=e&&"function"==typeof e.toHexString)return e;throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}this.id=e,t.cacheHexString&&(this.__id=this.toString("hex"))},u=[],h=0;h<256;h++)u[h]=(h<=15?"0":"")+h.toString(16);c.prototype.toHexString=function(){if(c.cacheHexString&&this.__id)return this.__id;var t="";if(!this.id||!this.id.length)throw new Error("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]");if(this.id instanceof f)return t=p(this.id),c.cacheHexString&&(this.__id=t),t;for(var e=0;e<this.id.length;e++)t+=u[this.id.charCodeAt(e)];return c.cacheHexString&&(this.__id=t),t},c.prototype.get_inc=function(){return c.index=(c.index+1)%16777215},c.prototype.getInc=function(){return this.get_inc()},c.prototype.generate=function(t){"number"!=typeof t&&(t=~~(Date.now()/1e3));var e=(void 0===r||1===r.pid?Math.floor(1e5*Math.random()):r.pid)%65535,n=this.get_inc(),i=s.allocBuffer(12);return i[3]=255&t,i[2]=t>>8&255,i[1]=t>>16&255,i[0]=t>>24&255,i[6]=255&o,i[5]=o>>8&255,i[4]=o>>16&255,i[8]=255&e,i[7]=e>>8&255,i[11]=255&n,i[10]=n>>8&255,i[9]=n>>16&255,i},c.prototype[i]=c.prototype.toString=function(t){return this.id&&this.id.copy?this.id.toString("string"==typeof t?t:"hex"):this.toHexString()},c.prototype.toJSON=function(){return this.toHexString()},c.prototype.equals=function(t){return t instanceof c?this.toString()===t.toString():"string"==typeof t&&c.isValid(t)&&12===t.length&&this.id instanceof f?t===this.id.toString("binary"):"string"==typeof t&&c.isValid(t)&&24===t.length?t.toLowerCase()===this.toHexString():"string"==typeof t&&c.isValid(t)&&12===t.length?t===this.id:!(null==t||!(t instanceof c||t.toHexString))&&t.toHexString()===this.toHexString()},c.prototype.getTimestamp=function(){var t=new Date;return t.setTime(1e3*Math.floor(this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24)),t},c.index=~~(16777215*Math.random()),c.createPk=function(){return new c},c.createFromTime=function(t){var e=s.toBuffer([0,0,0,0,0,0,0,0,0,0,0,0]);return e[3]=255&t,e[2]=t>>8&255,e[1]=t>>16&255,e[0]=t>>24&255,new c(e)};var d=[];for(h=0;h<10;)d[48+h]=h++;for(;h<16;)d[55+h]=d[87+h]=h++;var f=e,p=function(t){return t.toString("hex")};c.createFromHexString=function(t){if(void 0===t||null!=t&&24!==t.length)throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(l)return new c(s.toBuffer(t,"hex"));for(var e=new f(12),n=0,r=0;r<24;)e[n++]=d[t.charCodeAt(r++)]<<4|d[t.charCodeAt(r++)];return new c(e)},c.isValid=function(t){return null!=t&&("number"==typeof t||("string"==typeof t?12===t.length||24===t.length&&a.test(t):t instanceof c||t instanceof f||"function"==typeof t.toHexString&&(t.id instanceof f||"string"==typeof t.id)&&(12===t.id.length||24===t.id.length&&a.test(t.id))))},Object.defineProperty(c.prototype,"generationTime",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(t){this.id[3]=255&t,this.id[2]=t>>8&255,this.id[1]=t>>16&255,this.id[0]=t>>24&255}}),t.exports=c,t.exports.ObjectID=c,t.exports.ObjectId=c}).call(this,n(2).Buffer,n(11))},function(t,e){function n(t,e){if(!(this instanceof n))return new n;this._bsontype="BSONRegExp",this.pattern=t||"",this.options=e||"";for(var r=0;r<this.options.length;r++)if("i"!==this.options[r]&&"m"!==this.options[r]&&"x"!==this.options[r]&&"l"!==this.options[r]&&"s"!==this.options[r]&&"u"!==this.options[r])throw new Error("the regular expression options ["+this.options[r]+"] is not supported")}t.exports=n,t.exports.BSONRegExp=n},function(t,e,n){(function(e){var r=e&&n(4).inspect.custom||"inspect";function i(t){if(!(this instanceof i))return new i(t);this._bsontype="Symbol",this.value=t}i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return this.value},i.prototype[r]=function(){return this.value},i.prototype.toJSON=function(){return this.value},t.exports=i,t.exports.Symbol=i}).call(this,n(2).Buffer)},function(t,e){var n=function t(e,n){if(!(this instanceof t))return new t(e,n);this._bsontype="Code",this.code=e,this.scope=n};n.prototype.toJSON=function(){return{scope:this.scope,code:this.code}},t.exports=n,t.exports.Code=n},function(t,e,n){"use strict";var r=n(24),i=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,s=/^(\+|-)?(Infinity|inf)$/i,o=/^(\+|-)?NaN$/i,a=6176,l=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),c=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),u=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),h=/^([-+])?(\d+)?$/,d=n(16),f=function(t){return!isNaN(parseInt(t,10))},p=function(t){var e=r.fromNumber(1e9),n=r.fromNumber(0),i=0;if(!(t.parts[0]||t.parts[1]||t.parts[2]||t.parts[3]))return{quotient:t,rem:n};for(i=0;i<=3;i++)n=(n=n.shiftLeft(32)).add(new r(t.parts[i],0)),t.parts[i]=n.div(e).low_,n=n.modulo(e);return{quotient:t,rem:n}},m=function(t){this._bsontype="Decimal128",this.bytes=t};m.fromString=function(t){var e,n=!1,p=!1,g=!1,y=0,_=0,v=0,b=0,w=0,x=[0],S=0,E=0,A=0,T=0,C=0,M=0,O=[0,0],P=[0,0],D=0;if((t=t.trim()).length>=7e3)throw new Error(t+" not a valid Decimal128 string");var R=t.match(i),L=t.match(s),I=t.match(o);if(!R&&!L&&!I||0===t.length)throw new Error(t+" not a valid Decimal128 string");if(R&&R[4]&&void 0===R[2])throw new Error(t+" not a valid Decimal128 string");if("+"!==t[D]&&"-"!==t[D]||(n="-"===t[D++]),!f(t[D])&&"."!==t[D]){if("i"===t[D]||"I"===t[D])return new m(d.toBuffer(n?c:u));if("N"===t[D])return new m(d.toBuffer(l))}for(;f(t[D])||"."===t[D];)if("."!==t[D])S<34&&("0"!==t[D]||g)&&(g||(w=_),g=!0,x[E++]=parseInt(t[D],10),S+=1),g&&(v+=1),p&&(b+=1),_+=1,D+=1;else{if(p)return new m(d.toBuffer(l));p=!0,D+=1}if(p&&!_)throw new Error(t+" not a valid Decimal128 string");if("e"===t[D]||"E"===t[D]){var N=t.substr(++D).match(h);if(!N||!N[2])return new m(d.toBuffer(l));C=parseInt(N[0],10),D+=N[0].length}if(t[D])return new m(d.toBuffer(l));if(A=0,S){if(T=S-1,y=v,0!==C&&1!==y)for(;"0"===t[w+y-1];)y-=1}else A=0,T=0,x[0]=0,v=1,S=1,y=0;for(C<=b&&b-C>16384?C=-6176:C-=b;C>6111;){if((T+=1)-A>34){var k=x.join("");if(k.match(/^0+$/)){C=6111;break}return new m(d.toBuffer(n?c:u))}C-=1}for(;C<-6176||S<v;){if(0===T){C=-6176,y=0;break}if(S<v?v-=1:T-=1,!(C<6111)){if((k=x.join("")).match(/^0+$/)){C=6111;break}return new m(d.toBuffer(n?c:u))}C+=1}if(T-A+1<y&&"0"!==t[y]){var F=_;p&&-6176===C&&(w+=1,F+=1);var B=parseInt(t[w+T+1],10),j=0;if(B>=5&&(j=1,5===B))for(j=x[T]%2==1,M=w+T+2;M<F;M++)if(parseInt(t[M],10)){j=1;break}if(j)for(var U=T;U>=0&&++x[U]>9;U--)if(x[U]=0,0===U){if(!(C<6111))return new m(d.toBuffer(n?c:u));C+=1,x[U]=1}}if(O=r.fromNumber(0),P=r.fromNumber(0),0===y)O=r.fromNumber(0),P=r.fromNumber(0);else if(T-A<17)for(U=A,P=r.fromNumber(x[U++]),O=new r(0,0);U<=T;U++)P=(P=P.multiply(r.fromNumber(10))).add(r.fromNumber(x[U]));else{for(U=A,O=r.fromNumber(x[U++]);U<=T-17;U++)O=(O=O.multiply(r.fromNumber(10))).add(r.fromNumber(x[U]));for(P=r.fromNumber(x[U++]);U<=T;U++)P=(P=P.multiply(r.fromNumber(10))).add(r.fromNumber(x[U]))}var V,z,$,H,G=function(t,e){if(!t&&!e)return{high:r.fromNumber(0),low:r.fromNumber(0)};var n=t.shiftRightUnsigned(32),i=new r(t.getLowBits(),0),s=e.shiftRightUnsigned(32),o=new r(e.getLowBits(),0),a=n.multiply(s),l=n.multiply(o),c=i.multiply(s),u=i.multiply(o);return a=a.add(l.shiftRightUnsigned(32)),l=new r(l.getLowBits(),0).add(c).add(u.shiftRightUnsigned(32)),{high:a=a.add(l.shiftRightUnsigned(32)),low:u=l.shiftLeft(32).add(new r(u.getLowBits(),0))}}(O,r.fromString("100000000000000000"));G.low=G.low.add(P),(($=(V=G.low).high_>>>0)<(H=(z=P).high_>>>0)||$===H&&V.low_>>>0<z.low_>>>0)&&(G.high=G.high.add(r.fromNumber(1))),e=C+a;var W={low:r.fromNumber(0),high:r.fromNumber(0)};G.high.shiftRightUnsigned(49).and(r.fromNumber(1)).equals(r.fromNumber)?(W.high=W.high.or(r.fromNumber(3).shiftLeft(61)),W.high=W.high.or(r.fromNumber(e).and(r.fromNumber(16383).shiftLeft(47))),W.high=W.high.or(G.high.and(r.fromNumber(0x7fffffffffff)))):(W.high=W.high.or(r.fromNumber(16383&e).shiftLeft(49)),W.high=W.high.or(G.high.and(r.fromNumber(562949953421311)))),W.low=G.low,n&&(W.high=W.high.or(r.fromString("9223372036854775808")));var q=d.allocBuffer(16);return D=0,q[D++]=255&W.low.low_,q[D++]=W.low.low_>>8&255,q[D++]=W.low.low_>>16&255,q[D++]=W.low.low_>>24&255,q[D++]=255&W.low.high_,q[D++]=W.low.high_>>8&255,q[D++]=W.low.high_>>16&255,q[D++]=W.low.high_>>24&255,q[D++]=255&W.high.low_,q[D++]=W.high.low_>>8&255,q[D++]=W.high.low_>>16&255,q[D++]=W.high.low_>>24&255,q[D++]=255&W.high.high_,q[D++]=W.high.high_>>8&255,q[D++]=W.high.high_>>16&255,q[D++]=W.high.high_>>24&255,new m(q)},a=6176,m.prototype.toString=function(){for(var t,e,n,i,s,o,l=0,c=new Array(36),u=0;u<c.length;u++)c[u]=0;var h,d,f,m,g,y=0,_=!1,v={parts:new Array(4)},b=[];y=0;var w=this.bytes;if(i=w[y++]|w[y++]<<8|w[y++]<<16|w[y++]<<24,n=w[y++]|w[y++]<<8|w[y++]<<16|w[y++]<<24,e=w[y++]|w[y++]<<8|w[y++]<<16|w[y++]<<24,t=w[y++]|w[y++]<<8|w[y++]<<16|w[y++]<<24,y=0,(new r(i,n),new r(e,t)).lessThan(r.ZERO)&&b.push("-"),(s=t>>26&31)>>3==3){if(30===s)return b.join("")+"Infinity";if(31===s)return"NaN";o=t>>15&16383,f=8+(t>>14&1)}else f=t>>14&7,o=t>>17&16383;if(h=o-a,v.parts[0]=(16383&t)+((15&f)<<14),v.parts[1]=e,v.parts[2]=n,v.parts[3]=i,0===v.parts[0]&&0===v.parts[1]&&0===v.parts[2]&&0===v.parts[3])_=!0;else for(g=3;g>=0;g--){var x=0,S=p(v);if(v=S.quotient,x=S.rem.low_)for(m=8;m>=0;m--)c[9*g+m]=x%10,x=Math.floor(x/10)}if(_)l=1,c[y]=0;else for(l=36,u=0;!c[y];)u++,l-=1,y+=1;if((d=l-1+h)>=34||d<=-7||h>0){for(b.push(c[y++]),(l-=1)&&b.push("."),u=0;u<l;u++)b.push(c[y++]);b.push("E"),b.push(d>0?"+"+d:d)}else if(h>=0)for(u=0;u<l;u++)b.push(c[y++]);else{var E=l+h;if(E>0)for(u=0;u<E;u++)b.push(c[y++]);else b.push("0");for(b.push(".");E++<0;)b.push("0");for(u=0;u<l-Math.max(E-1,0);u++)b.push(c[y++])}return b.join("")},m.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},t.exports=m,t.exports.Decimal128=m},function(t,e){function n(){if(!(this instanceof n))return new n;this._bsontype="MinKey"}t.exports=n,t.exports.MinKey=n},function(t,e){function n(){if(!(this instanceof n))return new n;this._bsontype="MaxKey"}t.exports=n,t.exports.MaxKey=n},function(t,e){function n(t,e,r){if(!(this instanceof n))return new n(t,e,r);this._bsontype="DBRef",this.namespace=t,this.oid=e,this.db=r}n.prototype.toJSON=function(){return{$ref:this.namespace,$id:this.oid,$db:null==this.db?"":this.db}},t.exports=n,t.exports.DBRef=n},function(t,e,n){"use strict";t.exports=n(114)},function(t,e,n){"use strict";t.exports=new Set(["__proto__","constructor","prototype"])},function(t,e,n){"use strict";var r=n(52);t.exports=function(t){return r(t,null!=this?this.path:null)}},function(t,e,n){"use strict";var r=n(13);t.exports=function(e,n){if(t.exports.convertToTrue.has(e))return!0;if(t.exports.convertToFalse.has(e))return!1;if(null==e)return e;throw new r("boolean",e,n)},t.exports.convertToTrue=new Set([!0,"true",1,"1","yes"]),t.exports.convertToFalse=new Set([!1,"false",0,"0","no"])},function(t,e,n){"use strict";(function(r){function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw s}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l,c=n(19).EventEmitter,u=n(139),h=n(14),d=n(6),f=n(8),p=n(140),m=n(54),g=n(75),y=n(0).arrayParentSymbol,_=n(3),v=n(141),b=n(71),w=n(49),x=n(15).get().ReadPreference,S=n(142),E=n(4),A=n(1),T=n(146),C=n(147).middlewareFunctions,M=n(77).middlewareFunctions,O=C.concat(M).reduce(function(t,e){return t.add(e)},new Set),P=0;function D(t,e){if(!(this instanceof D))return new D(t,e);if(this.obj=t,this.paths={},this.aliases={},this.subpaths={},this.virtuals={},this.singleNestedPaths={},this.nested={},this.inherits={},this.callQueue=[],this._indexes=[],this.methods={},this.methodOptions={},this.statics={},this.tree={},this.query={},this.childSchemas=[],this.plugins=[],this.$id=++P,this.mapPaths=[],this.s={hooks:new u},this.options=this.defaultOptions(e),Array.isArray(t)){var n,r=o(t);try{for(r.s();!(n=r.n()).done;)this.add(n.value)}catch(t){r.e(t)}finally{r.f()}}else t&&this.add(t);var i=t&&t._id&&A.isObject(t._id);!this.paths._id&&!this.options.noId&&this.options._id&&!i&&g(this),this.setupTimestamp(this.options.timestamps)}(D.prototype=Object.create(c.prototype)).constructor=D,D.prototype.instanceOfSchema=!0,Object.defineProperty(D.prototype,"$schemaType",{configurable:!1,enumerable:!1,writable:!0}),Object.defineProperty(D.prototype,"childSchemas",{configurable:!1,enumerable:!0,writable:!0}),D.prototype.clone=function(){var t=this,e=new(null==this.base?D:this.base.Schema)({},this._userProvidedOptions);return e.base=this.base,e.obj=this.obj,e.options=A.clone(this.options),e.callQueue=this.callQueue.map(function(t){return t}),e.methods=A.clone(this.methods),e.methodOptions=A.clone(this.methodOptions),e.statics=A.clone(this.statics),e.query=A.clone(this.query),e.plugins=Array.prototype.slice.call(this.plugins),e._indexes=A.clone(this._indexes),e.s.hooks=this.s.hooks.clone(),e.tree=A.clone(this.tree),e.paths=A.clone(this.paths),e.nested=A.clone(this.nested),e.subpaths=A.clone(this.subpaths),e.singleNestedPaths=A.clone(this.singleNestedPaths),e.childSchemas=function(t){for(var e=[],n=0,r=Object.keys(t.paths);n<r.length;n++){var i=t.paths[r[n]];(i.$isMongooseDocumentArray||i.$isSingleNested)&&e.push({schema:i.schema,model:i.caster})}return e}(e),e.virtuals=A.clone(this.virtuals),e.$globalPluginsApplied=this.$globalPluginsApplied,e.$isRootDiscriminator=this.$isRootDiscriminator,e.$implicitlyCreated=this.$implicitlyCreated,e.mapPaths=[].concat(this.mapPaths),null!=this.discriminatorMapping&&(e.discriminatorMapping=Object.assign({},this.discriminatorMapping)),null!=this.discriminators&&(e.discriminators=Object.assign({},this.discriminators)),e.aliases=Object.assign({},this.aliases),e.on("init",function(e){return t.emit("init",e)}),e},D.prototype.pick=function(t,e){var n=new D({},e||this.options);if(!Array.isArray(t))throw new h('Schema#pick() only accepts an array argument, got "'+s(t)+'"');var r,a=o(t);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(this.nested[l])n.add(i({},l,_(this.tree,l)));else{var c=this.path(l);if(null==c)throw new h("Path `"+l+"` is not in the schema");n.add(i({},l,c))}}}catch(t){a.e(t)}finally{a.f()}return n},D.prototype.defaultOptions=function(t){t&&!1===t.safe&&(t.safe={w:0}),t&&t.safe&&0===t.safe.w&&(t.versionKey=!1),this._userProvidedOptions=null==t?{}:A.clone(t);var e=_(this,"base.options",{});if((t=A.options({strict:!("strict"in e)||e.strict,strictQuery:"strictQuery"in e&&e.strictQuery,bufferCommands:!0,capped:!1,versionKey:"__v",optimisticConcurrency:!1,discriminatorKey:"__t",minimize:!0,autoIndex:null,shardKey:null,read:null,validateBeforeSave:!0,noId:!1,_id:!0,noVirtualId:!1,id:!0,typeKey:"type",typePojoToMixed:!("typePojoToMixed"in e)||e.typePojoToMixed},A.clone(t))).read&&(t.read=x(t.read)),t.optimisticConcurrency&&!t.versionKey)throw new h("Must set `versionKey` if using `optimisticConcurrency`");return t},D.prototype.add=function(t,e){if(t instanceof D||null!=t&&t.instanceOfSchema)return b(this,t),this;if(!1===t._id&&null==e&&(this.options._id=!1),"__proto__."===(e=e||"")||"constructor."===e||"prototype."===e)return this;for(var n=0,r=Object.keys(t);n<r.length;n++){var s=r[n],a=e+s;if(null==t[s])throw new TypeError("Invalid value for schema path `"+a+'`, got value "'+t[s]+'"');if("_id"!==s||!1!==t[s])if(t[s]instanceof m||"VirtualType"===_(t[s],"constructor.name",null))this.virtual(t[s]);else{if(Array.isArray(t[s])&&1===t[s].length&&null==t[s][0])throw new TypeError("Invalid value for schema Array path `"+a+'`, got value "'+t[s][0]+'"');if(A.isPOJO(t[s])||t[s]instanceof f)if(Object.keys(t[s]).length<1)e&&(this.nested[e.substr(0,e.length-1)]=!0),this.path(a,t[s]);else if(!t[s][this.options.typeKey]||"type"===this.options.typeKey&&t[s].type.type)this.nested[a]=!0,this.add(t[s],a+".");else if(!this.options.typePojoToMixed&&A.isPOJO(t[s][this.options.typeKey])){e&&(this.nested[e.substr(0,e.length-1)]=!0);var l=new D(t[s][this.options.typeKey],{typePojoToMixed:!1}),c=Object.assign({},t[s],i({},this.options.typeKey,l));this.path(e+s,c)}else e&&(this.nested[e.substr(0,e.length-1)]=!0),this.path(e+s,t[s]);else e&&(this.nested[e.substr(0,e.length-1)]=!0),this.path(e+s,t[s])}}return function(t,e){var n,r=o(e=e||Object.keys(t.paths));try{for(r.s();!(n=r.n()).done;){var i=n.value,s=_(t.paths[i],"options");if(null!=s){var a=t.paths[i].path,l=s.alias;if(l){if("string"!=typeof l)throw new Error("Invalid value for alias option on "+a+", got "+l);t.aliases[l]=a,t.virtual(l).get(function(t){return function(){return"function"==typeof this.get?this.get(t):this[t]}}(a)).set(function(t){return function(e){return this.$set(t,e)}}(a))}}}}catch(t){r.e(t)}finally{r.f()}}(this,Object.keys(t).map(function(t){return e?e+t:t})),this},D.reserved=Object.create(null),D.prototype.reserved=D.reserved;var R=D.reserved;function L(t){return/\.\d+/.test(t)?t.replace(/\.\d+\./g,".$.").replace(/\.\d+$/,".$"):t}function I(t,e){if(0===t.mapPaths.length)return null;var n,r=o(t.mapPaths);try{for(r.s();!(n=r.n()).done;){var i=n.value.path;if(new RegExp("^"+i.replace(/\.\$\*/g,"\\.[^.]+")+"$").test(e))return t.paths[i]}}catch(t){r.e(t)}finally{r.f()}return null}function N(t,e){var n=e.split(/\.(\d+)\.|\.(\d+)$/).filter(Boolean);if(n.length<2)return t.paths.hasOwnProperty(n[0])?t.paths[n[0]]:"adhocOrUndefined";var r=t.path(n[0]),i=!1;if(!r)return"adhocOrUndefined";for(var s=n.length-1,o=1;o<n.length;++o){i=!1;var a=n[o];if(o===s&&r&&!/\D/.test(a)){r=r.$isMongooseDocumentArray?r.$embeddedSchemaType:r instanceof l.Array?r.caster:void 0;break}if(/\D/.test(a)){if(!r||!r.schema){r=void 0;break}i="nested"===r.schema.pathType(a),r=r.schema.path(a)}else r instanceof l.Array&&o!==s&&(r=r.caster)}return t.subpaths[e]=r,r?"real":i?"nested":"adhocOrUndefined"}R.prototype=R.emit=R.listeners=R.on=R.removeListener=R.collection=R.errors=R.get=R.init=R.isModified=R.isNew=R.populated=R.remove=R.save=R.toObject=R.validate=1,D.prototype.path=function(t,e){var n=L(t);if(void 0===e){var r=function(t,e,n){return t.paths.hasOwnProperty(e)?t.paths[e]:t.subpaths.hasOwnProperty(n)?t.subpaths[n]:t.singleNestedPaths.hasOwnProperty(n)&&"object"===s(t.singleNestedPaths[n])?t.singleNestedPaths[n]:null}(this,t,n);if(null!=r)return r;var i=I(this,t);return null!=i?i:null!=(r=this.hasMixedParent(n))?r:/\.\d+\.?.*$/.test(t)?function(t,e){return N(t,e),t.subpaths[e]}(this,t):void 0}var a=t.split(".")[0];if(R[a])throw new Error("`"+a+"` may not be used as a schema pathname");"object"===s(e)&&A.hasUserDefinedProperty(e,"ref")&&T(e.ref,t);var l,c=t.split(/\./),u=c.pop(),h=this.tree,f="",p=o(c);try{for(p.s();!(l=p.n()).done;){var m=l.value;if(f=f+=(f.length>0?".":"")+m,h[m]||(this.nested[f]=!0,h[m]={}),"object"!==s(h[m]))throw new Error("Cannot set nested path `"+t+"`. Parent path `"+f+"` already set to type "+h[m].name+".");h=h[m]}}catch(t){p.e(t)}finally{p.f()}h[u]=A.clone(e),this.paths[t]=this.interpretAsType(t,e,this.options);var g=this.paths[t];if(g.$isSchemaMap){var y=t+".$*",_={type:{}};A.hasUserDefinedProperty(e,"of")&&(_=A.isPOJO(e.of)&&Object.keys(e.of).length>0&&!A.hasUserDefinedProperty(e.of,this.options.typeKey)?new D(e.of):e.of),A.hasUserDefinedProperty(e,"ref")&&(_={type:_,ref:e.ref}),this.paths[y]=this.interpretAsType(y,_,this.options),this.mapPaths.push(this.paths[y]),g.$__schemaType=this.paths[y]}if(g.$isSingleNested){for(var v=0,b=Object.keys(g.schema.paths);v<b.length;v++){var w=b[v];this.singleNestedPaths[t+"."+w]=g.schema.paths[w]}for(var x=0,S=Object.keys(g.schema.singleNestedPaths);x<S.length;x++){var E=S[x];this.singleNestedPaths[t+"."+E]=g.schema.singleNestedPaths[E]}for(var C=0,M=Object.keys(g.schema.subpaths);C<M.length;C++){var O=M[C];this.singleNestedPaths[t+"."+O]=g.schema.subpaths[O]}for(var P=0,k=Object.keys(g.schema.nested);P<k.length;P++)this.singleNestedPaths[t+"."+k[P]]="nested";Object.defineProperty(g.schema,"base",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),g.caster.base=this.base,this.childSchemas.push({schema:g.schema,model:g.caster})}else g.$isMongooseDocumentArray&&(Object.defineProperty(g.schema,"base",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),g.casterConstructor.base=this.base,this.childSchemas.push({schema:g.schema,model:g.casterConstructor}));if(g.$isMongooseArray&&g.caster instanceof d){for(var F=t,B=g,j=[];B.$isMongooseArray;)F+=".$",B.$isMongooseDocumentArray?(B.$embeddedSchemaType._arrayPath=F,B.$embeddedSchemaType._arrayParentPath=t,B=B.$embeddedSchemaType.clone()):(B.caster._arrayPath=F,B.caster._arrayParentPath=t,B=B.caster.clone()),B.path=F,j.push(B);for(var U=0,V=j;U<V.length;U++){var z=V[U];this.subpaths[z.path]=z}}if(g.$isMongooseDocumentArray){for(var $=0,H=Object.keys(g.schema.paths);$<H.length;$++){var G=H[$],W=g.schema.paths[G];this.subpaths[t+"."+G]=W,"object"===s(W)&&null!=W&&(W.$isUnderneathDocArray=!0)}for(var q=0,Z=Object.keys(g.schema.subpaths);q<Z.length;q++){var Y=Z[q],J=g.schema.subpaths[Y];this.subpaths[t+"."+Y]=J,"object"===s(J)&&null!=J&&(J.$isUnderneathDocArray=!0)}for(var K=0,X=Object.keys(g.schema.singleNestedPaths);K<X.length;K++){var Q=X[K],tt=g.schema.singleNestedPaths[Q];this.subpaths[t+"."+Q]=tt,"object"===s(tt)&&null!=tt&&(tt.$isUnderneathDocArray=!0)}}return this},Object.defineProperty(D.prototype,"base",{configurable:!0,enumerable:!1,writable:!0,value:null}),D.prototype.interpretAsType=function(t,e,n){if(e instanceof d){if(e.path===t)return e;var i=e.clone();return i.path=t,i}var o=null!=this.base?this.base.Schema.Types:D.Types;if(!(A.isPOJO(e)||e instanceof f)&&"Object"!==A.getFunctionName(e.constructor)){var a=e;(e={})[n.typeKey]=a}var l,c=!e[n.typeKey]||"type"===n.typeKey&&e.type.type?{}:e[n.typeKey];if(A.isPOJO(c)||"mixed"===c)return new o.Mixed(t,e);if(Array.isArray(c)||c===Array||"array"===c||c===o.Array){var u=c===Array||"array"===c?e.cast||e.of:c[0];if(u&&u.instanceOfSchema)return new o.DocumentArray(t,u,e);if(u&&u[n.typeKey]&&u[n.typeKey].instanceOfSchema)return new o.DocumentArray(t,u[n.typeKey],e,u);if(Array.isArray(u))return new o.Array(t,this.interpretAsType(t,u,n),e);if("string"==typeof u)u=o[u.charAt(0).toUpperCase()+u.substring(1)];else if(u&&(!u[n.typeKey]||"type"===n.typeKey&&u.type.type)&&A.isPOJO(u)){if(Object.keys(u).length){var h={minimize:n.minimize};n.typeKey&&(h.typeKey=n.typeKey),n.hasOwnProperty("strict")&&(h.strict=n.strict),n.hasOwnProperty("typePojoToMixed")&&(h.typePojoToMixed=n.typePojoToMixed),this._userProvidedOptions.hasOwnProperty("_id")?h._id=this._userProvidedOptions._id:D.Types.DocumentArray.defaultOptions&&null!=D.Types.DocumentArray.defaultOptions._id&&(h._id=D.Types.DocumentArray.defaultOptions._id);var p=new D(u,h);return p.$implicitlyCreated=!0,new o.DocumentArray(t,p,e)}return new o.Array(t,o.Mixed,e)}if(u&&("ClockDate"===(l="string"==typeof(c=!u[n.typeKey]||"type"===n.typeKey&&u.type.type?u:u[n.typeKey])?c:c.schemaName||A.getFunctionName(c))&&(l="Date"),!o.hasOwnProperty(l)))throw new TypeError("Invalid schema configuration: "+"`".concat(l,"` is not a valid type within the array `").concat(t,"`.")+"See http://bit.ly/mongoose-schematypes for a list of valid schema types.");return new o.Array(t,u||o.Mixed,e,n)}if(c&&c.instanceOfSchema)return new o.Embedded(c,t,e);if((l=r.isBuffer(c)?"Buffer":"function"==typeof c||"object"===s(c)?c.schemaName||A.getFunctionName(c):null==c?""+c:c.toString())&&(l=l.charAt(0).toUpperCase()+l.substring(1)),"ObjectID"===l&&(l="ObjectId"),"ClockDate"===l&&(l="Date"),null==o[l])throw new TypeError("Invalid schema configuration: `".concat(l,"` is not ")+"a valid type at path `".concat(t,"`. See ")+"http://bit.ly/mongoose-schematypes for a list of valid schema types.");return new o[l](t,e)},D.prototype.eachPath=function(t){for(var e=Object.keys(this.paths),n=e.length,r=0;r<n;++r)t(e[r],this.paths[e[r]]);return this},D.prototype.requiredPaths=function(t){if(this._requiredpaths&&!t)return this._requiredpaths;for(var e=Object.keys(this.paths),n=e.length,r=[];n--;){var i=e[n];this.paths[i].isRequired&&r.push(i)}return this._requiredpaths=r,this._requiredpaths},D.prototype.indexedPaths=function(){return this._indexedpaths||(this._indexedpaths=this.indexes()),this._indexedpaths},D.prototype.pathType=function(t){var e=L(t);if(this.paths.hasOwnProperty(t))return"real";if(this.virtuals.hasOwnProperty(t))return"virtual";if(this.nested.hasOwnProperty(t))return"nested";if(this.subpaths.hasOwnProperty(e)||this.subpaths.hasOwnProperty(t))return"real";var n=this.singleNestedPaths.hasOwnProperty(e)||this.singleNestedPaths.hasOwnProperty(t);return n?"nested"===n?"nested":"real":null!=I(this,t)?"real":/\.\d+\.|\.\d+$/.test(t)?N(this,t):"adhocOrUndefined"},D.prototype.hasMixedParent=function(t){var e=t.split(/\./g);t="";for(var n=0;n<e.length;++n)if(this.paths.hasOwnProperty(t=n>0?t+"."+e[n]:e[n])&&this.paths[t]instanceof l.Mixed)return this.paths[t];return null},D.prototype.setupTimestamp=function(t){return S(this,t)},D.prototype.queue=function(t,e){return this.callQueue.push([t,e]),this},D.prototype.pre=function(t){if(t instanceof RegExp){var e,n=Array.prototype.slice.call(arguments,1),r=o(O);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.test(i)&&this.pre.apply(this,[i].concat(n))}}catch(t){r.e(t)}finally{r.f()}return this}if(Array.isArray(t)){var s,a=Array.prototype.slice.call(arguments,1),l=o(t);try{for(l.s();!(s=l.n()).done;){var c=s.value;this.pre.apply(this,[c].concat(a))}}catch(t){l.e(t)}finally{l.f()}return this}return this.s.hooks.pre.apply(this.s.hooks,arguments),this},D.prototype.post=function(t){if(t instanceof RegExp){var e,n=Array.prototype.slice.call(arguments,1),r=o(O);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.test(i)&&this.post.apply(this,[i].concat(n))}}catch(t){r.e(t)}finally{r.f()}return this}if(Array.isArray(t)){var s,a=Array.prototype.slice.call(arguments,1),l=o(t);try{for(l.s();!(s=l.n()).done;){var c=s.value;this.post.apply(this,[c].concat(a))}}catch(t){l.e(t)}finally{l.f()}return this}return this.s.hooks.post.apply(this.s.hooks,arguments),this},D.prototype.plugin=function(t,e){if("function"!=typeof t)throw new Error('First param to `schema.plugin()` must be a function, got "'+s(t)+'"');if(e&&e.deduplicate){var n,r=o(this.plugins);try{for(r.s();!(n=r.n()).done;)if(n.value.fn===t)return this}catch(t){r.e(t)}finally{r.f()}}return this.plugins.push({fn:t,opts:e}),t(this,e),this},D.prototype.method=function(t,e,n){if("string"!=typeof t)for(var r in t)this.methods[r]=t[r],this.methodOptions[r]=A.clone(n);else this.methods[t]=e,this.methodOptions[t]=A.clone(n);return this},D.prototype.static=function(t,e){if("string"!=typeof t)for(var n in t)this.statics[n]=t[n];else this.statics[t]=e;return this},D.prototype.index=function(t,e){return t||(t={}),e||(e={}),e.expires&&A.expires(e),this._indexes.push([t,e]),this},D.prototype.set=function(t,e,n){if(1===arguments.length)return this.options[t];switch(t){case"read":this.options[t]=x(e,n),this._userProvidedOptions[t]=this.options[t];break;case"safe":k(this.options,e),this._userProvidedOptions[t]=this.options[t];break;case"timestamps":this.setupTimestamp(e),this.options[t]=e,this._userProvidedOptions[t]=this.options[t];break;case"_id":this.options[t]=e,this._userProvidedOptions[t]=this.options[t],e&&!this.paths._id?g(this):!e&&null!=this.paths._id&&this.paths._id.auto&&this.remove("_id");break;default:this.options[t]=e,this._userProvidedOptions[t]=this.options[t]}return this};var k=E.deprecate(function(t,e){t.safe=!1===e?{w:0}:e},"Mongoose: The `safe` option for schemas is deprecated. Use the `writeConcern` option instead: http://bit.ly/mongoose-write-concern");D.prototype.get=function(t){return this.options[t]};var F="2d 2dsphere hashed text".split(" ");function B(t,e){var n,r=e.split("."),i=r.pop(),s=t.tree,a=o(r);try{for(a.s();!(n=a.n()).done;)s=s[n.value]}catch(t){a.e(t)}finally{a.f()}delete s[i]}function j(t){return t.startsWith("$[")&&t.endsWith("]")}Object.defineProperty(D,"indexTypes",{get:function(){return F},set:function(){throw new Error("Cannot overwrite Schema.indexTypes")}}),D.prototype.indexes=function(){return v(this)},D.prototype.virtual=function(t,e){var n=this;if(t instanceof m||null!=t&&"VirtualType"===t.constructor.name)return this.virtual(t.path,t.options);if(e=new p(e),A.hasUserDefinedProperty(e,["ref","refPath"])){if(null==e.localField)throw new Error("Reference virtuals require `localField` option");if(null==e.foreignField)throw new Error("Reference virtuals require `foreignField` option");this.pre("init",function(n){if(w.has(t,n)){var r=w.get(t,n);this.$$populatedVirtuals||(this.$$populatedVirtuals={}),this.$$populatedVirtuals[t]=e.justOne||e.count?Array.isArray(r)?r[0]:r:Array.isArray(r)?r:null==r?[]:[r],w.unset(t,n)}});var r=this.virtual(t);return r.options=e,r.set(function(n){this.$$populatedVirtuals||(this.$$populatedVirtuals={}),e.justOne||e.count?(this.$$populatedVirtuals[t]=Array.isArray(n)?n[0]:n,"object"!==s(this.$$populatedVirtuals[t])&&(this.$$populatedVirtuals[t]=e.count?n:null)):(this.$$populatedVirtuals[t]=Array.isArray(n)?n:null==n?[]:[n],this.$$populatedVirtuals[t]=this.$$populatedVirtuals[t].filter(function(t){return t&&"object"===s(t)}))}),"function"==typeof e.get&&r.get(e.get),r}var i=this.virtuals,o=t.split(".");if("real"===this.pathType(t))throw new Error('Virtual path "'+t+'" conflicts with a real path in the schema');i[t]=o.reduce(function(n,r,i){return n[r]||(n[r]=i===o.length-1?new m(e,t):{}),n[r]},this.tree);for(var a=o[0],l=0;l<o.length-1&&(null==this.paths[a]||!this.paths[a].$isMongooseDocumentArray||"break"!==function(){var t=o.slice(l+1).join(".");return n.paths[a].schema.virtual(t).get(function(e,n,r){return r.__parentArray[y].get(a+"."+r.__index+"."+t)}),"break"}());++l)a+="."+o[l+1];return i[t]},D.prototype.virtualpath=function(t){return this.virtuals.hasOwnProperty(t)?this.virtuals[t]:null},D.prototype.remove=function(t){return"string"==typeof t&&(t=[t]),Array.isArray(t)&&t.forEach(function(t){if(null!=this.path(t)||this.nested[t]){if(this.nested[t]){var e,n=o(Object.keys(this.paths).concat(Object.keys(this.nested)));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.startsWith(t+".")&&(delete this.paths[r],delete this.nested[r],B(this,r))}}catch(t){n.e(t)}finally{n.f()}return delete this.nested[t],void B(this,t)}delete this.paths[t],B(this,t)}},this),this},D.prototype.loadClass=function(t,e){return t===Object.prototype||t===Function.prototype||t.prototype.hasOwnProperty("$isMongooseModelPrototype")||(this.loadClass(Object.getPrototypeOf(t),e),e||Object.getOwnPropertyNames(t).forEach(function(e){if(!e.match(/^(length|name|prototype|constructor|__proto__)$/)){var n=Object.getOwnPropertyDescriptor(t,e);this.static(e,n.value)}},this),Object.getOwnPropertyNames(t.prototype).forEach(function(n){if(!n.match(/^(constructor)$/)){var r=Object.getOwnPropertyDescriptor(t.prototype,n);e||"function"==typeof r.value&&this.method(n,r.value),"function"==typeof r.get&&(this.virtuals[n]&&(this.virtuals[n].getters=[]),this.virtual(n).get(r.get)),"function"==typeof r.set&&(this.virtuals[n]&&(this.virtuals[n].setters=[]),this.virtual(n).set(r.set))}},this)),this},D.prototype._getSchema=function(t){var e=this.path(t),n=[];if(e)return e.$fullPath=t,e;for(var r=t.split("."),i=0;i<r.length;++i)("$"===r[i]||j(r[i]))&&(r[i]="0");return function t(e,r){for(var i,s,o=e.length+1;o--;)if(s=e.slice(0,o).join("."),i=r.path(s)){if(n.push(s),i.caster){if(i.caster instanceof l.Mixed)return i.caster.$fullPath=n.join("."),i.caster;if(o!==e.length&&i.schema){var a=void 0;return"$"===e[o]||j(e[o])?o+1===e.length?i:((a=t(e.slice(o+1),i.schema))&&(a.$isUnderneathDocArray=a.$isUnderneathDocArray||!i.schema.$isSingleNested),a):((a=t(e.slice(o),i.schema))&&(a.$isUnderneathDocArray=a.$isUnderneathDocArray||!i.schema.$isSingleNested),a)}}else if(i.$isSchemaMap)return o+1>=e.length?i.$__schemaType:t(e.slice(o+1),i.$__schemaType.schema);return i.$fullPath=n.join("."),i}}(r,this)},D.prototype._getPathType=function(t){return this.path(t)?"real":function t(e,n){for(var r,i,s=e.length+1;s--;){if(i=e.slice(0,s).join("."),r=n.path(i))return r.caster?r.caster instanceof l.Mixed?{schema:r,pathType:"mixed"}:s!==e.length&&r.schema?"$"===e[s]||j(e[s])?s===e.length-1?{schema:r,pathType:"nested"}:t(e.slice(s+1),r.schema):t(e.slice(s),r.schema):{schema:r,pathType:r.$isSingleNested?"nested":"array"}:{schema:r,pathType:"real"};if(s===e.length&&n.nested[i])return{schema:n,pathType:"nested"}}return{schema:r||n,pathType:"undefined"}}(t.split("."),this)},t.exports=e=D,D.Types=l=n(55),e.ObjectId=l.ObjectId}).call(this,n(2).Buffer)},function(t,e,n){"use strict";var r=n(1);function i(t,e){this.path=e,this.getters=[],this.setters=[],this.options=Object.assign({},t)}i.prototype._applyDefaultGetters=function(){if(!(this.getters.length>0||this.setters.length>0)){var t="$"+this.path;this.getters.push(function(){return this[t]}),this.setters.push(function(e){this[t]=e})}},i.prototype.clone=function(){var t=new i(this.options,this.path);return t.getters=[].concat(this.getters),t.setters=[].concat(this.setters),t},i.prototype.get=function(t){return this.getters.push(t),this},i.prototype.set=function(t){return this.setters.push(t),this},i.prototype.applyGetters=function(t,e){r.hasUserDefinedProperty(this.options,["ref","refPath"])&&e.$$populatedVirtuals&&e.$$populatedVirtuals.hasOwnProperty(this.path)&&(t=e.$$populatedVirtuals[this.path]);for(var n=t,i=this.getters.length-1;i>=0;i--)n=this.getters[i].call(e,n,this,e);return n},i.prototype.applySetters=function(t,e){for(var n=t,r=this.setters.length-1;r>=0;r--)n=this.setters[r].call(e,n,this,e);return n},t.exports=i},function(t,e,n){"use strict";e.String=n(148),e.Number=n(79),e.Boolean=n(152),e.DocumentArray=n(153),e.Embedded=n(160),e.Array=n(56),e.Buffer=n(162),e.Date=n(164),e.ObjectId=n(167),e.Mixed=n(26),e.Decimal128=e.Decimal=n(169),e.Map=n(171),e.Oid=e.ObjectId,e.Object=e.Mixed,e.Bool=e.Boolean,e.ObjectID=e.ObjectId},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s,o,a=n(51),l=n(73),c=n(14),u=n(154),h=n(6),d=h.CastError,f=n(26),p=n(155),m=n(156),g=n(3),y=n(82),_=n(4),v=n(1),b=n(35).castToNumber,w=n(83),x=n(36),S=Symbol("mongoose#isNestedArray"),E=Object.freeze({});function A(t,e,r,i){o||(o=n(37).Embedded);var s,a,l="type";if(i&&i.typeKey&&(l=i.typeKey),this.schemaOptions=i,e){var c={};v.isPOJO(e)&&(e[l]?(delete(c=v.clone(e))[l],e=e[l]):e=f),null!=r&&null!=r.ref&&null==c.ref&&(c.ref=r.ref),e===Object&&(e=f);var u="string"==typeof e?e:v.getFunctionName(e),d=n(55),p=d.hasOwnProperty(u)?d[u]:e;this.casterConstructor=p,this.casterConstructor instanceof A&&(this.casterConstructor[S]=!0),"function"!=typeof p||p.$isArraySubdocument||p.$isSchemaMap?(this.caster=p,this.caster instanceof o||(this.caster.path=t)):this.caster=new p(this.caster instanceof o?null:t,c),this.$embeddedSchemaType=this.caster}if(this.$isMongooseArray=!0,h.call(this,t,r,"Array"),null!=this.defaultValue&&(a="function"==typeof(s=this.defaultValue)),!("defaultValue"in this)||void 0!==this.defaultValue){var m=function(){var t=[];return a?t=s.call(this):null!=s&&(t=t.concat(s)),t};m.$runBeforeSetters=!a,this.default(m)}}A.schemaName="Array",A.options={castNonArrays:!0},A.defaultOptions={},A.set=h.set,(A.prototype=Object.create(h.prototype)).constructor=A,A.prototype.OptionsConstructor=u,A._checkRequired=h.prototype.checkRequired,A.checkRequired=h.checkRequired,A.prototype.checkRequired=function(t,e){return h._isRef(this,t,e,!0)?!!t:("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():A.checkRequired())(t)},A.prototype.enum=function(){for(var t=this;;){var e=g(t,"caster.instance");if("Array"!==e){if("String"!==e&&"Number"!==e)throw new Error("`enum` can only be set on an array of strings or numbers , not "+e);break}t=t.caster}var n=arguments;return!Array.isArray(arguments)&&v.isObject(arguments)&&(n=v.object.vals(n)),t.caster.enum.apply(t.caster,n),this},A.prototype.applyGetters=function(t,e){if(null!=e&&null!=e.$__&&e.populated(this.path))return t;var n=h.prototype.applyGetters.call(this,t,e);if(Array.isArray(n))for(var r=n.length,i=0;i<r;++i)n[i]=this.caster.applyGetters(n[i],e);return n},A.prototype._applySetters=function(t,e,n,r){if(this.casterConstructor.$isMongooseArray&&A.options.castNonArrays&&!this[S]){for(var i=0,s=this;null!=s&&s.$isMongooseArray&&!s.$isMongooseDocumentArray;)++i,s=s.casterConstructor;if(null!=t&&t.length>0){var o=p(t);if(o.min===o.max&&o.max<i&&o.containsNonArrayItem)for(var a=o.max;a<i;++a)t=[t]}}return h.prototype._applySetters.call(this,t,e,n,r)},A.prototype.cast=function(t,e,r,i,o){var a,l;if(s||(s=n(37).Array),Array.isArray(t)){var u=t.length;if(!u&&e){var h=e.schema.indexedPaths(),p=this.path;for(a=0,l=h.length;a<l;++a){var m=h[a][0][p];if("2dsphere"===m||"2d"===m)return}var g=this.path.endsWith(".coordinates")?this.path.substr(0,this.path.lastIndexOf(".")):null;if(null!=g)for(a=0,l=h.length;a<l;++a)if("2dsphere"===h[a][0][g])return}if(t=s(t,(o=o||E).path||this._arrayPath||this.path,e,this),r&&null!=e&&null!=e.$__&&e.populated(this.path))return t;var y=this.caster,v=y.$isMongooseArray,b="Number"===y.instance;if(y&&this.casterConstructor!==f)try{for(a=0;a<u;a++){if(b&&void 0===t[a])throw new c("Mongoose number arrays disallow storing undefined");var w={};v&&(null!=o.arrayPath||null!=y._arrayParentPath)&&(w.arrayPathIndex=a),t[a]=y.applySetters(t[a],e,r,void 0,w)}}catch(e){throw new d("["+e.kind+"]",_.inspect(t),this.path+"."+a,e,this)}return t}if(r||A.options.castNonArrays)return e&&r&&e.markModified(this.path),this.cast([t],e,r);throw new d("Array",_.inspect(t),this.path,null,this)},A.prototype._castForPopulate=function(t,e){if(s||(s=n(37).Array),Array.isArray(t)){var r,i=t.length,o=this.caster;if(o&&this.casterConstructor!==f)try{for(r=0;r<i;r++){var a={};o.$isMongooseArray&&null!=o._arrayParentPath&&(a.arrayPathIndex=r),t[r]=o.cast(t[r],e,!1,void 0,a)}}catch(e){throw new d("["+e.kind+"]",_.inspect(t),this.path+"."+r,e,this)}return t}throw new d("Array",_.inspect(t),this.path,null,this)},A.prototype.discriminator=function(t,e){for(var n=this;n.$isMongooseArray&&!n.$isMongooseDocumentArray;)if(null==(n=n.casterConstructor)||"function"==typeof n)throw new c("You can only add an embedded discriminator on a document array, "+this.path+" is a plain array");return n.discriminator(t,e)},A.prototype.clone=function(){var t=Object.assign({},this.options),e=new this.constructor(this.path,this.caster,t,this.schemaOptions);return e.validators=this.validators.slice(),void 0!==this.requiredValidator&&(e.requiredValidator=this.requiredValidator),e},A.prototype.castForQuery=function(t,e){var n,r,i=this;if(2===arguments.length){if(!(n=this.$conditionalHandlers[t]))throw new Error("Can't use "+t+" with Array.");r=n.call(this,e)}else{var s=this.casterConstructor;if((r=t)&&s.discriminators&&s.schema&&s.schema.options&&s.schema.options.discriminatorKey)if("string"==typeof r[s.schema.options.discriminatorKey]&&s.discriminators[r[s.schema.options.discriminatorKey]])s=s.discriminators[r[s.schema.options.discriminatorKey]];else{var o=x(s.discriminators,r[s.schema.options.discriminatorKey]);o&&(s=o)}var a=this.casterConstructor.prototype,l=a&&(a.castForQuery||a.cast);!l&&s.castForQuery&&(l=s.castForQuery);var c=this.caster;Array.isArray(r)?(this.setters.reverse().forEach(function(t){r=t.call(i,r,i)}),r=r.map(function(t){return v.isObject(t)&&t.$elemMatch?t:l?t=l.call(c,t):null!=t?t=new s(t):t})):l?r=l.call(c,r):null!=r&&(r=new s(r))}return r};var T=A.prototype.$conditionalHandlers={};function C(t){return function(e){if(!Array.isArray(e))throw new TypeError("conditional "+t+" requires an array");var n,i=[],s=r(e);try{for(s.s();!(n=s.n()).done;)i.push(m(this.casterConstructor.schema,n.value))}catch(t){s.e(t)}finally{s.f()}return i}}T.$all=function(t){return Array.isArray(t)||(t=[t]),t=t.map(function(t){if(v.isObject(t)){var e={};return e[this.path]=t,m(this.casterConstructor.schema,e)[this.path]}return t},this),this.castForQuery(t)},T.$options=String,T.$elemMatch=function(t){for(var e=Object.keys(t),n=e.length,r=0;r<n;++r){var i=e[r],s=t[i];y(i)&&null!=s&&(t[i]=this.castForQuery(i,s))}var o=g(this,"casterConstructor.schema.options.discriminatorKey"),a=g(this,"casterConstructor.schema.discriminators",{});return m(null!=o&&null!=t[o]&&null!=a[t[o]]?a[t[o]]:this.casterConstructor.schema,t)},T.$geoIntersects=w.cast$geoIntersects,T.$or=C("$or"),T.$and=C("$and"),T.$nor=C("$nor"),T.$near=T.$nearSphere=w.cast$near,T.$within=T.$geoWithin=w.cast$within,T.$size=T.$minDistance=T.$maxDistance=b,T.$exists=a,T.$type=l,T.$eq=T.$gt=T.$gte=T.$lt=T.$lte=T.$ne=T.$regex=A.prototype.castForQuery,T.$nin=h.prototype.$conditionalHandlers.$nin,T.$in=h.prototype.$conditionalHandlers.$in,t.exports=A},function(t,e,n){"use strict";var r,i=n(0).documentSchemaSymbol,s=n(3),o=n(17).internalToObjectOptions,a=n(1),l=n(0).getSymbol,c=n(0).scopeSymbol;function u(t,e,i,s){r=r||n(12);for(var o,l,c=Object.keys(t),u=c.length,d=0;d<u;++d)o=t[l=c[d]],h(l,a.isPOJO(o)&&Object.keys(o).length&&(!o[s.typeKey]||"type"===s.typeKey&&o.type.type)?o:null,e,i,0,s)}function h(t,e,h,d,f,p){r=r||n(12);var m=(d?d+".":"")+t;d=d||"",Object.defineProperty(h,t,e?{enumerable:!0,configurable:!0,get:function(){var t,n,o=this;if(this.$__.getters||(this.$__.getters={}),!this.$__.getters[m]){var l=Object.create(r.prototype,(t=this,n={},Object.getOwnPropertyNames(t).forEach(function(e){n[e]=Object.getOwnPropertyDescriptor(t,e),n[e].get?delete n[e]:n[e].enumerable=-1===["isNew","$__","errors","_doc","$locals","$op","__parentArray","__index","$isDocumentArrayElement"].indexOf(e)}),n));d||(l.$__[c]=this),l.$__.nestedPath=m,Object.defineProperty(l,"schema",{enumerable:!1,configurable:!0,writable:!1,value:h.schema}),Object.defineProperty(l,"$__schema",{enumerable:!1,configurable:!0,writable:!1,value:h.schema}),Object.defineProperty(l,i,{enumerable:!1,configurable:!0,writable:!1,value:h.schema}),Object.defineProperty(l,"toObject",{enumerable:!1,configurable:!0,writable:!1,value:function(){return a.clone(o.get(m,null,{virtuals:s(this,"schema.options.toObject.virtuals",null)}))}}),Object.defineProperty(l,"$__get",{enumerable:!1,configurable:!0,writable:!1,value:function(){return o.get(m,null,{virtuals:s(this,"schema.options.toObject.virtuals",null)})}}),Object.defineProperty(l,"toJSON",{enumerable:!1,configurable:!0,writable:!1,value:function(){return o.get(m,null,{virtuals:s(o,"schema.options.toJSON.virtuals",null)})}}),Object.defineProperty(l,"$__isNested",{enumerable:!1,configurable:!0,writable:!1,value:!0});var f=Object.freeze({minimize:!0,virtuals:!1,getters:!1,transform:!1});Object.defineProperty(l,"$isEmpty",{enumerable:!1,configurable:!0,writable:!1,value:function(){return 0===Object.keys(this.get(m,null,f)||{}).length}}),Object.defineProperty(l,"$__parent",{enumerable:!1,configurable:!0,writable:!1,value:this}),u(e,l,m,p),this.$__.getters[m]=l}return this.$__.getters[m]},set:function(t){null!=t&&t.$__isNested?t=t.$__get():t instanceof r&&!t.$__isNested&&(t=t.toObject(o)),(this.$__[c]||this).$set(m,t)}}:{enumerable:!0,configurable:!0,get:function(){return this[l].call(this.$__[c]||this,m)},set:function(t){this.$set.call(this.$__[c]||this,m,t)}})}e.compile=u,e.defineKey=h},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return null==t||"object"!==r(t)||!("$meta"in t)&&!("$slice"in t)}},function(t,e,n){"use strict";(function(e){if(void 0!==e.Map)t.exports=e.Map,t.exports.Map=e.Map;else{var n=function(t){this._keys=[],this._values={};for(var e=0;e<t.length;e++)if(null!=t[e]){var n=t[e],r=n[0],i=n[1];this._keys.push(r),this._values[r]={v:i,i:this._keys.length-1}}};n.prototype.clear=function(){this._keys=[],this._values={}},n.prototype.delete=function(t){var e=this._values[t];return null!=e&&(delete this._values[t],this._keys.splice(e.i,1),!0)},n.prototype.entries=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?[n,t._values[n].v]:void 0,done:void 0===n}}}},n.prototype.forEach=function(t,e){e=e||this;for(var n=0;n<this._keys.length;n++){var r=this._keys[n];t.call(e,this._values[r].v,r,e)}},n.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},n.prototype.has=function(t){return null!=this._values[t]},n.prototype.keys=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?n:void 0,done:void 0===n}}}},n.prototype.set=function(t,e){return this._values[t]?(this._values[t].v=e,this):(this._keys.push(t),this._values[t]={v:e,i:this._keys.length-1},this)},n.prototype.values=function(){var t=this,e=0;return{next:function(){var n=t._keys[e++];return{value:void 0!==n?t._values[n].v:void 0,done:void 0===n}}}},Object.defineProperty(n.prototype,"size",{enumerable:!0,get:function(){return this._keys.length}}),t.exports=n,t.exports.Map=n}}).call(this,n(10))},function(t,e){var n=function t(e){if(!(this instanceof t))return new t(e);this._bsontype="Int32",this.value=e};n.prototype.valueOf=function(){return this.value},n.prototype.toJSON=function(){return this.value},t.exports=n,t.exports.Int32=n},function(t,e,n){"use strict";var r=n(12),i=n(180),s=!1;t.exports=function(){return s?i:r},t.exports.setBrowser=function(t){s=t}},function(t,e){t.exports=function(t,e,n){var r=[],i=t.length;if(0===i)return r;var s=e<0?Math.max(0,e+i):e||0;for(void 0!==n&&(i=n<0?n+i:n);i-- >s;)r[i-s]=t[i];return r}},function(t,e,n){var r=n(2),i=r.Buffer;function s(t,e){for(var n in t)e[n]=t[n]}function o(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},o.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=Object.prototype.toString;t.exports=function(t){if("object"!=n(e=t)||"[object RegExp]"!=r.call(e))throw new TypeError("Not a RegExp");var e,i=[];t.global&&i.push("g"),t.multiline&&i.push("m"),t.ignoreCase&&i.push("i"),t.dotAll&&i.push("s"),t.unicode&&i.push("u"),t.sticky&&i.push("y");var s=new RegExp(t.source,i.join(""));return"number"==typeof t.lastIndex&&(s.lastIndex=t.lastIndex),s}},function(t,e,n){"use strict";t.exports=function(t){return t.name?t.name:(t.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1]}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e){return r(t,"_bsontype",void 0)===e}},function(t,e,n){"use strict";(function(e){var r=n(23),i=n(118),s={_promise:null,get:function(){return s._promise},set:function(t){r.ok("function"==typeof t,"mongoose.Promise must be a function, got ".concat(t)),s._promise=t,i.Promise=t}};s.set(e.Promise),t.exports=s}).call(this,n(10))},function(t,e,n){"use strict";(function(t,r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=n(120).Buffer,o=n(64),a=["__proto__","constructor","prototype"],l=e.clone=function t(n,r){if(null==n)return n;if(Array.isArray(n))return e.cloneArray(n,r);if(n.constructor){if(/ObjectI[dD]$/.test(n.constructor.name))return"function"==typeof n.clone?n.clone():new n.constructor(n.id);if("ReadPreference"===n.constructor.name)return new n.constructor(n.mode,t(n.tags,r));if("Binary"==n._bsontype&&n.buffer&&n.value)return"function"==typeof n.clone?n.clone():new n.constructor(n.value(!0),n.sub_type);if("Date"===n.constructor.name||"Function"===n.constructor.name)return new n.constructor(+n);if("RegExp"===n.constructor.name)return o(n);if("Buffer"===n.constructor.name)return e.cloneBuffer(n)}return u(n)?e.cloneObject(n,r):n.valueOf?n.valueOf():void 0};e.cloneObject=function(t,e){for(var n,r,i=e&&e.minimize,s={},o=0,c=Object.keys(t);o<c.length;o++){var u=c[o];-1===a.indexOf(u)&&(r=l(t[u],e),i&&void 0===r||(n||(n=!0),s[u]=r))}return i?n&&s:s},e.cloneArray=function(t,e){for(var n=[],r=0,i=t.length;r<i;r++)n.push(l(t[r],e));return n},e.tick=function(t){if("function"==typeof t)return function(){var e=arguments;h(function(){t.apply(this,e)})}},e.merge=function t(n,r){for(var i,s=Object.keys(r),o=s.length;o--;)-1===a.indexOf(i=s[o])&&(void 0===n[i]?n[i]=r[i]:e.isObject(r[i])?t(n[i],r[i]):n[i]=r[i])},e.mergeClone=function t(n,r){for(var i,s=Object.keys(r),o=s.length;o--;)-1===a.indexOf(i=s[o])&&(void 0===n[i]?n[i]=l(r[i]):e.isObject(r[i])?t(n[i],r[i]):n[i]=l(r[i]))},e.readPref=function(t){switch(t){case"p":t="primary";break;case"pp":t="primaryPreferred";break;case"s":t="secondary";break;case"sp":t="secondaryPreferred";break;case"n":t="nearest"}return t},e.readConcern=function(t){if("string"==typeof t){switch(t){case"l":t="local";break;case"a":t="available";break;case"m":t="majority";break;case"lz":t="linearizable";break;case"s":t="snapshot"}t={level:t}}return t};var c=Object.prototype.toString;e.toString=function(t){return c.call(t)};var u=e.isObject=function(t){return"[object Object]"==e.toString(t)};e.isArray=function(t){return Array.isArray(t)||"object"==i(t)&&"[object Array]"==e.toString(t)},e.keys=Object.keys,e.create="function"==typeof Object.create?Object.create:function(t){if(arguments.length>1)throw new Error("Adding properties is not supported");function e(){}return e.prototype=t,new e},e.inherits=function(t,n){t.prototype=e.create(n.prototype),t.prototype.constructor=t};var h=e.soon="function"==typeof t?t:r.nextTick;e.cloneBuffer=function(t){var e=s.alloc(t.length);return t.copy(e,0,0,t.length),e},e.isArgumentsObject=function(t){return"[object Arguments]"===Object.prototype.toString.call(t)}}).call(this,n(69).setImmediate,n(11))},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(119),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(10))},function(t,e,n){"use strict";(function(t,n,r,i){function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.isNode=void 0!==t&&"object"==s(n)&&"object"==(void 0===r?"undefined":s(r))&&"function"==typeof i&&t.argv,e.isMongo=!e.isNode&&"function"==typeof printjson&&"function"==typeof ObjectId&&"function"==typeof rs&&"function"==typeof sh,e.isBrowser=!e.isNode&&!e.isMongo&&"undefined"!=typeof window,e.type=e.isNode?"node":e.isMongo?"mongo":e.isBrowser?"browser":"unknown"}).call(this,n(11),n(125)(t),n(10),n(2).Buffer)},function(t,e,n){"use strict";t.exports=function(t,e,n){for(var r={},i=0,s=Object.keys(e.tree);i<s.length;i++){var o=s[i];n&&(t.paths[o]||t.nested[o]||t.singleNestedPaths[o])||(r[o]=e.tree[o])}for(var a in t.add(r),t.callQueue=t.callQueue.concat(e.callQueue),t.method(e.methods),t.static(e.statics),e.query)t.query[a]=e.query[a];for(var l in e.virtuals)t.virtuals[l]=e.virtuals[l].clone();t.s.hooks.merge(e.s.hooks,!1)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=n(5),c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(r,t);var e,n=s(r);function r(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var i=t.message;i||(i=l.messages.general.default);var s=u(i,t);return e=n.call(this,s),t=Object.assign({},t,{message:s}),e.properties=t,e.kind=t.type,e.path=t.path,e.value=t.value,e.reason=t.reason,e}return(e=[{key:"toString",value:function(){return this.message}},{key:"toJSON",value:function(){return Object.assign({name:this.name,message:this.message},this)}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(r.prototype,e),r}(l);function u(t,e){if("function"==typeof t)return t(e);for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];"message"!==i&&(t=t.replace("{"+i.toUpperCase()+"}",e[i]))}return t}Object.defineProperty(c.prototype,"name",{value:"ValidatorError"}),Object.defineProperty(c.prototype,"properties",{enumerable:!1,writable:!0,value:null}),c.prototype.formatMessage=u,t.exports=c},function(t,e,n){"use strict";t.exports=function(t){if(Array.isArray(t)){if(!t.every(function(t){return"number"==typeof t||"string"==typeof t}))throw new Error("$type array values must be strings or numbers");return t}if("number"!=typeof t&&"string"!=typeof t)throw new Error("$type parameter must be number, string, or array of numbers and strings");return t}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t,r){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var s=Array.isArray(r)?"array":"primitive value";return(i=e.call(this,"Tried to set nested object field `"+t+"` to ".concat(s," `")+r+"` and strict mode is set to throw.")).path=t,i}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"ObjectExpectedError"}),t.exports=a},function(t,e,n){"use strict";t.exports=function(t){var e={_id:{auto:!0}};e._id[t.options.typeKey]="ObjectId",t.add(e)}},function(t,e,n){"use strict";t.exports=function(t,e){return null==t?null:"boolean"==typeof t?e:"boolean"==typeof t[e]?t[e]?e:null:e in t?t[e]:e}},function(t,e,n){"use strict";var r=n(34),i=n(25);function s(t,e,n){var o={useErrorHandlers:!0,numCallbackParams:1,nullResultByDefault:!0,contextParameter:!0},a=(n=n||{}).decorateDoc?t:t.prototype;t.$appliedHooks=!0;for(var l=0,c=Object.keys(e.paths);l<c.length;l++){var u=e.paths[c[l]],h=null;if(u.$isSingleNested)h=u.caster;else{if(!u.$isMongooseDocumentArray)continue;h=u.Constructor}if(!h.$appliedHooks&&(s(h,u.schema,n),null!=h.discriminators))for(var d=0,f=Object.keys(h.discriminators);d<f.length;d++){var p=f[d];s(h.discriminators[p],h.discriminators[p].schema,n)}}var m=e.s.hooks.filter(function(t){return"updateOne"===t.name||"deleteOne"===t.name?!!t.document:"remove"===t.name||"init"===t.name?null==t.document||!!t.document:null==t.query&&null==t.document||!1!==t.document}).filter(function(t){return!e.methods[t.name]||!t.fn[r.builtInMiddleware]});t._middleware=m,a.$__originalValidate=a.$__originalValidate||a.$__validate;for(var g=0,y=["save","validate","remove","deleteOne"];g<y.length;g++){var _=y[g],v="validate"===_?"$__originalValidate":"$__".concat(_),b=m.createWrapper(_,a[v],null,o);a["$__".concat(_)]=b}a.$__init=m.createWrapperSync("init",a.$__init,null,o);for(var w=Object.keys(e.methods),x=Object.assign({},o,{checkForPromise:!0}),S=function(){var e=A[E];if(!m.hasHooks(e))return"continue";var n=a[e];a[e]=function(){var n=this,r=Array.prototype.slice.call(arguments),s=r.slice(-1).pop(),o="function"==typeof s?r.slice(0,r.length-1):r;return i(s,function(t){return n["$__".concat(e)].apply(n,o.concat([t]))},t.events)},a["$__".concat(e)]=m.createWrapper(e,n,null,x)},E=0,A=w;E<A.length;E++)S()}t.exports=s,s.middlewareFunctions=["deleteOne","save","validate","remove","updateOne","init"]},function(t,e,n){"use strict";var r=n(13);t.exports=function(t,e){if(null==t)return t;if(t._id&&"string"==typeof t._id)return t._id;if(t.toString&&t.toString!==Object.prototype.toString&&!Array.isArray(t))return t.toString();throw new r("string",t,e)}},function(t,e,n){"use strict";var r=n(5),i=n(150),s=n(6),o=n(151),a=n(80),l=n(1),c=s.CastError;function u(t,e){s.call(this,t,e,"Number")}function h(t){return this.cast(t)}u.get=s.get,u.set=s.set,u._cast=o,u.cast=function(t){return 0===arguments.length||(!1===t&&(t=this._defaultCaster),this._cast=t),this._cast},u._defaultCaster=function(t){if("number"!=typeof t)throw new Error;return t},u.schemaName="Number",u.defaultOptions={},(u.prototype=Object.create(s.prototype)).constructor=u,u.prototype.OptionsConstructor=i,u._checkRequired=function(t){return"number"==typeof t||t instanceof Number},u.checkRequired=s.checkRequired,u.prototype.checkRequired=function(t,e){return s._isRef(this,t,e,!0)?!!t:("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():u.checkRequired())(t)},u.prototype.min=function(t,e){if(this.minValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.minValidator},this)),null!=t){var n=e||r.messages.Number.min;n=n.replace(/{MIN}/,t),this.validators.push({validator:this.minValidator=function(e){return null==e||e>=t},message:n,type:"min",min:t})}return this},u.prototype.max=function(t,e){if(this.maxValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.maxValidator},this)),null!=t){var n=e||r.messages.Number.max;n=n.replace(/{MAX}/,t),this.validators.push({validator:this.maxValidator=function(e){return null==e||e<=t},message:n,type:"max",max:t})}return this},u.prototype.enum=function(t,e){return this.enumValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.enumValidator},this)),Array.isArray(t)||(t=l.isObject(t)?l.object.vals(t):Array.prototype.slice.call(arguments),e=r.messages.Number.enum),e=null==e?r.messages.Number.enum:e,this.enumValidator=function(e){return null==e||-1!==t.indexOf(e)},this.validators.push({validator:this.enumValidator,message:e,type:"enum",enumValues:t}),this},u.prototype.cast=function(t,e,n){if(s._isRef(this,t,e,n))return"number"==typeof t?t:this._castRef(t,e,n);var r,i=t&&void 0!==t._id?t._id:t;r="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():u.cast();try{return r(i)}catch(t){throw new c("Number",i,this.path,t,this)}},u.prototype.$conditionalHandlers=l.options(s.prototype.$conditionalHandlers,{$bitsAllClear:a,$bitsAnyClear:a,$bitsAllSet:a,$bitsAnySet:a,$gt:h,$gte:h,$lt:h,$lte:h,$mod:function(t){var e=this;return Array.isArray(t)?t.map(function(t){return e.cast(t)}):[this.cast(t)]}}),u.prototype.castForQuery=function(t,e){var n;if(2===arguments.length){if(!(n=this.$conditionalHandlers[t]))throw new c("number",e,this.path,null,this);return n.call(this,e)}return this._castForQuery(t)},t.exports=u},function(t,e,n){"use strict";(function(e){var r=n(13);function i(t,e){var n=Number(e);if(isNaN(n))throw new r("number",e,t);return n}t.exports=function(t){var n=this;return Array.isArray(t)?t.map(function(t){return i(n.path,t)}):e.isBuffer(t)?t:i(n.path,t)}}).call(this,n(2).Buffer)},function(t,e,n){"use strict";var r=n(7);t.exports=function(t,e){return"string"==typeof t&&"string"==typeof e||"number"==typeof t&&"number"==typeof e?t===e:t instanceof r&&e instanceof r&&t.toString()===e.toString()}},function(t,e,n){"use strict";var r=new Set(["$ref","$id","$db"]);t.exports=function(t){return t.startsWith("$")&&!r.has(t)}},function(t,e,n){"use strict";var r=n(35).castArraysOfNumbers,i=n(35).castToNumber;function s(t,e){switch(t.$geometry.type){case"Polygon":case"LineString":case"Point":r(t.$geometry.coordinates,e)}return o(e,t),t}function o(t,e){e.$maxDistance&&(e.$maxDistance=i.call(t,e.$maxDistance)),e.$minDistance&&(e.$minDistance=i.call(t,e.$minDistance))}e.cast$geoIntersects=function(t){if(t.$geometry)return s(t,this),t},e.cast$near=function(t){var e=n(56);if(Array.isArray(t))return r(t,this),t;if(o(this,t),t&&t.$geometry)return s(t,this);if(!Array.isArray(t))throw new TypeError("$near must be either an array or an object with a $geometry property");return e.prototype.castForQuery.call(this,t)},e.cast$within=function(t){var e=this;if(o(this,t),t.$box||t.$polygon)t[t.$box?"$box":"$polygon"].forEach(function(t){if(!Array.isArray(t))throw new TypeError("Invalid $within $box argument. Expected an array, received "+t);t.forEach(function(n,r){t[r]=i.call(e,n)})});else if(t.$center||t.$centerSphere){var n=t.$center?"$center":"$centerSphere";t[n].forEach(function(r,s){Array.isArray(r)?r.forEach(function(t,n){r[n]=i.call(e,t)}):t[n][s]=i.call(e,r)})}else t.$geometry&&s(t,this);return t}},function(t,e,n){"use strict";var r=n(85),i=n(0).arrayAtomicsSymbol,s=n(0).arrayParentSymbol,o=n(0).arrayPathSymbol,a=n(0).arraySchemaSymbol,l=Array.prototype.push;t.exports=function(t,e,n,c){var u;if(Array.isArray(t)){var h=t.length;if(0===h)u=new r;else if(1===h)(u=new r(1))[0]=t[0];else if(h<1e4)u=new r,l.apply(u,t);else{u=new r;for(var d=0;d<h;++d)l.call(u,t[d])}null!=t[i]&&(u[i]=t[i])}else u=new r;return u[o]=e,null!=n&&null!=n.$__&&(u[s]=n,u[a]=c||n.schema.path(e)),u}},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){var e="function"==typeof Map?new Map:void 0;return(c=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return u(t,arguments,f(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),d(n,t)})(t)}function u(t,e,n){return(u=h()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&d(i,n.prototype),i}).apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=n(12),m=n(27),g=n(14),y=n(7),_=n(86),v=n(3),b=n(17).internalToObjectOptions,w=n(1),x=n(4),S=n(0).arrayAtomicsSymbol,E=n(0).arrayParentSymbol,A=n(0).arrayPathSymbol,T=n(0).arraySchemaSymbol,C=n(0).populateModelSymbol,M=Symbol("mongoose#Array#sliced"),O=Array.prototype.push,P=Symbol("mongoose#MongooseCoreArray#validators"),D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(c,t);var n,r,i,s=(n=c,r=h(),function(){var t,e=f(n);if(r){var i=f(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return l(this,t)});function c(){return o(this,c),s.apply(this,arguments)}return(i=[{key:"isMongooseArray",get:function(){return!0}},{key:"validators",get:function(){return this[P]},set:function(t){this[P]=t}},{key:"$__getAtomics",value:function(){var t=[],e=Object.keys(this[S]||{}),n=e.length,r=Object.assign({},b,{_isNested:!0});if(0===n)return t[0]=["$set",this.toObject(r)],t;for(;n--;){var i=e[n],s=this[S][i];w.isMongooseObject(s)?s=s.toObject(r):Array.isArray(s)?s=this.toObject.call(s,r):null!=s&&Array.isArray(s.$each)?s.$each=this.toObject.call(s.$each,r):null!=s&&"function"==typeof s.valueOf&&(s=s.valueOf()),"$addToSet"===i&&(s={$each:s}),t.push([i,s])}return t}},{key:"$atomics",value:function(){return this[S]||{}}},{key:"$parent",value:function(){return this[E]}},{key:"$path",value:function(){return this[A]}},{key:"$shift",value:function(){if(this._registerAtomic("$pop",-1),this._markModified(),!this._shifted)return this._shifted=!0,[].shift.call(this)}},{key:"$pop",value:function(){if(this._registerAtomic("$pop",1),this._markModified(),!this._popped)return this._popped=!0,[].pop.call(this)}},{key:"$schema",value:function(){return this[T]}},{key:"_cast",value:function(t){var n,r=!1;return this[E]&&(r=this[E].populated(this[A],!0)),r&&null!=t?(n=r.options[C],(e.isBuffer(t)||t instanceof y||!w.isObject(t))&&(t={_id:t}),t.$__schema&&t.$__schema.discriminatorMapping&&void 0!==t.$__schema.discriminatorMapping.key||(t=new n(t)),this[T].caster.applySetters(t,this[E],!0)):this[T].caster.applySetters(t,this[E],!1)}},{key:"_mapCast",value:function(t,e){return this._cast(t,this.length+e)}},{key:"_markModified",value:function(t){var e,n=this[E];if(n){if(e=this[A],arguments.length&&(e=e+"."+t),null!=e&&e.endsWith(".$"))return this;n.markModified(e,arguments.length>0?t:n)}return this}},{key:"_registerAtomic",value:function(t,e){if(!this[M]){if("$set"===t)return this[S]={$set:e},_(this[E],this[A]),this._markModified(),this;this[S]||(this[S]={});var n,r=this[S];if("$pop"===t&&!("$pop"in r)){var i=this;this[E].once("save",function(){i._popped=i._shifted=null})}if(this[S].$set||Object.keys(r).length&&!(t in r))return this[S]={$set:this},this;if("$pullAll"===t||"$addToSet"===t)r[t]||(r[t]=[]),r[t]=r[t].concat(e);else if("$pullDocs"===t){var s=r.$pull||(r.$pull={});e[0]instanceof m?(n=s.$or||(s.$or=[]),Array.prototype.push.apply(n,e.map(function(t){return t.toObject({transform:!1,virtuals:!1})}))):(n=s._id||(s._id={$in:[]})).$in=n.$in.concat(e)}else"$push"===t?(r.$push=r.$push||{$each:[]},null!=e&&w.hasUserDefinedProperty(e,"$each")?r.$push=e:r.$push.$each=r.$push.$each.concat(e)):r[t]=e;return this}}},{key:"addToSet",value:function(){R(this,arguments);var t=[].map.call(arguments,this._mapCast,this);t=this[T].applySetters(t,this[E]);var e=[],n="";return t[0]instanceof m?n="doc":t[0]instanceof Date&&(n="date"),t.forEach(function(t){var r,i=+t;switch(n){case"doc":r=this.some(function(e){return e.equals(t)});break;case"date":r=this.some(function(t){return+t===i});break;default:r=~this.indexOf(t)}r||([].push.call(this,t),this._registerAtomic("$addToSet",t),this._markModified(),[].push.call(e,t))},this),e}},{key:"hasAtomics",value:function(){return w.isPOJO(this[S])?Object.keys(this[S]).length:0}},{key:"includes",value:function(t,e){return-1!==this.indexOf(t,e)}},{key:"indexOf",value:function(t,e){t instanceof y&&(t=t.toString());for(var n=this.length,r=e=null==e?0:e;r<n;++r)if(t==this[r])return r;return-1}},{key:"inspect",value:function(){return JSON.stringify(this)}},{key:"nonAtomicPush",value:function(){var t=[].map.call(arguments,this._mapCast,this),e=[].push.apply(this,t);return this._registerAtomic("$set",this),this._markModified(),e}},{key:"pop",value:function(){var t=[].pop.call(this);return this._registerAtomic("$set",this),this._markModified(),t}},{key:"pull",value:function(){for(var t,e=[].map.call(arguments,this._cast,this),n=this[E].get(this[A]),r=n.length;r--;)if((t=n[r])instanceof p){var i=e.some(function(e){return t.equals(e)});i&&[].splice.call(n,r,1)}else~n.indexOf.call(e,t)&&[].splice.call(n,r,1);return e[0]instanceof m?this._registerAtomic("$pullDocs",e.map(function(t){return t.$__getValue("_id")||t})):this._registerAtomic("$pullAll",e),this._markModified(),_(this[E],this[A])>0&&this._registerAtomic("$set",this),this}},{key:"push",value:function(){var t=arguments,e=t,n=null!=t[0]&&w.hasUserDefinedProperty(t[0],"$each");if(n&&(e=t[0],t=t[0].$each),null==this[T])return O.apply(this,t);R(this,t);var r,i=this[E];t=[].map.call(t,this._mapCast,this),t=this[T].applySetters(t,i,void 0,void 0,{skipDocumentArrayCast:!0});var s=this[S];if(n){if(e.$each=t,v(s,"$push.$each.length",0)>0&&s.$push.$position!=s.$position)throw new g("Cannot call `Array#push()` multiple times with different `$position`");null!=e.$position?([].splice.apply(this,[e.$position,0].concat(t)),r=this.length):r=[].push.apply(this,t)}else{if(v(s,"$push.$each.length",0)>0&&null!=s.$push.$position)throw new g("Cannot call `Array#push()` multiple times with different `$position`");e=t,r=[].push.apply(this,t)}return this._registerAtomic("$push",e),this._markModified(),r}},{key:"remove",value:function(){return this.pull.apply(this,arguments)}},{key:"set",value:function(t,e){var n=this._cast(e,t);return this[t]=n,this._markModified(t),this}},{key:"shift",value:function(){var t=[].shift.call(this);return this._registerAtomic("$set",this),this._markModified(),t}},{key:"sort",value:function(){var t=[].sort.apply(this,arguments);return this._registerAtomic("$set",this),t}},{key:"splice",value:function(){var t;if(R(this,Array.prototype.slice.call(arguments,2)),arguments.length){var e;if(null==this[T])e=arguments;else{e=[];for(var n=0;n<arguments.length;++n)e[n]=n<2?arguments[n]:this._cast(arguments[n],arguments[0]+(n-2))}t=[].splice.apply(this,e),this._registerAtomic("$set",this)}return t}},{key:"slice",value:function(){var t=a(f(c.prototype),"slice",this).apply(this,arguments);return t[E]=this[E],t[T]=this[T],t[S]=this[S],t[A]=this[A],t[M]=!0,t}},{key:"filter",value:function(){var t=a(f(c.prototype),"filter",this).apply(this,arguments);return t[E]=this[E],t[T]=this[T],t[S]=this[S],t[A]=this[A],t}},{key:"toBSON",value:function(){return this.toObject(b)}},{key:"toObject",value:function(t){return t&&t.depopulate?((t=w.clone(t))._isNested=!0,[].concat(this).map(function(e){return e instanceof p?e.toObject(t):e})):[].concat(this)}},{key:"unshift",value:function(){var t;return R(this,arguments),null==this[T]?t=arguments:(t=[].map.call(arguments,this._cast,this),t=this[T].applySetters(t,this[E])),[].unshift.apply(this,t),this._registerAtomic("$set",this),this._markModified(),this.length}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(c.prototype,i),c}(c(Array));function R(t,e){var n,r,s,o=null==t?null:v(t[T],"caster.options.ref",null);0===t.length&&e.length>0&&function(t,e){if(!e)return!1;var n,r=i(t);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(null==s)return!1;var o=s.constructor;if(!(s instanceof p)||o.modelName!==e&&o.baseModelName!==e)return!1}}catch(t){r.e(t)}finally{r.f()}return!0}(e,o)&&t[E].populated(t[A],[],(s=e[0].constructor,(r=C)in(n={})?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,n))}x.inspect.custom&&(D.prototype[x.inspect.custom]=D.prototype.inspect),t.exports=D}).call(this,n(2).Buffer)},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=(n=n||{}).skipDocArrays,i=0;if(!t)return i;for(var s=0,o=Object.keys(t.$__.activePaths.states.modify);s<o.length;s++){var a=o[s];if(r){var l=t.$__schema.path(a);if(l&&l.$isMongooseDocumentArray)continue}a.startsWith(e+".")&&(delete t.$__.activePaths.states.modify[a],++i)}return i}},function(t,e,n){"use strict";var r=n(15).get().Binary,i=n(1),s=n(63).Buffer;function o(t,e,n){var r,a,c,u,h,d=arguments.length;return r=0===d||null==arguments[0]?0:t,Array.isArray(e)?(c=e[0],u=e[1]):a=e,h="number"==typeof r||r instanceof Number?s.alloc(r):s.from(r,a,n),i.decorate(h,o.mixin),h.isMongooseBuffer=!0,h[o.pathSymbol]=c,h[l]=u,h._subtype=0,h}var a=Symbol.for("mongoose#Buffer#_path"),l=Symbol.for("mongoose#Buffer#_parent");o.pathSymbol=a,o.mixin={_subtype:void 0,_markModified:function(){var t=this[l];return t&&t.markModified(this[o.pathSymbol]),this},write:function(){var t=s.prototype.write.apply(this,arguments);return t>0&&this._markModified(),t},copy:function(t){var e=s.prototype.copy.apply(this,arguments);return t&&t.isMongooseBuffer&&t._markModified(),e}},"writeUInt8 writeUInt16 writeUInt32 writeInt8 writeInt16 writeInt32 writeFloat writeDouble fill utf8Write binaryWrite asciiWrite set writeUInt16LE writeUInt16BE writeUInt32LE writeUInt32BE writeInt16LE writeInt16BE writeInt32LE writeInt32BE writeFloatLE writeFloatBE writeDoubleLE writeDoubleBE".split(" ").forEach(function(t){s.prototype[t]&&(o.mixin[t]=function(){var e=s.prototype[t].apply(this,arguments);return this._markModified(),e})}),o.mixin.toObject=function(t){var e="number"==typeof t?t:this._subtype||0;return new r(s.from(this),e)},o.mixin.toBSON=function(){return new r(this,this._subtype||0)},o.mixin.equals=function(t){if(!s.isBuffer(t))return!1;if(this.length!==t.length)return!1;for(var e=0;e<this.length;++e)if(this[e]!==t[e])return!1;return!0},o.mixin.subtype=function(t){if("number"!=typeof t)throw new TypeError("Invalid subtype. Expected a number");this._subtype!==t&&this._markModified(),this._subtype=t},o.Binary=r,t.exports=o},function(t,e,n){"use strict";var r=n(15).get().ObjectId,i=n(23);t.exports=function(t){if(null==t)return t;if(t instanceof r)return t;if(t._id){if(t._id instanceof r)return t._id;if(t._id.toString instanceof Function)return new r(t._id.toString())}if(t.toString instanceof Function)return new r(t.toString());i.ok(!1)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){var e="function"==typeof Map?new Map:void 0;return(l=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return c(t,arguments,d(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,t)})(t)}function c(t,e,n){return(c=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&h(i,n.prototype),i}).apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=n(26),p=n(7),m=n(1).deepEqual,g=n(3),y=n(90),_=n(4),v=n(50),b=n(0).populateModelSymbol,w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(l,t);var e,n,r,s=(e=l,n=u(),function(){var t,r=d(e);if(n){var i=d(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return a(this,t)});function l(t,e,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),null!=t&&"Object"===t.constructor.name&&(t=Object.keys(t).reduce(function(e,n){return e.concat([[n,t[n]]])},[])),(i=s.call(this,t)).$__parent=null!=n&&null!=n.$__?n:null,i.$__path=e,i.$__schemaType=null==r?new f(e):r,i.$__runDeferred(),i}return(r=[{key:"$init",value:function(t,e){x(t),o(d(l.prototype),"set",this).call(this,t,e),null!=e&&e.$isSingleNested&&(e.$basePath=this.$__path+"."+t)}},{key:"$__set",value:function(t,e){o(d(l.prototype),"set",this).call(this,t,e)}},{key:"get",value:function(t,e){return t instanceof p&&(t=t.toString()),!1===(e=e||{}).getters?o(d(l.prototype),"get",this).call(this,t):this.$__schemaType.applyGetters(o(d(l.prototype),"get",this).call(this,t),this.$__parent)}},{key:"set",value:function(t,e){if(t instanceof p&&(t=t.toString()),x(t),e=y(e),null==this.$__schemaType)return this.$__deferred=this.$__deferred||[],void this.$__deferred.push({key:t,value:e});var n=this.$__path+"."+t,r=null!=this.$__parent&&this.$__parent.$__?this.$__parent.populated(n)||this.$__parent.populated(this.$__path):null,i=this.get(t);if(null!=r)null==e.$__&&(e=new r.options[b](e)),e.$__.wasPopulated=!0;else try{e=this.$__schemaType.applySetters(e,this.$__parent,!1,this.get(t),{path:n})}catch(t){if(null!=this.$__parent&&null!=this.$__parent.$__)return void this.$__parent.invalidate(n,t);throw t}o(d(l.prototype),"set",this).call(this,t,e),null!=e&&e.$isSingleNested&&(e.$basePath=this.$__path+"."+t);var s=this.$__parent;null==s||null==s.$__||m(e,i)||s.markModified(this.$__path+"."+t)}},{key:"clear",value:function(){o(d(l.prototype),"clear",this).call(this);var t=this.$__parent;null!=t&&t.markModified(this.$__path)}},{key:"delete",value:function(t){t instanceof p&&(t=t.toString()),this.set(t,void 0),o(d(l.prototype),"delete",this).call(this,t)}},{key:"toBSON",value:function(){return new Map(this)}},{key:"toObject",value:function(t){if(g(t,"flattenMaps")){var e,n={},r=i(this.keys());try{for(r.s();!(e=r.n()).done;){var s=e.value;n[s]=this.get(s)}}catch(t){r.e(t)}finally{r.f()}return n}return new Map(this)}},{key:"toJSON",value:function(){var t,e={},n=i(this.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r]=this.get(r)}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"inspect",value:function(){return new Map(this)}},{key:"$__runDeferred",value:function(){if(this.$__deferred){var t,e=i(this.$__deferred);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.set(n.key,n.value)}}catch(t){e.e(t)}finally{e.f()}this.$__deferred=null}}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(l.prototype,r),l}(l(Map));function x(t){var e=r(t);if("string"!==e)throw new TypeError("Mongoose maps only support string keys, got ".concat(e));if(t.startsWith("$"))throw new Error('Mongoose maps do not support keys that start with "$", got "'.concat(t,'"'));if(t.includes("."))throw new Error('Mongoose maps do not support keys that contain ".", got "'.concat(t,'"'));if(v.has(t))throw new Error('Mongoose maps do not support reserved key name "'.concat(t,'"'))}_.inspect.custom&&Object.defineProperty(w.prototype,_.inspect.custom,{enumerable:!1,writable:!1,configurable:!1,value:w.prototype.inspect}),Object.defineProperty(w.prototype,"$__set",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(w.prototype,"$__parent",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(w.prototype,"$__path",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(w.prototype,"$__schemaType",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(w.prototype,"$isMongooseMap",{enumerable:!1,writable:!1,configurable:!1,value:!0}),Object.defineProperty(w.prototype,"$__deferredCalls",{enumerable:!1,writable:!1,configurable:!1,value:!0}),t.exports=w},function(t,e,n){"use strict";var r=n(1);t.exports=function(t){return r.isPOJO(t)&&null!=t.$__&&null!=t._doc?t._doc:t}},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=n(12),o=n(22),a=n(17).internalToObjectOptions,l=n(25),c=n(0).documentArrayParent;function u(t,e,n,i,o){var a=this;this.$isSingleNested=!0,null!=o&&null!=o.path&&(this.$basePath=o.path);var l=null!=o&&o.priorDoc,c=null;if(l&&(this._doc=Object.assign({},o.priorDoc._doc),delete this._doc[this.$__schema.options.discriminatorKey],c=Object.keys(o.priorDoc._doc||{}).filter(function(t){return t!==a.$__schema.options.discriminatorKey})),null!=n&&(o=Object.assign({},o,{isNew:n.isNew,defaults:n.$__.$options.defaults})),s.call(this,t,e,i,o),l){var u,h=r(c);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!this.$__.activePaths.states.modify[d]&&!this.$__.activePaths.states.default[d]&&!this.$__.$setCalled.has(d)){var f=this.$__schema.path(d),p=null==f?void 0:f.getDefault(this);void 0===p?delete this._doc[d]:(this._doc[d]=p,this.$__.activePaths.default(d))}}}catch(t){h.e(t)}finally{h.f()}delete o.priorDoc,delete this.$__.$options.priorDoc}}t.exports=u,(u.prototype=Object.create(s.prototype)).toBSON=function(){return this.toObject(a)},u.prototype.save=function(t,e){var n=this;return"function"==typeof t&&(e=t,t={}),(t=t||{}).suppressWarning||console.warn("mongoose: calling `save()` on a subdoc does **not** save the document to MongoDB, it only runs save middleware. Use `subdoc.save({ suppressWarning: true })` to hide this warning if you're sure this behavior is right for your app."),l(e,function(t){n.$__save(t)})},u.prototype.$__save=function(t){var e=this;return o(function(){return t(null,e)})},u.prototype.$isValid=function(t){return this.$__parent&&this.$basePath?this.$__parent.$isValid([this.$basePath,t].join(".")):s.prototype.$isValid.call(this,t)},u.prototype.markModified=function(t){if(s.prototype.markModified.call(this,t),this.$__parent&&this.$basePath){if(this.$__parent.isDirectModified(this.$basePath))return;this.$__parent.markModified([this.$basePath,t].join("."),this)}},u.prototype.isModified=function(t,e){var n=this;return this.$__parent&&this.$basePath?Array.isArray(t)||"string"==typeof t?(t=(t=Array.isArray(t)?t:t.split(" ")).map(function(t){return[n.$basePath,t].join(".")}),this.$__parent.isModified(t,e)):this.$__parent.isModified(this.$basePath):s.prototype.isModified.call(this,t,e)},u.prototype.$markValid=function(t){s.prototype.$markValid.call(this,t),this.$__parent&&this.$basePath&&this.$__parent.$markValid([this.$basePath,t].join("."))},u.prototype.invalidate=function(t,e,n){if(e!==this.ownerDocument().$__.validationError&&s.prototype.invalidate.call(this,t,e,n),this.$__parent&&this.$basePath)this.$__parent.invalidate([this.$basePath,t].join("."),e,n);else if("cast"===e.kind||"CastError"===e.name)throw e;return this.ownerDocument().$__.validationError},u.prototype.$ignore=function(t){s.prototype.$ignore.call(this,t),this.$__parent&&this.$basePath&&this.$__parent.$ignore([this.$basePath,t].join("."))},u.prototype.ownerDocument=function(){if(this.$__.ownerDocument)return this.$__.ownerDocument;var t=this.$__parent;if(!t)return this;for(;t.$__parent||t[c];)t=t.$__parent||t[c];return this.$__.ownerDocument=t,this.$__.ownerDocument},u.prototype.$parent=u.prototype.parent=function(){return this.$__parent},u.prototype.$__remove=function(t){return t(null,this)},u.prototype.remove=function(t,e){"function"==typeof t&&(e=t,t=null),function(t){var e=t.ownerDocument();function n(){e.removeListener("save",n),e.removeListener("remove",n),t.emit("remove",t),t.constructor.emit("remove",t),e=t=null}e.on("save",n),e.on("remove",n)}(this),t&&t.noop||this.$__parent.set(this.$basePath,null),"function"==typeof e&&e(null)},u.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.nested.populate("path")`, use `doc.populate("nested.path")`')}},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=n(26),o=n(7),a=n(57).defineKey,l=n(3),c=n(1),u={toJSON:!0,toObject:!0,_id:!0,id:!0};t.exports=function(t,e,n,i,h){if(!n||!n.instanceOfSchema)throw new Error("You must pass a valid discriminator Schema");if(t.schema.discriminatorMapping&&!t.schema.discriminatorMapping.isRoot)throw new Error('Discriminator "'+e+'" can only be a discriminator of the root model');if(h){var d=l(t.base,"options.applyPluginsToDiscriminators",!1);t.base._applyPlugins(n,{skipTopLevel:!d})}var f=t.schema.options.discriminatorKey,p=t.schema.path(f);if(null!=p)c.hasUserDefinedProperty(p.options,"select")||(p.options.select=!0),p.options.$skipDiscriminatorCheck=!0;else{var m={};m[f]={default:void 0,select:!0,$skipDiscriminatorCheck:!0},m[f][t.schema.options.typeKey]=String,t.schema.add(m),a(f,null,t.prototype,null,[f],t.schema.options)}if(n.path(f)&&!0!==n.path(f).options.$skipDiscriminatorCheck)throw new Error('Discriminator "'+e+'" cannot have field with name "'+f+'"');var g=e;if(("string"==typeof i&&i.length||"number"==typeof i||i instanceof o)&&(g=i),function(e,n){e._baseSchema=n,n.paths._id&&n.paths._id.options&&!n.paths._id.options.auto&&e.remove("_id");for(var i=[],o=0,a=Object.keys(n.paths);o<a.length;o++){var l=a[o];if(e.nested[l])i.push(l);else if(-1!==l.indexOf(".")){var h,d="",m=r(l.split(".").slice(0,-1));try{for(m.s();!(h=m.n()).done;)(e.paths[d+=(d.length?".":"")+h.value]instanceof s||e.singleNestedPaths[d]instanceof s)&&i.push(l)}catch(t){m.e(t)}finally{m.f()}}}c.merge(e,n,{isDiscriminatorSchemaMerge:!0,omit:{discriminators:!0,base:!0},omitNested:i.reduce(function(t,e){return t["tree."+e]=!0,t},{})});for(var y=0,_=i;y<_.length;y++)delete e.paths[_[y]];e.childSchemas.forEach(function(t){t.model.prototype.$__setSchema(t.schema)});var v={};v[f]={default:g,select:!0,set:function(t){if(t===g)return g;throw new Error("Can't set discriminator key \""+f+'"')},$skipDiscriminatorCheck:!0},v[f][e.options.typeKey]=p?p.instance:String,e.add(v),e.discriminatorMapping={key:f,value:g,isRoot:!1},n.options.collection&&(e.options.collection=n.options.collection);var b=e.options.toJSON,w=e.options.toObject,x=e.options._id,S=e.options.id,E=Object.keys(e.options);e.options.discriminatorKey=n.options.discriminatorKey;for(var A=0,T=E;A<T.length;A++){var C=T[A];if(!u[C]){if("pluralization"===C&&1==e.options[C]&&null==n.options[C])continue;if(!c.deepEqual(e.options[C],n.options[C]))throw new Error("Can't customize discriminator option "+C+" (can only modify "+Object.keys(u).join(", ")+")")}}e.options=c.clone(n.options),b&&(e.options.toJSON=b),w&&(e.options.toObject=w),void 0!==x&&(e.options._id=x),e.options.id=S,e.s.hooks=t.schema.s.hooks.merge(e.s.hooks),e.plugins=Array.prototype.slice.call(n.plugins),e.callQueue=n.callQueue.concat(e.callQueue),delete e._requiredpaths}(n,t.schema),t.discriminators||(t.discriminators={}),t.schema.discriminatorMapping||(t.schema.discriminatorMapping={key:f,value:null,isRoot:!0}),t.schema.discriminators||(t.schema.discriminators={}),t.schema.discriminators[e]=n,t.discriminators[e])throw new Error('Discriminator with name "'+e+'" already exists');return n}},function(t,e,n){"use strict";var r=n(75);t.exports=function(t,e){return null==e||null==e._id||(t=t.clone(),e._id?t.paths._id||(r(t),t.options._id=!0):(t.remove("_id"),t.options._id=!1)),t}},function(t,e,n){"use strict";var r=n(36);t.exports=function(t,e){var n=t.schema.options.discriminatorKey;if(null!=e&&t.discriminators&&null!=e[n])if(t.discriminators[e[n]])t=t.discriminators[e[n]];else{var i=r(t.discriminators,e[n]);i&&(t=i)}return t}},function(t,e,n){"use strict";t.exports=n(96)},function(t,e,n){"use strict";(function(r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n(15).set(n(100));var l=n(61),c=n(67);l.setBrowser(!0),Object.defineProperty(e,"Promise",{get:function(){return c.get()},set:function(t){c.set(t)}}),e.PromiseProvider=c,e.Error=n(5),e.Schema=n(53),e.Types=n(37),e.VirtualType=n(54),e.SchemaType=n(6),e.utils=n(1),e.Document=l(),e.model=function(t,n){var r=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(r,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(r);function r(t,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),e.call(this,t,n,i)}return r}(e.Document);return r.modelName=t,r},"undefined"!=typeof window&&(window.mongoose=t.exports,window.Buffer=r)}).call(this,n(2).Buffer)},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[1];return 3*(e[0]+n)/4-n},e.toByteArray=function(t){var e,n,r=c(t),o=r[0],a=r[1],l=new s(function(t,e,n){return 3*(e+n)/4-n}(0,o,a)),u=0,h=a>0?o-4:o;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=255&e;return 2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,l[u++]=255&e),1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,l[u++]=e>>8&255,l[u++]=255&e),l},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(u(t,o,o+16383>a?a:o+16383));return 1===i?s.push(r[(e=t[n-1])>>2]+r[e<<4&63]+"=="):2===i&&s.push(r[(e=(t[n-2]<<8)+t[n-1])>>10]+r[e>>4&63]+r[e<<2&63]+"="),s.join("")};for(var r=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=o.length;a<l;++a)r[a]=o[a],i[o.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t,e,n){for(var i,s=[],o=e;o<n;o+=3)s.push(r[(i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var s,o,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=t[e+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+t[e+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=256*o+t[e+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),s-=c}return(f?-1:1)*o*Math.pow(2,s-r)},e.write=function(t,e,n,r,i,s){var o,a,l,c=8*s-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:s-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*l-1)*Math.pow(2,i),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[n+f]=255&a,f+=p,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;t[n+f]=255&o,f+=p,o/=256,c-=8);t[n+f-p]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";e.Binary=n(101),e.Collection=function(){throw new Error("Cannot create a collection from browser library")},e.getConnection=function(){return function(){throw new Error("Cannot create a connection from browser library")}},e.Decimal128=n(108),e.ObjectId=n(109),e.ReadPreference=n(110)},function(t,e,n){"use strict";var r=n(38).Binary;t.exports=r},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return t&&"object"===n(t)&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(module,exports,__nested_webpack_require_271668__){"use strict";var Long=__nested_webpack_require_271668__(24).Long,Double=__nested_webpack_require_271668__(39).Double,Timestamp=__nested_webpack_require_271668__(40).Timestamp,ObjectID=__nested_webpack_require_271668__(41).ObjectID,_Symbol=__nested_webpack_require_271668__(43).Symbol,Code=__nested_webpack_require_271668__(44).Code,MinKey=__nested_webpack_require_271668__(46).MinKey,MaxKey=__nested_webpack_require_271668__(47).MaxKey,Decimal128=__nested_webpack_require_271668__(45),Int32=__nested_webpack_require_271668__(60),DBRef=__nested_webpack_require_271668__(48).DBRef,BSONRegExp=__nested_webpack_require_271668__(42).BSONRegExp,Binary=__nested_webpack_require_271668__(28).Binary,utils=__nested_webpack_require_271668__(16),deserialize=function(t,e,n){var r=(e=null==e?{}:e)&&e.index?e.index:0,i=t[r]|t[r+1]<<8|t[r+2]<<16|t[r+3]<<24;if(i<5||t.length<i||i+r>t.length)throw new Error("corrupt bson message");if(0!==t[r+i-1])throw new Error("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return deserializeObject(t,r,e,n)},deserializeObject=function t(e,n,r,i){var s=null!=r.evalFunctions&&r.evalFunctions,o=null!=r.cacheFunctions&&r.cacheFunctions,a=null!=r.cacheFunctionsCrc32&&r.cacheFunctionsCrc32;if(!a)var l=null;var c=null==r.fieldsAsRaw?null:r.fieldsAsRaw,u=null!=r.raw&&r.raw,h="boolean"==typeof r.bsonRegExp&&r.bsonRegExp,d=null!=r.promoteBuffers&&r.promoteBuffers,f=null==r.promoteLongs||r.promoteLongs,p=null==r.promoteValues||r.promoteValues,m=n;if(e.length<5)throw new Error("corrupt bson message < 5 bytes long");var g=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;if(g<5||g>e.length)throw new Error("corrupt bson message");for(var y=i?[]:{},_=0;;){var v=e[n++];if(0===v)break;for(var b=n;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");var w=i?_++:e.toString("utf8",n,b);if(n=b+1,v===BSON.BSON_DATA_STRING){var x=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;if(x<=0||x>e.length-n||0!==e[n+x-1])throw new Error("bad string length in bson");y[w]=e.toString("utf8",n,n+x-1),n+=x}else if(v===BSON.BSON_DATA_OID){var S=utils.allocBuffer(12);e.copy(S,0,n,n+12),y[w]=new ObjectID(S),n+=12}else if(v===BSON.BSON_DATA_INT&&!1===p)y[w]=new Int32(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24);else if(v===BSON.BSON_DATA_INT)y[w]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;else if(v===BSON.BSON_DATA_NUMBER&&!1===p)y[w]=new Double(e.readDoubleLE(n)),n+=8;else if(v===BSON.BSON_DATA_NUMBER)y[w]=e.readDoubleLE(n),n+=8;else if(v===BSON.BSON_DATA_DATE){var E=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24,A=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;y[w]=new Date(new Long(E,A).toNumber())}else if(v===BSON.BSON_DATA_BOOLEAN){if(0!==e[n]&&1!==e[n])throw new Error("illegal boolean type value");y[w]=1===e[n++]}else if(v===BSON.BSON_DATA_OBJECT){var T=n,C=e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24;if(C<=0||C>e.length-n)throw new Error("bad embedded document length in bson");y[w]=u?e.slice(n,n+C):t(e,T,r,!1),n+=C}else if(v===BSON.BSON_DATA_ARRAY){T=n;var M=r,O=n+(C=e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24);if(c&&c[w]){for(var P in M={},r)M[P]=r[P];M.raw=!0}if(y[w]=t(e,T,M,!0),0!==e[(n+=C)-1])throw new Error("invalid array terminator byte");if(n!==O)throw new Error("corrupted array bson")}else if(v===BSON.BSON_DATA_UNDEFINED)y[w]=void 0;else if(v===BSON.BSON_DATA_NULL)y[w]=null;else if(v===BSON.BSON_DATA_LONG){E=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24,A=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;var D=new Long(E,A);y[w]=f&&!0===p&&D.lessThanOrEqual(JS_INT_MAX_LONG)&&D.greaterThanOrEqual(JS_INT_MIN_LONG)?D.toNumber():D}else if(v===BSON.BSON_DATA_DECIMAL128){var R=utils.allocBuffer(16);e.copy(R,0,n,n+16),n+=16;var L=new Decimal128(R);y[w]=L.toObject?L.toObject():L}else if(v===BSON.BSON_DATA_BINARY){var I=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24,N=I,k=e[n++];if(I<0)throw new Error("Negative binary type element size found");if(I>e.length)throw new Error("Binary type size larger than document size");if(null!=e.slice){if(k===Binary.SUBTYPE_BYTE_ARRAY){if((I=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(I>N-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if(I<N-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}y[w]=d&&p?e.slice(n,n+I):new Binary(e.slice(n,n+I),k)}else{var F="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(I)):new Array(I);if(k===Binary.SUBTYPE_BYTE_ARRAY){if((I=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if(I>N-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if(I<N-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}for(b=0;b<I;b++)F[b]=e[n+b];y[w]=d&&p?F:new Binary(F,k)}n+=I}else if(v===BSON.BSON_DATA_REGEXP&&!1===h){for(b=n;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");var B=e.toString("utf8",n,b);for(b=n=b+1;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");var j=e.toString("utf8",n,b);n=b+1;var U=new Array(j.length);for(b=0;b<j.length;b++)switch(j[b]){case"m":U[b]="m";break;case"s":U[b]="g";break;case"i":U[b]="i"}y[w]=new RegExp(B,U.join(""))}else if(v===BSON.BSON_DATA_REGEXP&&!0===h){for(b=n;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");for(B=e.toString("utf8",n,b),b=n=b+1;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");j=e.toString("utf8",n,b),n=b+1,y[w]=new BSONRegExp(B,j)}else if(v===BSON.BSON_DATA_SYMBOL){if((x=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)<=0||x>e.length-n||0!==e[n+x-1])throw new Error("bad string length in bson");y[w]=new _Symbol(e.toString("utf8",n,n+x-1)),n+=x}else if(v===BSON.BSON_DATA_TIMESTAMP)E=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24,A=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24,y[w]=new Timestamp(E,A);else if(v===BSON.BSON_DATA_MIN_KEY)y[w]=new MinKey;else if(v===BSON.BSON_DATA_MAX_KEY)y[w]=new MaxKey;else if(v===BSON.BSON_DATA_CODE){if((x=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)<=0||x>e.length-n||0!==e[n+x-1])throw new Error("bad string length in bson");var V=e.toString("utf8",n,n+x-1);if(s)if(o){var z=a?l(V):V;y[w]=isolateEvalWithHash(functionCache,z,V,y)}else y[w]=isolateEval(V);else y[w]=new Code(V);n+=x}else if(v===BSON.BSON_DATA_CODE_W_SCOPE){var $=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;if($<13)throw new Error("code_w_scope total size shorter minimum expected length");if((x=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)<=0||x>e.length-n||0!==e[n+x-1])throw new Error("bad string length in bson");V=e.toString("utf8",n,n+x-1),T=n+=x,C=e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24;var H=t(e,T,r,!1);if(n+=C,$<8+C+x)throw new Error("code_w_scope total size is to short, truncating scope");if($>8+C+x)throw new Error("code_w_scope total size is to long, clips outer document");s?(o?(z=a?l(V):V,y[w]=isolateEvalWithHash(functionCache,z,V,y)):y[w]=isolateEval(V),y[w].scope=H):y[w]=new Code(V,H)}else{if(v!==BSON.BSON_DATA_DBPOINTER)throw new Error("Detected unknown BSON type "+v.toString(16)+' for fieldname "'+w+'", are you using the latest BSON parser');if((x=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)<=0||x>e.length-n||0!==e[n+x-1])throw new Error("bad string length in bson");var G=e.toString("utf8",n,n+x-1);n+=x;var W=utils.allocBuffer(12);e.copy(W,0,n,n+12),S=new ObjectID(W),n+=12;var q=G.split("."),Z=q.shift(),Y=q.join(".");y[w]=new DBRef(Y,S,Z)}}if(g!==n-m){if(i)throw new Error("corrupt array bson");throw new Error("corrupt object bson")}return null!=y.$id&&(y=new DBRef(y.$ref,y.$id,y.$db)),y},isolateEvalWithHash=function isolateEvalWithHash(functionCache,hash,functionString,object){var value=null;return null==functionCache[hash]&&(eval("value = "+functionString),functionCache[hash]=value),functionCache[hash].bind(object)},isolateEval=function isolateEval(functionString){var value=null;return eval("value = "+functionString),value},BSON={},functionCache=BSON.functionCache={};BSON.BSON_DATA_NUMBER=1,BSON.BSON_DATA_STRING=2,BSON.BSON_DATA_OBJECT=3,BSON.BSON_DATA_ARRAY=4,BSON.BSON_DATA_BINARY=5,BSON.BSON_DATA_UNDEFINED=6,BSON.BSON_DATA_OID=7,BSON.BSON_DATA_BOOLEAN=8,BSON.BSON_DATA_DATE=9,BSON.BSON_DATA_NULL=10,BSON.BSON_DATA_REGEXP=11,BSON.BSON_DATA_DBPOINTER=12,BSON.BSON_DATA_CODE=13,BSON.BSON_DATA_SYMBOL=14,BSON.BSON_DATA_CODE_W_SCOPE=15,BSON.BSON_DATA_INT=16,BSON.BSON_DATA_TIMESTAMP=17,BSON.BSON_DATA_LONG=18,BSON.BSON_DATA_DECIMAL128=19,BSON.BSON_DATA_MIN_KEY=255,BSON.BSON_DATA_MAX_KEY=127,BSON.BSON_BINARY_SUBTYPE_DEFAULT=0,BSON.BSON_BINARY_SUBTYPE_FUNCTION=1,BSON.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,BSON.BSON_BINARY_SUBTYPE_UUID=3,BSON.BSON_BINARY_SUBTYPE_MD5=4,BSON.BSON_BINARY_SUBTYPE_USER_DEFINED=128,BSON.BSON_INT32_MAX=2147483647,BSON.BSON_INT32_MIN=-2147483648,BSON.BSON_INT64_MAX=Math.pow(2,63)-1,BSON.BSON_INT64_MIN=-Math.pow(2,63),BSON.JS_INT_MAX=9007199254740992,BSON.JS_INT_MIN=-9007199254740992;var JS_INT_MAX_LONG=Long.fromNumber(9007199254740992),JS_INT_MIN_LONG=Long.fromNumber(-9007199254740992);module.exports=deserialize},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(106).writeIEEE754,s=n(24).Long,o=n(59),a=n(28).Binary,l=n(16).normalizedFunctionString,c=/\x00/,u=["$db","$ref","$id","$clusterTime"],h=function(t){return"object"===r(t)&&"[object Date]"===Object.prototype.toString.call(t)},d=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},f=function(t,e,n,r,i){t[r++]=I.BSON_DATA_STRING;var s=t.write(e,r,i?"ascii":"utf8");t[(r=r+s+1)-1]=0;var o=t.write(n,r+4,"utf8");return t[r+3]=o+1>>24&255,t[r+2]=o+1>>16&255,t[r+1]=o+1>>8&255,t[r]=o+1&255,r=r+4+o,t[r++]=0,r},p=function(t,e,n,r,o){if(Math.floor(n)===n&&n>=I.JS_INT_MIN&&n<=I.JS_INT_MAX)if(n>=I.BSON_INT32_MIN&&n<=I.BSON_INT32_MAX){t[r++]=I.BSON_DATA_INT;var a=t.write(e,r,o?"ascii":"utf8");r+=a,t[r++]=0,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=n>>16&255,t[r++]=n>>24&255}else if(n>=I.JS_INT_MIN&&n<=I.JS_INT_MAX)t[r++]=I.BSON_DATA_NUMBER,r+=a=t.write(e,r,o?"ascii":"utf8"),t[r++]=0,i(t,n,r,"little",52,8),r+=8;else{t[r++]=I.BSON_DATA_LONG,r+=a=t.write(e,r,o?"ascii":"utf8"),t[r++]=0;var l=s.fromNumber(n),c=l.getLowBits(),u=l.getHighBits();t[r++]=255&c,t[r++]=c>>8&255,t[r++]=c>>16&255,t[r++]=c>>24&255,t[r++]=255&u,t[r++]=u>>8&255,t[r++]=u>>16&255,t[r++]=u>>24&255}else t[r++]=I.BSON_DATA_NUMBER,r+=a=t.write(e,r,o?"ascii":"utf8"),t[r++]=0,i(t,n,r,"little",52,8),r+=8;return r},m=function(t,e,n,r,i){return t[r++]=I.BSON_DATA_NULL,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,r},g=function(t,e,n,r,i){return t[r++]=I.BSON_DATA_BOOLEAN,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,t[r++]=n?1:0,r},y=function(t,e,n,r,i){t[r++]=I.BSON_DATA_DATE,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0;var o=s.fromNumber(n.getTime()),a=o.getLowBits(),l=o.getHighBits();return t[r++]=255&a,t[r++]=a>>8&255,t[r++]=a>>16&255,t[r++]=a>>24&255,t[r++]=255&l,t[r++]=l>>8&255,t[r++]=l>>16&255,t[r++]=l>>24&255,r},_=function(t,e,n,r,i){if(t[r++]=I.BSON_DATA_REGEXP,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,n.source&&null!=n.source.match(c))throw Error("value "+n.source+" must not contain null bytes");return r+=t.write(n.source,r,"utf8"),t[r++]=0,n.global&&(t[r++]=115),n.ignoreCase&&(t[r++]=105),n.multiline&&(t[r++]=109),t[r++]=0,r},v=function(t,e,n,r,i){if(t[r++]=I.BSON_DATA_REGEXP,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,null!=n.pattern.match(c))throw Error("pattern "+n.pattern+" must not contain null bytes");return r+=t.write(n.pattern,r,"utf8"),t[r++]=0,r+=t.write(n.options.split("").sort().join(""),r,"utf8"),t[r++]=0,r},b=function(t,e,n,r,i){return t[r++]=null===n?I.BSON_DATA_NULL:"MinKey"===n._bsontype?I.BSON_DATA_MIN_KEY:I.BSON_DATA_MAX_KEY,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,r},w=function(t,e,n,r,i){if(t[r++]=I.BSON_DATA_OID,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,"string"==typeof n.id)t.write(n.id,r,"binary");else{if(!n.id||!n.id.copy)throw new Error("object ["+JSON.stringify(n)+"] is not a valid ObjectId");n.id.copy(t,r,0,12)}return r+12},x=function(t,e,n,r,i){t[r++]=I.BSON_DATA_BINARY,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0;var s=n.length;return t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,t[r++]=I.BSON_BINARY_SUBTYPE_DEFAULT,n.copy(t,r,0,s),r+s},S=function(t,e,n,r,i,s,o,a,l,c){for(var u=0;u<c.length;u++)if(c[u]===n)throw new Error("cyclic dependency detected");c.push(n),t[r++]=Array.isArray(n)?I.BSON_DATA_ARRAY:I.BSON_DATA_OBJECT,r+=t.write(e,r,l?"ascii":"utf8"),t[r++]=0;var h=L(t,n,i,r,s+1,o,a,c);return c.pop(),h},E=function(t,e,n,r,i){return t[r++]=I.BSON_DATA_DECIMAL128,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,n.bytes.copy(t,r,0,16),r+16},A=function(t,e,n,r,i){t[r++]="Long"===n._bsontype?I.BSON_DATA_LONG:I.BSON_DATA_TIMESTAMP,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0;var s=n.getLowBits(),o=n.getHighBits();return t[r++]=255&s,t[r++]=s>>8&255,t[r++]=s>>16&255,t[r++]=s>>24&255,t[r++]=255&o,t[r++]=o>>8&255,t[r++]=o>>16&255,t[r++]=o>>24&255,r},T=function(t,e,n,r,i){return t[r++]=I.BSON_DATA_INT,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=n>>16&255,t[r++]=n>>24&255,r},C=function(t,e,n,r,s){return t[r++]=I.BSON_DATA_NUMBER,r+=t.write(e,r,s?"ascii":"utf8"),t[r++]=0,i(t,n,r,"little",52,8),r+8},M=function(t,e,n,r,i,s,o){t[r++]=I.BSON_DATA_CODE,r+=t.write(e,r,o?"ascii":"utf8"),t[r++]=0;var a=l(n),c=t.write(a,r+4,"utf8")+1;return t[r]=255&c,t[r+1]=c>>8&255,t[r+2]=c>>16&255,t[r+3]=c>>24&255,r=r+4+c-1,t[r++]=0,r},O=function(t,e,n,i,s,o,a,l,c){if(n.scope&&"object"===r(n.scope)){t[i++]=I.BSON_DATA_CODE_W_SCOPE;var u=t.write(e,i,c?"ascii":"utf8");i+=u,t[i++]=0;var h=i,d="string"==typeof n.code?n.code:n.code.toString(),f=t.write(d,(i+=4)+4,"utf8")+1;t[i]=255&f,t[i+1]=f>>8&255,t[i+2]=f>>16&255,t[i+3]=f>>24&255,t[i+4+f-1]=0;var p=L(t,n.scope,s,i=i+f+4,o+1,a,l);i=p-1;var m=p-h;t[h++]=255&m,t[h++]=m>>8&255,t[h++]=m>>16&255,t[h++]=m>>24&255,t[i++]=0}else{t[i++]=I.BSON_DATA_CODE,i+=u=t.write(e,i,c?"ascii":"utf8"),t[i++]=0,d=n.code.toString();var g=t.write(d,i+4,"utf8")+1;t[i]=255&g,t[i+1]=g>>8&255,t[i+2]=g>>16&255,t[i+3]=g>>24&255,i=i+4+g-1,t[i++]=0}return i},P=function(t,e,n,r,i){t[r++]=I.BSON_DATA_BINARY,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0;var s=n.value(!0),o=n.position;return n.sub_type===a.SUBTYPE_BYTE_ARRAY&&(o+=4),t[r++]=255&o,t[r++]=o>>8&255,t[r++]=o>>16&255,t[r++]=o>>24&255,t[r++]=n.sub_type,n.sub_type===a.SUBTYPE_BYTE_ARRAY&&(t[r++]=255&(o-=4),t[r++]=o>>8&255,t[r++]=o>>16&255,t[r++]=o>>24&255),s.copy(t,r,0,n.position),r+n.position},D=function(t,e,n,r,i){t[r++]=I.BSON_DATA_SYMBOL,r+=t.write(e,r,i?"ascii":"utf8"),t[r++]=0;var s=t.write(n.value,r+4,"utf8")+1;return t[r]=255&s,t[r+1]=s>>8&255,t[r+2]=s>>16&255,t[r+3]=s>>24&255,r=r+4+s-1,t[r++]=0,r},R=function(t,e,n,r,i,s,o){t[r++]=I.BSON_DATA_OBJECT,r+=t.write(e,r,o?"ascii":"utf8"),t[r++]=0;var a,l=r,c=(a=L(t,null!=n.db?{$ref:n.namespace,$id:n.oid,$db:n.db}:{$ref:n.namespace,$id:n.oid},!1,r,i+1,s))-l;return t[l++]=255&c,t[l++]=c>>8&255,t[l++]=c>>16&255,t[l++]=c>>24&255,a},L=function(t,n,i,s,a,l,L,I){s=s||0,(I=I||[]).push(n);var N=s+4;if(Array.isArray(n))for(var k=0;k<n.length;k++){var F=""+k,B=n[k];if(B&&B.toBSON){if("function"!=typeof B.toBSON)throw new Error("toBSON is not a function");B=B.toBSON()}var j=r(B);if("string"===j)N=f(t,F,B,N,!0);else if("number"===j)N=p(t,F,B,N,!0);else{if("bigint"===j)throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"===j)N=g(t,F,B,N,!0);else if(B instanceof Date||h(B))N=y(t,F,B,N,!0);else if(void 0===B)N=m(t,F,0,N,!0);else if(null===B)N=m(t,F,0,N,!0);else if("ObjectID"===B._bsontype||"ObjectId"===B._bsontype)N=w(t,F,B,N,!0);else if(e.isBuffer(B))N=x(t,F,B,N,!0);else if(B instanceof RegExp||d(B))N=_(t,F,B,N,!0);else if("object"===j&&null==B._bsontype)N=S(t,F,B,N,i,a,l,L,!0,I);else if("object"===j&&"Decimal128"===B._bsontype)N=E(t,F,B,N,!0);else if("Long"===B._bsontype||"Timestamp"===B._bsontype)N=A(t,F,B,N,!0);else if("Double"===B._bsontype)N=C(t,F,B,N,!0);else if("function"==typeof B&&l)N=M(t,F,B,N,0,0,l);else if("Code"===B._bsontype)N=O(t,F,B,N,i,a,l,L,!0);else if("Binary"===B._bsontype)N=P(t,F,B,N,!0);else if("Symbol"===B._bsontype)N=D(t,F,B,N,!0);else if("DBRef"===B._bsontype)N=R(t,F,B,N,a,l,!0);else if("BSONRegExp"===B._bsontype)N=v(t,F,B,N,!0);else if("Int32"===B._bsontype)N=T(t,F,B,N,!0);else if("MinKey"===B._bsontype||"MaxKey"===B._bsontype)N=b(t,F,B,N,!0);else if(void 0!==B._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+B._bsontype)}}else if(n instanceof o)for(var U=n.entries(),V=!1;!V;){var z=U.next();if(!(V=z.done)){if(F=z.value[0],j=r(B=z.value[1]),"string"==typeof F&&-1===u.indexOf(F)){if(null!=F.match(c))throw Error("key "+F+" must not contain null bytes");if(i){if("$"===F[0])throw Error("key "+F+" must not start with '$'");if(~F.indexOf("."))throw Error("key "+F+" must not contain '.'")}}if("string"===j)N=f(t,F,B,N);else if("number"===j)N=p(t,F,B,N);else{if("bigint"===j)throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"===j)N=g(t,F,B,N);else if(B instanceof Date||h(B))N=y(t,F,B,N);else if(null===B||void 0===B&&!1===L)N=m(t,F,0,N);else if("ObjectID"===B._bsontype||"ObjectId"===B._bsontype)N=w(t,F,B,N);else if(e.isBuffer(B))N=x(t,F,B,N);else if(B instanceof RegExp||d(B))N=_(t,F,B,N);else if("object"===j&&null==B._bsontype)N=S(t,F,B,N,i,a,l,L,!1,I);else if("object"===j&&"Decimal128"===B._bsontype)N=E(t,F,B,N);else if("Long"===B._bsontype||"Timestamp"===B._bsontype)N=A(t,F,B,N);else if("Double"===B._bsontype)N=C(t,F,B,N);else if("Code"===B._bsontype)N=O(t,F,B,N,i,a,l,L);else if("function"==typeof B&&l)N=M(t,F,B,N,0,0,l);else if("Binary"===B._bsontype)N=P(t,F,B,N);else if("Symbol"===B._bsontype)N=D(t,F,B,N);else if("DBRef"===B._bsontype)N=R(t,F,B,N,a,l);else if("BSONRegExp"===B._bsontype)N=v(t,F,B,N);else if("Int32"===B._bsontype)N=T(t,F,B,N);else if("MinKey"===B._bsontype||"MaxKey"===B._bsontype)N=b(t,F,B,N);else if(void 0!==B._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+B._bsontype)}}}else{if(n.toBSON){if("function"!=typeof n.toBSON)throw new Error("toBSON is not a function");if(null!=(n=n.toBSON())&&"object"!==r(n))throw new Error("toBSON function did not return an object")}for(F in n){if((B=n[F])&&B.toBSON){if("function"!=typeof B.toBSON)throw new Error("toBSON is not a function");B=B.toBSON()}if(j=r(B),"string"==typeof F&&-1===u.indexOf(F)){if(null!=F.match(c))throw Error("key "+F+" must not contain null bytes");if(i){if("$"===F[0])throw Error("key "+F+" must not start with '$'");if(~F.indexOf("."))throw Error("key "+F+" must not contain '.'")}}if("string"===j)N=f(t,F,B,N);else if("number"===j)N=p(t,F,B,N);else{if("bigint"===j)throw new TypeError("Unsupported type BigInt, please use Decimal128");if("boolean"===j)N=g(t,F,B,N);else if(B instanceof Date||h(B))N=y(t,F,B,N);else if(void 0===B)!1===L&&(N=m(t,F,0,N));else if(null===B)N=m(t,F,0,N);else if("ObjectID"===B._bsontype||"ObjectId"===B._bsontype)N=w(t,F,B,N);else if(e.isBuffer(B))N=x(t,F,B,N);else if(B instanceof RegExp||d(B))N=_(t,F,B,N);else if("object"===j&&null==B._bsontype)N=S(t,F,B,N,i,a,l,L,!1,I);else if("object"===j&&"Decimal128"===B._bsontype)N=E(t,F,B,N);else if("Long"===B._bsontype||"Timestamp"===B._bsontype)N=A(t,F,B,N);else if("Double"===B._bsontype)N=C(t,F,B,N);else if("Code"===B._bsontype)N=O(t,F,B,N,i,a,l,L);else if("function"==typeof B&&l)N=M(t,F,B,N,0,0,l);else if("Binary"===B._bsontype)N=P(t,F,B,N);else if("Symbol"===B._bsontype)N=D(t,F,B,N);else if("DBRef"===B._bsontype)N=R(t,F,B,N,a,l);else if("BSONRegExp"===B._bsontype)N=v(t,F,B,N);else if("Int32"===B._bsontype)N=T(t,F,B,N);else if("MinKey"===B._bsontype||"MaxKey"===B._bsontype)N=b(t,F,B,N);else if(void 0!==B._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+B._bsontype)}}}I.pop(),t[N++]=0;var $=N-s;return t[s++]=255&$,t[s++]=$>>8&255,t[s++]=$>>16&255,t[s++]=$>>24&255,N},I={BSON_DATA_NUMBER:1,BSON_DATA_STRING:2,BSON_DATA_OBJECT:3,BSON_DATA_ARRAY:4,BSON_DATA_BINARY:5,BSON_DATA_UNDEFINED:6,BSON_DATA_OID:7,BSON_DATA_BOOLEAN:8,BSON_DATA_DATE:9,BSON_DATA_NULL:10,BSON_DATA_REGEXP:11,BSON_DATA_CODE:13,BSON_DATA_SYMBOL:14,BSON_DATA_CODE_W_SCOPE:15,BSON_DATA_INT:16,BSON_DATA_TIMESTAMP:17,BSON_DATA_LONG:18,BSON_DATA_DECIMAL128:19,BSON_DATA_MIN_KEY:255,BSON_DATA_MAX_KEY:127,BSON_BINARY_SUBTYPE_DEFAULT:0,BSON_BINARY_SUBTYPE_FUNCTION:1,BSON_BINARY_SUBTYPE_BYTE_ARRAY:2,BSON_BINARY_SUBTYPE_UUID:3,BSON_BINARY_SUBTYPE_MD5:4,BSON_BINARY_SUBTYPE_USER_DEFINED:128,BSON_INT32_MAX:2147483647,BSON_INT32_MIN:-2147483648};I.BSON_INT64_MAX=Math.pow(2,63)-1,I.BSON_INT64_MIN=-Math.pow(2,63),I.JS_INT_MAX=9007199254740992,I.JS_INT_MIN=-9007199254740992,t.exports=L}).call(this,n(2).Buffer)},function(t,e){e.readIEEE754=function(t,e,n,r,i){var s,o,a="big"===n,l=8*i-r-1,c=(1<<l)-1,u=c>>1,h=-7,d=a?0:i-1,f=a?1:-1,p=t[e+d];for(d+=f,s=p&(1<<-h)-1,p>>=-h,h+=l;h>0;s=256*s+t[e+d],d+=f,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=r;h>0;o=256*o+t[e+d],d+=f,h-=8);if(0===s)s=1-u;else{if(s===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),s-=u}return(p?-1:1)*o*Math.pow(2,s-r)},e.writeIEEE754=function(t,e,n,r,i,s){var o,a,l,c="big"===r,u=8*s-i-1,h=(1<<u)-1,d=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=c?s-1:0,m=c?-1:1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=h?(a=0,o=h):o+d>=1?(a=(e*l-1)*Math.pow(2,i),o+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;t[n+p]=255&a,p+=m,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[n+p]=255&o,p+=m,o/=256,u-=8);t[n+p-m]|=128*g}},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(24).Long,s=n(39).Double,o=n(40).Timestamp,a=n(41).ObjectID,l=n(43).Symbol,c=n(42).BSONRegExp,u=n(44).Code,h=n(45),d=n(46).MinKey,f=n(47).MaxKey,p=n(48).DBRef,m=n(28).Binary,g=n(16).normalizedFunctionString,y=function(t,e,n){var r=5;if(Array.isArray(t))for(var i=0;i<t.length;i++)r+=_(i.toString(),t[i],e,!0,n);else for(var s in t.toBSON&&(t=t.toBSON()),t)r+=_(s,t[s],e,!1,n);return r};function _(t,n,_,b,w){switch(n&&n.toBSON&&(n=n.toBSON()),r(n)){case"string":return 1+e.byteLength(t,"utf8")+1+4+e.byteLength(n,"utf8")+1;case"number":return Math.floor(n)===n&&n>=v.JS_INT_MIN&&n<=v.JS_INT_MAX&&n>=v.BSON_INT32_MIN&&n<=v.BSON_INT32_MAX?(null!=t?e.byteLength(t,"utf8")+1:0)+5:(null!=t?e.byteLength(t,"utf8")+1:0)+9;case"undefined":return b||!w?(null!=t?e.byteLength(t,"utf8")+1:0)+1:0;case"boolean":return(null!=t?e.byteLength(t,"utf8")+1:0)+2;case"object":if(null==n||n instanceof d||n instanceof f||"MinKey"===n._bsontype||"MaxKey"===n._bsontype)return(null!=t?e.byteLength(t,"utf8")+1:0)+1;if(n instanceof a||"ObjectID"===n._bsontype||"ObjectId"===n._bsontype)return(null!=t?e.byteLength(t,"utf8")+1:0)+13;if(n instanceof Date||"object"===r(S=n)&&"[object Date]"===Object.prototype.toString.call(S))return(null!=t?e.byteLength(t,"utf8")+1:0)+9;if(void 0!==e&&e.isBuffer(n))return(null!=t?e.byteLength(t,"utf8")+1:0)+6+n.length;if(n instanceof i||n instanceof s||n instanceof o||"Long"===n._bsontype||"Double"===n._bsontype||"Timestamp"===n._bsontype)return(null!=t?e.byteLength(t,"utf8")+1:0)+9;if(n instanceof h||"Decimal128"===n._bsontype)return(null!=t?e.byteLength(t,"utf8")+1:0)+17;if(n instanceof u||"Code"===n._bsontype)return null!=n.scope&&Object.keys(n.scope).length>0?(null!=t?e.byteLength(t,"utf8")+1:0)+1+4+4+e.byteLength(n.code.toString(),"utf8")+1+y(n.scope,_,w):(null!=t?e.byteLength(t,"utf8")+1:0)+1+4+e.byteLength(n.code.toString(),"utf8")+1;if(n instanceof m||"Binary"===n._bsontype)return n.sub_type===m.SUBTYPE_BYTE_ARRAY?(null!=t?e.byteLength(t,"utf8")+1:0)+(n.position+1+4+1+4):(null!=t?e.byteLength(t,"utf8")+1:0)+(n.position+1+4+1);if(n instanceof l||"Symbol"===n._bsontype)return(null!=t?e.byteLength(t,"utf8")+1:0)+e.byteLength(n.value,"utf8")+4+1+1;if(n instanceof p||"DBRef"===n._bsontype){var x={$ref:n.namespace,$id:n.oid};return null!=n.db&&(x.$db=n.db),(null!=t?e.byteLength(t,"utf8")+1:0)+1+y(x,_,w)}return n instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(n)?(null!=t?e.byteLength(t,"utf8")+1:0)+1+e.byteLength(n.source,"utf8")+1+(n.global?1:0)+(n.ignoreCase?1:0)+(n.multiline?1:0)+1:n instanceof c||"BSONRegExp"===n._bsontype?(null!=t?e.byteLength(t,"utf8")+1:0)+1+e.byteLength(n.pattern,"utf8")+1+e.byteLength(n.options,"utf8")+1:(null!=t?e.byteLength(t,"utf8")+1:0)+y(n,_,w)+1;case"function":if(n instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(n)||"[object RegExp]"===String.call(n))return(null!=t?e.byteLength(t,"utf8")+1:0)+1+e.byteLength(n.source,"utf8")+1+(n.global?1:0)+(n.ignoreCase?1:0)+(n.multiline?1:0)+1;if(_&&null!=n.scope&&Object.keys(n.scope).length>0)return(null!=t?e.byteLength(t,"utf8")+1:0)+1+4+4+e.byteLength(g(n),"utf8")+1+y(n.scope,_,w);if(_)return(null!=t?e.byteLength(t,"utf8")+1:0)+1+4+e.byteLength(g(n),"utf8")+1}var S;return 0}var v={BSON_INT32_MAX:2147483647,BSON_INT32_MIN:-2147483648,JS_INT_MAX:9007199254740992,JS_INT_MIN:-9007199254740992};t.exports=y}).call(this,n(2).Buffer)},function(t,e,n){"use strict";t.exports=n(38).Decimal128},function(t,e,n){"use strict";var r=n(38).ObjectID;Object.defineProperty(r.prototype,"_id",{enumerable:!1,configurable:!0,get:function(){return this}}),t.exports=r},function(t,e,n){"use strict";t.exports=function(){}},function(t,e,n){"use strict";var r=n(112).ctor("require","modify","init","default","ignore");t.exports=function(){this.strictMode=void 0,this.selected=void 0,this.shardval=void 0,this.saveError=void 0,this.validationError=void 0,this.adhocPaths=void 0,this.removing=void 0,this.inserting=void 0,this.saving=void 0,this.version=void 0,this.getters={},this._id=void 0,this.populate=void 0,this.populated=void 0,this.wasPopulated=!1,this.scope=void 0,this.activePaths=new r,this.pathsToScopes={},this.cachedRequired={},this.session=null,this.$setCalled=new Set,this.ownerDocument=void 0,this.fullPath=void 0}},function(t,e,n){"use strict";var r=n(1),i=t.exports=function(){};i.ctor=function(){var t=r.args(arguments),e=function(){i.apply(this,arguments),this.paths={},this.states={},this.stateNames=t;for(var e=t.length;e--;)this.states[t[e]]={}};return e.prototype=new i,t.forEach(function(t){e.prototype[t]=function(e){this._changeState(e,t)}}),e},i.prototype._changeState=function(t,e){var n=this.states[this.paths[t]];n&&delete n[t],this.paths[t]=e,this.states[e][t]=!0},i.prototype.clear=function(t){for(var e,n=Object.keys(this.states[t]),r=n.length;r--;)delete this.states[t][e=n[r]],delete this.paths[e]},i.prototype.some=function(){var t=this,e=arguments.length?arguments:this.stateNames;return Array.prototype.some.call(e,function(e){return Object.keys(t.states[e]).length})},i.prototype._iter=function(t){return function(){var e=arguments.length,n=r.args(arguments,0,e-1),i=arguments[e-1];n.length||(n=this.stateNames);var s=this,o=n.reduce(function(t,e){return t.concat(Object.keys(s.states[e]))},[]);return o[t](function(t,e,n){return i(t,e,n)})}},i.prototype.forEach=function(){return this.forEach=this._iter("forEach"),this.forEach.apply(this,arguments)},i.prototype.map=function(){return this.map=this._iter("map"),this.map.apply(this,arguments)}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=1e3,i=6e4,s=60*i,o=24*s;function a(t,e,n,r){var i=e>=1.5*n;return Math.round(t/n)+" "+r+(i?"s":"")}t.exports=function(t,e){e=e||{};var l=n(t);if("string"===l&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===l&&isFinite(t))return e.long?function(t){var e=Math.abs(t);return e>=o?a(t,e,o,"day"):e>=s?a(t,e,s,"hour"):e>=i?a(t,e,i,"minute"):e>=r?a(t,e,r,"second"):t+" ms"}(t):function(t){var e=Math.abs(t);return e>=o?Math.round(t/o)+"d":e>=s?Math.round(t/s)+"h":e>=i?Math.round(t/i)+"m":e>=r?Math.round(t/r)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(115),s=["__proto__","constructor","prototype"];function o(t){return t}e.get=function(t,n,r,s){var a;"function"==typeof r&&(r.length<2?(s=r,r=void 0):(a=r,r=void 0)),s||(s=o);var l="string"==typeof t?i(t):t;if(!Array.isArray(l))throw new TypeError("Invalid `path`. Must be either string or array");for(var c,u=n,h=0;h<l.length;++h){if(c=l[h],Array.isArray(u)&&!/^\d+$/.test(c)){var d=l.slice(h);return[].concat(u).map(function(t){return t?e.get(d,t,r||a,s):s(void 0)})}if(a)u=a(u,c);else{var f=r&&u[r]?u[r]:u;u=f instanceof Map?f.get(c):f[c]}if(!u)return s(u)}return s(u)},e.has=function(t,e){var n="string"==typeof t?i(t):t;if(!Array.isArray(n))throw new TypeError("Invalid `path`. Must be either string or array");for(var s=n.length,o=e,a=0;a<s;++a){if(null==o||"object"!==r(o)||!(n[a]in o))return!1;o=o[n[a]]}return!0},e.unset=function(t,e){var n="string"==typeof t?i(t):t;if(!Array.isArray(n))throw new TypeError("Invalid `path`. Must be either string or array");for(var o=n.length,a=e,l=0;l<o;++l){if(null==a||"object"!==r(a)||!(n[l]in a))return!1;if(-1!==s.indexOf(n[l]))return!1;if(l===o-1)return delete a[n[l]],!0;a=a instanceof Map?a.get(n[l]):a[n[l]]}return!0},e.set=function(t,n,r,a,l,c){var u;"function"==typeof a&&(a.length<2?(l=a,a=void 0):(u=a,a=void 0)),l||(l=o);var h="string"==typeof t?i(t):t;if(!Array.isArray(h))throw new TypeError("Invalid `path`. Must be either string or array");if(null!=r){for(var d=0;d<h.length;++d)if(-1!==s.indexOf(h[d]))return;for(var f,p=c||/\$/.test(t)&&!1!==c,m=r,g=(d=0,h.length-1);d<g;++d)if("$"!=(f=h[d])){if(Array.isArray(m)&&!/^\d+$/.test(f)){var y=h.slice(d);if(!p&&Array.isArray(n))for(var _=0;_<m.length&&_<n.length;++_)e.set(y,n[_],m[_],a||u,l,p);else for(_=0;_<m.length;++_)e.set(y,n,m[_],a||u,l,p);return}if(u)m=u(m,f);else{var v=a&&m[a]?m[a]:m;m=v instanceof Map?v.get(f):v[f]}if(!m)return}else if(d==g-1)break;if(f=h[g],a&&m[a]&&(m=m[a]),Array.isArray(m)&&!/^\d+$/.test(f))if(!p&&Array.isArray(n))!function t(e,n,r,i,s,o){for(var a,l=0;l<e.length&&l<n.length;++l)a=e[l],Array.isArray(a)&&Array.isArray(n[l])?t(a,n[l],r,i,s,o):a&&(i?i(a,r,o(n[l])):(a[s]&&(a=a[s]),a[r]=o(n[l])))}(m,n,f,u,a,l);else for(_=0;_<m.length;++_){var b=m[_];b&&(u?u(b,f,l(n)):(b[a]&&(b=b[a]),b[f]=l(n)))}else u?u(m,f,l(n)):m instanceof Map?m.set(f,l(n)):m[f]=l(n)}}},function(t,e,n){"use strict";t.exports=function(t){for(var e=[],n="",r="DEFAULT",i=0;i<t.length;++i)"IN_SQUARE_BRACKETS"!==r||/\d/.test(t[i])||"]"===t[i]||(r="DEFAULT",n=e[e.length-1]+"["+n,e.splice(e.length-1,1)),"["===t[i]?("IMMEDIATELY_AFTER_SQUARE_BRACKETS"!==r&&(e.push(n),n=""),r="IN_SQUARE_BRACKETS"):"]"===t[i]?"IN_SQUARE_BRACKETS"===r?(r="IMMEDIATELY_AFTER_SQUARE_BRACKETS",e.push(n),n=""):(r="DEFAULT",n+=t[i]):"."===t[i]?("IMMEDIATELY_AFTER_SQUARE_BRACKETS"!==r&&(e.push(n),n=""),r="DEFAULT"):n+=t[i];return"IMMEDIATELY_AFTER_SQUARE_BRACKETS"!==r&&e.push(n),e}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(29);t.exports=function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._docs={},this._childDocs=[],null!=e&&(e=i(e),Object.assign(this,e),"object"===r(e.subPopulate)&&(this.populate=e.subPopulate),null!=e.perDocumentLimit&&null!=e.limit))throw new Error("Can not use `limit` and `perDocumentLimit` at the same time. Path: `"+e.path+"`.")}},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,l=o(t),c=1;c<arguments.length;c++){for(var u in n=Object(arguments[c]))i.call(n,u)&&(l[u]=n[u]);if(r){a=r(n);for(var h=0;h<a.length;h++)s.call(n,a[h])&&(l[a[h]]=n[a[h]])}}return l}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(62),s=n(23),o=n(4),a=n(68),l=n(121)("mquery");function c(t,e){if(!(this instanceof c))return new c(t,e);var n=this.constructor.prototype;this.op=n.op||void 0,this.options=Object.assign({},n.options),this._conditions=n._conditions?a.clone(n._conditions):{},this._fields=n._fields?a.clone(n._fields):void 0,this._update=n._update?a.clone(n._update):void 0,this._path=n._path||void 0,this._distinct=n._distinct||void 0,this._collection=n._collection||void 0,this._traceFunction=n._traceFunction||void 0,e&&this.setOptions(e),t&&(t.find&&t.remove&&t.update?this.collection(t):this.find(t))}var u="$geoWithin";Object.defineProperty(c,"use$geoWithin",{get:function(){return"$geoWithin"==u},set:function(t){u=!0===t?"$geoWithin":"$within"}}),c.prototype.toConstructor=function(){function t(e,n){if(!(this instanceof t))return new t(e,n);c.call(this,e,n)}a.inherits(t,c);var e=t.prototype;return e.options={},e.setOptions(this.options),e.op=this.op,e._conditions=a.clone(this._conditions),e._fields=a.clone(this._fields),e._update=a.clone(this._update),e._path=this._path,e._distinct=this._distinct,e._collection=this._collection,e._traceFunction=this._traceFunction,t},c.prototype.setOptions=function(t){if(!t||!a.isObject(t))return this;for(var e,n=a.keys(t),r=0;r<n.length;++r)if("function"==typeof this[e=n[r]]){var i=a.isArray(t[e])?t[e]:[t[e]];this[e].apply(this,i)}else this.options[e]=t[e];return this},c.prototype.collection=function(t){return this._collection=new c.Collection(t),this},c.prototype.collation=function(t){return this.options.collation=t,this},c.prototype.$where=function(t){return this._conditions.$where=t,this},c.prototype.where=function(){if(!arguments.length)return this;this.op||(this.op="find");var t=r(arguments[0]);if("string"==t)return this._path=arguments[0],2===arguments.length&&(this._conditions[this._path]=arguments[1]),this;if("object"==t&&!Array.isArray(arguments[0]))return this.merge(arguments[0]);throw new TypeError("path must be a string or object")},c.prototype.equals=function(t){return this._ensurePath("equals"),this._conditions[this._path]=t,this},c.prototype.eq=function(t){return this._ensurePath("eq"),this._conditions[this._path]=t,this},c.prototype.or=function(t){var e=this._conditions.$or||(this._conditions.$or=[]);return a.isArray(t)||(t=[t]),e.push.apply(e,t),this},c.prototype.nor=function(t){var e=this._conditions.$nor||(this._conditions.$nor=[]);return a.isArray(t)||(t=[t]),e.push.apply(e,t),this},c.prototype.and=function(t){var e=this._conditions.$and||(this._conditions.$and=[]);return Array.isArray(t)||(t=[t]),e.push.apply(e,t),this},"gt gte lt lte ne in nin all regex size maxDistance minDistance".split(" ").forEach(function(t){c.prototype[t]=function(){var e,n;1===arguments.length?(this._ensurePath(t),n=arguments[0],e=this._path):(n=arguments[1],e=arguments[0]);var i=null===this._conditions[e]||"object"===r(this._conditions[e])?this._conditions[e]:this._conditions[e]={};return i["$"+t]=n,this}}),c.prototype.mod=function(){var t,e;1===arguments.length?(this._ensurePath("mod"),t=arguments[0],e=this._path):2!==arguments.length||a.isArray(arguments[1])?3===arguments.length?(t=i(arguments,1),e=arguments[0]):(t=arguments[1],e=arguments[0]):(this._ensurePath("mod"),t=i(arguments),e=this._path);var n=this._conditions[e]||(this._conditions[e]={});return n.$mod=t,this},c.prototype.exists=function(){var t,e;0===arguments.length?(this._ensurePath("exists"),t=this._path,e=!0):1===arguments.length?"boolean"==typeof arguments[0]?(this._ensurePath("exists"),t=this._path,e=arguments[0]):(t=arguments[0],e=!0):2===arguments.length&&(t=arguments[0],e=arguments[1]);var n=this._conditions[t]||(this._conditions[t]={});return n.$exists=e,this},c.prototype.elemMatch=function(){if(null==arguments[0])throw new TypeError("Invalid argument");var t,e,n;if("function"==typeof arguments[0])this._ensurePath("elemMatch"),e=this._path,t=arguments[0];else if(a.isObject(arguments[0]))this._ensurePath("elemMatch"),e=this._path,n=arguments[0];else if("function"==typeof arguments[1])e=arguments[0],t=arguments[1];else{if(!arguments[1]||!a.isObject(arguments[1]))throw new TypeError("Invalid argument");e=arguments[0],n=arguments[1]}t&&(t(n=new c),n=n._conditions);var r=this._conditions[e]||(this._conditions[e]={});return r.$elemMatch=n,this},c.prototype.within=function(){if(this._ensurePath("within"),this._geoComparison=u,0===arguments.length)return this;if(2===arguments.length)return this.box.apply(this,arguments);if(2<arguments.length)return this.polygon.apply(this,arguments);var t=arguments[0];if(!t)throw new TypeError("Invalid argument");if(t.center)return this.circle(t);if(t.box)return this.box.apply(this,t.box);if(t.polygon)return this.polygon.apply(this,t.polygon);if(t.type&&t.coordinates)return this.geometry(t);throw new TypeError("Invalid argument")},c.prototype.box=function(){var t,e;if(3===arguments.length)t=arguments[0],e=[arguments[1],arguments[2]];else{if(2!==arguments.length)throw new TypeError("Invalid argument");this._ensurePath("box"),t=this._path,e=[arguments[0],arguments[1]]}var n=this._conditions[t]||(this._conditions[t]={});return n[this._geoComparison||u]={$box:e},this},c.prototype.polygon=function(){var t,e;"string"==typeof arguments[0]?(e=arguments[0],t=i(arguments,1)):(this._ensurePath("polygon"),e=this._path,t=i(arguments));var n=this._conditions[e]||(this._conditions[e]={});return n[this._geoComparison||u]={$polygon:t},this},c.prototype.circle=function(){var t,e;if(1===arguments.length)this._ensurePath("circle"),t=this._path,e=arguments[0];else{if(2!==arguments.length)throw new TypeError("Invalid argument");t=arguments[0],e=arguments[1]}if(!("radius"in e)||!e.center)throw new Error("center and radius are required");var n=this._conditions[t]||(this._conditions[t]={}),r=e.spherical?"$centerSphere":"$center",i=this._geoComparison||u;return n[i]={},n[i][r]=[e.center,e.radius],"unique"in e&&(n[i].$uniqueDocs=!!e.unique),this},c.prototype.near=function(){var t,e;if(this._geoComparison="$near",0===arguments.length)return this;if(1===arguments.length)this._ensurePath("near"),t=this._path,e=arguments[0];else{if(2!==arguments.length)throw new TypeError("Invalid argument");t=arguments[0],e=arguments[1]}if(!e.center)throw new Error("center is required");var n=this._conditions[t]||(this._conditions[t]={}),r=e.spherical?"$nearSphere":"$near";if(Array.isArray(e.center)){n[r]=e.center;var i="maxDistance"in e?e.maxDistance:null;null!=i&&(n.$maxDistance=i),null!=e.minDistance&&(n.$minDistance=e.minDistance)}else{if("Point"!=e.center.type||!Array.isArray(e.center.coordinates))throw new Error(o.format("Invalid GeoJSON specified for %s",r));n[r]={$geometry:e.center},"maxDistance"in e&&(n[r].$maxDistance=e.maxDistance),"minDistance"in e&&(n[r].$minDistance=e.minDistance)}return this},c.prototype.intersects=function(){if(this._ensurePath("intersects"),this._geoComparison="$geoIntersects",0===arguments.length)return this;var t=arguments[0];if(null!=t&&t.type&&t.coordinates)return this.geometry(t);throw new TypeError("Invalid argument")},c.prototype.geometry=function(){if("$within"!=this._geoComparison&&"$geoWithin"!=this._geoComparison&&"$near"!=this._geoComparison&&"$geoIntersects"!=this._geoComparison)throw new Error("geometry() must come after `within()`, `intersects()`, or `near()");var t,e;if(1!==arguments.length)throw new TypeError("Invalid argument");if(this._ensurePath("geometry"),e=this._path,!(t=arguments[0]).type||!Array.isArray(t.coordinates))throw new TypeError("Invalid argument");var n=this._conditions[e]||(this._conditions[e]={});return n[this._geoComparison]={$geometry:t},this},c.prototype.select=function(){var t=arguments[0];if(!t)return this;if(1!==arguments.length)throw new Error("Invalid select: select only takes 1 argument");this._validate("select");var e,n,i=this._fields||(this._fields={}),s=r(t);if(("string"==s||a.isArgumentsObject(t))&&"number"==typeof t.length||Array.isArray(t)){for("string"==s&&(t=t.split(/\s+/)),e=0,n=t.length;e<n;++e){var o=t[e];if(o){var l="-"==o[0]?0:1;0===l&&(o=o.substring(1)),i[o]=l}}return this}if(a.isObject(t)){var c=a.keys(t);for(e=0;e<c.length;++e)i[c[e]]=t[c[e]];return this}throw new TypeError("Invalid select() argument. Must be string or object.")},c.prototype.slice=function(){if(0===arguments.length)return this;var t,e;if(this._validate("slice"),1===arguments.length){var n=arguments[0];if("object"===r(n)&&!Array.isArray(n)){for(var s=Object.keys(n),o=s.length,a=0;a<o;++a)this.slice(s[a],n[s[a]]);return this}this._ensurePath("slice"),t=this._path,e=arguments[0]}else 2===arguments.length?"number"==typeof arguments[0]?(this._ensurePath("slice"),t=this._path,e=i(arguments)):(t=arguments[0],e=arguments[1]):3===arguments.length&&(t=arguments[0],e=i(arguments,1));var l=this._fields||(this._fields={});return l[t]={$slice:e},this},c.prototype.sort=function(t){if(!t)return this;var e,n,i;this._validate("sort");var s=r(t);if(Array.isArray(t)){for(n=t.length,e=0;e<t.length;++e){if(!Array.isArray(t[e]))throw new Error("Invalid sort() argument, must be array of arrays");f(this.options,t[e][0],t[e][1])}return this}if(1===arguments.length&&"string"==s){for(n=(t=t.split(/\s+/)).length,e=0;e<n;++e)if(i=t[e]){var o="-"==i[0]?-1:1;-1===o&&(i=i.substring(1)),d(this.options,i,o)}return this}if(a.isObject(t)){var l=a.keys(t);for(e=0;e<l.length;++e)d(this.options,i=l[e],t[i]);return this}if("undefined"!=typeof Map&&t instanceof Map)return p(this.options,t),this;throw new TypeError("Invalid sort() argument. Must be a string, object, or array.")};var h={1:1,"-1":-1,asc:1,ascending:1,desc:-1,descending:-1};function d(t,e,n){if(Array.isArray(t.sort))throw new TypeError("Can't mix sort syntaxes. Use either array or object:\n- `.sort([['field', 1], ['test', -1]])`\n- `.sort({ field: 1, test: -1 })`");var r;if(n&&n.$meta)(r=t.sort||(t.sort={}))[e]={$meta:n.$meta};else{r=t.sort||(t.sort={});var i=String(n||1).toLowerCase();if(!(i=h[i]))throw new TypeError("Invalid sort value: { "+e+": "+n+" }");r[e]=i}}function f(t,e,n){if(t.sort=t.sort||[],!Array.isArray(t.sort))throw new TypeError("Can't mix sort syntaxes. Use either array or object:\n- `.sort([['field', 1], ['test', -1]])`\n- `.sort({ field: 1, test: -1 })`");var r=String(n||1).toLowerCase();if(!(r=h[r]))throw new TypeError("Invalid sort value: [ "+e+", "+n+" ]");t.sort.push([e,r])}function p(t,e){if(t.sort=t.sort||new Map,!(t.sort instanceof Map))throw new TypeError("Can't mix sort syntaxes. Use either array or object or map consistently");e.forEach(function(e,n){var r=String(e||1).toLowerCase();if(!(r=h[r]))throw new TypeError("Invalid sort value: < "+n+": "+e+" >");t.sort.set(n,r)})}function m(t,e,n,r,i,s,o){return t.op=e,c.canMerge(n)&&t.merge(n),r&&t._mergeUpdate(r),a.isObject(i)&&t.setOptions(i),s||o?!t._update||!t.options.overwrite&&0===a.keys(t._update).length?(o&&a.soon(o.bind(null,null,0)),t):(i=t._optionsForExec(),o||(i.safe=!1),n=t._conditions,r=t._updateForExec(),l("update",t._collection.collectionName,n,r,i),o=t._wrapCallback(e,o,{conditions:n,doc:r,options:i}),t._collection[e](n,r,i,a.tick(o)),t):t}["limit","skip","maxScan","batchSize","comment"].forEach(function(t){c.prototype[t]=function(e){return this._validate(t),this.options[t]=e,this}}),c.prototype.maxTime=c.prototype.maxTimeMS=function(t){return this._validate("maxTime"),this.options.maxTimeMS=t,this},c.prototype.snapshot=function(){return this._validate("snapshot"),this.options.snapshot=!arguments.length||!!arguments[0],this},c.prototype.hint=function(){if(0===arguments.length)return this;this._validate("hint");var t=arguments[0];if(a.isObject(t)){var e=this.options.hint||(this.options.hint={});for(var n in t)e[n]=t[n];return this}if("string"==typeof t)return this.options.hint=t,this;throw new TypeError("Invalid hint. "+t)},c.prototype.j=function(t){return this.options.j=t,this},c.prototype.slaveOk=function(t){return this.options.slaveOk=!arguments.length||!!t,this},c.prototype.read=c.prototype.setReadPreference=function(t){return arguments.length>1&&!c.prototype.read.deprecationWarningIssued&&(console.error("Deprecation warning: 'tags' argument is not supported anymore in Query.read() method. Please use mongodb.ReadPreference object instead."),c.prototype.read.deprecationWarningIssued=!0),this.options.readPreference=a.readPref(t),this},c.prototype.readConcern=c.prototype.r=function(t){return this.options.readConcern=a.readConcern(t),this},c.prototype.tailable=function(){return this._validate("tailable"),this.options.tailable=!arguments.length||!!arguments[0],this},c.prototype.writeConcern=c.prototype.w=function(t){return"object"===r(t)?(void 0!==t.j&&(this.options.j=t.j),void 0!==t.w&&(this.options.w=t.w),void 0!==t.wtimeout&&(this.options.wtimeout=t.wtimeout)):this.options.w="m"===t?"majority":t,this},c.prototype.wtimeout=c.prototype.wTimeout=function(t){return this.options.wtimeout=t,this},c.prototype.merge=function(t){if(!t)return this;if(!c.canMerge(t))throw new TypeError("Invalid argument. Expected instanceof mquery or plain object");return t instanceof c?(t._conditions&&a.merge(this._conditions,t._conditions),t._fields&&(this._fields||(this._fields={}),a.merge(this._fields,t._fields)),t.options&&(this.options||(this.options={}),a.merge(this.options,t.options)),t._update&&(this._update||(this._update={}),a.mergeClone(this._update,t._update)),t._distinct&&(this._distinct=t._distinct),this):(a.merge(this._conditions,t),this)},c.prototype.find=function(t,e){if(this.op="find","function"==typeof t?(e=t,t=void 0):c.canMerge(t)&&this.merge(t),!e)return this;var n=this._conditions,r=this._optionsForExec();return this.$useProjection?r.projection=this._fieldsForExec():r.fields=this._fieldsForExec(),l("find",this._collection.collectionName,n,r),e=this._wrapCallback("find",e,{conditions:n,options:r}),this._collection.find(n,r,a.tick(e)),this},c.prototype.cursor=function(t){if(this.op){if("find"!==this.op)throw new TypeError(".cursor only support .find method")}else this.find(t);var e=this._conditions,n=this._optionsForExec();return this.$useProjection?n.projection=this._fieldsForExec():n.fields=this._fieldsForExec(),l("findCursor",this._collection.collectionName,e,n),this._collection.findCursor(e,n)},c.prototype.findOne=function(t,e){if(this.op="findOne","function"==typeof t?(e=t,t=void 0):c.canMerge(t)&&this.merge(t),!e)return this;var n=this._conditions,r=this._optionsForExec();return this.$useProjection?r.projection=this._fieldsForExec():r.fields=this._fieldsForExec(),l("findOne",this._collection.collectionName,n,r),e=this._wrapCallback("findOne",e,{conditions:n,options:r}),this._collection.findOne(n,r,a.tick(e)),this},c.prototype.count=function(t,e){if(this.op="count",this._validate(),"function"==typeof t?(e=t,t=void 0):c.canMerge(t)&&this.merge(t),!e)return this;var n=this._conditions,r=this._optionsForExec();return l("count",this._collection.collectionName,n,r),e=this._wrapCallback("count",e,{conditions:n,options:r}),this._collection.count(n,r,a.tick(e)),this},c.prototype.distinct=function(t,e,n){if(this.op="distinct",this._validate(),!n){switch(r(e)){case"function":n=e,"string"==typeof t&&(e=t,t=void 0);break;case"undefined":case"string":break;default:throw new TypeError("Invalid `field` argument. Must be string or function")}switch(r(t)){case"function":n=t,t=e=void 0;break;case"string":e=t,t=void 0}}if("string"==typeof e&&(this._distinct=e),c.canMerge(t)&&this.merge(t),!n)return this;if(!this._distinct)throw new Error("No value for `distinct` has been declared");var i=this._conditions,s=this._optionsForExec();return l("distinct",this._collection.collectionName,i,s),n=this._wrapCallback("distinct",n,{conditions:i,options:s}),this._collection.distinct(this._distinct,i,s,a.tick(n)),this},c.prototype.update=function(t,e,n,i){var s;switch(arguments.length){case 3:"function"==typeof n&&(i=n,n=void 0);break;case 2:"function"==typeof e&&(i=e,e=t,t=void 0);break;case 1:switch(r(t)){case"function":i=t,t=n=e=void 0;break;case"boolean":s=t,t=void 0;break;default:e=t,t=n=void 0}}return m(this,"update",t,e,n,s,i)},c.prototype.updateMany=function(t,e,n,i){var s;switch(arguments.length){case 3:"function"==typeof n&&(i=n,n=void 0);break;case 2:"function"==typeof e&&(i=e,e=t,t=void 0);break;case 1:switch(r(t)){case"function":i=t,t=n=e=void 0;break;case"boolean":s=t,t=void 0;break;default:e=t,t=n=void 0}}return m(this,"updateMany",t,e,n,s,i)},c.prototype.updateOne=function(t,e,n,i){var s;switch(arguments.length){case 3:"function"==typeof n&&(i=n,n=void 0);break;case 2:"function"==typeof e&&(i=e,e=t,t=void 0);break;case 1:switch(r(t)){case"function":i=t,t=n=e=void 0;break;case"boolean":s=t,t=void 0;break;default:e=t,t=n=void 0}}return m(this,"updateOne",t,e,n,s,i)},c.prototype.replaceOne=function(t,e,n,i){var s;switch(arguments.length){case 3:"function"==typeof n&&(i=n,n=void 0);break;case 2:"function"==typeof e&&(i=e,e=t,t=void 0);break;case 1:switch(r(t)){case"function":i=t,t=n=e=void 0;break;case"boolean":s=t,t=void 0;break;default:e=t,t=n=void 0}}return this.setOptions({overwrite:!0}),m(this,"replaceOne",t,e,n,s,i)},c.prototype.remove=function(t,e){var n;if(this.op="remove","function"==typeof t?(e=t,t=void 0):c.canMerge(t)?this.merge(t):!0===t&&(n=t,t=void 0),!n&&!e)return this;var r=this._optionsForExec();e||(r.safe=!1);var i=this._conditions;return l("remove",this._collection.collectionName,i,r),e=this._wrapCallback("remove",e,{conditions:i,options:r}),this._collection.remove(i,r,a.tick(e)),this},c.prototype.deleteOne=function(t,e){var n;if(this.op="deleteOne","function"==typeof t?(e=t,t=void 0):c.canMerge(t)?this.merge(t):!0===t&&(n=t,t=void 0),!n&&!e)return this;var r=this._optionsForExec();e||(r.safe=!1),delete r.justOne;var i=this._conditions;return l("deleteOne",this._collection.collectionName,i,r),e=this._wrapCallback("deleteOne",e,{conditions:i,options:r}),this._collection.deleteOne(i,r,a.tick(e)),this},c.prototype.deleteMany=function(t,e){var n;if(this.op="deleteMany","function"==typeof t?(e=t,t=void 0):c.canMerge(t)?this.merge(t):!0===t&&(n=t,t=void 0),!n&&!e)return this;var r=this._optionsForExec();e||(r.safe=!1),delete r.justOne;var i=this._conditions;return l("deleteOne",this._collection.collectionName,i,r),e=this._wrapCallback("deleteOne",e,{conditions:i,options:r}),this._collection.deleteMany(i,r,a.tick(e)),this},c.prototype.findOneAndUpdate=function(t,e,n,r){switch(this.op="findOneAndUpdate",this._validate(),arguments.length){case 3:"function"==typeof n&&(r=n,n={});break;case 2:"function"==typeof e&&(r=e,e=t,t=void 0),n=void 0;break;case 1:"function"==typeof t?(r=t,t=n=e=void 0):(e=t,t=n=void 0)}return c.canMerge(t)&&this.merge(t),e&&this._mergeUpdate(e),n&&this.setOptions(n),r?this._findAndModify("update",r):this},c.prototype.findOneAndRemove=c.prototype.findOneAndDelete=function(t,e,n){return this.op="findOneAndRemove",this._validate(),"function"==typeof e?(n=e,e=void 0):"function"==typeof t&&(n=t,t=void 0),c.canMerge(t)&&this.merge(t),e&&this.setOptions(e),n?this._findAndModify("remove",n):this},c.prototype._findAndModify=function(t,e){s.equal("function",r(e));var n,i=this._optionsForExec();if("remove"==t)i.remove=!0;else if("new"in i||(i.new=!0),"upsert"in i||(i.upsert=!1),!(n=this._updateForExec())){if(!i.upsert)return this.findOne(e);n={$set:{}}}null!=this._fieldsForExec()&&(this.$useProjection?i.projection=this._fieldsForExec():i.fields=this._fieldsForExec());var o=this._conditions;return l("findAndModify",this._collection.collectionName,o,n,i),e=this._wrapCallback("findAndModify",e,{conditions:o,doc:n,options:i}),this._collection.findAndModify(o,n,i,a.tick(e)),this},c.prototype._wrapCallback=function(t,e,n){var r=this._traceFunction||c.traceFunction;if(r){n.collectionName=this._collection.collectionName;var i=r&&r.call(null,t,n,this),s=(new Date).getTime();return function(t,n){if(i){var r=(new Date).getTime()-s;i.call(null,t,n,r)}e&&e.apply(null,arguments)}}return e},c.prototype.setTraceFunction=function(t){return this._traceFunction=t,this},c.prototype.exec=function(t,e){switch(r(t)){case"function":e=t,t=null;break;case"string":this.op=t}s.ok(this.op,"Missing query type: (find, update, etc)"),"update"!=this.op&&"remove"!=this.op||e||(e=!0);var n=this;if("function"!=typeof e)return new c.Promise(function(t,e){n[n.op](function(n,r){n?e(n):t(r),t=e=null})});this[this.op](e)},c.prototype.thunk=function(){var t=this;return function(e){t.exec(e)}},c.prototype.then=function(t,e){var n=this;return new c.Promise(function(t,e){n.exec(function(n,r){n?e(n):t(r),t=e=null})}).then(t,e)},c.prototype.stream=function(t){if("find"!=this.op)throw new Error("stream() is only available for find");var e=this._conditions,n=this._optionsForExec();return this.$useProjection?n.projection=this._fieldsForExec():n.fields=this._fieldsForExec(),l("stream",this._collection.collectionName,e,n,t),this._collection.findStream(e,n,t)},c.prototype.selected=function(){return!!(this._fields&&Object.keys(this._fields).length>0)},c.prototype.selectedInclusively=function(){if(!this._fields)return!1;var t=Object.keys(this._fields);if(0===t.length)return!1;for(var e=0;e<t.length;++e){var n=t[e];if(0===this._fields[n])return!1;if(this._fields[n]&&"object"===r(this._fields[n])&&this._fields[n].$meta)return!1}return!0},c.prototype.selectedExclusively=function(){if(!this._fields)return!1;var t=Object.keys(this._fields);if(0===t.length)return!1;for(var e=0;e<t.length;++e)if(0===this._fields[t[e]])return!0;return!1},c.prototype._mergeUpdate=function(t){this._update||(this._update={}),t instanceof c?t._update&&a.mergeClone(this._update,t._update):a.mergeClone(this._update,t)},c.prototype._optionsForExec=function(){return a.clone(this.options)},c.prototype._fieldsForExec=function(){return a.clone(this._fields)},c.prototype._updateForExec=function(){for(var t=a.clone(this._update),e=a.keys(t),n=e.length,r={};n--;){var i=e[n];this.options.overwrite?r[i]=t[i]:"$"!==i[0]?(r.$set||(r.$set=t.$set?t.$set:{}),r.$set[i]=t[i],e.splice(n,1),~e.indexOf("$set")||e.push("$set")):"$set"===i&&r.$set||(r[i]=t[i])}return this._compiledUpdate=r,r},c.prototype._ensurePath=function(t){if(!this._path)throw new Error(t+"() must be used after where() when called with these arguments")},c.permissions=n(124),c._isPermitted=function(t,e){var n=c.permissions[e];return!n||!0!==n[t]},c.prototype._validate=function(t){var e,n;if(void 0===t){if("function"!=typeof(n=c.permissions[this.op]))return!0;e=n(this)}else c._isPermitted(t,this.op)||(e=t);if(e)throw new Error(e+" cannot be used with "+this.op)},c.canMerge=function(t){return t instanceof c||a.isObject(t)},c.setGlobalTraceFunction=function(t){c.traceFunction=t},c.utils=a,c.env=n(70),c.Collection=n(126),c.BaseCollection=n(31),c.Promise=n(128),t.exports=c},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,s,o,a,l=1,c={},u=!1,h=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){p(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?(o="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&p(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(o+e,"*")}):t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){s.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,r=function(t){var e=h.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(p,0,t)},d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[l]=i,r(l),l++},d.clearImmediate=f}function f(t){delete c[t]}function p(t){if(u)setTimeout(p,0,t);else{var e=c[t];if(e){u=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{f(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(10),n(11))},function(t,e,n){var r=n(2),i=r.Buffer;function s(t,e){for(var n in t)e[n]=t[n]}function o(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=o),s(i,o),o.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},o.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){(function(r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(122)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),n){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,s=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(s=i))}),t.splice(s,0,r)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=s,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(s())}).call(this,n(11))},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,s=i-(n||i);t.diff=s,t.prev=n,t.curr=i,n=i;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var l=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;l++;var i=e.formatters[r];return"function"==typeof i&&(n=i.call(t,o[l]),o.splice(l,1),l--),n}),e.formatArgs.call(t,o);var c=r.log||e.log||console.log.bind(console);c.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var s=e.instances[n];s.enabled=e.enabled(s.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(123),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=1e3,i=6e4,s=60*i,o=24*s;function a(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var l,c=n(t);if("string"===c&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===c&&!1===isNaN(t))return e.long?a(l=t,o,"day")||a(l,s,"hour")||a(l,i,"minute")||a(l,r,"second")||l+" ms":function(t){return t>=o?Math.round(t/o)+"d":t>=s?Math.round(t/s)+"h":t>=i?Math.round(t/i)+"m":t>=r?Math.round(t/r)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";var r=e;r.distinct=function(t){return t._fields&&Object.keys(t._fields).length>0?"field selection and slice":(Object.keys(r.distinct).every(function(n){return!t.options[n]||(e=n,!1)}),e);var e},r.distinct.select=r.distinct.slice=r.distinct.sort=r.distinct.limit=r.distinct.skip=r.distinct.batchSize=r.distinct.comment=r.distinct.maxScan=r.distinct.snapshot=r.distinct.hint=r.distinct.tailable=!0,r.findOneAndUpdate=r.findOneAndRemove=function(t){var e;return Object.keys(r.findOneAndUpdate).every(function(n){return!t.options[n]||(e=n,!1)}),e},r.findOneAndUpdate.limit=r.findOneAndUpdate.skip=r.findOneAndUpdate.batchSize=r.findOneAndUpdate.maxScan=r.findOneAndUpdate.snapshot=r.findOneAndUpdate.hint=r.findOneAndUpdate.tailable=r.findOneAndUpdate.comment=!0,r.count=function(t){return t._fields&&Object.keys(t._fields).length>0?"field selection and slice":(Object.keys(r.count).every(function(n){return!t.options[n]||(e=n,!1)}),e);var e},r.count.slice=r.count.batchSize=r.count.comment=r.count.maxScan=r.count.snapshot=r.count.tailable=!0},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var r=n(70);if("unknown"==r.type)throw new Error("Unknown environment");t.exports=n(r.isNode?127:31)},function(t,e,n){"use strict";var r=n(31);function i(t){this.collection=t,this.collectionName=t.collectionName}n(68).inherits(i,r),i.prototype.find=function(t,e,n){this.collection.find(t,e,function(t,e){if(t)return n(t);try{e.toArray(n)}catch(t){n(t)}})},i.prototype.findOne=function(t,e,n){this.collection.findOne(t,e,n)},i.prototype.count=function(t,e,n){this.collection.count(t,e,n)},i.prototype.distinct=function(t,e,n,r){this.collection.distinct(t,e,n,r)},i.prototype.update=function(t,e,n,r){this.collection.update(t,e,n,r)},i.prototype.updateMany=function(t,e,n,r){this.collection.updateMany(t,e,n,r)},i.prototype.updateOne=function(t,e,n,r){this.collection.updateOne(t,e,n,r)},i.prototype.replaceOne=function(t,e,n,r){this.collection.replaceOne(t,e,n,r)},i.prototype.deleteOne=function(t,e,n){this.collection.deleteOne(t,e,n)},i.prototype.deleteMany=function(t,e,n){this.collection.deleteMany(t,e,n)},i.prototype.remove=function(t,e,n){this.collection.remove(t,e,n)},i.prototype.findAndModify=function(t,e,n,r){var i=Array.isArray(n.sort)?n.sort:[];this.collection.findAndModify(t,i,e,n,r)},i.prototype.findStream=function(t,e,n){return this.collection.find(t,e).stream(n)},i.prototype.findCursor=function(t,e){return this.collection.find(t,e)},t.exports=i},function(t,e,n){(function(n,r,i){var s,o,a;function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}a=function(){return function t(e,n,r){function i(o,a){if(!n[o]){if(!e[o]){var l="function"==typeof _dereq_&&_dereq_;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){return i(e[o][1][t]||t)},u,u.exports,t,e,n,r)}return n[o].exports}for(var s="function"==typeof _dereq_&&_dereq_,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){var e=t._SomePromiseArray;function n(t){var n=new e(t),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}t.any=function(t){return n(t)},t.prototype.any=function(){return n(this)}}},{}],2:[function(t,e,r){"use strict";var i;try{throw new Error}catch(t){i=t}var s=t("./schedule"),o=t("./queue"),a=t("./util");function l(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=s}function c(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function u(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function h(t){this._normalQueue._pushOne(t),this._queueTick()}l.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},l.prototype.hasCustomScheduler=function(){return this._customScheduler},l.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},l.prototype.disableTrampolineIfNecessary=function(){a.hasDevTools&&(this._trampolineEnabled=!1)},l.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},l.prototype.fatalError=function(t,e){e?(n.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),n.exit(2)):this.throwLater(t)},l.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},a.hasDevTools?(l.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?c.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},l.prototype.invoke=function(t,e,n){this._trampolineEnabled?u.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},l.prototype.settlePromises=function(t){this._trampolineEnabled?h.call(this,t):this._schedule(function(){t._settlePromises()})}):(l.prototype.invokeLater=c,l.prototype.invoke=u,l.prototype.settlePromises=h),l.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),r=t.shift();e.call(n,r)}else e._settlePromises()}},l.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},l.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},l.prototype._reset=function(){this._isTickUsed=!1},e.exports=l,e.exports.firstLineError=i},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,s=function(t,e){this._reject(e)},o=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(s,s,null,this,t)},a=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},l=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(s){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var c=n(s),u=new t(e);u._propagateFrom(this,1);var h=this._target();if(u._setBoundTo(c),c instanceof t){var d={promiseRejectionQueued:!1,promise:u,target:h,bindingPromise:c};h._then(e,o,void 0,u,d),c._then(a,l,void 0,u,d),u._setOnCancel(c)}else u._resolveCallback(h);return u},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var i=t("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=r)}catch(t){}return i},e.exports=i},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),s=r(null);i[" size"]=s[" size"]=0}e.exports=function(e){var n=t("./util"),r=n.canEvaluate;function i(t){return function(t,r){var i;if(null!=t&&(i=t[r]),"function"!=typeof i){var s="Object "+n.classString(t)+" has no method '"+n.toString(r)+"'";throw new e.TypeError(s)}return i}(t,this.pop()).apply(t,this)}function s(t){return t[this]}function o(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(i,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e;if("number"==typeof t)e=o;else if(r){var n=(void 0)(t);e=null!==n?n:s}else e=s;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var s=t("./util"),o=s.tryCatch,a=s.errorObj,l=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(s.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=o(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),l.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=t("./es5").keys,i=n.tryCatch,s=n.errorObj;return function(t,o,a){return function(l){var c=a._boundValue();t:for(var u=0;u<t.length;++u){var h=t[u];if(h===Error||null!=h&&h.prototype instanceof Error){if(l instanceof h)return i(o).call(c,l)}else if("function"==typeof h){var d=i(h).call(c,l);if(d===s)return d;if(d)return i(o).call(c,l)}else if(n.isObject(l)){for(var f=r(h),p=0;p<f.length;++p){var m=f[p];if(h[m]!=l[m])continue t}return i(o).call(c,l)}}return e}}}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){var e=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},r.CapturedTrace=null,r.create=function(){if(e)return new r},r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=t.prototype._pushContext,s=t.prototype._popContext,o=t._peekContext,a=t.prototype._peekContext,l=t.prototype._promiseCreated;r.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=s,t._peekContext=o,t.prototype._peekContext=a,t.prototype._promiseCreated=l,e=!1},e=!0,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},r}},{}],9:[function(t,e,r){"use strict";e.exports=function(e,r){var i,s,o,a=e._getDomain,c=e._async,u=t("./errors").Warning,h=t("./util"),d=h.canAttachTrace,f=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,p=/\((?:timers\.js):\d+:\d+\)/,m=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,g=null,y=null,_=!1,v=!(0==h.env("BLUEBIRD_DEBUG")),b=!(0==h.env("BLUEBIRD_WARNINGS")||!v&&!h.env("BLUEBIRD_WARNINGS")),w=!(0==h.env("BLUEBIRD_LONG_STACK_TRACES")||!v&&!h.env("BLUEBIRD_LONG_STACK_TRACES")),x=0!=h.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(b||!!h.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout(function(){t._notifyUnhandledRejection()},1)}},e.prototype._notifyUnhandledRejectionIsHandled=function(){H("rejectionHandled",i,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),H("unhandledRejection",s,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return U(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var e=a();s="function"==typeof t?null===e?t:h.domainBind(e,t):void 0},e.onUnhandledRejectionHandled=function(t){var e=a();i="function"==typeof t?null===e?t:h.domainBind(e,t):void 0};var S=function(){};e.longStackTraces=function(){if(c.haveItemsQueued()&&!X.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!X.longStackTraces&&W()){var t=e.prototype._captureStackTrace,n=e.prototype._attachExtraTrace;X.longStackTraces=!0,S=function(){if(c.haveItemsQueued()&&!X.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=n,r.deactivateLongStackTraces(),c.enableTrampoline(),X.longStackTraces=!1},e.prototype._captureStackTrace=B,e.prototype._attachExtraTrace=j,r.activateLongStackTraces(),c.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return X.longStackTraces&&W()};var E=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return h.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!h.global.dispatchEvent(n)}}return"function"==typeof Event?(t=new Event("CustomEvent"),h.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!h.global.dispatchEvent(n)}):((t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),h.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!h.global.dispatchEvent(n)})}catch(t){}return function(){return!1}}(),A=h.isNode?function(){return n.emit.apply(n,arguments)}:h.global?function(t){var e="on"+t.toLowerCase(),n=h.global[e];return!!n&&(n.apply(h.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function T(t,e){return{promise:e}}var C={promiseCreated:T,promiseFulfilled:T,promiseRejected:T,promiseResolved:T,promiseCancelled:T,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:T},M=function(t){var e=!1;try{e=A.apply(null,arguments)}catch(t){c.throwLater(t),e=!0}var n=!1;try{n=E(t,C[t].apply(null,arguments))}catch(t){c.throwLater(t),n=!0}return n||e};function O(){return!1}function P(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+h.toString(t));r._attachCancellationCallback(t)})}catch(t){return t}}function D(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?h.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function R(){return this._onCancelField}function L(t){this._onCancelField=t}function I(){this._cancellationParent=void 0,this._onCancelField=void 0}function N(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&S()),"warnings"in t){var n=t.warnings;X.warnings=!!n,x=X.warnings,h.isObject(n)&&"wForgottenReturn"in n&&(x=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!X.cancellation){if(c.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=I,e.prototype._propagateFrom=N,e.prototype._onCancel=R,e.prototype._setOnCancel=L,e.prototype._attachCancellationCallback=D,e.prototype._execute=P,k=N,X.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!X.monitoring?(X.monitoring=!0,e.prototype._fireEvent=M):!t.monitoring&&X.monitoring&&(X.monitoring=!1,e.prototype._fireEvent=O)),e},e.prototype._fireEvent=O,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var k=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)};function F(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function B(){this._trace=new J(this._peekContext())}function j(t,e){if(d(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=z(t);h.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),h.notEnumerableProp(t,"__stackCleaned__",!0)}}}function U(t,n,r){if(X.warnings){var i,s=new u(t);if(n)r._attachExtraTrace(s);else if(X.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(s);else{var o=z(s);s.stack=o.message+"\n"+o.stack.join("\n")}M("warning",s)||$(s,"",!0)}}function V(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||g.test(r),s=i&&q(r);i&&!s&&(_&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function z(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||g.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:V(e)}}function $(t,e,n){var r;"undefined"!=typeof console&&(r=h.isObject(t)?e+y(t.stack,t):e+String(t),"function"==typeof o?o(r,n):"function"!=typeof console.log&&"object"!==l(console.log)||console.log(r))}function H(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(t){c.throwLater(t)}"unhandledRejection"===t?M(t,n,r)||i||$(n,"Unhandled rejection "):M(t,r)}function G(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{if(e=t&&"function"==typeof t.toString?t.toString():h.toString(t),/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){return t.length<41?t:t.substr(0,38)+"..."}(e)+">, no stack trace)"}function W(){return"function"==typeof K}var q=function(){return!1},Z=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function Y(t){var e=t.match(Z);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function J(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);K(this,J),e>32&&this.uncycle()}h.inherits(J,Error),r.CapturedTrace=J,J.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;for(r=(t=this._length=r)-1;r>=0;--r){var s=e[r].stack;void 0===n[s]&&(n[s]=r)}for(r=0;r<t;++r){var o=n[e[r].stack];if(void 0!==o&&o!==r){o>0&&(e[o-1]._parent=void 0,e[o-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var a=r>0?e[r-1]:this;o<t-1?(a._parent=e[o+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var l=a._length+1,c=r-2;c>=0;--c)e[c]._length=l,l++;return}}}},J.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=z(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(V(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,s=e[i],o=-1,a=r.length-1;a>=0;--a)if(r[a]===s){o=a;break}for(a=o;a>=0&&e[i]===r[a];--a)e.pop(),i--;e=r}}(r),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(r),h.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,r)),h.notEnumerableProp(t,"__stackCleaned__",!0)}};var K=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():G(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,g=t,y=e;var n=Error.captureStackTrace;return q=function(t){return f.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return g=/@/,y=e,_=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){r="stack"in t}return!("stack"in i)&&r&&"number"==typeof Error.stackTraceLimit?(g=t,y=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6}):(y=function(t,e){return"string"==typeof t?t:"object"!==l(e)&&"function"!=typeof e||void 0===e.name||void 0===e.message?G(e):e.toString()},null)}();"undefined"!=typeof console&&void 0!==console.warn&&(o=function(t){console.warn(t)},h.isNode&&n.stderr.isTTY?o=function(t,e){console.warn((e?"\x1b[33m":"\x1b[31m")+t+"\x1b[0m\n")}:h.isNode||"string"!=typeof(new Error).stack||(o=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var X={warnings:b,longStackTraces:!1,cancellation:!1,monitoring:!1};return w&&e.longStackTraces(),{longStackTraces:function(){return X.longStackTraces},warnings:function(){return X.warnings},cancellation:function(){return X.cancellation},monitoring:function(){return X.monitoring},propagateFromFunction:function(){return k},boundValueFunction:function(){return F},checkForgottenReturns:function(t,e,n,r,i){if(void 0===t&&null!==e&&x){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var s="",o="";if(e._trace){for(var a=e._trace.stack.split("\n"),l=V(a),c=l.length-1;c>=0;--c){var u=l[c];if(!p.test(u)){var h=u.match(m);h&&(s="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(l.length>0){var d=l[0];for(c=0;c<a.length;++c)if(a[c]===d){c>0&&(o="\n"+a[c-1]);break}}}r._warn("a promise was created in a "+n+"handler "+s+"but was not returned from it, see http://goo.gl/rRqMUw"+o,!0,e)}},setBounds:function(t,e){if(W()){for(var n,r,i=t.stack.split("\n"),s=e.stack.split("\n"),o=-1,a=-1,l=0;l<i.length;++l)if(c=Y(i[l])){n=c.fileName,o=c.line;break}for(l=0;l<s.length;++l){var c;if(c=Y(s[l])){r=c.fileName,a=c.line;break}}o<0||a<0||!n||!r||n!==r||o>=a||(q=function(t){if(f.test(t))return!0;var e=Y(t);return!!(e&&e.fileName===n&&o<=e.line&&e.line<=a)})}},warn:U,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),U(n)},CapturedTrace:J,fireDomEvent:E,fireGlobalEvent:A}}},{"./errors":12,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],r=function(){throw e};return this.caught(t,r)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();var i=function(){return r};return this.caught(n,i)}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.reduce,r=t.all;function i(){return r(this)}t.prototype.each=function(t){return n(this,t,e,0)._then(i,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,r){return n(t,r,e,0)._then(i,void 0,void 0,t,void 0)},t.mapSeries=function(t,r){return n(t,r,e,e)}}},{}],12:[function(t,e,n){"use strict";var r,i,s=t("./es5"),o=s.freeze,a=t("./util"),l=a.inherits,c=a.notEnumerableProp;function u(t,e){function n(r){if(!(this instanceof n))return new n(r);c(this,"message","string"==typeof r?r:e),c(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return l(n,Error),n}var h=u("Warning","warning"),d=u("CancellationError","cancellation error"),f=u("TimeoutError","timeout error"),p=u("AggregateError","aggregate error");try{r=TypeError,i=RangeError}catch(t){r=u("TypeError","type error"),i=u("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<m.length;++g)"function"==typeof Array.prototype[m[g]]&&(p.prototype[m[g]]=Array.prototype[m[g]]);s.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var y=0;function _(t){if(!(this instanceof _))return new _(t);c(this,"name","OperationalError"),c(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(c(this,"message",t.message),c(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}p.prototype.toString=function(){var t=Array(4*y+1).join(" "),e="\n"+t+"AggregateError of:\n";y++,t=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),s=0;s<i.length;++s)i[s]=t+i[s];e+=(r=i.join("\n"))+"\n"}return y--,e},l(_,Error);var v=Error.__BluebirdErrorTypes__;v||(v=o({CancellationError:d,TimeoutError:f,OperationalError:_,RejectionError:_,AggregateError:p}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:v,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:i,CancellationError:v.CancellationError,OperationalError:v.OperationalError,TimeoutError:v.TimeoutError,AggregateError:v.AggregateError,Warning:h}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,s={}.toString,o={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e};e.exports={isArray:function(t){try{return"[object Array]"===s.call(t)}catch(t){return!1}},keys:a,names:a,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return o}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),s=e.CancellationError,o=i.errorObj,a=t("./catch_filter")(r);function l(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function c(t){this.finallyHandler=t}function u(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function h(){return f.call(this,this.promise._target()._settledValue())}function d(t){if(!u(this,t))return o.e=t,o}function f(t){var i=this.promise,a=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?a.call(i._boundValue()):a.call(i._boundValue(),t);if(l===r)return l;if(void 0!==l){i._setReturnedNonUndefined();var f=n(l,i);if(f instanceof e){if(null!=this.cancelPromise){if(f._isCancelled()){var p=new s("late cancellation observer");return i._attachExtraTrace(p),o.e=p,o}f.isPending()&&f._attachCancellationCallback(new c(this))}return f._then(h,d,void 0,this,void 0)}}}return i.isRejected()?(u(this),o.e=t,o):(u(this),t)}return l.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){u(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new l(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,f,f)},e.prototype.tap=function(t){return this._passThrough(t,1,f)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,f);var r,s=new Array(n-1),o=0;for(r=0;r<n-1;++r){var l=arguments[r];if(!i.isObject(l))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+i.classString(l)));s[o++]=l}s.length=o;var c=arguments[r];return this._passThrough(a(s,c,this),1,void 0,f)},l}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,s,o){var a=t("./errors").TypeError,l=t("./util"),c=l.errorObj,u=l.tryCatch,h=[];function d(t,n,i,s){if(o.cancellation()){var a=new e(r),l=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return l}),a._captureStackTrace(),a._setOnCancel(this)}else(this._promise=new e(r))._captureStackTrace();this._stack=s,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(d,s),d.prototype._isResolved=function(){return null===this._promise},d.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},d.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=u(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=u(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},d.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=u(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},d.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=u(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},d.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},d.prototype._continue=function(t){var n=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var s=i(r,this._promise);if(s instanceof e||null!==(s=function(t,n,r){for(var s=0;s<n.length;++s){r._pushContext();var o=u(n[s])(t);if(r._popContext(),o===c){r._pushContext();var a=e.reject(c.e);return r._popContext(),a}var l=i(o,r);if(l instanceof e)return l}return null}(s,this._yieldHandlers,this._promise))){var o=(s=s._target())._bitField;0==(50397184&o)?(this._yieldedPromise=s,s._proxy(this,null)):0!=(33554432&o)?e._async.invoke(this._promiseFulfilled,this,s._value()):0!=(16777216&o)?e._async.invoke(this._promiseRejected,this,s._reason()):this._promiseCancelled()}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(t,e){if("function"!=typeof t)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=d,i=(new Error).stack;return function(){var e=t.apply(this,arguments),s=new r(void 0,void 0,n,i),o=s.promise();return s._generator=e,s._promiseFulfilled(void 0),o}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new a("expecting a function but got "+l.classString(t));h.push(t)},e.spawn=function(t){if(o.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new d(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,s,o){t("./util"),e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var r=[].slice.call(arguments);t&&r.pop();var i=new n(r).promise();return void 0!==t?i.spread(t):i}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,s,o){var a=e._getDomain,c=t("./util"),u=c.tryCatch,h=c.errorObj,d=e._async;function f(t,e,n,r){this.constructor$(t),this._promise._captureStackTrace();var i=a();this._callback=null===i?e:c.domainBind(i,e),this._preservedValues=r===s?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}function p(t,n,i,s){if("function"!=typeof n)return r("expecting a function but got "+c.classString(n));var o=0;if(void 0!==i){if("object"!==l(i)||null===i)return e.reject(new TypeError("options argument must be an object but it is "+c.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(i.concurrency)));o=i.concurrency}return new f(t,n,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,s).promise()}c.inherits(f,n),f.prototype._asyncInit=function(){this._init$(void 0,-2)},f.prototype._init=function(){},f.prototype._promiseFulfilled=function(t,n){var r=this._values,s=this.length(),a=this._preservedValues,l=this._limit;if(n<0){if(r[n=-1*n-1]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var c=this._promise,d=this._callback,f=c._boundValue();c._pushContext();var p=u(d).call(f,t,n,s),m=c._popContext();if(o.checkForgottenReturns(p,m,null!==a?"Promise.filter":"Promise.map",c),p===h)return this._reject(p.e),!0;var g=i(p,this._promise);if(g instanceof e){var y=(g=g._target())._bitField;if(0==(50397184&y))return l>=1&&this._inFlight++,r[n]=g,g._proxy(this,-1*(n+1)),!1;if(0==(33554432&y))return 0!=(16777216&y)?(this._reject(g._reason()),!0):(this._cancel(),!0);p=g._value()}r[n]=p}return++this._totalResolved>=s&&(null!==a?this._filter(r,a):this._resolve(r),!0)},f.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},f.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,s=0;s<n;++s)t[s]&&(r[i++]=e[s]);r.length=i,this._resolve(r)},f.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return p(this,t,e,null)},e.map=function(t,e,n,r){return p(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,s){var o=t("./util"),a=o.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+o.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),o=r._popContext();return s.checkForgottenReturns(i,o,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return i("expecting a function but got "+o.classString(t));var r,l=new e(n);if(l._captureStackTrace(),l._pushContext(),arguments.length>1){s.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],u=arguments[2];r=o.isArray(c)?a(t).apply(u,c):a(t).call(u,c)}else r=a(t)();var h=l._popContext();return s.checkForgottenReturns(r,h,"Promise.try",l),l._resolveFromSyncValue(r),l},e.prototype._resolveFromSyncValue=function(t){t===o.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";var r=t("./util"),i=r.maybeWrapAsError,s=t("./errors").OperationalError,o=t("./es5"),a=/^(?:name|message|stack|cause)$/;function l(t){var e;if(function(t){return t instanceof Error&&o.getPrototypeOf(t)===Error.prototype}(t)){(e=new s(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=o.keys(t),i=0;i<n.length;++i){var l=n[i];a.test(l)||(e[l]=t[l])}return e}return r.markAsOriginatingFromRejection(t),t}e.exports=function(t,e){return function(n,r){if(null!==t){if(n){var s=l(i(n));t._attachExtraTrace(s),t._reject(s)}else if(e){var o=[].slice.call(arguments,1);t._fulfill(o)}else t._fulfill(r);t=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=e._async,i=n.tryCatch,s=n.errorObj;function o(t,e){if(!n.isArray(t))return a.call(this,t,e);var o=i(e).apply(this._boundValue(),[null].concat(t));o===s&&r.throwLater(o.e)}function a(t,e){var n=this._boundValue(),o=void 0===t?i(e).call(n,null):i(e).call(n,null,t);o===s&&r.throwLater(o.e)}function l(t,e){if(!t){var n=new Error(t+"");n.cause=t,t=n}var o=i(e).call(this._boundValue(),t);o===s&&r.throwLater(o.e)}e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=a;void 0!==e&&Object(e).spread&&(n=o),this._then(n,l,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,r){"use strict";e.exports=function(){var r=function(){return new p("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},i=function(){return new O.PromiseInspection(this._target())},s=function(t){return O.reject(new p(t))};function o(){}var a,l={},c=t("./util");c.notEnumerableProp(O,"_getDomain",a=c.isNode?function(){var t=n.domain;return void 0===t&&(t=null),t}:function(){return null});var u=t("./es5"),h=t("./async"),d=new h;u.defineProperty(O,"_async",{value:d});var f=t("./errors"),p=O.TypeError=f.TypeError;O.RangeError=f.RangeError;var m=O.CancellationError=f.CancellationError;O.TimeoutError=f.TimeoutError,O.OperationalError=f.OperationalError,O.RejectionError=f.OperationalError,O.AggregateError=f.AggregateError;var g=function(){},y={},_={},v=t("./thenables")(O,g),b=t("./promise_array")(O,g,v,s,o),w=t("./context")(O),x=w.create,S=t("./debuggability")(O,w),E=t("./finally")(O,v,_),A=t("./catch_filter")(_),T=t("./nodeback"),C=c.errorObj,M=c.tryCatch;function O(t){t!==g&&function(t,e){if(null==t||t.constructor!==O)throw new p("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new p("expecting a function but got "+c.classString(e))}(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function P(t){this.promise._resolveCallback(t)}function D(t){this.promise._rejectCallback(t,!1)}function R(t){var e=new O(g);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return O.prototype.toString=function(){return"[object Promise]"},O.prototype.caught=O.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;n<e-1;++n){var o=arguments[n];if(!c.isObject(o))return s("Catch statement predicate: expecting an object but got "+c.classString(o));r[i++]=o}return r.length=i,this.then(void 0,A(r,t=arguments[n],this))}return this.then(void 0,t)},O.prototype.reflect=function(){return this._then(i,i,void 0,this,void 0)},O.prototype.then=function(t,e){if(S.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+c.classString(t);arguments.length>1&&(n+=", "+c.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},O.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},O.prototype.spread=function(t){return"function"!=typeof t?s("expecting a function but got "+c.classString(t)):this.all()._then(t,void 0,void 0,y,void 0)},O.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},O.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new b(this).promise()},O.prototype.error=function(t){return this.caught(c.originatesFromRejection,t)},O.getNewLibraryCopy=e.exports,O.is=function(t){return t instanceof O},O.fromNode=O.fromCallback=function(t){var e=new O(g);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=M(t)(T(e,n));return r===C&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},O.all=function(t){return new b(t).promise()},O.cast=function(t){var e=v(t);return e instanceof O||((e=new O(g))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},O.resolve=O.fulfilled=O.cast,O.reject=O.rejected=function(t){var e=new O(g);return e._captureStackTrace(),e._rejectCallback(t,!0),e},O.setScheduler=function(t){if("function"!=typeof t)throw new p("expecting a function but got "+c.classString(t));return d.setScheduler(t)},O.prototype._then=function(t,e,n,r,i){var s=void 0!==i,o=s?i:new O(g),l=this._target(),u=l._bitField;s||(o._propagateFrom(this,3),o._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&u)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,o));var h=a();if(0!=(50397184&u)){var f,p,y=l._settlePromiseCtx;0!=(33554432&u)?(p=l._rejectionHandler0,f=t):0!=(16777216&u)?(p=l._fulfillmentHandler0,f=e,l._unsetRejectionIsUnhandled()):(y=l._settlePromiseLateCancellationObserver,p=new m("late cancellation observer"),l._attachExtraTrace(p),f=e),d.invoke(y,l,{handler:null===h?f:"function"==typeof f&&c.domainBind(h,f),promise:o,receiver:r,value:p})}else l._addCallbacks(t,e,o,r,h);return o},O.prototype._length=function(){return 65535&this._bitField},O.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},O.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},O.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},O.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},O.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},O.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},O.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},O.prototype._isFinal=function(){return(4194304&this._bitField)>0},O.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},O.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},O.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},O.prototype._setAsyncGuaranteed=function(){d.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},O.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==l)return void 0===e&&this._isBound()?this._boundValue():e},O.prototype._promiseAt=function(t){return this[4*t-4+2]},O.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},O.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},O.prototype._boundValue=function(){},O.prototype._migrateCallback0=function(t){var e=t._fulfillmentHandler0,n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=l),this._addCallbacks(e,n,r,i,null)},O.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),s=t._receiverAt(e);void 0===s&&(s=l),this._addCallbacks(n,r,i,s,null)},O.prototype._addCallbacks=function(t,e,n,r,i){var s=this._length();if(s>=65531&&(s=0,this._setLength(0)),0===s)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:c.domainBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:c.domainBind(i,e));else{var o=4*s-4;this[o+2]=n,this[o+3]=r,"function"==typeof t&&(this[o+0]=null===i?t:c.domainBind(i,t)),"function"==typeof e&&(this[o+1]=null===i?e:c.domainBind(i,e))}return this._setLength(s+1),s},O.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},O.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(r(),!1);var n=v(t,this);if(!(n instanceof O))return this._fulfill(t);e&&this._propagateFrom(n,2);var i=n._target();if(i!==this){var s=i._bitField;if(0==(50397184&s)){var o=this._length();o>0&&i._migrateCallback0(this);for(var a=1;a<o;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!=(33554432&s))this._fulfill(i._value());else if(0!=(16777216&s))this._reject(i._reason());else{var l=new m("late cancellation observer");i._attachExtraTrace(l),this._reject(l)}}else this._reject(r())}},O.prototype._rejectCallback=function(t,e,n){var r=c.ensureErrorObject(t),i=r===t;if(!i&&!n&&S.warnings()){var s="a promise was rejected with a non-error: "+c.classString(t);this._warn(s,!0)}this._attachExtraTrace(r,!!e&&i),this._reject(t)},O.prototype._resolveFromExecutor=function(t){if(t!==g){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},O.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0==(65536&i)){var s;r._pushContext(),e===y?n&&"number"==typeof n.length?s=M(t).apply(this._boundValue(),n):(s=C).e=new p("cannot .spread() a non-array: "+c.classString(n)):s=M(t).call(e,n);var o=r._popContext();0==(65536&(i=r._bitField))&&(s===_?r._reject(n):s===C?r._rejectCallback(s.e,!1):(S.checkForgottenReturns(s,o,"",r,this),r._resolveCallback(s)))}},O.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},O.prototype._followee=function(){return this._rejectionHandler0},O.prototype._setFollowee=function(t){this._rejectionHandler0=t},O.prototype._settlePromise=function(t,e,n,r){var s=t instanceof O,a=this._bitField,l=0!=(134217728&a);0!=(65536&a)?(s&&t._invokeInternalOnCancel(),n instanceof E&&n.isFinallyHandler()?(n.cancelPromise=t,M(e).call(n,r)===C&&t._reject(C.e)):e===i?t._fulfill(i.call(n)):n instanceof o?n._promiseCancelled(t):s||t instanceof b?t._cancel():n.cancel()):"function"==typeof e?s?(l&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,r,t)):e.call(n,r,t):n instanceof o?n._isResolved()||(0!=(33554432&a)?n._promiseFulfilled(r,t):n._promiseRejected(r,t)):s&&(l&&t._setAsyncGuaranteed(),0!=(33554432&a)?t._fulfill(r):t._reject(r))},O.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,i=t.value;"function"==typeof e?n instanceof O?this._settlePromiseFromHandler(e,r,i,n):e.call(r,i,n):n instanceof O&&n._reject(i)},O.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},O.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},O.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},O.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=r();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():d.settlePromises(this))}},O.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return d.fatalError(t,c.isNode);(65535&e)>0?d.settlePromises(this):this._ensurePossibleRejectionHandled()}},O.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),s=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,s,e)}},O.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),s=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,s,e)}},O.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},O.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},O.defer=O.pending=function(){return S.deprecated("Promise.defer","new Promise"),{promise:new O(g),resolve:P,reject:D}},c.notEnumerableProp(O,"_makeSelfResolutionError",r),t("./method")(O,g,v,s,S),t("./bind")(O,g,v,S),t("./cancel")(O,b,s,S),t("./direct_resolve")(O),t("./synchronous_inspection")(O),t("./join")(O,b,v,g,d,a),O.Promise=O,O.version="3.5.1",t("./map.js")(O,b,s,v,g,S),t("./call_get.js")(O),t("./using.js")(O,s,v,x,g,S),t("./timers.js")(O,g,S),t("./generators.js")(O,s,g,v,o,S),t("./nodeify.js")(O),t("./promisify.js")(O,g),t("./props.js")(O,b,v,s),t("./race.js")(O,g,v,s),t("./reduce.js")(O,b,s,v,g,S),t("./settle.js")(O,b,S),t("./some.js")(O,b,s),t("./filter.js")(O,g),t("./each.js")(O,g),t("./any.js")(O),c.toFastProperties(O),c.toFastProperties(O.prototype),R({a:1}),R({b:2}),R({c:3}),R(1),R(function(){}),R(void 0),R(!1),R(new O(g)),S.setBounds(h.firstLineError,c.lastLineError),O}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,s){var o=t("./util");function a(t){var r=this._promise=new e(n);t instanceof e&&r._propagateFrom(t,3),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return o.inherits(a,s),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(n,s){var a=r(this._values,this._promise);if(a instanceof e){var l=(a=a._target())._bitField;if(this._values=a,0==(50397184&l))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,s);if(0==(33554432&l))return 0!=(16777216&l)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=o.asArray(a)))0!==a.length?this._iterate(a):-5===s?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(s));else{var c=i("expecting an array or an iterable object but got "+o.classString(a)).reason();this._promise._rejectCallback(c,!1)}},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,s=!1,o=null,a=0;a<n;++a){var l=r(t[a],i);o=l instanceof e?(l=l._target())._bitField:null,s?null!==o&&l.suppressUnhandledRejections():null!==o?0==(50397184&o)?(l._proxy(this,a),this._values[a]=l):s=0!=(33554432&o)?this._promiseFulfilled(l._value(),a):0!=(16777216&o)?this._promiseRejected(l._reason(),a):this._promiseCancelled(a):s=this._promiseFulfilled(l,a)}s||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){var r={},i=t("./util"),s=t("./nodeback"),o=i.withAppended,a=i.maybeWrapAsError,c=i.canEvaluate,u=t("./errors").TypeError,h={__isPromisified__:!0},d=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),f=function(t){return i.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function p(t){return!d.test(t)}function m(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function g(t,e,n){var r=i.getDataPropertyOrDefault(t,e+n,h);return!!r&&m(r)}function y(t,e,n,r){for(var s=i.inheritedDataKeys(t),o=[],a=0;a<s.length;++a){var l=s[a],c=t[l],h=r===f||f(l);"function"!=typeof c||m(c)||g(t,l,e)||!r(l,c,t,h)||o.push(l,c)}return function(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var s=i.replace(n,""),o=0;o<t.length;o+=2)if(t[o]===s)throw new u("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}(o,e,n),o}var _=c?void 0:function(t,l,c,u,h,d){var f=function(){return this}(),p=t;function m(){var i=l;l===r&&(i=this);var c=new e(n);c._captureStackTrace();var u="string"==typeof p&&this!==f?this[p]:t,h=s(c,d);try{u.apply(i,o(arguments,h))}catch(t){c._rejectCallback(a(t),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return"string"==typeof p&&(t=u),i.notEnumerableProp(m,"__isPromisified__",!0),m};function v(t,e,n,s,o){for(var a=new RegExp(e.replace(/([$])/,"\\$")+"$"),l=y(t,e,a,n),c=0,u=l.length;c<u;c+=2){var h=l[c],d=l[c+1],f=h+e;if(s===_)t[f]=_(h,r,h,d,e,o);else{var p=s(d,function(){return _(h,r,h,d,e,o)});i.notEnumerableProp(p,"__isPromisified__",!0),t[f]=p}}return i.toFastProperties(t),t}e.promisify=function(t,e){if("function"!=typeof t)throw new u("expecting a function but got "+i.classString(t));if(m(t))return t;var n=function(t,e,n){return _(t,e,void 0,t,null,n)}(t,void 0===(e=Object(e)).context?r:e.context,!!e.multiArgs);return i.copyDescriptors(t,n,p),n},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!==l(t))throw new u("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,r=e.suffix;"string"!=typeof r&&(r="Async");var s=e.filter;"function"!=typeof s&&(s=f);var o=e.promisifier;if("function"!=typeof o&&(o=_),!i.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=i.inheritedDataKeys(t),c=0;c<a.length;++c){var h=t[a[c]];"constructor"!==a[c]&&i.isClass(h)&&(v(h.prototype,r,s,o,n),v(h,r,s,o,n))}return v(t,r,s,o,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var s,o=t("./util"),a=o.isObject,l=t("./es5");"function"==typeof Map&&(s=Map);var c=function(){var t=0,e=0;function n(n,r){this[t]=n,this[t+e]=r,t++}return function(r){e=r.size,t=0;var i=new Array(2*r.size);return r.forEach(n,i),i}}();function u(t){var e,n=!1;if(void 0!==s&&t instanceof s)e=c(t),n=!0;else{var r=l.keys(t),i=r.length;e=new Array(2*i);for(var o=0;o<i;++o){var a=r[o];e[o]=t[a],e[o+i]=a}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function h(t){var n,s=r(t);return a(s)?(n=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new u(s).promise(),s instanceof e&&n._propagateFrom(s,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}o.inherits(u,n),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(t){for(var e=new s,n=t.length/2|0,r=0;r<n;++r)e.set(t[n+r],t[r]);return e}(this._values);else{n={};for(var r=this.length(),i=0,o=this.length();i<o;++i)n[this._values[i+r]]=this._values[i]}return this._resolve(n),!0}return!1},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return h(this)},e.props=function(t){return h(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t){this._capacity=t,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var s=this._capacity-1;this[i+0&s]=t,this[i+1&s]=e,this[i+2&s]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,n,r,i){for(var s=0;s<i;++s)n[s+r]=t[s+0],t[s+0]=void 0}(this,0,this,e,this._front+this._length&e-1)},e.exports=r},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var s=t("./util");function o(t,a){var l,c=r(t);if(c instanceof e)return(l=c).then(function(t){return o(t,l)});if(null===(t=s.asArray(t)))return i("expecting an array or an iterable object but got "+s.classString(t));var u=new e(n);void 0!==a&&u._propagateFrom(a,3);for(var h=u._fulfill,d=u._reject,f=0,p=t.length;f<p;++f){var m=t[f];(void 0!==m||f in t)&&e.cast(m)._then(h,d,void 0,u,null)}return u}e.race=function(t){return o(t,void 0)},e.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,s,o){var a=e._getDomain,l=t("./util"),c=l.tryCatch;function u(t,n,r,i){this.constructor$(t);var o=a();this._fn=null===o?n:l.domainBind(o,n),void 0!==r&&(r=e.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=i===s?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function h(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function d(t,e,n,i){return"function"!=typeof e?r("expecting a function but got "+l.classString(e)):new u(t,e,n,i).promise()}function f(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(p,void 0,void 0,this,void 0)):p.call(this,n)}function p(t){var n,r=this.array,i=r._promise,s=c(r._fn);i._pushContext(),(n=void 0!==r._eachValues?s.call(i._boundValue(),t,this.index,this.length):s.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(r._currentCancellable=n);var a=i._popContext();return o.checkForgottenReturns(n,a,void 0!==r._eachValues?"Promise.each":"Promise.reduce",i),n}l.inherits(u,n),u.prototype._gotAccum=function(t){null!=this._eachValues&&t!==s&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},u.prototype._iterate=function(t){var n,r;this._values=t;var i=t.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<i;++r)n=n._then(f,void 0,void 0,{accum:null,value:t[r],index:r,length:i,array:this},void 0);void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(h,h,void 0,n,this)},e.prototype.reduce=function(t,e){return d(this,t,e,null)},e.reduce=function(t,e,n,r){return d(t,e,n,r)}}},{"./util":36}],29:[function(t,e,s){"use strict";var o,a,l,c,u,h=t("./util"),d=h.getNativePromise();if(h.isNode&&"undefined"==typeof MutationObserver){var f=r.setImmediate,p=n.nextTick;o=h.isRecentNode?function(t){f.call(r,t)}:function(t){p.call(n,t)}}else if("function"==typeof d&&"function"==typeof d.resolve){var m=d.resolve();o=function(t){m.then(t)}}else o="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?void 0!==i?function(t){i(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(a=document.createElement("div"),l={attributes:!0},c=!1,u=document.createElement("div"),new MutationObserver(function(){a.classList.toggle("foo"),c=!1}).observe(u,l),function(t){var e=new MutationObserver(function(){e.disconnect(),t()});e.observe(a,l),c||(c=!0,u.classList.toggle("foo"))});e.exports=o},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=e.PromiseInspection;function s(t){this.constructor$(t)}t("./util").inherits(s,n),s.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseFulfilled=function(t,e){var n=new i;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},s.prototype._promiseRejected=function(t,e){var n=new i;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new s(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),s=t("./errors").RangeError,o=t("./errors").AggregateError,a=i.isArray,l={};function c(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function u(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new c(t),i=n.promise();return n.setHowMany(e),n.init(),i}i.inherits(c,n),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=a(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(t){this._howMany=t},c.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new o,e=this.length();e<this._values.length;++e)this._values[e]!==l&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(t){this._values.push(t)},c.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(t){return new s("Input array must contain at least "+this._howMany+" items but contains only "+t+" items")},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return u(t,e)},e.prototype.some=function(t){return u(this,t)},e._SomePromiseArray=c}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},s=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},o=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return o.call(this._target())},t.prototype.isRejected=function(){return s.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){var r=t("./util"),i=r.errorObj,s=r.isObject,o={}.hasOwnProperty;return function(t,a){if(s(t)){if(t instanceof e)return t;var l=function(t){try{return function(t){return t.then}(t)}catch(t){return i.e=t,i}}(t);if(l===i){a&&a._pushContext();var c=e.reject(l.e);return a&&a._popContext(),c}if("function"==typeof l)return function(t){try{return o.call(t,"_promise0")}catch(t){return!1}}(t)?(c=new e(n),t._then(c._fulfill,c._reject,void 0,c,null),c):function(t,s,o){var a=new e(n),l=a;o&&o._pushContext(),a._captureStackTrace(),o&&o._popContext();var c=r.tryCatch(s).call(t,function(t){a&&(a._resolveCallback(t),a=null)},function(t){a&&(a._rejectCallback(t,!1,!0),a=null)});return a&&c===i&&(a._rejectCallback(c.e,!0,!0),a=null),l}(t,l,a)}return t}}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),s=e.TimeoutError;function o(t){this.handle=t}o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(t){return l(+this).thenReturn(t)},l=e.delay=function(t,i){var s,l;return void 0!==i?(s=e.resolve(i)._then(a,null,null,t,void 0),r.cancellation()&&i instanceof e&&s._setOnCancel(i)):(s=new e(n),l=setTimeout(function(){s._fulfill()},+t),r.cancellation()&&s._setOnCancel(new o(l)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};function c(t){return clearTimeout(this.handle),t}function u(t){throw clearTimeout(this.handle),t}e.prototype.delay=function(t){return l(t,this)},e.prototype.timeout=function(t,e){var n,a;t=+t;var l=new o(setTimeout(function(){n.isPending()&&function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new s("operation timed out"):new s(e),i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()}(n,e,a)},t));return r.cancellation()?(a=this.then(),(n=a._then(c,u,void 0,l,void 0))._setOnCancel(l)):n=this._then(c,u,void 0,l,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,s,o){var a=t("./util"),l=t("./errors").TypeError,c=t("./util").inherits,u=a.errorObj,h=a.tryCatch,d={};function f(t){setTimeout(function(){throw t},0)}function p(t,n){var i=0,o=t.length,a=new e(s);return function s(){if(i>=o)return a._fulfill();var l=function(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(t[i++]);if(l instanceof e&&l._isDisposable()){try{l=r(l._getDisposer().tryDispose(n),t.promise)}catch(t){return f(t)}if(l instanceof e)return l._then(s,f,null,null,null)}s()}(),a}function m(t,e,n){this._data=t,this._promise=e,this._context=n}function g(t,e,n){this.constructor$(t,e,n)}function y(t){return m.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function _(t){this.length=t,this.promise=null,this[t-1]=null}m.prototype.data=function(){return this._data},m.prototype.promise=function(){return this._promise},m.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():d},m.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==d?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},m.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},c(g,m),g.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},_.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var i,s=arguments[t-1];if("function"!=typeof s)return n("expecting a function but got "+a.classString(s));var l=!0;2===t&&Array.isArray(arguments[0])?(t=(i=arguments[0]).length,l=!1):(i=arguments,t--);for(var c=new _(t),d=0;d<t;++d){var f=i[d];if(m.isDisposer(f)){var g=f;(f=f.promise())._setDisposable(g)}else{var v=r(f);v instanceof e&&(f=v._then(y,null,null,{resources:c,index:d},void 0))}c[d]=f}var b=new Array(c.length);for(d=0;d<b.length;++d)b[d]=e.resolve(c[d]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return u.e=n.error(),u;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}x._pushContext(),s=h(s);var r=l?s.apply(void 0,t):s(t),i=x._popContext();return o.checkForgottenReturns(r,i,"Promise.using",x),r}),x=w.lastly(function(){var t=new e.PromiseInspection(w);return p(c,t)});return c.promise=x,x._setOnCancel(c),x},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new g(t,this,i());throw new l}}},{"./errors":12,"./util":36}],36:[function(t,e,i){"use strict";var s,o=t("./es5"),a="undefined"==typeof navigator,c={e:{}},u="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:void 0!==this?this:null;function h(){try{var t=s;return s=null,t.apply(this,arguments)}catch(t){return c.e=t,c}}function d(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function f(t,e,n){return d(t)||o.defineProperty(t,e,{value:n,configurable:!0,enumerable:!1,writable:!0}),t}var p=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(o.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var s;try{s=n(t)}catch(t){return r}for(var a=0;a<s.length;++a){var l=s[a];if(!i[l]){i[l]=!0;var c=Object.getOwnPropertyDescriptor(t,l);null!=c&&null==c.get&&null==c.set&&r.push(l)}}t=o.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var s in n)if(r.call(n,s))i.push(s);else{for(var o=0;o<t.length;++o)if(r.call(t[o],s))continue t;i.push(s)}return i}}(),m=/this\s*\.\s*\S+\s*=/,g=/^[a-z$_][a-z$_0-9]*$/i;function y(t){try{return t+""}catch(t){return"[no string representation]"}}function _(t){return t instanceof Error||null!==t&&"object"===l(t)&&"string"==typeof t.message&&"string"==typeof t.name}function v(t){return _(t)&&o.propertyIsWritable(t,"stack")}var b="stack"in new Error?function(t){return v(t)?t:new Error(y(t))}:function(t){if(v(t))return t;try{throw new Error(y(t))}catch(t){return t}};function w(t){return{}.toString.call(t)}var x=function(t){return o.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var S="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};x=function(t){return o.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?S(t):null}}var E,A=void 0!==n&&"[object process]"===w(n).toLowerCase(),T=void 0!==n&&void 0!==n.env,C={isClass:function(t){try{if("function"==typeof t){var e=o.names(t.prototype),n=o.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=m.test(t+"")&&o.names(t).length>0;if(n||r||i)return!0}return!1}catch(t){return!1}},isIdentifier:function(t){return g.test(t)},inheritedDataKeys:p,getDataPropertyOrDefault:function(t,e,n){if(!o.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0},thrower:function(t){throw t},isArray:o.isArray,asArray:x,notEnumerableProp:f,isPrimitive:d,isObject:function(t){return"function"==typeof t||"object"===l(t)&&null!==t},isError:_,canEvaluate:a,errorObj:c,tryCatch:function(t){return s=t,h},inherits:function(t,e){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=t,this.constructor$=e,e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}return r.prototype=e.prototype,t.prototype=new r,t.prototype},withAppended:function(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=t[n];return i[n]=e,i},maybeWrapAsError:function(t){return d(t)?new Error(y(t)):t},toFastProperties:function(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t},filledRange:function(t,e,n){for(var r=new Array(t),i=0;i<t;++i)r[i]=e+i+n;return r},toString:y,canAttachTrace:v,ensureErrorObject:b,originatesFromRejection:function(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)},markAsOriginatingFromRejection:function(t){try{f(t,"isOperational",!0)}catch(t){}},classString:w,copyDescriptors:function(t,e,n){for(var r=o.names(t),i=0;i<r.length;++i){var s=r[i];if(n(s))try{o.defineProperty(e,s,o.getDescriptor(t,s))}catch(t){}}},hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:A,hasEnvVariables:T,env:function(t){return T?n.env[t]:void 0},global:u,getNativePromise:function(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}},domainBind:function(t,e){return t.bind(e)}};C.isRecentNode=C.isNode&&(0===(E=n.versions.node.split(".").map(Number))[0]&&E[1]>10||E[0]>0),C.isNode&&C.toFastProperties(n);try{throw new Error}catch(t){C.lastLineError=t}e.exports=C},{"./es5":13}]},{},[4])(4)},"object"==l(e)&&void 0!==t?t.exports=a():void 0===(o="function"==typeof(s=a)?s.apply(e,[]):s)||(t.exports=o),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,n(11),n(10),n(69).setImmediate)},function(t,e,n){"use strict";var r=t.exports={};r.DocumentNotFoundError=null,r.general={},r.general.default="Validator failed for path `{PATH}` with value `{VALUE}`",r.general.required="Path `{PATH}` is required.",r.Number={},r.Number.min="Path `{PATH}` ({VALUE}) is less than minimum allowed value ({MIN}).",r.Number.max="Path `{PATH}` ({VALUE}) is more than maximum allowed value ({MAX}).",r.Number.enum="`{VALUE}` is not a valid enum value for path `{PATH}`.",r.Date={},r.Date.min="Path `{PATH}` ({VALUE}) is before minimum allowed value ({MIN}).",r.Date.max="Path `{PATH}` ({VALUE}) is after maximum allowed value ({MAX}).",r.String={},r.String.enum="`{VALUE}` is not a valid enum value for path `{PATH}`.",r.String.match="Path `{PATH}` is invalid ({VALUE}).",r.String.minlength="Path `{PATH}` (`{VALUE}`) is shorter than the minimum allowed length ({MINLENGTH}).",r.String.maxlength="Path `{PATH}` (`{VALUE}`) is longer than the maximum allowed length ({MAXLENGTH})."},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=n(5),l=n(4),c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t,r,i,s){var o,c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var u=a.messages;return c=null!=u.DocumentNotFoundError?"function"==typeof u.DocumentNotFoundError?u.DocumentNotFoundError(t,r):u.DocumentNotFoundError:'No document found for query "'+l.inspect(t)+'" on model "'+r+'"',(o=e.call(this,c)).result=s,o.numAffected=i,o.filter=t,o.query=t,o}return n}(a);Object.defineProperty(c.prototype,"name",{value:"DocumentNotFoundError"}),t.exports=c},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t,r,i){var s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var o=i.join(", ");return(s=e.call(this,'No matching document found for id "'+t._id+'" version '+r+' modifiedPaths "'+o+'"')).version=r,s.modifiedPaths=i,s}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"VersionError"}),t.exports=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"Can't save() the same doc multiple times in parallel. Document: "+t._id)}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"ParallelSaveError"}),t.exports=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"Cannot overwrite `"+t+"` model once compiled.")}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"OverwriteModelError"}),t.exports=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"Schema hasn't been registered for model \""+t+'".\nUse mongoose.model(name, schema)')}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"MissingSchemaError"}),t.exports=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var r="For your own good, using `document.save()` to update an array which was selected using an $elemMatch projection OR populated using skip, limit, query conditions, or exclusion of the _id field when the operation results in a $pop or $set of the entire array is not supported. The following path(s) would have been modified unsafely:\n  "+t.join("\n  ")+"\nUse Model.update() to update these arrays instead.";return e.call(this,r)}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"DivergentArrayError"}),t.exports=a},function(t,e,n){"use strict";var r=n(33);t.exports=function(t){var e,n;t.$immutable?(t.$immutableSetter=(e=t.path,n=t.options.immutable,function(t){if(null==this||null==this.$__)return t;if(this.isNew)return t;if(!("function"==typeof n?n.call(this,this):n))return t;var i=this.$__getValue(e);if("throw"===this.$__.strictMode&&t!==i)throw new r(e,"Path `"+e+"` is immutable and strict mode is set to throw.",!0);return i}),t.set(t.$immutableSetter)):t.$immutableSetter&&(t.setters=t.setters.filter(function(e){return e!==t.$immutableSetter}),delete t.$immutableSetter)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t,r,i){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,'Parameter "'+r+'" to '+i+"() must be an object, got "+t.toString())}return n}(n(5));Object.defineProperty(a.prototype,"name",{value:"ObjectParameterError"}),t.exports=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}(n);function n(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.call(this,"Can't validate() the same doc multiple times in parallel. Document: "+t._id)}return n}(n(14));Object.defineProperty(a.prototype,"name",{value:"ParallelValidateError"}),t.exports=a},function(t,e,n){"use strict";(function(e){function n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(){this._pres=new Map,this._posts=new Map}function o(t,e,n,r,i,s,o){return s.useErrorHandlers?t.execPost(n,r,i,{error:e},function(t){return"function"==typeof o&&o(t)}):"function"==typeof o?o(e):void 0}function a(t,e,n){return t.has(e)?t.get(e):n}function l(t,e,n,r){var i;try{i=t.apply(e,n)}catch(t){return r(t)}c(i)&&i.then(function(){return r()},function(t){return r(t)})}function c(t){return null!=t&&"function"==typeof t.then}function u(t){var n=!1,r=this;return function(){var i=arguments;if(!n)return n=!0,e.nextTick(function(){return t.apply(r,i)})}}s.prototype.execPre=function(t,n,r,i){3===arguments.length&&(i=r,r=[]);var s=a(this._pres,t,[]),o=s.length,h=s.numAsync||0,d=0,f=h,p=!1,m=r;if(!o)return e.nextTick(function(){i(null)});var g=function t(){if(!(d>=o)){var r=s[d];if(r.isAsync){var a=[u(y),u(function(t){if(t){if(p)return;return p=!0,i(t)}if(0==--f&&d>=o)return i(null)})];l(r.fn,n,a,a[0])}else if(r.fn.length>0){a=[u(y)];for(var h=arguments.length>=2?arguments:[null].concat(m),g=1;g<h.length;++g)a.push(h[g]);l(r.fn,n,a,a[0])}else{var _=null;try{_=r.fn.call(n)}catch(t){if(null!=t)return i(t)}if(c(_))_.then(function(){return y()},function(t){return y(t)});else{if(++d>=o)return f>0?void 0:e.nextTick(function(){i(null)});t()}}}};function y(t){if(t){if(p)return;return p=!0,i(t)}if(++d>=o)return f>0?void 0:i(null);g.apply(n,arguments)}g.apply(null,[null].concat(r))},s.prototype.execPreSync=function(t,e,n){for(var r=a(this._pres,t,[]),i=r.length,s=0;s<i;++s)r[s].fn.apply(e,n||[])},s.prototype.execPost=function(t,n,r,i,s){arguments.length<5&&(s=i,i=null);var o=a(this._posts,t,[]),h=o.length,d=0,f=null;if(i&&i.error&&(f=i.error),!h)return e.nextTick(function(){s.apply(null,[f].concat(r))});var p=function t(){for(var e=o[d].fn,i=0,a=r.length,p=[],m=0;m<a;++m)i+=r[m]&&r[m]._kareemIgnore?0:1,r[m]&&r[m]._kareemIgnore||p.push(r[m]);if(f)if(e.length===i+2){var g=u(function(e){if(e&&(f=e),++d>=h)return s.call(null,f);t()});l(e,n,[f].concat(p).concat([g]),g)}else{if(++d>=h)return s.call(null,f);t()}else{var y=u(function(e){return e?(f=e,t()):++d>=h?s.apply(null,[null].concat(r)):void t()});if(e.length===i+2)return++d>=h?s.apply(null,[null].concat(r)):t();if(e.length===i+1)l(e,n,p.concat([y]),y);else{var _,v;try{v=e.apply(n,p)}catch(t){_=t,f=t}if(c(v))return v.then(function(){return y()},function(t){return y(t)});if(++d>=h)return s.apply(null,[_].concat(r));t()}}};p()},s.prototype.execPostSync=function(t,e,n){for(var r=a(this._posts,t,[]),i=r.length,s=0;s<i;++s)r[s].fn.apply(e,n||[])},s.prototype.createWrapperSync=function(t,e){var n=this;return function(){n.execPreSync(t,this,arguments);var r=e.apply(this,arguments);return n.execPostSync(t,this,[r]),r}},s.prototype.wrap=function(t,e,n,r,i){var s=r.length>0?r[r.length-1]:null,a=("function"==typeof s&&r.slice(0,r.length-1),this),l=(i=i||{}).checkForPromise;this.execPre(t,n,r,function(c){if(c){for(var u=i.numCallbackParams||0,h=i.contextParameter?[n]:[],d=h.length;d<u;++d)h.push(null);return o(a,c,t,n,h,i,s)}var f="function"==typeof s?r.length-1:r.length,p=e.length,m=e.apply(n,r.slice(0,f).concat(g));if(l){if(null!=m&&"function"==typeof m.then)return m.then(function(t){return g(null,t)},function(t){return g(t)});if(p<f+1)return g(null,m)}function g(){var e=Array.prototype.slice.call(arguments,1);if(i.nullResultByDefault&&0===e.length&&e.push(null),arguments[0])return o(a,arguments[0],t,n,e,i,s);a.execPost(t,n,e,function(){return arguments[0]?"function"==typeof s?s(arguments[0]):void 0:"function"==typeof s?s.apply(n,arguments):void 0})}})},s.prototype.filter=function(t){for(var e=this,n=this.clone(),r=Array.from(n._pres.keys()),i=function(){var r=o[s],i=e._pres.get(r).map(function(t){return Object.assign({},t,{name:r})}).filter(t);if(0===i.length)return n._pres.delete(r),"continue";i.numAsync=i.filter(function(t){return t.isAsync}).length,n._pres.set(r,i)},s=0,o=r;s<o.length;s++)i();for(var a=Array.from(n._posts.keys()),l=function(){var r=u[c],i=e._posts.get(r).map(function(t){return Object.assign({},t,{name:r})}).filter(t);if(0===i.length)return n._posts.delete(r),"continue";n._posts.set(r,i)},c=0,u=a;c<u.length;c++)l();return n},s.prototype.hasHooks=function(t){return this._pres.has(t)||this._posts.has(t)},s.prototype.createWrapper=function(t,n,r,i){var s=this;return this.hasHooks(t)?function(){var e=r||this,o=Array.prototype.slice.call(arguments);s.wrap(t,n,e,o,i)}:function(){var t=arguments,r=this;e.nextTick(function(){return n.apply(r,t)})}},s.prototype.pre=function(t,e,n,r,s){var o={};"object"===i(e)&&null!=e?e=(o=e).isAsync:"boolean"!=typeof arguments[1]&&(r=n,n=e,e=!1);var l=a(this._pres,t,[]);if(this._pres.set(t,l),e&&(l.numAsync=l.numAsync||0,++l.numAsync),"function"!=typeof n)throw new Error('pre() requires a function, got "'+i(n)+'"');return s?l.unshift(Object.assign({},o,{fn:n,isAsync:e})):l.push(Object.assign({},o,{fn:n,isAsync:e})),this},s.prototype.post=function(t,e,n,r){var s=a(this._posts,t,[]);if("function"==typeof e&&(r=!!n,n=e,e={}),"function"!=typeof n)throw new Error('post() requires a function, got "'+i(n)+'"');return r?s.unshift(Object.assign({},e,{fn:n})):s.push(Object.assign({},e,{fn:n})),this._posts.set(t,s),this},s.prototype.clone=function(){var t,e=new s,r=n(this._pres.keys());try{for(r.s();!(t=r.n()).done;){var i=t.value,o=this._pres.get(i).slice();o.numAsync=this._pres.get(i).numAsync,e._pres.set(i,o)}}catch(t){r.e(t)}finally{r.f()}var a,l=n(this._posts.keys());try{for(l.s();!(a=l.n()).done;){var c=a.value;e._posts.set(c,this._posts.get(c).slice())}}catch(t){l.e(t)}finally{l.f()}return e},s.prototype.merge=function(t,e){var r,i=(e=1===arguments.length||e)?this.clone():this,s=n(t._pres.keys());try{var o=function(){var e=r.value,n=a(i._pres,e,[]),s=t._pres.get(e).filter(function(t){return-1===n.map(function(t){return t.fn}).indexOf(t.fn)}),o=n.concat(s);o.numAsync=n.numAsync||0,o.numAsync+=s.filter(function(t){return t.isAsync}).length,i._pres.set(e,o)};for(s.s();!(r=s.n()).done;)o()}catch(t){s.e(t)}finally{s.f()}var l,c=n(t._posts.keys());try{var u=function(){var e=l.value,n=a(i._posts,e,[]),r=t._posts.get(e).filter(function(t){return-1===n.indexOf(t)});i._posts.set(e,n.concat(r))};for(c.s();!(l=c.n()).done;)u()}catch(t){c.e(t)}finally{c.f()}return i},t.exports=s}).call(this,n(11))},function(t,e,n){"use strict";var r=n(9),i=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.assign(this,e),null!=e&&null!=e.options&&(this.options=Object.assign({},e.options))};Object.defineProperty(i.prototype,"ref",r),Object.defineProperty(i.prototype,"refPath",r),Object.defineProperty(i.prototype,"localField",r),Object.defineProperty(i.prototype,"foreignField",r),Object.defineProperty(i.prototype,"justOne",r),Object.defineProperty(i.prototype,"count",r),Object.defineProperty(i.prototype,"match",r),Object.defineProperty(i.prototype,"options",r),Object.defineProperty(i.prototype,"skip",r),Object.defineProperty(i.prototype,"limit",r),Object.defineProperty(i.prototype,"perDocumentLimit",r),t.exports=i},function(t,e,n){"use strict";var r=n(3),i=n(21);t.exports=function(t){var e=[],n=new WeakMap,s=t.constructor.indexTypes,o=new Map;return function t(a,l,c){if(!n.has(a)){n.set(a,!0),l=l||"";for(var u=0,h=Object.keys(a.paths);u<h.length;u++){var d=h[u],f=a.paths[d];if(null==c||!c.paths[d]){if(f.$isMongooseDocumentArray||f.$isSingleNested){if(!0!==r(f,"options.excludeIndexes")&&!0!==r(f,"schemaOptions.excludeIndexes")&&!0!==r(f,"schema.options.excludeIndexes")&&t(f.schema,l+d+"."),null!=f.schema.discriminators)for(var p=f.schema.discriminators,m=0,g=Object.keys(p);m<g.length;m++)t(p[g[m]],l+d+".",f.schema);if(f.$isMongooseDocumentArray)continue}var y=f._index||f.caster&&f.caster._index;if(!1!==y&&null!=y){var _={},v=i(y),b=v?y:{},w="string"==typeof y?y:!!v&&y.type;if(w&&-1!==s.indexOf(w))_[l+d]=w;else if(b.text)_[l+d]="text",delete b.text;else{var x=-1===Number(y);_[l+d]=x?-1:1}delete b.type,"background"in b||(b.background=!0),null!=a.options.autoIndex&&(b._autoIndex=a.options.autoIndex);var S=b&&b.name;"string"==typeof S&&o.has(S)?Object.assign(o.get(S),_):(e.push([_,b]),o.set(S,_))}}}n.delete(a),l?function(t,n){for(var r=t._indexes,i=r.length,s=0;s<i;++s){for(var o=r[s][0],a=r[s][1],l=Object.keys(o),c=l.length,u={},h=0;h<c;++h){var d=l[h];u[n+d]=o[d]}var f=Object.assign({},a);if(null!=a&&null!=a.partialFilterExpression){f.partialFilterExpression={};for(var p=a.partialFilterExpression,m=0,g=Object.keys(p);m<g.length;m++){var y=g[m];f.partialFilterExpression[n+y]=p[y]}}e.push([u,f])}}(a,l):(a._indexes.forEach(function(t){"background"in t[1]||(t[1].background=!0)}),e=e.concat(a._indexes))}}(t),e}},function(t,e,n){"use strict";var r=n(143),i=n(145),s=n(3),o=n(76),a=n(34);t.exports=function(t,e){var n=t.childSchemas.find(function(t){return!!t.schema.options.timestamps});if(e||n){var l=o(e,"createdAt"),c=o(e,"updatedAt"),u=null!=e&&e.hasOwnProperty("currentTime")?e.currentTime:null,h={};t.$timestamps={createdAt:l,updatedAt:c},c&&!t.paths[c]&&(h[c]=Date),l&&!t.paths[l]&&(h[l]=Date),t.add(h),t.pre("save",function(t){var e=s(this,"$__.saveOptions.timestamps");if(!1===e)return t();var n=null!=e&&!1===e.updatedAt,r=null!=e&&!1===e.createdAt,i=null!=u?u():(this.ownerDocument?this.ownerDocument():this).constructor.base.now(),o=this._id&&this._id.auto;if(!r&&l&&!this.get(l)&&this.$__isSelected(l)&&this.$set(l,o?this._id.getTimestamp():i),!n&&c&&(this.isNew||this.isModified())){var a=i;this.isNew&&(null!=l?a=this.$__getValue(l):o&&(a=this._id.getTimestamp())),this.$set(c,a)}t()}),t.methods.initializeTimestamps=function(){var t=null!=u?u():this.constructor.base.now();return l&&!this.get(l)&&this.$set(l,t),c&&!this.get(c)&&this.$set(c,t),this},f[a.builtInMiddleware]=!0;var d={query:!0,model:!1};t.pre("findOneAndReplace",d,f),t.pre("findOneAndUpdate",d,f),t.pre("replaceOne",d,f),t.pre("update",d,f),t.pre("updateOne",d,f),t.pre("updateMany",d,f)}function f(t){var e=null!=u?u():this.model.base.now();"findOneAndReplace"===this.op&&null==this.getUpdate()&&this.setUpdate({}),i(e,l,c,this.getUpdate(),this.options,this.schema),r(e,this.getUpdate(),this.model.schema),t()}}},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=n(144),o=n(76);function a(t,e,n){if(null!=e){if(Object.keys(e).some(function(t){return t.startsWith("$")})){if(e.$push)for(var i=0,s=Object.keys(e.$push);i<s.length;i++){var a=s[i],c=n.path(a);e.$push[a]&&c&&c.$isMongooseDocumentArray&&c.schema.options.timestamps&&function(){var n=c.schema.options.timestamps,r=o(n,"createdAt"),i=o(n,"updatedAt");e.$push[a].$each?e.$push[a].$each.forEach(function(e){null!=i&&(e[i]=t),null!=r&&(e[r]=t)}):(null!=i&&(e.$push[a][i]=t),null!=r&&(e.$push[a][r]=t))}()}if(null!=e.$set)for(var u=0,h=Object.keys(e.$set);u<h.length;u++)l(n,h[u],e.$set,t)}var d,f=r(Object.keys(e).filter(function(t){return!t.startsWith("$")}));try{for(f.s();!(d=f.n()).done;)l(n,d.value,e,t)}catch(t){f.e(t)}finally{f.f()}}}function l(t,e,n,i){var l=s(e),c=t.path(l);if(c){for(var u=[],h=l.split("."),d=h.length-1;d>0;--d){var f=t.path(h.slice(0,d).join("."));null!=f&&(f.$isMongooseDocumentArray||f.$isSingleNested)&&u.push({parentPath:e.split(".").slice(0,d).join("."),parentSchemaType:f})}if(Array.isArray(n[e])&&c.$isMongooseDocumentArray)!function(t,e,n){var r=e.schema.options.timestamps;if(r)for(var i=t.length,s=o(r,"createdAt"),l=o(r,"updatedAt"),c=0;c<i;++c)null!=l&&(t[c][l]=n),null!=s&&(t[c][s]=n),a(n,t[c],e.schema)}(n[e],c,i);else if(n[e]&&c.$isSingleNested)!function(t,e,n){var r=e.schema.options.timestamps;if(r){var i=o(r,"createdAt"),s=o(r,"updatedAt");null!=s&&(t[s]=n),null!=i&&(t[i]=n),a(n,t,e.schema)}}(n[e],c,i);else if(u.length>0){var p,m=r(u);try{for(m.s();!(p=m.n()).done;){var g=p.value,y=g.parentPath,_=g.parentSchemaType,v=_.schema.options.timestamps,b=o(v,"updatedAt");if(v&&null!=b)if(_.$isSingleNested)n[y+"."+b]=i;else if(_.$isMongooseDocumentArray){var w=e.substr(y.length+1);if(/^\d+$/.test(w)){n[y+"."+w][b]=i;continue}var x=w.indexOf(".");n[y+"."+(w=-1!==x?w.substr(0,x):w)+"."+b]=i}}}catch(t){m.e(t)}finally{m.f()}}else if(null!=c.schema&&c.schema!=t&&n[e]){var S=c.schema.options.timestamps,E=o(S,"createdAt"),A=o(S,"updatedAt");if(!S)return;null!=A&&(n[e][A]=i),null!=E&&(n[e][E]=i)}}}t.exports=a},function(t,e,n){"use strict";t.exports=function(t){return t.replace(/\.\$(\[[^\]]*\])?(?=\.)/g,".0").replace(/\.\$(\[[^\]]*\])?$/g,".0")}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e,n,i,s){var o=i,a=o,l=r(s,"overwrite",!1),c=r(s,"timestamps",!0);if(!c||null==o)return i;var u=null!=c&&!1===c.createdAt,h=null!=c&&!1===c.updatedAt;if(l)return i&&i.$set&&(i=i.$set,o.$set={},a=o.$set),h||!n||i[n]||(a[n]=t),u||!e||i[e]||(a[e]=t),o;if(i=i||{},Array.isArray(o))return o.push({$set:{updatedAt:t}}),o;if(o.$set=o.$set||{},!h&&n&&(!i.$currentDate||!i.$currentDate[n])){var d=!1;if(-1!==n.indexOf("."))for(var f=n.split("."),p=1;p<f.length;++p){var m=f.slice(-p).join("."),g=f.slice(0,-p).join(".");if(null!=i[g]){i[g][m]=t,d=!0;break}if(i.$set&&i.$set[g]){i.$set[g][m]=t,d=!0;break}}d||(o.$set[n]=t),o.hasOwnProperty(n)&&delete o[n]}if(!u&&e){i[e]&&delete i[e],i.$set&&i.$set[e]&&delete i.$set[e];var y=!1;if(-1!==e.indexOf("."))for(var _=e.split("."),v=1;v<_.length;++v){var b=_.slice(-v).join("."),w=_.slice(0,-v).join(".");if(null!=i[w]){i[w][b]=t,y=!0;break}if(i.$set&&i.$set[w]){i.$set[w][b]=t,y=!0;break}}y||(o.$setOnInsert=o.$setOnInsert||{},o.$setOnInsert[e]=t)}return 0===Object.keys(o.$set).length&&delete o.$set,o}},function(t,e,n){"use strict";var r=n(14),i=n(4);t.exports=function(t,e){if("string"!=typeof t&&"function"!=typeof t)throw new r('Invalid ref at path "'+e+'". Got '+i.inspect(t,{depth:0}))}},function(t,e,n){"use strict";function r(t,e){var n={useErrorHandlers:!0,numCallbackParams:1,nullResultByDefault:!0},i=e.hooks.filter(function(t){var e=function(t){var e={};return t.hasOwnProperty("query")&&(e.query=t.query),t.hasOwnProperty("document")&&(e.document=t.document),e}(t);return"updateOne"===t.name?null==e.query||!!e.query:"deleteOne"===t.name?!!e.query||0===Object.keys(e).length:"validate"===t.name||"remove"===t.name?!!e.query:null==t.query&&null==t.document||!!t.query});t.prototype._execUpdate=i.createWrapper("update",t.prototype._execUpdate,null,n),t.prototype.__distinct=i.createWrapper("distinct",t.prototype.__distinct,null,n),t.prototype.validate=i.createWrapper("validate",t.prototype.validate,null,n),r.middlewareFunctions.filter(function(t){return"update"!==t&&"distinct"!==t&&"validate"!==t}).forEach(function(e){t.prototype["_".concat(e)]=i.createWrapper(e,t.prototype["_".concat(e)],null,n)})}t.exports=r,r.middlewareFunctions=["count","countDocuments","deleteMany","deleteOne","distinct","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndRemove","findOneAndReplace","findOneAndUpdate","remove","replaceOne","update","updateMany","updateOne","validate"]},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=n(6),o=n(5),a=n(149),l=n(78),c=n(1),u=s.CastError;function h(t,e){this.enumValues=[],this.regExp=null,s.call(this,t,e,"String")}function d(t){return this.castForQuery(t)}h.schemaName="String",h.defaultOptions={},(h.prototype=Object.create(s.prototype)).constructor=h,Object.defineProperty(h.prototype,"OptionsConstructor",{configurable:!1,enumerable:!1,writable:!1,value:a}),h._cast=l,h.cast=function(t){return 0===arguments.length||(!1===t&&(t=this._defaultCaster),this._cast=t),this._cast},h._defaultCaster=function(t){if(null!=t&&"string"!=typeof t)throw new Error;return t},h.get=s.get,h.set=s.set,h._checkRequired=function(t){return(t instanceof String||"string"==typeof t)&&t.length},h.checkRequired=s.checkRequired,h.prototype.enum=function(){if(this.enumValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.enumValidator},this),this.enumValidator=!1),void 0===arguments[0]||!1===arguments[0])return this;var t,e;c.isObject(arguments[0])?Array.isArray(arguments[0].values)?(t=arguments[0].values,e=arguments[0].message):(t=c.object.vals(arguments[0]),e=o.messages.String.enum):(t=arguments,e=o.messages.String.enum);var n,i=r(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;void 0!==s&&this.enumValues.push(this.cast(s))}}catch(t){i.e(t)}finally{i.f()}var a=this.enumValues;return this.enumValidator=function(t){return void 0===t||~a.indexOf(t)},this.validators.push({validator:this.enumValidator,message:e,type:"enum",enumValues:a}),this},h.prototype.lowercase=function(t){return arguments.length>0&&!t?this:this.set(function(t,e){return"string"!=typeof t&&(t=e.cast(t)),t?t.toLowerCase():t})},h.prototype.uppercase=function(t){return arguments.length>0&&!t?this:this.set(function(t,e){return"string"!=typeof t&&(t=e.cast(t)),t?t.toUpperCase():t})},h.prototype.trim=function(t){return arguments.length>0&&!t?this:this.set(function(t,e){return"string"!=typeof t&&(t=e.cast(t)),t?t.trim():t})},h.prototype.minLength=h.prototype.minlength=function(t,e){if(this.minlengthValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.minlengthValidator},this)),null!=t){var n=e||o.messages.String.minlength;n=n.replace(/{MINLENGTH}/,t),this.validators.push({validator:this.minlengthValidator=function(e){return null===e||e.length>=t},message:n,type:"minlength",minlength:t})}return this},h.prototype.maxLength=h.prototype.maxlength=function(t,e){if(this.maxlengthValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.maxlengthValidator},this)),null!=t){var n=e||o.messages.String.maxlength;n=n.replace(/{MAXLENGTH}/,t),this.validators.push({validator:this.maxlengthValidator=function(e){return null===e||e.length<=t},message:n,type:"maxlength",maxlength:t})}return this},h.prototype.match=function(t,e){return this.validators.push({validator:function(e){return!!t&&(t.lastIndex=0,null==e||""===e||t.test(e))},message:e||o.messages.String.match,type:"regexp",regexp:t}),this},h.prototype.checkRequired=function(t,e){return s._isRef(this,t,e,!0)?!!t:("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():h.checkRequired())(t)},h.prototype.cast=function(t,e,n){if(s._isRef(this,t,e,n))return"string"==typeof t?t:this._castRef(t,e,n);var r;r="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():h.cast();try{return r(t)}catch(e){throw new u("string",t,this.path,null,this)}};var f=c.options(s.prototype.$conditionalHandlers,{$all:function(t){var e=this;return Array.isArray(t)?t.map(function(t){return e.castForQuery(t)}):[this.castForQuery(t)]},$gt:d,$gte:d,$lt:d,$lte:d,$options:String,$regex:d,$not:d});Object.defineProperty(h.prototype,"$conditionalHandlers",{configurable:!1,enumerable:!1,writable:!1,value:Object.freeze(f)}),h.prototype.castForQuery=function(t,e){var n;if(2===arguments.length){if(!(n=this.$conditionalHandlers[t]))throw new Error("Can't use "+t+" with String.");return n.call(this,e)}return e=t,"[object RegExp]"===Object.prototype.toString.call(e)?e:this._castForQuery(e)},t.exports=h},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"enum",c),Object.defineProperty(l.prototype,"match",c),Object.defineProperty(l.prototype,"lowercase",c),Object.defineProperty(l.prototype,"trim",c),Object.defineProperty(l.prototype,"uppercase",c),Object.defineProperty(l.prototype,"minLength",c),Object.defineProperty(l.prototype,"minlength",c),Object.defineProperty(l.prototype,"maxLength",c),Object.defineProperty(l.prototype,"maxlength",c),Object.defineProperty(l.prototype,"populate",c),t.exports=l},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"min",c),Object.defineProperty(l.prototype,"max",c),Object.defineProperty(l.prototype,"enum",c),Object.defineProperty(l.prototype,"populate",c),t.exports=l},function(t,e,n){"use strict";var r=n(23);t.exports=function(t){return null==t?t:""===t?null:("string"!=typeof t&&"boolean"!=typeof t||(t=Number(t)),r.ok(!isNaN(t)),t instanceof Number?t.valueOf():"number"==typeof t?t:Array.isArray(t)||"function"!=typeof t.valueOf?t.toString&&!Array.isArray(t)&&t.toString()==Number(t)?Number(t):void r.ok(!1):Number(t.valueOf()))}},function(t,e,n){"use strict";var r=n(13),i=n(6),s=n(52),o=n(1);function a(t,e){i.call(this,t,e,"Boolean")}a.schemaName="Boolean",a.defaultOptions={},(a.prototype=Object.create(i.prototype)).constructor=a,a._cast=s,a.set=i.set,a.cast=function(t){return 0===arguments.length||(!1===t&&(t=this._defaultCaster),this._cast=t),this._cast},a._defaultCaster=function(t){if(null!=t&&"boolean"!=typeof t)throw new Error;return t},a._checkRequired=function(t){return!0===t||!1===t},a.checkRequired=i.checkRequired,a.prototype.checkRequired=function(t){return this.constructor._checkRequired(t)},Object.defineProperty(a,"convertToTrue",{get:function(){return s.convertToTrue},set:function(t){s.convertToTrue=t}}),Object.defineProperty(a,"convertToFalse",{get:function(){return s.convertToFalse},set:function(t){s.convertToFalse=t}}),a.prototype.cast=function(t){var e;e="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():a.cast();try{return e(t)}catch(e){throw new r("Boolean",t,this.path,e,this)}},a.$conditionalHandlers=o.options(i.prototype.$conditionalHandlers,{}),a.prototype.castForQuery=function(t,e){var n;return 2===arguments.length?(n=a.$conditionalHandlers[t])?n.call(this,e):this._castForQuery(e):this._castForQuery(t)},a.prototype._castNullish=function(t){if(void 0===t&&null!=this.$$context&&null!=this.$$context._mongooseOptions&&this.$$context._mongooseOptions.omitUndefined)return t;var e="function"==typeof this.constructor.cast?this.constructor.cast():a.cast();return null==e?t:!(e.convertToFalse instanceof Set&&e.convertToFalse.has(t))&&(!!(e.convertToTrue instanceof Set&&e.convertToTrue.has(t))||t)},t.exports=a},function(t,e,n){"use strict";var r,i,s=n(56),o=n(13),a=n(19).EventEmitter,l=n(159),c=n(6),u=n(32),h=n(92),d=n(3),f=n(93),p=n(4),m=n(1),g=n(94),y=n(0).arrayAtomicsSymbol,_=n(0).arrayPathSymbol,v=n(0).documentArrayParent;function b(t,e,n,r){null!=r&&null!=r._id?e=f(e,r):null!=n&&null!=n._id&&(e=f(e,n));var i=w(e,n);i.prototype.$basePath=t,s.call(this,t,i,n),this.schema=e,this.schemaOptions=r||{},this.$isMongooseDocumentArray=!0,this.Constructor=i,i.base=e.base;var o=this.defaultValue;"defaultValue"in this&&void 0===o||this.default(function(){var t=o.call(this);return Array.isArray(t)||(t=[t]),t});var a=this;this.$embeddedSchemaType=new c(t+".$",{required:d(this,"schemaOptions.required",!1)}),this.$embeddedSchemaType.cast=function(t,e,n){return a.cast(t,e,n)[0]},this.$embeddedSchemaType.$isMongooseDocumentArrayElement=!0,this.$embeddedSchemaType.caster=this.Constructor,this.$embeddedSchemaType.schema=this.schema}function w(t,e,r){function s(){i.apply(this,arguments),this.$session(this.ownerDocument().$session())}i||(i=n(27));var o=null!=r?r.prototype:i.prototype;for(var l in(s.prototype=Object.create(o)).$__setSchema(t),s.schema=t,s.prototype.constructor=s,s.$isArraySubdocument=!0,s.events=new a,t.methods)s.prototype[l]=t.methods[l];for(var c in t.statics)s[c]=t.statics[c];for(var u in a.prototype)s[u]=a.prototype[u];return s.options=e,s}function x(t,e,n){if(n&&e){for(var r,i,s,o=t.path+".",a=Object.keys(e),l=a.length,c={};l--;)if((i=a[l]).startsWith(o)){if("$"===(s=i.substring(o.length)))continue;s.startsWith("$.")&&(s=s.substr(2)),r||(r=!0),c[s]=e[i]}return r&&c||void 0}}b.schemaName="DocumentArray",b.options={castNonArrays:!0},(b.prototype=Object.create(s.prototype)).constructor=b,b.prototype.OptionsConstructor=l,b.prototype.discriminator=function(t,e,n){"function"==typeof t&&(t=m.getFunctionName(t));var r=w(e=h(this.casterConstructor,t,e,n),null,this.casterConstructor);r.baseCasterConstructor=this.casterConstructor;try{Object.defineProperty(r,"name",{value:t})}catch(t){}return this.casterConstructor.discriminators[t]=r,this.casterConstructor.discriminators[t]},b.prototype.doValidate=function(t,e,s,o){r||(r=n(18));var a=this;try{c.prototype.doValidate.call(this,t,function(n){if(n)return n.$isArrayValidatorError=!0,e(n);var l,c=t&&t.length;if(!c)return e();if(o&&o.updateValidator)return e();function h(t){null!=t&&((l=t)instanceof u||(l.$isArrayValidatorError=!0)),--c||e(l)}t.isMongooseDocumentArray||(t=new r(t,a.path,s));for(var d=0,f=c;d<f;++d){var p=t[d];if(null!=p){if(!(p instanceof i)){var m=g(a.casterConstructor,t[d]);p=t[d]=new m(p,t,void 0,void 0,d)}null==o||!o.validateModifiedOnly||p.isModified()?p.$__validate(h):--c||e(l)}else--c||e(l)}},s)}catch(t){return t.$isArrayValidatorError=!0,e(t)}},b.prototype.doValidateSync=function(t,e,n){var r=c.prototype.doValidateSync.call(this,t,e);if(null!=r)return r.$isArrayValidatorError=!0,r;var s=t&&t.length,o=null;if(s){for(var a=0,l=s;a<l;++a){var u=t[a];if(u){if(!(u instanceof i)){var h=g(this.casterConstructor,t[a]);u=t[a]=new h(u,t,void 0,void 0,a)}if(null==n||!n.validateModifiedOnly||u.isModified()){var d=u.validateSync();d&&null==o&&(o=d)}}}return o}},b.prototype.getDefault=function(t){var e="function"==typeof this.defaultValue?this.defaultValue.call(t):this.defaultValue;if(null==e)return e;r||(r=n(18)),Array.isArray(e)||(e=[e]),e=new r(e,this.path,t);for(var i=0;i<e.length;++i){var s=new(g(this.casterConstructor,e[i]))({},e,void 0,void 0,i);s.init(e[i]),s.isNew=!0,Object.assign(s.$__.activePaths.default,s.$__.activePaths.init),s.$__.activePaths.init={},e[i]=s}return e},b.prototype.cast=function(t,e,s,a,l){if(r||(r=n(18)),null!=t&&null!=t[_]&&t===a)return t;var c,u,h={transform:!1,virtuals:!1};if(l=l||{},!Array.isArray(t)){if(!s&&!b.options.castNonArrays)throw new o("DocumentArray",p.inspect(t),this.path,null,this);return e&&s&&e.markModified(this.path),this.cast([t],e,s,a,l)}t&&t.isMongooseDocumentArray||l.skipDocumentArrayCast?t&&t.isMongooseDocumentArray&&(t=new r(t,this.path,e)):t=new r(t,this.path,e),null!=a&&(t[y]=a[y]||{}),null!=l.arrayPathIndex&&(t[_]=this.path+"."+l.arrayPathIndex);for(var d=t.length,f={skipId:!0,willInit:!0},w=0;w<d;++w)if(t[w]){var S=g(this.casterConstructor,t[w]);if(!t[w].$__||t[w]instanceof S&&t[w][v]===e||(t[w]=t[w].toObject({transform:!1,virtuals:t[w].schema===S.schema})),t[w]instanceof i)null==t[w].__index&&t[w].$setIndex(w);else if(null!=t[w])if(s)e?c||(c=x(this,e.$__.selected,s)):c=!0,u=new S(null,t,f,c,w),t[w]=u.init(t[w]);else if(a&&"function"==typeof a.id&&(u=a.id(t[w]._id)),a&&u&&m.deepEqual(u.toObject(h),t[w]))u.set(t[w]),t[w]=u;else try{u=new S(t[w],t,void 0,void 0,w),t[w]=u}catch(e){var E=p.inspect(t[w]);throw new o("embedded",E,t[_],e,this)}}return t},b.prototype.clone=function(){var t=Object.assign({},this.options),e=new this.constructor(this.path,this.schema,t,this.schemaOptions);return e.validators=this.validators.slice(),void 0!==this.requiredValidator&&(e.requiredValidator=this.requiredValidator),e.Constructor.discriminators=Object.assign({},this.Constructor.discriminators),e},b.prototype.applyGetters=function(t,e){return c.prototype.applyGetters.call(this,t,e)},b.defaultOptions={},b.set=c.set,t.exports=b},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"enum",c),Object.defineProperty(l.prototype,"of",c),t.exports=l},function(t,e,n){"use strict";t.exports=function t(e){if(!Array.isArray(e))return{min:0,max:0,containsNonArrayItem:!0};if(0===e.length)return{min:1,max:1,containsNonArrayItem:!1};if(1===e.length&&!Array.isArray(e[0]))return{min:1,max:1,containsNonArrayItem:!1};for(var n=t(e[0]),r=1;r<e.length;++r){var i=t(e[r]);i.min<n.min&&(n.min=i.min),i.max>n.max&&(n.max=i.max),n.containsNonArrayItem=n.containsNonArrayItem||i.containsNonArrayItem}return n.min=n.min+1,n.max=n.max+1,n}},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n(13),a=n(33),l=n(55),c=n(157),u=n(3),h=n(158),d=n(82),f=n(4),p=n(21),m=n(30),g=["Polygon","MultiPolygon"];function y(t,e,n){if(Array.isArray(t))t.forEach(function(r,i){if(Array.isArray(r)||p(r))return y(r,e,n);t[i]=e.castForQueryWrapper({val:r,context:n})});else for(var r=Object.keys(t),i=r.length;i--;){var s=r[i],o=t[s];Array.isArray(o)||p(o)?(y(o,e,n),t[s]=o):t[s]=e.castForQuery({val:o,context:n})}}t.exports=function t(e,n,i,_){if(Array.isArray(n))throw new Error("Query filter must be an object, got an array ",f.inspect(n));if(null==n)return n;n.hasOwnProperty("_bsontype")&&"ObjectID"!==n._bsontype&&delete n._bsontype,null!=e&&null!=e.discriminators&&null!=n[e.options.discriminatorKey]&&(e=h(e,n[e.options.discriminatorKey])||e);var v,b,w,x,S,E,A=Object.keys(n),T=A.length;for(i=i||{};T--;)if(E=n[x=A[T]],"$or"===x||"$nor"===x||"$and"===x){if(!Array.isArray(E))throw new o("Array",E,x);for(var C=0;C<E.length;++C){if(null==E[C]||"object"!==s(E[C]))throw new o("Object",E[C],x+"."+C);E[C]=t(e,E[C],i,_)}}else{if("$where"===x){if("string"!==(S=s(E))&&"function"!==S)throw new Error("Must have a string or function for $where");"function"===S&&(n[x]=E.toString());continue}if("$elemMatch"===x)E=t(e,E,i,_);else if("$text"===x)E=c(E,x);else{if(!e)continue;if(!(b=e.path(x)))for(var M=x.split("."),O=M.length;O--;){var P=M.slice(0,O).join("."),D=M.slice(O).join("."),R=e.path(P),L=u(R,"schema.options.discriminatorKey");if(null!=R&&null!=u(R,"schema.discriminators")&&null!=L&&D!==L){var I=u(n,P+"."+L);null!=I&&(b=R.schema.discriminators[I].path(D))}}if(b){if(null==E)continue;if("Object"===E.constructor.name)if(Object.keys(E).some(d))for(var N=Object.keys(E),k=void 0,F=N.length;F--;)if(w=E[k=N[F]],"$not"===k){if(w&&b&&!b.caster){if((v=Object.keys(w)).length&&d(v[0]))for(var B in w)w[B]=b.castForQueryWrapper({$conditional:B,val:w[B],context:_});else E[k]=b.castForQueryWrapper({$conditional:k,val:w,context:_});continue}t(b.caster?b.caster.schema:e,w,i,_)}else E[k]=b.castForQueryWrapper({$conditional:k,val:w,context:_});else n[x]=b.castForQueryWrapper({val:E,context:_});else if(Array.isArray(E)&&-1===["Buffer","Array"].indexOf(b.instance)){var j,U=[],V=r(E);try{for(V.s();!(j=V.n()).done;)U.push(b.castForQueryWrapper({val:j.value,context:_}))}catch(t){V.e(t)}finally{V.f()}n[x]={$in:U}}else n[x]=b.castForQueryWrapper({val:E,context:_})}else{for(var z=x.split("."),$=z.length,H=void 0,G=void 0,W=void 0;$--&&(H=z.slice(0,$).join("."),!(b=e.path(H))););if(b){b.caster&&b.caster.schema?((W={})[G=z.slice($).join(".")]=E,n[x]=t(b.caster.schema,W,i,_)[G]):n[x]=E;continue}if(p(E)){var q="";if(E.$near?q="$near":E.$nearSphere?q="$nearSphere":E.$within?q="$within":E.$geoIntersects?q="$geoIntersects":E.$geoWithin&&(q="$geoWithin"),q){var Z=new l.Number("__QueryCasting__"),Y=E[q];if(null!=E.$maxDistance&&(E.$maxDistance=Z.castForQueryWrapper({val:E.$maxDistance,context:_})),null!=E.$minDistance&&(E.$minDistance=Z.castForQueryWrapper({val:E.$minDistance,context:_})),"$within"===q){var J=Y.$center||Y.$centerSphere||Y.$box||Y.$polygon;if(!J)throw new Error("Bad $within parameter: "+JSON.stringify(E));Y=J}else if("$near"===q&&"string"==typeof Y.type&&Array.isArray(Y.coordinates))Y=Y.coordinates;else if(("$near"===q||"$nearSphere"===q||"$geoIntersects"===q)&&Y.$geometry&&"string"==typeof Y.$geometry.type&&Array.isArray(Y.$geometry.coordinates))null!=Y.$maxDistance&&(Y.$maxDistance=Z.castForQueryWrapper({val:Y.$maxDistance,context:_})),null!=Y.$minDistance&&(Y.$minDistance=Z.castForQueryWrapper({val:Y.$minDistance,context:_})),m(Y.$geometry)&&(Y.$geometry=Y.$geometry.toObject({transform:!1,virtuals:!1})),Y=Y.$geometry.coordinates;else if("$geoWithin"===q)if(Y.$geometry){m(Y.$geometry)&&(Y.$geometry=Y.$geometry.toObject({virtuals:!1}));var K=Y.$geometry.type;if(-1===g.indexOf(K))throw new Error('Invalid geoJSON type for $geoWithin "'+K+'", must be "Polygon" or "MultiPolygon"');Y=Y.$geometry.coordinates}else m(Y=Y.$box||Y.$polygon||Y.$center||Y.$centerSphere)&&(Y=Y.toObject({virtuals:!1}));y(Y,Z,_);continue}}if(e.nested[x])continue;if(i.upsert&&i.strict){if("throw"===i.strict)throw new a(x);throw new a(x,'Path "'+x+'" is not in schema, strict mode is `true`, and upsert is `true`.')}if("throw"===i.strictQuery)throw new a(x,'Path "'+x+"\" is not in schema and strictQuery is 'throw'.");i.strictQuery&&delete n[x]}}}return n}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(13),s=n(52),o=n(78);t.exports=function(t,e){if(null==t||"object"!==r(t))throw new i("$text",t,e);return null!=t.$search&&(t.$search=o(t.$search,e+".$search")),null!=t.$language&&(t.$language=o(t.$language,e+".$language")),null!=t.$caseSensitive&&(t.$caseSensitive=s(t.$caseSensitive,e+".$castSensitive")),null!=t.$diacriticSensitive&&(t.$diacriticSensitive=s(t.$diacriticSensitive,e+".$diacriticSensitive")),t}},function(t,e,n){"use strict";var r=n(81);t.exports=function(t,e){if(null==t||null==t.discriminators)return null;for(var n=0,i=Object.keys(t.discriminators);n<i.length;n++){var s=t.discriminators[i[n]];if(null!=s.discriminatorMapping&&r(s.discriminatorMapping.value,e))return s}return null}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"excludeIndexes",c),Object.defineProperty(l.prototype,"_id",c),t.exports=l},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i,s=n(13),o=n(19).EventEmitter,a=n(74),l=n(161),c=n(6),u=n(51),h=n(35).castToNumber,d=n(92),f=n(83),p=n(3),m=n(94),g=n(93),y=n(17).internalToObjectOptions;function _(t,e,n){t=g(t,n),this.caster=v(t),this.caster.path=e,this.caster.prototype.$basePath=e,this.schema=t,this.$isSingleNested=!0,c.call(this,e,n,"Embedded")}function v(t,e){i||(i=n(91));var r=function(t,e,n){var r=this;this.$__parent=n,i.apply(this,arguments),this.$session(this.ownerDocument().$session()),n&&(n.on("save",function(){r.emit("save",r),r.constructor.emit("save",r)}),n.on("isNew",function(t){r.isNew=t,r.emit("isNew",t),r.constructor.emit("isNew",t)}))},s=null!=e?e.prototype:i.prototype;for(var a in(r.prototype=Object.create(s)).$__setSchema(t),r.prototype.constructor=r,r.schema=t,r.$isSingleNested=!0,r.events=new o,r.prototype.toBSON=function(){return this.toObject(y)},t.methods)r.prototype[a]=t.methods[a];for(var l in t.statics)r[l]=t.statics[l];for(var c in o.prototype)r[c]=o.prototype[c];return r}t.exports=_,(_.prototype=Object.create(c.prototype)).constructor=_,_.prototype.OptionsConstructor=l,_.prototype.$conditionalHandlers.$geoWithin=function(t){return{$geometry:this.castForQuery(t.$geometry)}},_.prototype.$conditionalHandlers.$near=_.prototype.$conditionalHandlers.$nearSphere=f.cast$near,_.prototype.$conditionalHandlers.$within=_.prototype.$conditionalHandlers.$geoWithin=f.cast$within,_.prototype.$conditionalHandlers.$geoIntersects=f.cast$geoIntersects,_.prototype.$conditionalHandlers.$minDistance=h,_.prototype.$conditionalHandlers.$maxDistance=h,_.prototype.$conditionalHandlers.$exists=u,_.prototype.cast=function(t,e,n,i,s){if(t&&t.$isSingleNested&&t.parent===e)return t;if(null!=t&&("object"!==r(t)||Array.isArray(t)))throw new a(this.path,t);var o,l=m(this.caster,t),c=p(e,"$__.selected",{}),u=this.path,h=Object.keys(c).reduce(function(t,e){return e.startsWith(u+".")&&(t[e.substr(u.length+1)]=c[e]),t},{});return s=Object.assign({},s,{priorDoc:i}),n?((o=new l(void 0,h,e)).init(t),o):0===Object.keys(t).length?new l({},h,e,void 0,s):new l(t,h,e,void 0,s)},_.prototype.castForQuery=function(t,e,n){var r;if(2===arguments.length){if(!(r=this.$conditionalHandlers[t]))throw new Error("Can't use "+t);return r.call(this,e)}if(null==(e=t))return e;this.options.runSetters&&(e=this._applySetters(e));var i=m(this.caster,e),o=null!=n&&null!=n.strict?n.strict:void 0;try{e=new i(e,o)}catch(t){if(!(t instanceof s))throw new s("Embedded",e,this.path,t,this);throw t}return e},_.prototype.doValidate=function(t,e,n,r){var i=m(this.caster,t);if(r&&r.skipSchemaValidators)return t instanceof i||(t=new i(t,null,n)),t.validate(e);c.prototype.doValidate.call(this,t,function(n){return n?e(n):t?void t.validate(e):e(null)},n,r)},_.prototype.doValidateSync=function(t,e,n){if(!n||!n.skipSchemaValidators){var r=c.prototype.doValidateSync.call(this,t,e);if(r)return r}if(t)return t.validateSync()},_.prototype.discriminator=function(t,e,n){return e=d(this.caster,t,e,n),this.caster.discriminators[t]=v(e,this.caster),this.caster.discriminators[t]},_.defaultOptions={},_.set=c.set,_.prototype.clone=function(){var t=Object.assign({},this.options),e=new this.constructor(this.schema,this.path,t);return e.validators=this.validators.slice(),void 0!==this.requiredValidator&&(e.requiredValidator=this.requiredValidator),e.caster.discriminators=Object.assign({},this.caster.discriminators),e}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"_id",c),t.exports=l},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(87),s=n(163),o=n(6),a=n(80),l=n(1),c=i.Binary,u=o.CastError;function h(t,e){o.call(this,t,e,"Buffer")}function d(t){return this.castForQuery(t)}h.schemaName="Buffer",h.defaultOptions={},(h.prototype=Object.create(o.prototype)).constructor=h,h.prototype.OptionsConstructor=s,h._checkRequired=function(t){return!(!t||!t.length)},h.set=o.set,h.checkRequired=o.checkRequired,h.prototype.checkRequired=function(t,e){return o._isRef(this,t,e,!0)?!!t:this.constructor._checkRequired(t)},h.prototype.cast=function(t,n,s){var a;if(o._isRef(this,t,n,s)){if(t&&t.isMongooseBuffer)return t;if(e.isBuffer(t))return t&&t.isMongooseBuffer||(t=new i(t,[this.path,n]),null!=this.options.subtype&&(t._subtype=this.options.subtype)),t;if(t instanceof c){if(a=new i(t.value(!0),[this.path,n]),"number"!=typeof t.sub_type)throw new u("Buffer",t,this.path,null,this);return a._subtype=t.sub_type,a}return this._castRef(t,n,s)}if(t&&t._id&&(t=t._id),t&&t.isMongooseBuffer)return t;if(e.isBuffer(t))return t&&t.isMongooseBuffer||(t=new i(t,[this.path,n]),null!=this.options.subtype&&(t._subtype=this.options.subtype)),t;if(t instanceof c){if(a=new i(t.value(!0),[this.path,n]),"number"!=typeof t.sub_type)throw new u("Buffer",t,this.path,null,this);return a._subtype=t.sub_type,a}if(null===t)return t;var l=r(t);if("string"===l||"number"===l||Array.isArray(t)||"object"===l&&"Buffer"===t.type&&Array.isArray(t.data))return"number"===l&&(t=[t]),a=new i(t,[this.path,n]),null!=this.options.subtype&&(a._subtype=this.options.subtype),a;throw new u("Buffer",t,this.path,null,this)},h.prototype.subtype=function(t){return this.options.subtype=t,this},h.prototype.$conditionalHandlers=l.options(o.prototype.$conditionalHandlers,{$bitsAllClear:a,$bitsAnyClear:a,$bitsAllSet:a,$bitsAnySet:a,$gt:d,$gte:d,$lt:d,$lte:d}),h.prototype.castForQuery=function(t,e){var n;if(2===arguments.length){if(!(n=this.$conditionalHandlers[t]))throw new Error("Can't use "+t+" with Buffer.");return n.call(this,e)}var r=this._castForQuery(e=t);return r?r.toObject({transform:!1,virtuals:!1}):r},t.exports=h}).call(this,n(2).Buffer)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"subtype",c),t.exports=l},function(t,e,n){"use strict";var r=n(5),i=n(165),s=n(6),o=n(166),a=n(1),l=s.CastError;function c(t,e){s.call(this,t,e,"Date")}function u(t){return this.cast(t)}c.schemaName="Date",c.defaultOptions={},(c.prototype=Object.create(s.prototype)).constructor=c,c.prototype.OptionsConstructor=i,c._cast=o,c.set=s.set,c.cast=function(t){return 0===arguments.length||(!1===t&&(t=this._defaultCaster),this._cast=t),this._cast},c._defaultCaster=function(t){if(null!=t&&!(t instanceof Date))throw new Error;return t},c.prototype.expires=function(t){return this._index&&"Object"===this._index.constructor.name||(this._index={}),this._index.expires=t,a.expires(this._index),this},c._checkRequired=function(t){return t instanceof Date},c.checkRequired=s.checkRequired,c.prototype.checkRequired=function(t,e){return s._isRef(this,t,e,!0)?!!t:("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():c.checkRequired())(t)},c.prototype.min=function(t,e){if(this.minValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.minValidator},this)),t){var n=e||r.messages.Date.min;"string"==typeof n&&(n=n.replace(/{MIN}/,t===Date.now?"Date.now()":t.toString()));var i=this;this.validators.push({validator:this.minValidator=function(e){var n=t;"function"==typeof t&&t!==Date.now&&(n=n.call(this));var r=n===Date.now?n():i.cast(n);return null===e||e.valueOf()>=r.valueOf()},message:n,type:"min",min:t})}return this},c.prototype.max=function(t,e){if(this.maxValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.maxValidator},this)),t){var n=e||r.messages.Date.max;"string"==typeof n&&(n=n.replace(/{MAX}/,t===Date.now?"Date.now()":t.toString()));var i=this;this.validators.push({validator:this.maxValidator=function(e){var n=t;"function"==typeof n&&n!==Date.now&&(n=n.call(this));var r=n===Date.now?n():i.cast(n);return null===e||e.valueOf()<=r.valueOf()},message:n,type:"max",max:t})}return this},c.prototype.cast=function(t){var e;e="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():c.cast();try{return e(t)}catch(e){throw new l("date",t,this.path,e,this)}},c.prototype.$conditionalHandlers=a.options(s.prototype.$conditionalHandlers,{$gt:u,$gte:u,$lt:u,$lte:u}),c.prototype.castForQuery=function(t,e){if(2!==arguments.length)return this._castForQuery(t);var n=this.$conditionalHandlers[t];if(!n)throw new Error("Can't use "+t+" with Date.");return n.call(this,e)},t.exports=c},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"min",c),Object.defineProperty(l.prototype,"max",c),Object.defineProperty(l.prototype,"expires",c),t.exports=l},function(t,e,n){"use strict";var r=n(23);t.exports=function(t){return null==t||""===t?null:t instanceof Date?(r.ok(!isNaN(t.valueOf())),t):(r.ok("boolean"!=typeof t),e=t instanceof Number||"number"==typeof t?new Date(t):"string"==typeof t&&!isNaN(Number(t))&&(Number(t)>=275761||Number(t)<-271820)?new Date(Number(t)):"function"==typeof t.valueOf?new Date(t.valueOf()):new Date(t),isNaN(e.valueOf())?void r.ok(!1):e);var e}},function(t,e,n){"use strict";var r,i=n(168),s=n(6),o=n(88),a=n(7),l=n(1),c=s.CastError;function u(t,e){!("string"==typeof t&&24===t.length&&/^[a-f0-9]+$/i.test(t))&&void 0!==t||e&&e.suppressWarning||(console.warn("mongoose: To create a new ObjectId please try `Mongoose.Types.ObjectId` instead of using `Mongoose.Schema.ObjectId`. Set the `suppressWarning` option if you're trying to create a hex char path in your schema."),console.trace()),s.call(this,t,e,"ObjectID")}function h(t){return this.cast(t)}function d(){return new a}function f(t){if(r||(r=n(12)),this instanceof r){if(void 0===t){var e=new a;return this.$__._id=e,e}this.$__._id=t}return t}u.schemaName="ObjectId",u.defaultOptions={},(u.prototype=Object.create(s.prototype)).constructor=u,u.prototype.OptionsConstructor=i,u.get=s.get,u.set=s.set,u.prototype.auto=function(t){return t&&(this.default(d),this.set(f)),this},u._checkRequired=function(t){return t instanceof a},u._cast=o,u.cast=function(t){return 0===arguments.length||(!1===t&&(t=this._defaultCaster),this._cast=t),this._cast},u._defaultCaster=function(t){if(!(t instanceof a))throw new Error(t+" is not an instance of ObjectId");return t},u.checkRequired=s.checkRequired,u.prototype.checkRequired=function(t,e){return s._isRef(this,t,e,!0)?!!t:("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():u.checkRequired())(t)},u.prototype.cast=function(t,e,n){if(s._isRef(this,t,e,n))return t instanceof a?t:null!=t&&"objectid"===(t.constructor.name||"").toLowerCase()?new a(t.toHexString()):this._castRef(t,e,n);var r;r="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():u.cast();try{return r(t)}catch(e){throw new c("ObjectId",t,this.path,e,this)}},u.prototype.$conditionalHandlers=l.options(s.prototype.$conditionalHandlers,{$gt:h,$gte:h,$lt:h,$lte:h}),d.$runBeforeSetters=!0,t.exports=u},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"auto",c),Object.defineProperty(l.prototype,"populate",c),t.exports=l},function(t,e,n){"use strict";var r=n(6),i=r.CastError,s=n(20),o=n(170),a=n(1);function l(t,e){r.call(this,t,e,"Decimal128")}function c(t){return this.cast(t)}l.schemaName="Decimal128",l.defaultOptions={},(l.prototype=Object.create(r.prototype)).constructor=l,l._cast=o,l.set=r.set,l.cast=function(t){return 0===arguments.length||(!1===t&&(t=this._defaultCaster),this._cast=t),this._cast},l._defaultCaster=function(t){if(null!=t&&!(t instanceof s))throw new Error;return t},l._checkRequired=function(t){return t instanceof s},l.checkRequired=r.checkRequired,l.prototype.checkRequired=function(t,e){return r._isRef(this,t,e,!0)?!!t:("function"==typeof this.constructor.checkRequired?this.constructor.checkRequired():l.checkRequired())(t)},l.prototype.cast=function(t,e,n){if(r._isRef(this,t,e,n))return t instanceof s?t:this._castRef(t,e,n);var o;o="function"==typeof this._castFunction?this._castFunction:"function"==typeof this.constructor.cast?this.constructor.cast():l.cast();try{return o(t)}catch(e){throw new i("Decimal128",t,this.path,e,this)}},l.prototype.$conditionalHandlers=a.options(r.prototype.$conditionalHandlers,{$gt:c,$gte:c,$lt:c,$lte:c}),t.exports=l},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(20),s=n(23);t.exports=function(t){return null==t?t:"object"===r(t)&&"string"==typeof t.$numberDecimal?i.fromString(t.$numberDecimal):t instanceof i?t:"string"==typeof t?i.fromString(t):e.isBuffer(t)?new i(t):"number"==typeof t?i.fromString(String(t)):"function"==typeof t.valueOf&&"string"==typeof t.valueOf()?i.fromString(t.valueOf()):void s.ok(!1)}}).call(this,n(2).Buffer)},function(t,e,n){"use strict";(function(e){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=n(89),d=n(172),f=n(6),p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(s,t);var n,r=l(s);function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(n=r.call(this,t,e,"Map")).$isSchemaMap=!0,n}return(n=[{key:"set",value:function(t,e){return f.set(t,e)}},{key:"cast",value:function(t,n,r){if(t instanceof h)return t;var s=this.path;if(r){var o=new h({},s,n,this.$__schemaType);if(t instanceof e.Map){var a,l=i(t.keys());try{for(l.s();!(a=l.n()).done;){var c=a.value,u=t.get(c);u=null==u?o.$__schemaType._castNullish(u):o.$__schemaType.cast(u,n,!0,null,{path:s+"."+c}),o.$init(c,u)}}catch(t){l.e(t)}finally{l.f()}}else for(var d=0,f=Object.keys(t);d<f.length;d++){var p=f[d],m=t[p];m=null==m?o.$__schemaType._castNullish(m):o.$__schemaType.cast(m,n,!0,null,{path:s+"."+p}),o.$init(p,m)}return o}return new h(t,s,n,this.$__schemaType)}},{key:"clone",value:function(){var t=o(u(s.prototype),"clone",this).call(this);return null!=this.$__schemaType&&(t.$__schemaType=this.$__schemaType.clone()),t}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(s.prototype,n),s}(f);p.prototype.OptionsConstructor=d,p.defaultOptions={},t.exports=p}).call(this,n(10))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=a(t);if(e){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(){return i(this,n),e.apply(this,arguments)}return n}(n(8)),c=n(9);Object.defineProperty(l.prototype,"of",c),t.exports=l},function(t,e,n){"use strict";(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(15).get().Binary,s=n(20),o=n(7),a=n(30);function l(e){return e&&"object"===r(e)&&!(e instanceof Date)&&!(e instanceof o)&&(!Array.isArray(e)||e.length>0)&&!(e instanceof t)&&!(e instanceof s)&&!(e instanceof i)}e.flatten=function e(n,r,i,s){var o,c=(o=n&&a(n)&&!t.isBuffer(n)?Object.keys(n.toObject({transform:!1,virtuals:!1})):Object.keys(n||{})).length,u={};r=r?r+".":"";for(var h=0;h<c;++h){var d=o[h],f=n[d];u[r+d]=f;var p=s&&s.path&&s.path(r+d),m=s&&s.nested&&s.nested[r+d];if(!p||"Mixed"!==p.instance){if(l(f)){if(i&&i.skipArrays&&Array.isArray(f))continue;var g=e(f,r+d,i,s);for(var y in g)u[y]=g[y];Array.isArray(f)&&(u[r+d]=f)}if(m)for(var _=0,v=Object.keys(s.paths);_<v.length;_++){var b=v[_];b.startsWith(r+d+".")&&!u.hasOwnProperty(b)&&(u[b]=void 0)}}}return u},e.modifiedPaths=function e(n,r,i){var s=Object.keys(n||{}),o=s.length;i=i||{},r=r?r+".":"";for(var c=0;c<o;++c){var u=s[c],h=n[u];i[r+u]=!0,a(h)&&!t.isBuffer(h)&&(h=h.toObject({transform:!1,virtuals:!1})),l(h)&&e(h,r+u,i)}return i}}).call(this,n(2).Buffer)},function(t,e,n){"use strict";var r=n(3);t.exports=function t(e,n,i){for(var s=(i=i||{}).typeOnly,o=n.split("."),a=null,l="adhocOrUndefined",c=0;c<o.length;++c){var u=o.slice(0,c+1).join(".");if(null!=(a=e.schema.path(u))){if("Mixed"===a.instance)return s?"real":a;if(l=e.schema.pathType(u),(a.$isSingleNested||a.$isMongooseDocumentArrayElement)&&null!=a.schema.discriminators){var h=a.schema.discriminators,d=e.get(u+"."+r(a,"schema.options.discriminatorKey"));if(null==d||null==h[d])continue;var f=o.slice(c+1).join(".");return t(e.get(u),f,i)}}else l="adhocOrUndefined"}return s?l:a}},function(t,e,n){"use strict";function r(){return null!=this._id?String(this._id):null}t.exports=function(t){!t.paths.id&&!t.options.noVirtualId&&t.options.id&&t.virtual("id").get(r)}},function(t,e,n){"use strict";var r=n(58);t.exports=function(t){if(null==t)return null;var e=Object.keys(t),n=e.length,i=null;if(1===n&&"_id"===e[0])i=!!t[e[n]];else for(;n--;)if("_id"!==e[n]&&r(t[e[n]])){i=!t[e[n]];break}return i}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var o=n(178),a=n(3),l=n(36),c=n(58),u=n(29);function h(t){return function(e){e.options||(e.options={}),null!=t&&Array.isArray(t.virtuals)&&((t=Object.assign({},t)).virtuals=t.virtuals.filter(function(t){return"string"==typeof t&&t.startsWith(e.path+".")}).map(function(t){return t.slice(e.path.length+1)})),e.options.lean=t}}e.preparePopulationOptions=function(t,e){var n=t.options.populate,r=Object.keys(n).reduce(function(t,e){return t.concat([n[e]])},[]);return null!=e.lean&&r.filter(function(t){return null==a(t,"options.lean")}).forEach(h(e.lean)),r.forEach(function(e){e._localModel=t.model}),r},e.preparePopulationOptionsMQ=function(t,e){var n=t._mongooseOptions.populate,r=Object.keys(n).reduce(function(t,e){return t.concat([n[e]])},[]);null!=e.lean&&r.filter(function(t){return null==a(t,"options.lean")}).forEach(h(e.lean));var i=a(t,"options.session",null);null!=i&&r.forEach(function(t){null!=t.options?"session"in t.options||(t.options.session=i):t.options={session:i}});var s=t._fieldsForExec();return r.forEach(function(t){t._queryProjection=s}),r.forEach(function(e){e._localModel=t.model}),r},e.createModel=function(t,n,r,i,s){t.hooks.execPreSync("createModel",n);var o=t.schema?t.schema.discriminatorMapping:null,a=o&&o.isRoot?o.key:null,c=n[a];if(a&&c&&t.discriminators){var h=t.discriminators[c]||l(t.discriminators,c);if(h){var d=u(i);return e.applyPaths(d,h.schema),new h(void 0,d,!0)}}return void 0===s&&((s={}).defaults=!0),new t(void 0,r,{skipId:!0,isNew:!1,willInit:!0,defaults:s.defaults})},e.applyPaths=function(t,e){var n,s,l;if(t)for(l=(s=Object.keys(t)).length;l--;)if("+"!==s[l][0]){var u=t[s[l]];if(c(u)){n=!u;break}}var h=[],d=[],f=[];switch(function e(r,i){if(i||(i=""),-1!==f.indexOf(r))return[];f.push(r);var s=[];return r.eachPath(function(r,a){i&&(r=i+"."+r);var l=E(r,a);if(null==l&&a.$isMongooseArray&&!a.$isMongooseDocumentArray&&(l=E(r,a.caster)),null!=l&&s.push(l),a.schema){var c=e(a.schema,r);!1===n&&o(t,r,a.schema,h,c)}}),f.pop(),s}(e),n){case!0:var p,m=i(d);try{for(m.s();!(p=m.n()).done;)t[p.value]=0}catch(t){m.e(t)}finally{m.f()}break;case!1:e&&e.paths._id&&e.paths._id.options&&!1===e.paths._id.options.select&&(t._id=0);var g,y=i(h);try{for(y.s();!(g=y.n()).done;){var _=g.value;t[_]=t[_]||1}}catch(t){y.e(t)}finally{y.f()}break;case void 0:if(null==t)break;for(var v=0,b=Object.keys(t||{});v<b.length;v++){var w=b[v];w.startsWith("+")&&delete t[w]}var x,S=i(d);try{for(S.s();!(x=S.n()).done;)t[x.value]=0}catch(t){S.e(t)}finally{S.f()}}function E(e,i){var o="+"+e,l=t&&o in t;if(l&&delete t[o],"boolean"==typeof i.selected){if(l)return delete t[o],void(!1===n&&s.length>1&&!~s.indexOf(e)&&(t[e]=1));for(var c=e.split("."),u="",f=0;f<c.length;++f)if(-1!==d.indexOf(u+=u.length?"."+c[f]:c[f]))return;if(!n&&a(i,"options.$skipDiscriminatorCheck",!1))for(var p="",m=0;m<c.length;++m){var g=a(t,p+=(0===p.length?"":".")+c[m],!1)||a(t,p+".$",!1);if(g&&"object"!==r(g))return}return(i.selected?h:d).push(e),e}}},e.handleDeleteWriteOpResult=function(t){return function(e,n){if(e)return t(e);var r=Object.assign({},n.result);return null!=a(n,"result.n",null)&&(r.deletedCount=n.result.n),null!=n.deletedCount&&(r.deletedCount=n.deletedCount),t(null,r)}}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){var s=Object.keys(t).reduce(function(t,n){return t||n.startsWith(e+".")},!1),o=e+"."+n.options.discriminatorKey;s||1!==i.length||i[0]!==o||r.splice(r.indexOf(o),1)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return!!t&&("object"===r(t)||"function"==typeof t)&&"function"==typeof t.then}},function(t,e,n){"use strict";var r=n(12),i=n(19).EventEmitter,s=n(5),o=n(53),a=n(7),l=s.ValidationError,c=n(77),u=n(21);function h(t,e,n,i,l){if(!(this instanceof h))return new h(t,e,n,i,l);if(u(e)&&!e.instanceOfSchema&&(e=new o(e)),e=this.schema||e,!this.schema&&e.options._id&&void 0===(t=t||{})._id&&(t._id=new a),!e)throw new s.MissingSchemaError;for(var d in this.$__setSchema(e),r.call(this,t,n,i,l),c(this,e,{decorateDoc:!0}),e.methods)this[d]=e.methods[d];for(var f in e.statics)this[f]=e.statics[f]}(h.prototype=Object.create(r.prototype)).constructor=h,h.events=new i,h.$emitter=new i,["on","once","emit","listeners","removeListener","setMaxListeners","removeAllListeners","addListener"].forEach(function(t){h[t]=function(){return h.$emitter[t].apply(h.$emitter,arguments)}}),h.ValidationError=l,t.exports=h}])},module.exports=e()},8036:function(t,e,n){var r,i,s;(function(o,a){var l=(o=o||n(4158)).window,c=o.document,u=new function(){var t=/^(statics|enumerable|beans|preserve)$/,e=[],n=e.slice,r=Object.create,i=Object.getOwnPropertyDescriptor,s=Object.defineProperty,o=e.forEach||function(t,e){for(var n=0,r=this.length;n<r;n++)t.call(e,this[n],n,this)},l=function(t,e){for(var n in this)this.hasOwnProperty(n)&&t.call(e,this[n],n,this)},c=Object.assign||function(t){for(var e=1,n=arguments.length;e<n;e++){var r=arguments[e];for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t},u=function(t,e,n){if(t){var r=i(t,"length");(r&&"number"==typeof r.value?o:l).call(t,e,n=n||t)}return n};function h(e,n,r,o,a){var l={};function c(t,c){"string"==typeof(c=c||(c=i(n,t))&&(c.get?c:c.value))&&"#"===c[0]&&(c=e[c.substring(1)]||c);var u,h="function"==typeof c,f=c,p=a||h&&!c.base?c&&c.get?t in e:e[t]:null;a&&p||(h&&p&&(c.base=p),h&&!1!==o&&(u=t.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(l[u[3].toLowerCase()+u[4]]=u[2]),f&&!h&&f.get&&"function"==typeof f.get&&d.isPlainObject(f)||(f={value:f,writable:!0}),(i(e,t)||{configurable:!0}).configurable&&(f.configurable=!0,f.enumerable=null!=r?r:!u),s(e,t,f))}if(n){for(var u in n)n.hasOwnProperty(u)&&!t.test(u)&&c(u);for(var u in l){var h=l[u],f=e["set"+h],p=e["get"+h]||f&&e["is"+h];!p||!0!==o&&0!==p.length||c(u,{get:p,set:f})}}return e}function d(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&c(this,n)}return this}return h(d,{inject:function(t){if(t){var e=!0===t.statics?t:t.statics,n=t.beans,r=t.preserve;e!==t&&h(this.prototype,t,t.enumerable,n,r),h(this,e,null,n,r)}for(var i=1,s=arguments.length;i<s;i++)this.inject(arguments[i]);return this},extend:function(){for(var t,e,n,i=this,o=0,a=arguments.length;o<a&&(!t||!e);o++)n=arguments[o],t=t||n.initialize,e=e||n.prototype;return e=(t=t||function(){i.apply(this,arguments)}).prototype=e||r(this.prototype),s(e,"constructor",{value:t,writable:!0,configurable:!0}),h(t,this),arguments.length&&this.inject.apply(t,arguments),t.base=i,t}}).inject({enumerable:!1,initialize:d,set:d,inject:function(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&h(this,n,n.enumerable,n.beans,n.preserve)}return this},extend:function(){var t=r(this);return t.inject.apply(t,arguments)},each:function(t,e){return u(this,t,e)},clone:function(){return new this.constructor(this)},statics:{set:c,each:u,create:r,define:s,describe:i,clone:function(t){return c(new t.constructor,t)},isPlainObject:function(t){var e=null!=t&&t.constructor;return e&&(e===Object||e===d||"Object"===e.name)},pick:function(t,e){return t!==a?t:e},slice:function(t,e,r){return n.call(t,e,r)}}})};t.exports=u,u.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+u.each(this,function(t,e){if(!/^_/.test(e)){var n=typeof t;this.push(e+": "+("number"===n?m.instance.number(t):"string"===n?"'"+t+"'":t))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return u.importJSON(t,this)},exportJSON:function(t){return u.exportJSON(this,t)},toJSON:function(){return u.serialize(this)},set:function(t,e){return t&&u.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),n=e.prototype._class;return n&&!u.exports[n]&&(u.exports[n]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)&&Array.isArray(e)){if((n=t.length)!==e.length)return!1;for(;n--;)if(!u.equals(t[n],e[n]))return!1}else{var n,r=Object.keys(t);if((n=r.length)!==Object.keys(e).length)return!1;for(;n--;){var i=r[n];if(!e.hasOwnProperty(i)||!u.equals(t[i],e[i]))return!1}}return!0}return!1},read:function(t,e,n,r){if(this===u){var i=this.peek(t,e);return t.__index++,i}var s=this.prototype,o=s._readIndex,l=e||o&&t.__index||0,c=t.length,h=t[l];if(r=r||c-l,h instanceof this||n&&n.readNull&&null==h&&r<=1)return o&&(t.__index=l+1),h&&n&&n.clone?h.clone():h;if(h=u.create(s),o&&(h.__read=!0),h=h.initialize.apply(h,l>0||l+r<c?u.slice(t,l,l+r):t)||h,o){t.__index=l+h.__read;var d=h.__filtered;d&&(t.__filtered=d,h.__filtered=a),h.__read=a}return h},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,n,r){for(var i,s=[],o=e||0,a=r?o+r:t.length,l=o;l<a;l++)s.push(Array.isArray(i=t[l])?this.read(i,0,n):this.read(t,l,n,1));return s},readNamed:function(t,e,n,r,i){var s=this.getNamed(t,e),o=s!==a;if(o){var l=t.__filtered;if(!l){var c=this.getSource(t);(l=t.__filtered=u.create(c)).__unfiltered=c}l[e]=a}return this.read(o?[s]:t,n,r,i)},readSupported:function(t,e){var n=this.getSource(t),r=this,i=!1;return n&&Object.keys(n).forEach(function(n){if(n in e){var s=r.readNamed(t,n);s!==a&&(e[n]=s),i=!0}}),i},getSource:function(t){var e=t.__source;if(e===a){var n=1===t.length&&t[0];e=t.__source=n&&u.isPlainObject(n)?n:null}return e},getNamed:function(t,e){var n=this.getSource(t);if(n)return e?n[e]:t.__filtered||n},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,e,n,r){var i;function s(r){if(!(n&&r in n||i&&r in i)){var s=e[r];s!==a&&(t[r]=s)}}if(r){for(var o,l={},c=0,u=r.length;c<u;c++)(o=r[c])in e&&(s(o),l[o]=!0);i=l}return Object.keys(e.__unfiltered||e).forEach(s),t},isPlainValue:function(t,e){return u.isPlainObject(t)||Array.isArray(t)||e&&"string"==typeof t},serialize:function(t,e,n,r){e=e||{};var i,s=!r;if(s&&(e.formatter=new m(e.precision),r={length:0,definitions:{},references:{},add:function(t,e){var n="#"+t._id,r=this.references[n];if(!r){this.length++;var i=e.call(t),s=t._class;s&&i[0]!==s&&i.unshift(s),this.definitions[n]=i,r=this.references[n]=[n]}return r}}),t&&t._serialize){i=t._serialize(e,r);var o=t._class;!o||t._compactSerialize||!s&&n||i[0]===o||i.unshift(o)}else if(Array.isArray(t)){i=[];for(var a=0,l=t.length;a<l;a++)i[a]=u.serialize(t[a],e,n,r)}else if(u.isPlainObject(t)){i={};var c=Object.keys(t);for(a=0,l=c.length;a<l;a++){var h=c[a];i[h]=u.serialize(t[h],e,n,r)}}else i="number"==typeof t?e.formatter.number(t,e.precision):t;return s&&r.length>0?[["dictionary",r.definitions],i]:i},deserialize:function(t,e,n,r,i){var s=t,o=!n,a=o&&t&&t.length&&"dictionary"===t[0][0];if(n=n||{},Array.isArray(t)){var l=t[0],c="dictionary"===l;if(1==t.length&&/^#/.test(l))return n.dictionary[l];s=[];for(var h=(l=u.exports[l])?1:0,d=t.length;h<d;h++)s.push(u.deserialize(t[h],e,n,c,a));if(l){var f=s;s=e?e(l,f,o||i):new l(f)}}else if(u.isPlainObject(t))for(var p in s={},r&&(n.dictionary=s),t)s[p]=u.deserialize(t[p],e,n);return a?s[1]:s},exportJSON:function(t,e){var n=u.serialize(t,e);return e&&0==e.asString?n:JSON.stringify(n)},importJSON:function(t,e){return u.deserialize("string"==typeof t?JSON.parse(t):t,function(t,n,r){var i=r&&e&&e.constructor===t,s=i?e:u.create(t.prototype);if(1===n.length&&s instanceof C&&(i||!(s instanceof O))){var o=n[0];u.isPlainObject(o)&&(o.insert=!1,i&&(n=n.concat([{insert:!0}])))}return(i?s.set:t).apply(s,n),i&&(e=null),s})},push:function(t,e){var n=e.length;if(n<4096)t.push.apply(t,e);else{var r=t.length;t.length+=n;for(var i=0;i<n;i++)t[r+i]=e[i]}return t},splice:function(t,e,n,r){var i=e&&e.length,s=n===a;(n=s?t.length:n)>t.length&&(n=t.length);for(var o=0;o<i;o++)e[o]._index=n+o;if(s)return u.push(t,e),[];var l=[n,r];e&&u.push(l,e);for(var c=t.splice.apply(t,l),h=(o=0,c.length);o<h;o++)c[o]._index=a;for(o=n+i,h=t.length;o<h;o++)t[o]._index=o;return c},capitalize:function(t){return t.replace(/\b[a-z]/g,function(t){return t.toUpperCase()})},camelize:function(t){return t.replace(/-(.)/g,function(t,e){return e.toUpperCase()})},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var h={on:function(t,e){if("string"!=typeof t)u.each(t,function(t,e){this.on(e,t)},this);else{var n=this._eventTypes,r=n&&n[t],i=this._callbacks=this._callbacks||{};-1===(i=i[t]=i[t]||[]).indexOf(e)&&(i.push(e),r&&r.install&&1===i.length&&r.install.call(this,t))}return this},off:function(t,e){if("string"==typeof t){var n,r=this._eventTypes,i=r&&r[t],s=this._callbacks&&this._callbacks[t];return s&&(!e||-1!==(n=s.indexOf(e))&&1===s.length?(i&&i.uninstall&&i.uninstall.call(this,t),delete this._callbacks[t]):-1!==n&&s.splice(n,1)),this}u.each(t,function(t,e){this.off(e,t)},this)},once:function(t,e){return this.on(t,function n(){e.apply(this,arguments),this.off(t,n)})},emit:function(t,e){var n=this._callbacks&&this._callbacks[t];if(!n)return!1;var r=u.slice(arguments,1),i=e&&e.target&&!e.currentTarget;n=n.slice(),i&&(e.currentTarget=this);for(var s=0,o=n.length;s<o;s++)if(0==n[s].apply(this,r)){e&&e.stop&&e.stop();break}return i&&delete e.currentTarget,!0},responds:function(t){return!(!this._callbacks||!this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,n=this._callbacks,r=t?"install":"uninstall";if(e)for(var i in n)if(n[i].length>0){var s=e[i],o=s&&s[r];o&&o.call(this,i)}},statics:{inject:function t(e){var n=e._events;if(n){var r={};u.each(n,function(t,n){var i="string"==typeof t,s=i?t:n,o=u.capitalize(s),a=s.substring(2).toLowerCase();r[a]=i?{}:t,s="_"+s,e["get"+o]=function(){return this[s]},e["set"+o]=function(t){var e=this[s];e&&this.off(a,e),t&&this.on(a,t),this[s]=t}}),e._eventTypes=r}return t.base.apply(this,arguments)}}},d=u.extend({_class:"PaperScope",initialize:function t(){dt=this,this.settings=new u({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var e=t.prototype;if(!this.support){var n=lt.getContext(1,1)||{};e.support={nativeDash:"setLineDash"in n||"mozDash"in n,nativeBlendModes:ct.nativeModes},lt.release(n)}if(!this.agent){var r=o.navigator.userAgent.toLowerCase(),i=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(r)||[])[0],s="darwin"===i?"mac":i,a=e.agent=e.browser={platform:s};s&&(a[s]=!0),r.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(t,e,n,r,i){if(!a.chrome){var s="opera"===e?r:/^(node|trident)$/.test(e)?i:n;a.version=s,a.versionNumber=parseFloat(s),a.name=e={trident:"msie",jsdom:"node"}[e]||e,a[e]=!0}}),a.chrome&&delete a.webkit,a.atom&&delete a.chrome}},version:"0.12.15",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){var n=dt.PaperScript.execute(t,this,e);return X.updateFocus(),n},install:function(t){var e=this;for(var n in u.each(["project","view","tool"],function(n){u.define(t,n,{configurable:!0,get:function(){return e[n]}})}),this)!/^_/.test(n)&&this[n]&&(t[n]=this[n])},setup:function(t){return dt=this,this.project=new T(t),this},createCanvas:function(t,e){return lt.getCanvas(t,e)},activate:function(){dt=this},clear:function(){for(var t=this.projects,e=this.tools,n=t.length-1;n>=0;n--)t[n].remove();for(n=e.length-1;n>=0;n--)e[n].remove()},remove:function(){this.clear(),delete d._scopes[this._id]},statics:new function(){function t(t){return t+="Attribute",function(e,n){return e[t](n)||e[t]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),f=u.extend(h,{initialize:function(t){this._scope=dt,this._index=this._scope[this._list].push(this)-1,!t&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(u.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),p={findItemBoundsCollisions:function(t,e,n){function r(t){for(var e=new Array(t.length),n=0;n<t.length;n++){var r=t[n].getBounds();e[n]=[r.left,r.top,r.right,r.bottom]}return e}var i=r(t),s=e&&e!==t?r(e):i;return this.findBoundsCollisions(i,s,n||0)},findCurveBoundsCollisions:function(t,e,n,r){function i(t){for(var e=Math.min,n=Math.max,r=new Array(t.length),i=0;i<t.length;i++){var s=t[i];r[i]=[e(s[0],s[2],s[4],s[6]),e(s[1],s[3],s[5],s[7]),n(s[0],s[2],s[4],s[6]),n(s[1],s[3],s[5],s[7])]}return r}var s=i(t),o=e&&e!==t?i(e):s;if(r){for(var a=this.findBoundsCollisions(s,o,n||0,!1,!0),l=this.findBoundsCollisions(s,o,n||0,!0,!0),c=[],u=0,h=a.length;u<h;u++)c[u]={hor:a[u],ver:l[u]};return c}return this.findBoundsCollisions(s,o,n||0)},findBoundsCollisions:function(t,e,n,r,i){var s=!e||t===e,o=s?t:t.concat(e),a=t.length,l=o.length;function c(t,e,n){for(var r=0,i=t.length;r<i;){var s=i+r>>>1;o[t[s]][e]<n?r=s+1:i=s}return r-1}for(var u=r?1:0,h=u+2,d=r?0:1,f=d+2,p=new Array(l),m=0;m<l;m++)p[m]=m;p.sort(function(t,e){return o[t][u]-o[e][u]});var g=[],y=new Array(a);for(m=0;m<l;m++){var _=p[m],v=o[_],b=s?_:_-a,w=_<a,x=s||!w,S=w?[]:null;if(g.length){var E=c(g,h,v[u]-n)+1;if(g.splice(0,E),s&&i){S=S.concat(g);for(var A=0;A<g.length;A++)y[M=g[A]].push(b)}else{var T=v[f],C=v[d];for(A=0;A<g.length;A++){var M,O=o[M=g[A]],P=M<a,D=s||M>=a;(i||(w&&D||x&&P)&&T>=O[d]-n&&C<=O[f]+n)&&(w&&D&&S.push(s?M:M-a),x&&P&&y[M].push(b))}}}if(w&&(t===e&&S.push(_),y[_]=S),g.length){var R=c(g,h,v[h]);g.splice(R+1,0,_)}else g.push(_)}for(m=0;m<y.length;m++){var L=y[m];L&&L.sort(function(t,e){return t-e})}return y}},m=u.extend({initialize:function(t){this.precision=u.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,n){return this.number(t)+(n||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});m.instance=new m;var g=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,r=Math.sqrt,i=Math.pow,s=Math.log2||function(t){return Math.log(t)*Math.LOG2E},o=1e-12,a=112e-18;function l(t,e,n){return t<e?e:t>n?n:t}function c(t,e,r){function i(t){var e=134217729*t,n=t-e+e;return[n,t-n]}var s=e*e-t*r,o=e*e+t*r;if(3*n(s)<o){var a=i(t),l=i(e),c=i(r),u=e*e,h=t*r;s=u-h+(l[0]*l[0]-u+2*l[0]*l[1]+l[1]*l[1]-(a[0]*c[0]-h+a[0]*c[1]+a[1]*c[0]+a[1]*c[1]))}return s}function u(){var t=Math.max.apply(Math,arguments);return t&&(t<1e-8||t>1e8)?i(2,-Math.round(s(t))):0}return{EPSILON:o,MACHINE_EPSILON:a,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,KAPPA:4*(r(2)-1)/3,isZero:function(t){return t>=-1e-12&&t<=o},isMachineZero:function(t){return t>=-112e-18&&t<=a},clamp:l,integrate:function(n,r,i,s){for(var o=t[s-2],a=e[s-2],l=.5*(i-r),c=l+r,u=0,h=s+1>>1,d=1&s?a[u++]*n(c):0;u<h;){var f=l*o[u];d+=a[u++]*(n(c+f)+n(c-f))}return l*d},findRoot:function(t,e,r,i,s,o,a){for(var c=0;c<o;c++){var u=t(r),h=u/e(r),d=r-h;if(n(h)<a){r=d;break}u>0?(s=r,r=d<=i?.5*(i+s):d):(i=r,r=d>=s?.5*(i+s):d)}return l(r,i,s)},solveQuadratic:function(t,e,i,s,h,d){var f,p=1/0;if(n(t)<o){if(n(e)<o)return n(i)<o?-1:0;f=-i/e}else{var m=c(t,e*=-.5,i);if(m&&n(m)<a){var g=u(n(t),n(e),n(i));g&&(m=c(t*=g,e*=g,i*=g))}if(m>=-112e-18){var y=m<0?0:r(m),_=e+(e<0?-y:y);0===_?p=-(f=i/t):(f=_/t,p=i/_)}}var v=0,b=null==h,w=h-o,x=d+o;return isFinite(f)&&(b||f>w&&f<x)&&(s[v++]=b?f:l(f,h,d)),p!==f&&isFinite(p)&&(b||p>w&&p<x)&&(s[v++]=b?p:l(p,h,d)),v},solveCubic:function(t,e,s,c,h,d,f){var p,m,y,_,v,b=u(n(t),n(e),n(s),n(c));function w(n){var r=t*(p=n);_=(r+(m=r+e))*p+(y=m*p+s),v=y*p+c}if(b&&(t*=b,e*=b,s*=b,c*=b),n(t)<o)t=e,m=s,y=c,p=1/0;else if(n(c)<o)m=e,y=s,p=0;else{w(-e/t/3);var x=v/t,S=i(n(x),1/3),E=x<0?-1:1,A=-_/t,T=A>0?1.324717957244746*Math.max(S,r(A)):S,C=p-E*T;if(C!==p){do{w(C),C=0===_?p:p-v/_/(1+a)}while(E*C>E*p);n(t)*p*p>n(c/p)&&(m=((y=-c/p)-s)/p)}}var M=g.solveQuadratic(t,m,y,h,d,f),O=null==d;return isFinite(p)&&(0===M||M>0&&p!==h[0]&&p!==h[1])&&(O||p>d-o&&p<f+o)&&(h[M++]=O?p:l(p,d,f)),M}}},y={_id:1,_pools:{},get:function(t){if(t){var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}return this._id++}},_=u.extend({_class:"Point",_readIndex:!0,initialize:function(t,e){var n=typeof t,r=this.__read,i=0;if("number"===n){var s="number"==typeof e;this._set(t,s?e:t),r&&(i=s?2:1)}else if("undefined"===n||null===t)this._set(0,0),r&&(i=null===t?1:0);else{var o="string"===n?t.split(/[\s,]+/)||[]:t;i=1,Array.isArray(o)?this._set(+o[0],+(o.length>1?o[1]:o[0])):"x"in o?this._set(o.x||0,o.y||0):"width"in o?this._set(o.width||0,o.height||0):"angle"in o?(this._set(o.length||0,0),this.setAngle(o.angle||0)):(this._set(0,0),i=0)}return r&&(this.__read=i),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new _(this.x,this.y)},toString:function(){var t=m.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var n=t/this.getLength();g.isZero(n)&&this.getAngle(),this._set(this.x*n,this.y*n)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=_.read(arguments),e=this.getLength()*t.getLength();if(g.isZero(e))return NaN;var n=this.dot(t)/e;return Math.acos(n<-1?-1:n>1?1:n)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=_.read(arguments);return 180*Math.atan2(this.cross(t),this.dot(t))/Math.PI},getDistance:function(){var t=arguments,e=_.read(t),n=e.x-this.x,r=e.y-this.y,i=n*n+r*r,s=u.read(t);return s?i:Math.sqrt(i)},normalize:function(t){t===a&&(t=1);var e=this.getLength(),n=0!==e?t/e:0,r=new _(this.x*n,this.y*n);return n>=0&&(r._angle=this._angle),r},rotate:function(t,e){if(0===t)return this.clone();t=t*Math.PI/180;var n=e?this.subtract(e):this,r=Math.sin(t),i=Math.cos(t);return n=new _(n.x*i-n.y*r,n.x*r+n.y*i),e?n.add(e):n},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=_.read(arguments);return new _(this.x+t.x,this.y+t.y)},subtract:function(){var t=_.read(arguments);return new _(this.x-t.x,this.y-t.y)},multiply:function(){var t=_.read(arguments);return new _(this.x*t.x,this.y*t.y)},divide:function(){var t=_.read(arguments);return new _(this.x/t.x,this.y/t.y)},modulo:function(){var t=_.read(arguments);return new _(this.x%t.x,this.y%t.y)},negate:function(){return new _(-this.x,-this.y)},isInside:function(){return x.read(arguments).contains(this)},isClose:function(){var t=arguments,e=_.read(t),n=u.read(t);return this.getDistance(e)<=n},isCollinear:function(){var t=_.read(arguments);return _.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=_.read(arguments);return _.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=g.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=_.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=_.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=_.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new _(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=_.read(t),n=_.read(t);return new _(Math.min(e.x,n.x),Math.min(e.y,n.y))},max:function(){var t=arguments,e=_.read(t),n=_.read(t);return new _(Math.max(e.x,n.x),Math.max(e.y,n.y))},random:function(){return new _(Math.random(),Math.random())},isCollinear:function(t,e,n,r){return Math.abs(t*r-e*n)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+r*r))},isOrthogonal:function(t,e,n,r){return Math.abs(t*n+e*r)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+r*r))}}},u.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new _(e(this.x),e(this.y))}},{})),v=_.extend({initialize:function(t,e,n,r){this._x=t,this._y=e,this._owner=n,this._setter=r},_set:function(t,e,n){return this._x=t,this._y=e,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return"setPosition"===this._setter?4:0}}),b=u.extend({_class:"Size",_readIndex:!0,initialize:function(t,e){var n=typeof t,r=this.__read,i=0;if("number"===n){var s="number"==typeof e;this._set(t,s?e:t),r&&(i=s?2:1)}else if("undefined"===n||null===t)this._set(0,0),r&&(i=null===t?1:0);else{var o="string"===n?t.split(/[\s,]+/)||[]:t;i=1,Array.isArray(o)?this._set(+o[0],+(o.length>1?o[1]:o[0])):"width"in o?this._set(o.width||0,o.height||0):"x"in o?this._set(o.x||0,o.y||0):(this._set(0,0),i=0)}return r&&(this.__read=i),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new b(this.width,this.height)},toString:function(){var t=m.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=b.read(arguments);return new b(this.width+t.width,this.height+t.height)},subtract:function(){var t=b.read(arguments);return new b(this.width-t.width,this.height-t.height)},multiply:function(){var t=b.read(arguments);return new b(this.width*t.width,this.height*t.height)},divide:function(){var t=b.read(arguments);return new b(this.width/t.width,this.height/t.height)},modulo:function(){var t=b.read(arguments);return new b(this.width%t.width,this.height%t.height)},negate:function(){return new b(-this.width,-this.height)},isZero:function(){var t=g.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new b(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new b(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new b(Math.random(),Math.random())}}},u.each(["round","ceil","floor","abs"],function(t){var e=Math[t];this[t]=function(){return new b(e(this.width),e(this.height))}},{})),w=b.extend({initialize:function(t,e,n,r){this._width=t,this._height=e,this._owner=n,this._setter=r},_set:function(t,e,n){return this._width=t,this._height=e,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),x=u.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(t,e,n,r){var i,s=arguments,o=typeof t;if("number"===o?(this._set(t,e,n,r),i=4):"undefined"===o||null===t?(this._set(0,0,0,0),i=null===t?1:0):1===s.length&&(Array.isArray(t)?(this._set.apply(this,t),i=1):t.x!==a||t.width!==a?(this._set(t.x||0,t.y||0,t.width||0,t.height||0),i=1):t.from===a&&t.to===a&&(this._set(0,0,0,0),u.readSupported(s,this)&&(i=1))),i===a){var l,c,h=_.readNamed(s,"from"),d=u.peek(s),f=h.x,p=h.y;if(d&&d.x!==a||u.hasNamed(s,"to")){var m=_.readNamed(s,"to");(l=m.x-f)<0&&(f=m.x,l=-l),(c=m.y-p)<0&&(p=m.y,c=-c)}else{var g=b.read(s);l=g.width,c=g.height}this._set(f,p,l,c),i=s.__index}var y=s.__filtered;return y&&(this.__filtered=y),this.__read&&(this.__read=i),this},set:"#initialize",_set:function(t,e,n,r){return this.x=t,this.y=e,this.width=n,this.height=r,this},clone:function(){return new x(this.x,this.y,this.width,this.height)},equals:function(t){var e=u.isPlainValue(t)?x.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=m.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){return new(t?_:v)(this.x,this.y,this,"setPoint")},setPoint:function(){var t=_.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){return new(t?b:w)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=b.read(arguments),e=this._sx,n=this._sy,r=t.width,i=t.height;e&&(this.x+=(this.width-r)*e),n&&(this.y+=(this.height-i)*n),this.width=r,this.height=i,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=.5===this._sx?2*e:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=.5===this._sy?2*e:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=.5===this._sx?2*e:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=.5===this._sy?2*e:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||.5===this._sx?this.x=t-this.width/2:(this._sx&&(this.x+=2*(t-this.x)*this._sx),this.width=2*(t-this.x)),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||.5===this._sy?this.y=t-this.height/2:(this._sy&&(this.y+=2*(t-this.y)*this._sy),this.height=2*(t-this.y)),this._sy=.5,this._fh=0},getCenter:function(t){return new(t?_:v)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=_.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(t){return t&&t.width!==a||4===(Array.isArray(t)?t:arguments).length?this._containsRectangle(x.read(arguments)):this._containsPoint(_.read(arguments))},_containsPoint:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e+t.width<=this.x+this.width&&n+t.height<=this.y+this.height},intersects:function(){var t=x.read(arguments),e=u.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=x.read(arguments),e=Math.max(this.x,t.x),n=Math.max(this.y,t.y),r=Math.min(this.x+this.width,t.x+t.width),i=Math.min(this.y+this.height,t.y+t.height);return new x(e,n,r-e,i-n)},unite:function(){var t=x.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x+this.width,t.x+t.width),i=Math.max(this.y+this.height,t.y+t.height);return new x(e,n,r-e,i-n)},include:function(){var t=_.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x+this.width,t.x),i=Math.max(this.y+this.height,t.y);return new x(e,n,r-e,i-n)},expand:function(){var t=b.read(arguments),e=t.width,n=t.height;return new x(this.x-e/2,this.y-n/2,this.width+e,this.height+n)},scale:function(t,e){return this.expand(this.width*t-this.width,this.height*(e===a?t:e)-this.height)}},u.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(t,e){var n=t.join(""),r=/^[RL]/.test(n);e>=4&&(t[1]+=r?"Y":"X");var i=t[r?0:1],s=t[r?1:0],o="get"+i,a="get"+s,l="set"+i,c="set"+s,u="set"+n;this["get"+n]=function(t){return new(t?_:v)(this[o](),this[a](),this,u)},this[u]=function(){var t=_.read(arguments);this[l](t.x),this[c](t.y)}},{beans:!0})),S=x.extend({initialize:function(t,e,n,r,i,s){this._set(t,e,n,r,!0),this._owner=i,this._setter=s},_set:function(t,e,n,r,i){return this._x=t,this._y=e,this._width=n,this._height=r,i||this._owner[this._setter](this),this}},new function(){var t=x.prototype;return u.each(["x","y","width","height"],function(t){var e=u.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._dontNotify||this._owner[this._setter](this)}},u.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(e){var n="set"+e;this[n]=function(){this._dontNotify=!0,t[n].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(2&this._owner._selection)},setSelected:function(t){var e=this._owner;e._changeSelection&&e._changeSelection(2,t)}}))}),E=u.extend({_class:"Matrix",initialize:function t(e,n){var r=arguments,i=r.length,s=!0;if(i>=6?this._set.apply(this,r):1===i||2===i?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,n):Array.isArray(e)?this._set.apply(this,n?e.concat([n]):e):s=!1:i?s=!1:this.reset(),!s)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,n,r,i,s,o){return this._a=t,this._b=e,this._c=n,this._d=r,this._tx=i,this._ty=s,o||this._changed(),this},_serialize:function(t,e){return u.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new E(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=m.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var n=this._owner;return!!n&&(n.transform(null,u.pick(t,!0),e),this.isIdentity())},translate:function(){var t=_.read(arguments),e=t.x,n=t.y;return this._tx+=e*this._a+n*this._c,this._ty+=e*this._b+n*this._d,this._changed(),this},scale:function(){var t=arguments,e=_.read(t),n=_.read(t,0,{readNull:!0});return n&&this.translate(n),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,n&&this.translate(n.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=_.read(arguments,1),n=e.x,r=e.y,i=Math.cos(t),s=Math.sin(t),o=n-n*i+r*s,a=r-n*s-r*i,l=this._a,c=this._b,u=this._c,h=this._d;return this._a=i*l+s*u,this._b=i*c+s*h,this._c=-s*l+i*u,this._d=-s*c+i*h,this._tx+=o*l+a*u,this._ty+=o*c+a*h,this._changed(),this},shear:function(){var t=arguments,e=_.read(t),n=_.read(t,0,{readNull:!0});n&&this.translate(n);var r=this._a,i=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*r,this._d+=e.x*i,n&&this.translate(n.negate()),this._changed(),this},skew:function(){var t=arguments,e=_.read(t),n=_.read(t,0,{readNull:!0}),r=Math.PI/180,i=new _(Math.tan(e.x*r),Math.tan(e.y*r));return this.shear(i,n)},append:function(t,e){if(t){var n=this._a,r=this._b,i=this._c,s=this._d,o=t._a,a=t._c,l=t._b,c=t._d,u=t._tx,h=t._ty;this._a=o*n+l*i,this._c=a*n+c*i,this._b=o*r+l*s,this._d=a*r+c*s,this._tx+=u*n+h*i,this._ty+=u*r+h*s,e||this._changed()}return this},prepend:function(t,e){if(t){var n=this._a,r=this._b,i=this._c,s=this._d,o=this._tx,a=this._ty,l=t._a,c=t._c,u=t._b,h=t._d,d=t._tx,f=t._ty;this._a=l*n+c*r,this._c=l*i+c*s,this._b=u*n+h*r,this._d=u*i+h*s,this._tx=l*o+c*a+d,this._ty=u*o+h*a+f,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,n=this._c,r=this._d,i=this._tx,s=this._ty,o=t*r-e*n,a=null;return o&&!isNaN(o)&&isFinite(i)&&isFinite(s)&&(this._a=r/o,this._b=-e/o,this._c=-n/o,this._d=t/o,this._tx=(n*s-r*i)/o,this._ty=(e*i-t*s)/o,a=this),a},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new E(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,n){return arguments.length<3?this._transformPoint(_.read(arguments)):this._transformCoordinates(t,e,n)},_transformPoint:function(t,e,n){var r=t.x,i=t.y;return e||(e=new _),e._set(r*this._a+i*this._c+this._tx,r*this._b+i*this._d+this._ty,n)},_transformCoordinates:function(t,e,n){for(var r=0,i=2*n;r<i;r+=2){var s=t[r],o=t[r+1];e[r]=s*this._a+o*this._c+this._tx,e[r+1]=s*this._b+o*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,n=t.y,r=e+t.width,i=n+t.height,s=[e,n,r,n,r,i,e,i];return this._transformCoordinates(s,s,4)},_transformBounds:function(t,e,n){for(var r=this._transformCorners(t),i=r.slice(0,2),s=i.slice(),o=2;o<8;o++){var a=r[o],l=1&o;a<i[l]?i[l]=a:a>s[l]&&(s[l]=a)}return e||(e=new x),e._set(i[0],i[1],s[0]-i[0],s[1]-i[1],n)},inverseTransform:function(){return this._inverseTransform(_.read(arguments))},_inverseTransform:function(t,e,n){var r=this._a,i=this._b,s=this._c,o=this._d,a=this._tx,l=this._ty,c=r*o-i*s,u=null;if(c&&!isNaN(c)&&isFinite(a)&&isFinite(l)){var h=t.x-this._tx,d=t.y-this._ty;e||(e=new _),u=e._set((h*o-d*s)/c,(d*r-h*i)/c,n)}return u},decompose:function(){var t,e,n,r=this._a,i=this._b,s=this._c,o=this._d,a=r*o-i*s,l=Math.sqrt,c=Math.atan2,u=180/Math.PI;if(0!==r||0!==i){var h=l(r*r+i*i);t=Math.acos(r/h)*(i>0?1:-1),e=[h,a/h],n=[c(r*s+i*o,h*h),0]}else if(0!==s||0!==o){var d=l(s*s+o*o);t=Math.asin(s/d)*(o>0?1:-1),e=[a/d,d],n=[0,c(r*s+i*o,d*d)]}else t=0,n=e=[0,0];return{translation:this.getTranslation(),rotation:t*u,scaling:new _(e),skewing:new _(n[0]*u,n[1]*u)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new _(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},u.each(["a","b","c","d","tx","ty"],function(t){var e=u.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._changed()}},{})),A=u.extend({_class:"Line",initialize:function(t,e,n,r,i){var s=!1;arguments.length>=4?(this._px=t,this._py=e,this._vx=n,this._vy=r,s=i):(this._px=t.x,this._py=t.y,this._vx=e.x,this._vy=e.y,s=n),s||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new _(this._px,this._py)},getVector:function(){return new _(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return A.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return A.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return A.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return _.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return _.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,n,r,i,s,o,a,l,c){l||(n-=t,r-=e,o-=i,a-=s);var u=n*a-r*o;if(!g.isMachineZero(u)){var h=t-i,d=e-s,f=(o*d-a*h)/u,p=(n*d-r*h)/u,m=-1e-12,y=1+1e-12;if(c||m<f&&f<y&&m<p&&p<y)return c||(f=f<=0?0:f>=1?1:f),new _(t+f*n,e+f*r)}},getSide:function(t,e,n,r,i,s,o,a){o||(n-=t,r-=e);var l=i-t,c=l*r-(s-e)*n;return!a&&g.isMachineZero(c)&&(c=(l*n+l*n)/(n*n+r*r))>=0&&c<=1&&(c=0),c<0?-1:c>0?1:0},getSignedDistance:function(t,e,n,r,i,s,o){return o||(n-=t,r-=e),0===n?r>0?i-t:t-i:0===r?n<0?s-e:e-s:((i-t)*r-(s-e)*n)/(r>n?r*Math.sqrt(1+n*n/(r*r)):n*Math.sqrt(1+r*r/(n*n)))},getDistance:function(t,e,n,r,i,s,o){return Math.abs(A.getSignedDistance(t,e,n,r,i,s,o))}}}),T=f.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(t){f.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Y(null,null,this),this._view=X.create(this,t||lt.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return u.serialize(this._children,t,!0,e)},_changed:function(t,e){if(1&t){var n=this._view;n&&(n._needsUpdate=!0,!n._requested&&n._autoUpdate&&n.requestUpdate())}var r=this._changes;if(r&&e){var i=this._changesById,s=e._id,o=i[s];o?o.flags|=t:r.push(i[s]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return!!t.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new O({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:R,match:function(n){var r=n._definition,i=r._id;return e[i]||(e[i]=!0,t.push(r)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var n in t){var r=t[n],i=r._selection;1&i&&r.isInserted()?e.push(r):i||this._updateSelection(r)}return e},_updateSelection:function(t){var e=t._id,n=this._selectionItems;t._selection?n[e]!==t&&(this._selectionCount++,n[e]=t):n[e]===t&&(this._selectionCount--,delete n[e])},selectAll:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(a,t)},insertLayer:function(t,e){if(e instanceof O){e._remove(!1,!0),u.splice(this._children,[e],t,0),e._setProject(this,!0);var n=e._name;n&&e.setName(n),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,e,n){return e=this.insertLayer(t,e)||(this._activeLayer||this._insertItem(a,new O(C.NO_INSERT),!0)).insertChild(t,e),n&&e.activate&&e.activate(),e},getItems:function(t){return C._getItems(this,t)},getItem:function(t){return C._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return u.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){"mouseup"===t&&(e.mousedrag=null);var n=e[t];if(n){for(var r in n){var i=n[r];for(var s in e){var o=e[s];o&&o!=n&&delete o[i._id]}i.remove()}e[t]=null}}},draw:function(t,e,n){this._updateVersion++,t.save(),e.applyToContext(t);for(var r=this._children,i=new u({offset:new _(0,0),pixelRatio:n,viewMatrix:e.isIdentity()?null:e,matrices:[new E],updateMatrix:!0}),s=0,o=r.length;s<o;s++)r[s].draw(t,i);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var a=this._selectionItems,l=this._scope.settings.handleSize,c=this._updateVersion;for(var h in a)a[h]._drawSelection(t,e,l,a,c);t.restore()}}}),C=u.extend(h,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=u.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new E,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return u.each(t,function(t){this._events[t]={install:function(t){this.getView()._countItemEvent(t,1)},uninstall:function(t){this.getView()._countItemEvent(t,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,e){var n=t&&u.isPlainObject(t),r=n&&!0===t.internal,i=this._matrix=new E,s=n&&t.project||dt.project,o=dt.settings;return this._id=r?null:y.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&o.applyMatrix,e&&i.translate(e),i._owner=this,this._style=new Y(s._currentStyle,this,s),r||n&&0==t.insert||!o.insertItems&&(!n||!0!==t.insert)?this._setProject(s):(n&&t.parent||s)._insertItem(a,this,!0),n&&t!==C.NO_INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),n},_serialize:function(t,e){var n={},r=this;function i(i){for(var s in i){var o=r[s];u.equals(o,"leading"===s?1.2*i.fontSize:i[s])||(n[s]=u.serialize(o,t,"data"!==s,e))}}return i(this._serializeFields),this instanceof M||i(this._style._defaults),[this._class,n]},_changed:function(t){var e=this._symbol,n=this._parent||e,r=this._project;8&t&&(this._bounds=this._position=this._decomposed=a),16&t&&(this._globalMatrix=a),n&&72&t&&C._clearBoundsCache(n),2&t&&C._clearBoundsCache(this),r&&r._changed(t,this),e&&e._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var e=this._getOwner();if(t&&e){var n=e._children,r=e._namedChildren;(r[t]=r[t]||[]).push(this),t in n||(n[t]=this)}this._name=t||a,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},u.each(["locked","visible","blendMode","opacity","guide"],function(t){var e=u.capitalize(t),n="_"+t,r={locked:256,visible:265};this["get"+e]=function(){return this[n]},this["set"+e]=function(e){e!=this[n]&&(this[n]=e,this._changed(r[t]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){if(this._selectChildren)for(var t=this._children,e=0,n=t.length;e<n;e++)if(t[e].isSelected())return!0;return!!(1&this._selection)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,n=0,r=e.length;n<r;n++)e[n].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(1&this._selection);if(t&&e){for(var n=0,r=t.length;n<r;n++)if(!t[n].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var n=0,r=e.length;n<r;n++)e[n].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?_:v,n=this._position||(this._position=this._getPositionFromBounds());return new e(n.x,n.y,this,"setPosition")},setPosition:function(){this.translate(_.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new v(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=_.read(arguments,0,{clone:!0,readNull:!0}),this._position=a}},u.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,e){this[e]=function(e){return this.getBounds(e,t)}},{beans:!0,getBounds:function(t,e){var n=e||t instanceof E,r=u.set({},n?e:t,this._boundsOptions);r.stroke&&!this.getStrokeScaling()||(r.cacheItem=this);var i=this._getCachedBounds(n&&t,r).rect;return arguments.length?i:new S(i.x,i.y,i.width,i.height,this,"setBounds")},setBounds:function(){var t=x.read(arguments),e=this.getBounds(),n=this._matrix,r=new E,i=t.getCenter();r.translate(i),t.width==e.width&&t.height==e.height||(n.isInvertible()||(n.set(n._backup||(new E).translate(n.getTranslation())),e=this.getBounds()),r.scale(0!==e.width?t.width/e.width:0,0!==e.height?t.height/e.height:0)),i=e.getCenter(),r.translate(-i.x,-i.y),this.transform(r)},_getBounds:function(t,e){var n=this._children;return n&&n.length?(C._updateBoundsCache(this,e.cacheItem),C._getBounds(n,t,e)):new x},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,n){t=t&&t._orNullIfIdentity();var r=e.internal&&!n,i=e.cacheItem,s=r?null:this._matrix._orNullIfIdentity(),o=i&&(!t||t.equals(s))&&this._getBoundsCacheKey(e,r),a=this._bounds;if(C._updateBoundsCache(this._parent||this._symbol,i),o&&a&&o in a)return{rect:(d=a[o]).rect.clone(),nonscaling:d.nonscaling};var l=this._getBounds(t||s,e),c=l.rect||l,u=this._style,h=l.nonscaling||u.hasStroke()&&!u.getStrokeScaling();if(o){a||(this._bounds=a={});var d=a[o]={rect:c.clone(),nonscaling:h,internal:r}}return{rect:c,nonscaling:h}},_getStrokeMatrix:function(t,e){var n=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,r=n?n.getViewMatrix().invert():t;return r&&r._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var n=e._id,r=t._boundsCache=t._boundsCache||{ids:{},list:[]};r.ids[n]||(r.list.push(e),r.ids[n]=e)}},_clearBoundsCache:function(t){var e=t._boundsCache;if(e){t._bounds=t._position=t._boundsCache=a;for(var n=0,r=e.list,i=r.length;n<i;n++){var s=r[n];s!==t&&(s._bounds=s._position=a,s._boundsCache&&C._clearBoundsCache(s))}}},_getBounds:function(t,e,n){var r=1/0,i=-r,s=r,o=i,a=!1;n=n||{};for(var l=0,c=t.length;l<c;l++){var u=t[l];if(u._visible&&!u.isEmpty(!0)){var h=u._getCachedBounds(e&&e.appended(u._matrix),n,!0),d=h.rect;r=Math.min(d.x,r),s=Math.min(d.y,s),i=Math.max(d.x+d.width,i),o=Math.max(d.y+d.height,o),h.nonscaling&&(a=!0)}}return{rect:isFinite(r)?new x(r,s,i-r,o-s):new x,nonscaling:a}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(null!=e&&null!=t){var n=this._decomposed;this.rotate(t-e),n&&(n.rotation=t,this._decomposed=n)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new v(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=_.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var n=this.getRotation(),r=this._decomposed,i=new E,s=g.isZero;if(s(t.x)||s(t.y))i.translate(r.translation),n&&i.rotate(n),i.scale(e.x,e.y),this._matrix.set(i);else{var o=this.getPosition(!0);i.translate(o),n&&i.rotate(n),i.scale(e.x/t.x,e.y/t.y),n&&i.rotate(-n),i.translate(o.negate()),this.transform(i)}r&&(r.scaling=e,this._decomposed=r)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var n=this._parent,r=[];n;){if(!n._globalMatrix){e=null;for(var i=0,s=r.length;i<s;i++)r[i]._globalMatrix=null;break}r.push(n),n=n._parent}return e||(e=this._globalMatrix=this._matrix.clone(),(n=this._parent)&&e.prepend(n.getGlobalMatrix(!0))),t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var n=this._children,r=0,i=n&&n.length;r<i;r++)n[r]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var n=this._children,r=0,i=n&&n.length;r<i;r++)n[r]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof O)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return u.equals(this._children,t._children)},clone:function(t){var e=new this.constructor(C.NO_INSERT),n=this._children,r=u.pick(t?t.insert:a,t===a||!0===t),i=u.pick(t?t.deep:a,!0);n&&e.copyAttributes(this),n&&!i||e.copyContent(this),n||e.copyAttributes(this),r&&e.insertAbove(this);var s=this._name,o=this._parent;if(s&&o){n=o._children;for(var l=s,c=1;n[s];)s=l+" "+c++;s!==l&&e.setName(s)}return e},copyContent:function(t){for(var e=t._children,n=0,r=e&&e.length;n<r;n++)this.addChild(e[n].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var n=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],r=0,i=n.length;r<i;r++){var s=n[r];t.hasOwnProperty(s)&&(this[s]=t[s])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var o=t._data,a=t._name;this._data=o?u.clone(o):null,a&&this.setName(a)},rasterize:function(t,e){var n,r,i;u.isPlainObject(t)?(n=t.resolution,r=t.insert,i=t.raster):(n=t,r=e),i?i.matrix.reset(!0):i=new D(C.NO_INSERT);var s=this.getStrokeBounds(),o=(n||this.getView().getResolution())/72,l=s.getTopLeft().floor(),c=s.getBottomRight().ceil(),h=new b(c.subtract(l)),d=h.multiply(o);if(i.setSize(d,!0),!d.isZero()){var f=i.getContext(!0),p=(new E).scale(o).translate(l.negate());f.save(),p.applyToContext(f),this.draw(f,new u({matrices:[p]})),f.restore()}return i.transform((new E).translate(l.add(h.divide(2))).scale(1/o)),(r===a||r)&&i.insertAbove(this),i},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(_.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var n=e.length-1;n>=0;n--)if(e[n].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return x.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new U.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof C&&this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0}},new function(){function t(){var t=arguments;return this._hitTest(_.read(t),I.getOptions(t))}function e(){var t=arguments,e=_.read(t),n=I.getOptions(t),r=[];return this._hitTest(e,new u({all:r},n)),r}function n(t,e,n,r){var i=this._children;if(i)for(var s=i.length-1;s>=0;s--){var o=i[s],a=o!==r&&o._hitTest(t,e,n);if(a&&!e.all)return a}return null}return T.inject({hitTest:t,hitTestAll:e,_hitTest:n}),{hitTest:t,hitTestAll:e,_hitTestChildren:n}},{_hitTest:function(t,e,n){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var r=this._matrix,i=n?n.appended(r):this.getGlobalMatrix().prepend(this.getView()._matrix),s=Math.max(e.tolerance,1e-12),o=e._tolerancePadding=new b(U._getStrokePadding(s,r._shiftless().invert()));if(!(t=r._inverseTransform(t))||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(o.multiply(2))._containsPoint(t))return null;var a,l,c=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==u.hyphenate(this._class)||e.class&&!(this instanceof e.class)),h=e.match,d=this;function f(t){return t&&h&&!h(t)&&(t=null),t&&e.all&&e.all.push(t),t}function p(e,n){var r=n?a["get"+n]():d.getPosition();if(t.subtract(r).divide(o).length<=1)return new I(e,d,{name:n?u.hyphenate(n):e,point:r})}var m=e.position,g=e.center,y=e.bounds;if(c&&this._parent&&(m||g||y)){if((g||y)&&(a=this.getInternalBounds()),!(l=m&&p("position")||g&&p("center","Center"))&&y)for(var _=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],v=0;v<8&&!l;v++)l=p("bounds",_[v]);l=f(l)}return l||(l=this._hitTestChildren(t,e,i)||c&&f(this._hitTestSelf(t,e,i,this.getStrokeScaling()?null:i._shiftless().invert()))||null),l&&l.point&&(l.point=r.transform(l.point)),l},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new I("fill",this)},matches:function(t,e){var n=typeof t;if("object"===n){for(var r in t)if(t.hasOwnProperty(r)&&!this.matches(r,t[r]))return!1;return!0}if("function"===n)return t(this);if("match"===t)return e(this);var i=/^(empty|editable)$/.test(t)?this["is"+u.capitalize(t)]():"type"===t?u.hyphenate(this._class):this[t];if("class"===t){if("function"==typeof e)return this instanceof e;i=this._class}if("function"==typeof e)return!!e(i);if(e){if(e.test)return e.test(i);if(u.isPlainObject(e))return function t(e,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],s=n[r];if(u.isPlainObject(i)&&u.isPlainObject(s)){if(!t(i,s))return!1}else if(!u.equals(i,s))return!1}return!0}(e,i)}return u.equals(i,e)},getItems:function(t){return C._getItems(this,t,this._matrix)},getItem:function(t){return C._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,n,r,i,s){if(!i){var o="object"==typeof n&&n,a=o&&o.overlapping,l=o&&o.inside,c=(_=a||l)&&x.read([_]);i={items:[],recursive:o&&!1!==o.recursive,inside:!!l,overlapping:!!a,rect:c,path:a&&new U.Rectangle({rectangle:c,insert:!1})},o&&(n=u.filter({},n,{recursive:!0,inside:!0,overlapping:!0}))}var h=e._children,d=i.items;r=(c=i.rect)&&(r||new E);for(var f=0,p=h&&h.length;f<p;f++){var m=h[f],g=r&&r.appended(m._matrix),y=!0;if(c){var _=m.getBounds(g);if(!c.intersects(_))continue;c.contains(_)||i.overlapping&&(_.contains(c)||i.path.intersects(m,g))||(y=!1)}if(y&&m.matches(n)&&(d.push(m),s))break;if(!1!==i.recursive&&t(m,n,g,i,s),s&&d.length>0)break}return d}}},{importJSON:function(t){var e=u.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(a,t)},insertChild:function(t,e){var n=e?this.insertChildren(t,[e]):null;return n&&n[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var n=this._children;if(n&&e&&e.length>0){for(var r={},i=(e=u.slice(e)).length-1;i>=0;i--){var s=(c=e[i])&&c._id;!c||r[s]?e.splice(i,1):(c._remove(!1,!0),r[s]=!0)}u.splice(n,e,t,0);for(var o=this._project,a=o._changes,l=(i=0,e.length);i<l;i++){var c,h=(c=e[i])._name;c._parent=this,c._setProject(o,!0),h&&c.setName(h),a&&c._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var n=t&&t._getOwner(),r=t!==this&&n?this:null;return r&&(r._remove(!1,!0),n._insertItem(t._index+e,r)),r},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(a,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(a,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&1===e.length){var n=e[0].reduce(t);return this._parent?(n.insertAbove(this),this.remove()):n.remove(),n}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,n=t._namedChildren,r=this._name,i=n[r],s=i?i.indexOf(this):-1;-1!==s&&(e[r]==this&&delete e[r],i.splice(s,1),i.length?e[r]=i[0]:delete n[r])}},_remove:function(t,e){var n=this._getOwner(),r=this._project,i=this._index;return this._style&&this._style._dispose(),!!n&&(this._name&&this._removeNamed(),null!=i&&(r._activeLayer===this&&(r._activeLayer=this.getNextSibling()||this.getPreviousSibling()),u.splice(n._children,null,i,1)),this._installEvents(!1),t&&r._changes&&this._changed(5),e&&n._changed(11,this),this._parent=null,!0)},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=u.pick(e,this._children.length);for(var n=u.splice(this._children,null,t,e-t),r=n.length-1;r>=0;r--)n[r]._remove(!0,!1);return n.length>0&&this._changed(11),n},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,n=e?e.length:0;if(t){for(var r=0;r<n;r++)if(!e[r].isEmpty(t))return!1;return!0}return!n},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(t){var e=[];do{e.unshift(t)}while(t=t._parent);return e}for(var n=e(this),r=e(t),i=0,s=Math.min(n.length,r.length);i<s;i++)if(n[i]!=r[i])return n[i]._index<r[i]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(t){return-1===this._getOrder(t)},isBelow:function(t){return 1===this._getOrder(t)},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return!!t&&t.isDescendant(this)},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},u.each(["rotate","scale","shear","skew"],function(t){var e="rotate"===t;this[t]=function(){var n=arguments,r=(e?u:_).read(n),i=_.read(n,0,{readNull:!0});return this.transform((new E)[t](r,i||this.getPosition(!0)))}},{translate:function(){var t=new E;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,n){var r=this._matrix,i=t&&!t.isIdentity(),s=n&&this._canApplyMatrix||this._applyMatrix&&(i||!r.isIdentity()||e&&this._children);if(!i&&!s)return this;if(i){!t.isInvertible()&&r.isInvertible()&&(r._backup=r.getValues()),r.prepend(t,!0);var o=this._style,a=o.getFillColor(!0),l=o.getStrokeColor(!0);a&&a.transform(t),l&&l.transform(t)}if(s&&(s=this._transformContent(r,e,n))){var c=this._pivot;c&&r._transformPoint(c,c,!0),r.reset(!0),n&&this._canApplyMatrix&&(this._applyMatrix=!0)}var u=this._bounds,h=this._position;(i||s)&&this._changed(25);var d=i&&u&&t.decompose();if(d&&d.skewing.isZero()&&d.rotation%90==0){for(var f in u){var p=u[f];if(p.nonscaling)delete u[f];else if(s||!p.internal){var m=p.rect;t._transformBounds(m,m)}}this._bounds=u;var g=u[this._getBoundsCacheKey(this._boundsOptions||{})];g&&(this._position=this._getPositionFromBounds(g.rect))}else i&&h&&this._pivot&&(this._position=t._transformPoint(h,h));return this},_transformContent:function(t,e,n){var r=this._children;if(r){for(var i=0,s=r.length;i<s;i++)r[i].transform(t,e,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(_.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(_.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(_.read(arguments))},localToParent:function(){return this._matrix._transformPoint(_.read(arguments))},fitBounds:function(t,e){t=x.read(arguments);var n=this.getBounds(),r=n.height/n.width,i=t.height/t.width,s=(e?r>i:r<i)?t.width/n.width:t.height/n.height,o=new x(new _,new b(n.width*s,n.height*s));o.setCenter(t.getCenter()),this.setBounds(o)}}),{_setStyles:function(t,e,n){var r=this._style,i=this._matrix;if(r.hasFill()&&(t.fillStyle=r.getFillColor().toCanvasStyle(t,i)),r.hasStroke()){t.strokeStyle=r.getStrokeColor().toCanvasStyle(t,i),t.lineWidth=r.getStrokeWidth();var s=r.getStrokeJoin(),o=r.getStrokeCap(),a=r.getMiterLimit();if(s&&(t.lineJoin=s),o&&(t.lineCap=o),a&&(t.miterLimit=a),dt.support.nativeDash){var l=r.getDashArray(),c=r.getDashOffset();l&&l.length&&("setLineDash"in t?(t.setLineDash(l),t.lineDashOffset=c):(t.mozDash=l,t.mozDashOffset=c))}}if(r.hasShadow()){var u=e.pixelRatio||1,h=n._shiftless().prepend((new E).scale(u,u)),d=h.transform(new _(r.getShadowBlur(),0)),f=h.transform(this.getShadowOffset());t.shadowColor=r.getShadowColor().toCanvasStyle(t),t.shadowBlur=d.getLength(),t.shadowOffsetX=f.x,t.shadowOffsetY=f.y}},draw:function(t,e,n){if(this._updateVersion=this._project._updateVersion,this._visible&&0!==this._opacity){var r=e.matrices,i=e.viewMatrix,s=this._matrix,o=r[r.length-1].appended(s);if(o.isInvertible()){i=i?i.appended(o):o,r.push(o),e.updateMatrix&&(this._globalMatrix=o);var a,l,c,u=this._blendMode,h=g.clamp(this._opacity,0,1),d="normal"===u,f=ct.nativeModes[u],p=d&&1===h||e.dontStart||e.clip||(f||d&&h<1)&&this._canComposite(),m=e.pixelRatio||1;if(!p){var y=this.getStrokeBounds(i);if(!y.width||!y.height)return void r.pop();c=e.offset,l=e.offset=y.getTopLeft().floor(),a=t,t=lt.getContext(y.getSize().ceil().add(1).multiply(m)),1!==m&&t.scale(m,m)}t.save();var _=n?n.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&i,v=!p&&e.clipItem,b=!_||v;if(p?(t.globalAlpha=h,f&&(t.globalCompositeOperation=u)):b&&t.translate(-l.x,-l.y),b&&(p?s:i).applyToContext(t),v&&e.clipItem.draw(t,e.extend({clip:!0})),_){t.setTransform(m,0,0,m,0,0);var w=e.offset;w&&t.translate(-w.x,-w.y)}this._draw(t,e,i,_),t.restore(),r.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),p||(ct.process(u,t,a,h,l.subtract(c).multiply(m)),lt.release(t),e.offset=c)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof V)return e._isUpdated(t);var n=this._updateVersion===t;return!n&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,n=!0),n},_drawSelection:function(t,e,n,r,i){var s=this._selection,o=1&s,a=2&s||o&&this._selectBounds,l=4&s;if(this._drawSelected||(o=!1),(o||a||l)&&this._isUpdated(i)){var c,u=this.getSelectedColor(!0)||(c=this.getLayer())&&c.getSelectedColor(!0),h=e.appended(this.getGlobalMatrix(!0)),d=n/2;if(t.strokeStyle=t.fillStyle=u?u.toCanvasStyle(t):"#009dec",o&&this._drawSelected(t,h,r),l){var f=this.getPosition(!0),p=this._parent,m=p?p.localToGlobal(f):f,g=m.x,y=m.y;t.beginPath(),t.arc(g,y,d,0,2*Math.PI,!0),t.stroke();for(var _=[[0,-1],[1,0],[0,1],[-1,0]],v=d,b=n+1,w=0;w<4;w++){var x=_[w],S=x[0],E=x[1];t.moveTo(g+S*v,y+E*v),t.lineTo(g+S*b,y+E*b),t.stroke()}}if(a){var A=h._transformCorners(this.getInternalBounds());for(t.beginPath(),w=0;w<8;w++)t[w?"lineTo":"moveTo"](A[w],A[++w]);for(t.closePath(),t.stroke(),w=0;w<8;w++)t.fillRect(A[w]-d,A[++w]-d,n,n)}}},_canComposite:function(){return!1}},u.each(["down","drag","up","move"],function(t){this["removeOn"+u.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}},{removeOn:function(t){for(var e in t)if(t[e]){var n="mouse"+e,r=this._project,i=r._removeSets=r._removeSets||{};i[n]=i[n]||{},i[n][this._id]=this}return this}}),{tween:function(t,e,n){n||(n=e,e=t,t=null,n||(n=e,e=null));var r=null!=n&&("number"==typeof n?n:n.duration),i=new ot(this,t,e,r,n&&n.easing,n&&n.start);return r&&this.on("frame",function t(e){i._handleFrame(1e3*e.time),i.running||this.off("frame",t)}),i},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),M=C.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function t(e){t.base.call(this,e),2050&e&&(this._clipItem=a)},_getClipItem:function(){var t=this._clipItem;if(t===a){t=null;for(var e=this._children,n=0,r=e.length;n<r;n++)if(e[n]._clipMask){t=e[n];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,n){var r=this._getClipItem();return r?r._getCachedBounds(r._matrix.prepended(e),u.set({},n,{stroke:!1})):t.base.call(this,e,n)},_hitTestChildren:function t(e,n,r){var i=this._getClipItem();return(!i||i.contains(e))&&t.base.call(this,e,n,r,i)},_draw:function(t,e){var n=e.clip,r=!n&&this._getClipItem();e=e.extend({clipItem:r,clip:!1}),n?(t.beginPath(),e.dontStart=e.dontFinish=!0):r&&r.draw(t,e.extend({clip:!0}));for(var i=this._children,s=0,o=i.length;s<o;s++){var a=i[s];a!==r&&a.draw(t,e)}}}),O=M.extend({_class:"Layer",initialize:function(){M.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function t(){return this._parent?t.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),P=C.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t,e){this._initialize(t,e)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&u.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new w(t.width,t.height,this,"setSize")},setSize:function(){var t=b.read(arguments);if(this._size){if(!this._size.equals(t)){var e=this._type,n=t.width,r=t.height;"rectangle"===e?this._radius.set(b.min(this._radius,t.divide(2).abs())):"circle"===e?(n=r=(n+r)/2,this._radius=n/2):"ellipse"===e&&this._radius._set(n/2,r/2),this._size._set(n,r),this._changed(9)}}else this._size=t.clone()},getRadius:function(){var t=this._radius;return"circle"===this._type?t:new w(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if("circle"===e){if(t===this._radius)return;var n=2*t;this._radius=t,this._size._set(n,n)}else if(t=b.read(arguments),this._radius){if(this._radius.equals(t))return;this._radius.set(t),"rectangle"===e?(n=b.max(this._size,t.multiply(2)),this._size.set(n)):"ellipse"===e&&this._size._set(2*t.width,2*t.height)}else this._radius=t.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var e=new(U[u.capitalize(this._type)])({center:new _,size:this._size,radius:this._radius,insert:!1});return e.copyAttributes(this),dt.settings.applyMatrix&&e.setApplyMatrix(!0),(t===a||t)&&e.insertAbove(this),e},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,n,r){var i=this._style,s=i.hasFill(),o=i.hasStroke(),a=e.dontFinish||e.clip,l=!r;if(s||o||a){var c=this._type,u=this._radius,h="circle"===c;if(e.dontStart||t.beginPath(),l&&h)t.arc(0,0,u,0,2*Math.PI,!0);else{var d=h?u:u.width,f=h?u:u.height,p=this._size,m=p.width,g=p.height;if(l&&"rectangle"===c&&0===d&&0===f)t.rect(-m/2,-g/2,m,g);else{var y=m/2,_=g/2,v=.44771525016920644,b=d*v,w=f*v,x=[-y,-_+f,-y,-_+w,-y+b,-_,-y+d,-_,y-d,-_,y-b,-_,y,-_+w,y,-_+f,y,_-f,y,_-w,y-b,_,y-d,_,-y+d,_,-y+b,_,-y,_-w,-y,_-f];r&&r.transform(x,x,32),t.moveTo(x[0],x[1]),t.bezierCurveTo(x[2],x[3],x[4],x[5],x[6],x[7]),y!==d&&t.lineTo(x[8],x[9]),t.bezierCurveTo(x[10],x[11],x[12],x[13],x[14],x[15]),_!==f&&t.lineTo(x[16],x[17]),t.bezierCurveTo(x[18],x[19],x[20],x[21],x[22],x[23]),y!==d&&t.lineTo(x[24],x[25]),t.bezierCurveTo(x[26],x[27],x[28],x[29],x[30],x[31])}}t.closePath()}a||!s&&!o||(this._setStyles(t,e,n),s&&(t.fill(i.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),o&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var n=new x(this._size).setCenter(0,0),r=this._style,i=e.stroke&&r.hasStroke()&&r.getStrokeWidth();return t&&(n=t._transformBounds(n)),i?n.expand(U._getStrokePadding(i,this._getStrokeMatrix(t,e))):n}},new function(){function t(t,e,n){var r=t._radius;if(!r.isZero())for(var i=t._size.divide(2),s=1;s<=4;s++){var o=new _(s>1&&s<4?-1:1,s>2?-1:1),a=o.multiply(i),l=a.subtract(o.multiply(r));if(new x(n?a.add(o.multiply(n)):a,l).contains(e))return{point:l,quadrant:s}}}function e(t,e,n,r){var i=t.divide(e);return(!r||i.isInQuadrant(r))&&i.subtract(i.normalize()).multiply(e).divide(n).length<=1}return{_contains:function e(n){if("rectangle"===this._type){var r=t(this,n);return r?n.subtract(r.point).divide(this._radius).getLength()<=1:e.base.call(this,n)}return n.divide(this.size).getLength()<=.5},_hitTestSelf:function n(r,i,s,o){var a=!1,l=this._style,c=i.stroke&&l.hasStroke(),u=i.fill&&l.hasFill();if(c||u){var h=this._type,d=this._radius,f=c?l.getStrokeWidth()/2:0,p=i._tolerancePadding.add(U._getStrokePadding(f,!l.getStrokeScaling()&&o));if("rectangle"===h){var m=p.multiply(2),g=t(this,r,m);if(g)a=e(r.subtract(g.point),d,p,g.quadrant);else{var y=new x(this._size).setCenter(0,0),_=y.expand(m),v=y.expand(m.negate());a=_._containsPoint(r)&&!v._containsPoint(r)}}else a=e(r,d,p)}return a?new I(c?"stroke":"fill",this):n.base.apply(this,arguments)}}},{statics:new function(){function t(t,e,n,r,i){var s=u.create(P.prototype);return s._type=t,s._size=n,s._radius=r,s._initialize(u.getNamed(i),e),s}return{Circle:function(){var e=arguments,n=_.readNamed(e,"center"),r=u.readNamed(e,"radius");return t("circle",n,new b(2*r),r,e)},Rectangle:function(){var e=arguments,n=x.readNamed(e,"rectangle"),r=b.min(b.readNamed(e,"radius"),n.getSize(!0).divide(2));return t("rectangle",n.getCenter(!0),n.getSize(!0),r,e)},Ellipse:function(){var e=arguments,n=P._readEllipse(e),r=n.radius;return t("ellipse",n.center,r.multiply(2),r,e)},_readEllipse:function(t){var e,n;if(u.hasNamed(t,"radius"))e=_.readNamed(t,"center"),n=b.readNamed(t,"radius");else{var r=x.readNamed(t,"rectangle");e=r.getCenter(!0),n=r.getSize(!0).divide(2)}return{center:e,radius:n}}}}}),D=C.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(t,e){if(!this._initialize(t,e!==a&&_.read(arguments))){var n,r=typeof t,i="string"===r?c.getElementById(t):"object"===r?t:null;if(i&&i!==C.NO_INSERT)if(i.getContext||null!=i.naturalHeight)n=i;else if(i){var s=b.read(arguments);s.isZero()||(n=lt.getCanvas(s))}n?this.setImage(n):this.setSource(t)}this._size||(this._size=new b,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,n=t._canvas;if(e)this._setImage(e);else if(n){var r=lt.getCanvas(t._size);r.getContext("2d").drawImage(n,0,0),this._setImage(r)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new w(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,e){var n=b.read(arguments);if(n.equals(this._size))e&&this.clear();else if(n.width>0&&n.height>0){var r=!e&&this.getElement();this._setImage(lt.getCanvas(n)),r&&this.getContext(!0).drawImage(r,0,0,n.width,n.height)}else this._canvas&&lt.release(this._canvas),this._size=n.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||0===t.width&&0===t.height},getResolution:function(){var t=this._matrix,e=new _(0,0).transform(t),n=new _(1,0).transform(t).subtract(e),r=new _(0,1).transform(t).subtract(e);return new b(72/n.getLength(),72/r.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function n(t){var n=e.getView(),r=t&&t.type||"load";n&&e.responds(r)&&(dt=n._scope,e.emit(r,new tt(t)))}this._setImage(t),this._loaded?setTimeout(n,0):t&&K.add(t,{load:function(r){e._setImage(t),n(r)},error:n})},_setImage:function(t){this._canvas&&lt.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new b(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=lt.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){lt.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var e=new o.Image,n=this._crossOrigin;n&&(e.crossOrigin=n),t&&(e.src=t),this.setImage(e)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing="string"==typeof t?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=x.read(arguments),e=lt.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=x.read(arguments),e=new D(C.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var n=this.getCanvas();return n?n.toDataURL.apply(n,arguments):null},drawImage:function(t){var e=_.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var e,n;if(t?t instanceof j?(n=t,e=t.getBounds()):"object"==typeof t&&("width"in t?e=new x(t):"x"in t&&(e=new x(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var r=Math.min(e.width,32),i=Math.min(e.height,32),s=D._sampleContext;s?s.clearRect(0,0,33,33):s=D._sampleContext=lt.getContext(new b(32)),s.save();var o=(new E).scale(r/e.width,i/e.height).translate(-e.x,-e.y);o.applyToContext(s),n&&n.draw(s,new u({clip:!0,matrices:[o]})),this._matrix.applyToContext(s);var a=this.getElement(),l=this._size;a&&s.drawImage(a,-l.width/2,-l.height/2),s.restore();for(var c=s.getImageData(.5,.5,Math.ceil(r),Math.ceil(i)).data,h=[0,0,0],d=0,f=0,p=c.length;f<p;f+=4){var m=c[f+3];d+=m,h[0]+=c[f]*(m/=255),h[1]+=c[f+1]*m,h[2]+=c[f+2]*m}for(f=0;f<3;f++)h[f]/=d;return d?W.read(h):null},getPixel:function(){var t=_.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new W("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=_.read(t),n=W.read(t),r=n._convert("rgb"),i=n._alpha,s=this.getContext(!0),o=s.createImageData(1,1),a=o.data;a[0]=255*r[0],a[1]=255*r[1],a[2]=255*r[2],a[3]=null!=i?255*i:255,s.putImageData(o,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=b.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=x.read(arguments);return t.isEmpty()&&(t=new x(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},setImageData:function(t){var e=_.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},_getBounds:function(t,e){var n=new x(this._size).setCenter(0,0);return t?t._transformBounds(n):n},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new I("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,n){var r=this.getElement();if(r&&r.width>0&&r.height>0){t.globalAlpha=g.clamp(this._opacity,0,1),this._setStyles(t,e,n);var i=this._smoothing,s="off"===i;J.setPrefixed(t,s?"imageSmoothingEnabled":"imageSmoothingQuality",!s&&i),t.drawImage(r,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),R=C.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(t,e){this._initialize(t,e!==a&&_.read(arguments,1))||this.setDefinition(t instanceof L?t:new L(t))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var n=this._definition._item;return n._getCachedBounds(n._matrix.prepended(t),e)},_hitTestSelf:function(t,e,n){var r=e.extend({all:!1}),i=this._definition._item._hitTest(t,r,n);return i&&(i.item=this),i},_draw:function(t,e){this._definition._item.draw(t,e)}}),L=u.extend({_class:"SymbolDefinition",initialize:function(t,e){this._id=y.get(),this.project=dt.project,t&&this.setItem(t,e)},_serialize:function(t,e){return e.add(this,function(){return u.serialize([this._class,this._item],t,!1,e)})},_changed:function(t){8&t&&C._clearBoundsCache(this),1&t&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new _),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new R(this,t)},clone:function(){return new L(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),I=u.extend({_class:"HitResult",initialize:function(t,e,n){this.type=t,this.item=e,n&&this.inject(n)},statics:{getOptions:function(t){var e=t&&u.read(t);return new u({type:null,tolerance:dt.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),N=u.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(t,e,n,r,i,s){var o,l,c,u,h=arguments.length;h>0&&(null==t||"object"==typeof t?1===h&&t&&"point"in t?(o=t.point,l=t.handleIn,c=t.handleOut,u=t.selection):(o=t,l=e,c=n,u=r):(o=[t,e],l=n!==a?[n,r]:null,c=i!==a?[i,s]:null)),new k(o,this,"_point"),new k(l,this,"_handleIn"),new k(c,this,"_handleOut"),u&&this.setSelection(u)},_serialize:function(t,e){var n=this._point,r=this._selection,i=r||this.hasHandles()?[n,this._handleIn,this._handleOut]:n;return r&&i.push(r),u.serialize(i,t,!0,e)},_changed:function(t){var e=this._path;if(e){var n,r=e._curves,i=this._index;r&&(t&&t!==this._point&&t!==this._handleIn||!(n=i>0?r[i-1]:e._closed?r[r.length-1]:null)||n._changed(),t&&t!==this._point&&t!==this._handleOut||!(n=r[i])||n._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(_.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(_.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(_.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,n=this._path;this._selection=t=t||0,n&&t!==e&&(n._updateSelection(this,e,t),n._changed(257))},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){return!!(7&this._selection)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==a?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new B(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,e,n){var r=t||{},i=r.type,s=r.factor,o=this.getPrevious(),l=this.getNext(),c=(o||this)._point,u=this._point,h=(l||this)._point,d=c.getDistance(u),f=u.getDistance(h);if(i&&"catmull-rom"!==i){if("geometric"!==i)throw new Error("Smoothing method '"+i+"' not supported.");if(o&&l){var p=c.subtract(h),m=s===a?.4:s,g=m*d/(d+f);e||this.setHandleIn(p.multiply(g)),n||this.setHandleOut(p.multiply(g-m))}}else{var y,v=s===a?.5:s,b=Math.pow(d,v),w=b*b,x=Math.pow(f,v),S=x*x;if(!e&&o){var E=2*S+3*x*b+w;this.setHandleIn(0!=(y=3*x*(x+b))?new _((S*c._x+E*u._x-w*h._x)/y-u._x,(S*c._y+E*u._y-w*h._y)/y-u._y):new _)}!n&&l&&(E=2*w+3*b*x+S,this.setHandleOut(0!=(y=3*b*(b+x))?new _((w*h._x+E*u._x-S*c._x)/y-u._x,(w*h._y+E*u._y-S*c._y)/y-u._y):new _))}},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,n=t.clone();t.set(e),e.set(n)},reversed:function(){return new N(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new N(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,e,n){var r=1-n,i=n,s=t._point,o=e._point,a=t._handleIn,l=e._handleIn,c=e._handleOut,u=t._handleOut;this._point._set(r*s._x+i*o._x,r*s._y+i*o._y,!0),this._handleIn._set(r*a._x+i*l._x,r*a._y+i*l._y,!0),this._handleOut._set(r*u._x+i*c._x,r*u._y+i*c._y,!0),this._changed()},_transformCoordinates:function(t,e,n){var r=this._point,i=n&&this._handleIn.isZero()?null:this._handleIn,s=n&&this._handleOut.isZero()?null:this._handleOut,o=r._x,a=r._y,l=2;return e[0]=o,e[1]=a,i&&(e[l++]=i._x+o,e[l++]=i._y+a),s&&(e[l++]=s._x+o,e[l++]=s._y+a),t&&(t._transformCoordinates(e,e,l/2),o=e[0],a=e[1],n?(r._x=o,r._y=a,l=2,i&&(i._x=e[l++]-o,i._y=e[l++]-a),s&&(s._x=e[l++]-o,s._y=e[l++]-a)):(i||(e[l++]=o,e[l++]=a),s||(e[l++]=o,e[l++]=a))),e}}),k=_.extend({initialize:function(t,e,n){var r,i,s;if(t)if((r=t[0])!==a)i=t[1];else{var o=t;(r=o.x)===a&&(r=(o=_.read(arguments)).x),i=o.y,s=o.selected}else r=i=0;this._x=r,this._y=i,this._owner=e,e[n]=this,s&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=g.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),F=u.extend({_class:"Curve",beans:!0,initialize:function(t,e,n,r,i,s,o,a){var l,c,u,h,d,f,p=arguments.length;3===p?(this._path=t,l=e,c=n):p?1===p?"segment1"in t?(l=new N(t.segment1),c=new N(t.segment2)):"point1"in t?(u=t.point1,d=t.handle1,f=t.handle2,h=t.point2):Array.isArray(t)&&(u=[t[0],t[1]],h=[t[6],t[7]],d=[t[2]-t[0],t[3]-t[1]],f=[t[4]-t[6],t[5]-t[7]]):2===p?(l=new N(t),c=new N(e)):4===p?(u=t,d=e,f=n,h=r):8===p&&(u=[t,e],h=[o,a],d=[n-t,r-e],f=[i-o,s-a]):(l=new N,c=new N),this._segment1=l||new N(u,null,d),this._segment2=c||new N(h,f,null)},_serialize:function(t,e){return u.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=a},clone:function(){return new F(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return F.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,n=e._handleOut;(t=e.remove())&&this._segment1._handleOut.set(n)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(_.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(_.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(_.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(_.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return F.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],n=0;n<8;n+=2)e.push(new _(t[n],t[n+1]));return e}},{getLength:function(){return null==this._length&&(this._length=F.getLength(this.getValues(),0,1)),this._length},getArea:function(){return F.getArea(this.getValues())},getLine:function(){return new A(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new F(F.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return F.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var n=null;if(t>=1e-8&&t<=.99999999){var r=F.subdivide(this.getValues(),t),i=r[0],s=r[1],o=e||this.hasHandles(),a=this._segment1,l=this._segment2,c=this._path;o&&(a._handleOut._set(i[2]-i[0],i[3]-i[1]),l._handleIn._set(s[4]-s[6],s[5]-s[7]));var u=i[6],h=i[7],d=new N(new _(u,h),o&&new _(i[4]-u,i[5]-h),o&&new _(s[2]-u,s[3]-h));c?(c.insert(a._index+1,d),n=this.getNext()):(this._segment2=d,this._changed(),n=new F(d,l))}return n},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,e){return this.divideAtTime(t===a?.5:e?t:this.getTimeAt(t))},split:function(t,e){return this.splitAtTime(t===a?.5:e?t:this.getTimeAt(t))},reversed:function(){return new F(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,n,r){var i=t._point,s=t._handleOut,o=e._handleIn,a=e._point,l=i.x,c=i.y,u=a.x,h=a.y,d=r?[l,c,l,c,u,h,u,h]:[l,c,l+s._x,c+s._y,u+o._x,h+o._y,u,h];return n&&n._transformCoordinates(d,d,4),d},subdivide:function(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],l=t[5],c=t[6],u=t[7];e===a&&(e=.5);var h=1-e,d=h*n+e*i,f=h*r+e*s,p=h*i+e*o,m=h*s+e*l,g=h*o+e*c,y=h*l+e*u,_=h*d+e*p,v=h*f+e*m,b=h*p+e*g,w=h*m+e*y,x=h*_+e*b,S=h*v+e*w;return[[n,r,d,f,_,v,x,S],[x,S,b,w,g,y,c,u]]},getMonoCurves:function(t,e){var n=[],r=e?0:1,i=t[r+0],s=t[r+2],o=t[r+4],a=t[r+6];if(i>=s==s>=o&&s>=o==o>=a||F.isStraight(t))n.push(t);else{var l=[],c=g.solveQuadratic(3*(s-o)-i+a,2*(i+o)-4*s,s-i,l,1e-8,.99999999);if(c){l.sort();var u=l[0],h=F.subdivide(t,u);n.push(h[0]),c>1&&(h=F.subdivide(h[1],u=(l[1]-u)/(1-u)),n.push(h[0])),n.push(h[1])}else n.push(t)}return n},solveCubic:function(t,e,n,r,i,s){var o=t[e],a=t[e+2],l=t[e+4],c=t[e+6],u=0;if(!(o<n&&c<n&&a<n&&l<n||o>n&&c>n&&a>n&&l>n)){var h=3*(a-o),d=3*(l-a)-h;u=g.solveCubic(c-o-h-d,d,h,o-n,r,i,s)}return u},getTimeOf:function(t,e){var n=new _(t[0],t[1]),r=new _(t[6],t[7]),i=1e-7;if(null===(e.isClose(n,1e-12)?0:e.isClose(r,1e-12)?1:null))for(var s=[e.x,e.y],o=[],a=0;a<2;a++)for(var l=F.solveCubic(t,a,s[a],o,0,1),c=0;c<l;c++){var u=o[c];if(e.isClose(F.getPoint(t,u),i))return u}return e.isClose(n,i)?0:e.isClose(r,i)?1:null},getNearestTime:function(t,e){if(F.isStraight(t)){var n=t[0],r=t[1],i=t[6]-n,s=t[7]-r,o=i*i+s*s;if(0===o)return 0;var a=((e.x-n)*i+(e.y-r)*s)/o;return a<1e-12?0:a>.999999999999?1:F.getTimeOf(t,new _(n+a*i,r+a*s))}var l=1/0,c=0;function u(n){if(n>=0&&n<=1){var r=e.getDistance(F.getPoint(t,n),!0);if(r<l)return l=r,c=n,!0}}for(var h=0;h<=100;h++)u(h/100);for(var d=.005;d>1e-8;)u(c-d)||u(c+d)||(d/=2);return c},getPart:function(t,e,n){var r=e>n;if(r){var i=e;e=n,n=i}return e>0&&(t=F.subdivide(t,e)[1]),n<1&&(t=F.subdivide(t,(n-e)/(1-e))[0]),r?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var n=t[0],r=t[1],i=t[6],s=t[7],o=3*t[2]-2*n-i,a=3*t[3]-2*r-s,l=3*t[4]-2*i-n,c=3*t[5]-2*s-r;return Math.max(o*o,l*l)+Math.max(a*a,c*c)<=16*e*e},getArea:function(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7];return 3*((l-n)*(r+s)-(a-e)*(i+o)+i*(e-s)-r*(n-o)+l*(s+e/3)-a*(o+n/3))/20},getBounds:function(t){for(var e=t.slice(0,2),n=e.slice(),r=[0,0],i=0;i<2;i++)F._addBounds(t[i],t[i+2],t[i+4],t[i+6],i,0,e,n,r);return new x(e[0],e[1],n[0]-e[0],n[1]-e[1])},_addBounds:function(t,e,n,r,i,s,o,a,l){function c(t,e){var n=t-e,r=t+e;n<o[i]&&(o[i]=n),r>a[i]&&(a[i]=r)}var u=o[i]+(s/=2),h=a[i]-s;if(t<u||e<u||n<u||r<u||t>h||e>h||n>h||r>h)if(e<t!=e<r&&n<t!=n<r)c(t,0),c(r,0);else{var d=g.solveQuadratic(3*(e-n)-t+r,2*(t+n)-4*e,e-t,l);c(r,0);for(var f=0;f<d;f++){var p=l[f],m=1-p;1e-8<=p&&p<=.99999999&&c(m*m*m*t+3*m*m*p*e+3*m*p*p*n+p*p*p*r,s)}}}}},u.each(["getBounds","getStrokeBounds","getHandleBounds"],function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=U[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}},{}),u.each({isStraight:function(t,e,n,r){if(e.isZero()&&n.isZero())return!0;var i=r.subtract(t);if(i.isZero())return!1;if(i.isCollinear(e)&&i.isCollinear(n)){var s=new A(t,r);if(s.getDistance(t.add(e))<1e-7&&s.getDistance(r.add(n))<1e-7){var o=i.dot(i),a=i.dot(e)/o,l=i.dot(n)/o;return a>=0&&a<=1&&l<=0&&l>=-1}}return!1},isLinear:function(t,e,n,r){var i=r.subtract(t).divide(3);return e.equals(i)&&n.negate().equals(i)}},function(t,e){this[e]=function(e){var n=this._segment1,r=this._segment2;return t(n._point,n._handleOut,r._handleIn,r._point,e)},this.statics[e]=function(e,n){var r=e[0],i=e[1],s=e[6],o=e[7];return t(new _(r,i),new _(e[2]-r,e[3]-i),new _(e[4]-s,e[5]-o),new _(s,o),n)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return null!=t&&t>=0&&t<=1?new B(this,t):null},getTimeAt:function(t,e){return F.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=_.read(arguments);return t.isZero()?[]:F.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(_.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return F.getTimeOf(this.getValues(),_.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=_.read(arguments),e=this.getValues(),n=F.getNearestTime(e,t),r=F.getPoint(e,n);return new B(this,n,r,null,t.getDistance(r))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return u.each(t,function(t){this[t+"At"]=function(e,n){var r=this.getValues();return F[t](r,n?e:F.getTimeAt(r,e))},this[t+"AtTime"]=function(e){return F[t](this.getValues(),e)}},{statics:{_evaluateMethods:t}})},new function(){function t(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=9*(r-s)+3*(t[6]-e),l=6*(e+s)-12*r,c=3*(r-e),u=9*(i-o)+3*(t[7]-n),h=6*(n+o)-12*i,d=3*(i-n);return function(t){var e=(a*t+l)*t+c,n=(u*t+h)*t+d;return Math.sqrt(e*e+n*n)}}function e(t,e){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(e-t))))}function n(t,e,n,r){if(null==e||e<0||e>1)return null;var i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=g.isZero;d(o-i)&&d(a-s)&&(o=i,a=s),d(l-u)&&d(c-h)&&(l=u,c=h);var f,p,m=3*(o-i),y=3*(l-o)-m,v=u-i-m-y,b=3*(a-s),w=3*(c-a)-b,x=h-s-b-w;if(0===n)f=0===e?i:1===e?u:((v*e+y)*e+m)*e+i,p=0===e?s:1===e?h:((x*e+w)*e+b)*e+s;else{var S=1e-8,E=1-S;if(e<S?(f=m,p=b):e>E?(f=3*(u-l),p=3*(h-c)):(f=(3*v*e+2*y)*e+m,p=(3*x*e+2*w)*e+b),r){0===f&&0===p&&(e<S||e>E)&&(f=l-o,p=c-a);var A=Math.sqrt(f*f+p*p);A&&(f/=A,p/=A)}if(3===n){l=6*v*e+2*y,c=6*x*e+2*w;var T=Math.pow(f*f+p*p,1.5);f=0!==T?(f*c-p*l)/T:0,p=0}}return 2===n?new _(p,-f):new _(f,p)}return{statics:{classify:function(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=r*(n-c)+i*(l-e)+e*c-n*l,h=3*(s*(i-n)+o*(e-r)+r*n-i*e),d=h-u,f=d-u+(e*(c-o)+n*(s-l)+l*o-c*s),p=Math.sqrt(f*f+d*d+h*h),m=0!==p?1/p:0,y=g.isZero,_="serpentine";function v(t,e,n){var r=e!==a,i=r&&e>0&&e<1,s=r&&n>0&&n<1;return!r||(i||s)&&("loop"!==t||i&&s)||(t="arch",i=s=!1),{type:t,roots:i||s?i&&s?e<n?[e,n]:[n,e]:[i?e:n]:null}}if(d*=m,h*=m,y(f*=m))return y(d)?v(y(h)?"line":"quadratic"):v(_,h/(3*d));var b=3*d*d-4*f*h;if(y(b))return v("cusp",d/(2*f));var w=b>0?Math.sqrt(b/3):Math.sqrt(-b),x=2*f;return v(b>0?_:"loop",(d+w)/x,(d-w)/x)},getLength:function(n,r,i,s){if(r===a&&(r=0),i===a&&(i=1),F.isStraight(n)){var o=n;i<1&&(o=F.subdivide(o,i)[0],r/=i),r>0&&(o=F.subdivide(o,r)[1]);var l=o[6]-o[0],c=o[7]-o[1];return Math.sqrt(l*l+c*c)}return g.integrate(s||t(n),r,i,e(r,i))},getTimeAt:function(n,r,i){if(i===a&&(i=r<0?1:0),0===r)return i;var s=Math.abs,o=r>0,l=o?i:0,c=o?1:i,u=t(n),h=F.getLength(n,l,c,u),d=s(r)-h;if(s(d)<1e-12)return o?c:l;if(d>1e-12)return null;var f=0;return g.findRoot(function(t){return f+=g.integrate(u,i,t,e(i,t)),i=t,f-r},u,i+r/h,l,c,32,1e-12)},getPoint:function(t,e){return n(t,e,0,!1)},getTangent:function(t,e){return n(t,e,1,!0)},getWeightedTangent:function(t,e){return n(t,e,1,!1)},getNormal:function(t,e){return n(t,e,2,!0)},getWeightedNormal:function(t,e){return n(t,e,2,!1)},getCurvature:function(t,e){return n(t,e,3,!1).x},getPeaks:function(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=3*r-e-3*s+t[6],l=3*e-6*r+3*s,c=-3*e+3*r,u=3*i-n-3*o+t[7],h=3*n-6*i+3*o,d=-3*n+3*i,f=[];return g.solveCubic(9*(a*a+u*u),9*(a*l+h*u),2*(l*l+h*h)+3*(c*a+d*u),c*l+h*d,f,1e-8,.99999999),f.sort()}}}},new function(){function t(t,e,n,r,i,s,o){var a=!o&&n.getPrevious()===i,l=!o&&n!==i&&n.getNext()===i,c=1e-8,u=1-c;if(null!==r&&r>=(a?c:0)&&r<=(l?u:1)&&null!==s&&s>=(l?c:0)&&s<=(a?u:1)){var h=new B(n,r,null,o),d=new B(i,s,null,o);h._intersection=d,d._intersection=h,e&&!e(h)||B.insert(t,h,!0)}}function e(r,i,s,o,a,l,c,u,h,d,f,p,m){if(++h>=4096||++u>=40)return h;var g,y,_=i[0],v=i[1],b=i[6],w=i[7],x=A.getSignedDistance,S=x(_,v,b,w,i[2],i[3]),E=x(_,v,b,w,i[4],i[5]),T=S*E>0?3/4:4/9,C=T*Math.min(0,S,E),M=T*Math.max(0,S,E),O=x(_,v,b,w,r[0],r[1]),P=x(_,v,b,w,r[2],r[3]),D=x(_,v,b,w,r[4],r[5]),R=x(_,v,b,w,r[6],r[7]),L=function(t,e,n,r){var i,s=[0,t],o=[1/3,e],a=[2/3,n],l=[1,r],c=e-(2*t+r)/3,u=n-(t+2*r)/3;if(c*u<0)i=[[s,o,l],[s,a,l]];else{var h=c/u;i=[h>=2?[s,o,l]:h<=.5?[s,a,l]:[s,o,a,l],[s,l]]}return(c||u)<0?i.reverse():i}(O,P,D,R),I=L[0],N=L[1];if(0===S&&0===E&&0===O&&0===P&&0===D&&0===R||null==(g=n(I,N,C,M))||null==(y=n(I.reverse(),N.reverse(),C,M)))return h;var k=d+(f-d)*g,B=d+(f-d)*y;if(Math.max(m-p,B-k)<1e-9){var j=(k+B)/2,U=(p+m)/2;t(a,l,c?o:s,c?U:j,c?s:o,c?j:U)}else{r=F.getPart(r,g,y);var V,z=m-p;y-g>.8?B-k>z?(h=e(i,(V=F.subdivide(r,.5))[0],o,s,a,l,!c,u,h,p,m,k,j=(k+B)/2),h=e(i,V[1],o,s,a,l,!c,u,h,p,m,j,B)):(h=e((V=F.subdivide(i,.5))[0],r,o,s,a,l,!c,u,h,p,U=(p+m)/2,k,B),h=e(V[1],r,o,s,a,l,!c,u,h,U,m,k,B)):h=0===z||z>=1e-9?e(i,r,o,s,a,l,!c,u,h,p,m,k,B):e(r,i,s,o,a,l,c,u,h,k,B,p,m)}return h}function n(t,e,n,i){return t[0][1]<n?r(t,!0,n):e[0][1]>i?r(e,!1,i):t[0][0]}function r(t,e,n){for(var r=t[0][0],i=t[0][1],s=1,o=t.length;s<o;s++){var a=t[s][0],l=t[s][1];if(e?l>=n:l<=n)return l===n?a:r+(n-i)*(a-r)/(l-i);r=a,i=l}return null}function i(t,e,n,r,i){var s=g.isZero;if(s(r)&&s(i)){var o=F.getTimeOf(t,new _(e,n));return null===o?[]:[o]}for(var a=Math.atan2(-i,r),l=Math.sin(a),c=Math.cos(a),u=[],h=[],d=0;d<8;d+=2){var f=t[d]-e,p=t[d+1]-n;u.push(f*c-p*l,f*l+p*c)}return F.solveCubic(u,1,0,h,0,1),h}function s(e,n,r,s,o,a,l){for(var c=n[0],u=n[1],h=i(e,c,u,n[6]-c,n[7]-u),d=0,f=h.length;d<f;d++){var p=h[d],m=F.getPoint(e,p),g=F.getTimeOf(n,m);null!==g&&t(o,a,l?s:r,l?g:p,l?r:s,l?p:g)}}function o(e,n,r,i,s,o){var a=A.intersect(e[0],e[1],e[6],e[7],n[0],n[1],n[6],n[7]);a&&t(s,o,r,F.getTimeOf(e,a),i,F.getTimeOf(n,a))}function a(n,r,i,a,l,u){var h=1e-12,d=Math.min,f=Math.max;if(f(n[0],n[2],n[4],n[6])+h>d(r[0],r[2],r[4],r[6])&&d(n[0],n[2],n[4],n[6])-h<f(r[0],r[2],r[4],r[6])&&f(n[1],n[3],n[5],n[7])+h>d(r[1],r[3],r[5],r[7])&&d(n[1],n[3],n[5],n[7])-h<f(r[1],r[3],r[5],r[7])){var p=c(n,r);if(p)for(var m=0;m<2;m++){var g=p[m];t(l,u,i,g[0],a,g[1],!0)}else{var y=F.isStraight(n),v=F.isStraight(r),b=y&&v,w=y&&!v,x=l.length;if((b?o:y||v?s:e)(w?r:n,w?n:r,w?a:i,w?i:a,l,u,w,0,0,0,1,0,1),!b||l.length===x)for(m=0;m<4;m++){var S=m>>1,E=1&m,A=6*S,T=6*E,C=new _(n[A],n[A+1]),M=new _(r[T],r[T+1]);C.isClose(M,h)&&t(l,u,i,S,a,E)}}}return l}function l(e,n,r,i){var s=F.classify(e);if("loop"===s.type){var o=s.roots;t(r,i,n,o[0],n,o[1])}return r}function c(t,e){function n(t){var e=t[6]-t[0],n=t[7]-t[1];return e*e+n*n}var r=Math.abs,i=A.getDistance,s=1e-7,o=F.isStraight(t),a=F.isStraight(e),l=o&&a,c=n(t)<n(e),u=c?e:t,h=c?t:e,d=u[0],f=u[1],p=u[6]-d,m=u[7]-f;if(i(d,f,p,m,h[0],h[1],!0)<s&&i(d,f,p,m,h[6],h[7],!0)<s)!l&&i(d,f,p,m,u[2],u[3],!0)<s&&i(d,f,p,m,u[4],u[5],!0)<s&&i(d,f,p,m,h[2],h[3],!0)<s&&i(d,f,p,m,h[4],h[5],!0)<s&&(o=a=l=!0);else if(l)return null;if(o^a)return null;for(var g=[t,e],y=[],v=0;v<4&&y.length<2;v++){var b=1&v,w=1^b,x=v>>1,S=F.getTimeOf(g[b],new _(g[w][x?6:0],g[w][x?7:1]));if(null!=S){var E=b?[x,S]:[S,x];(!y.length||r(E[0]-y[0][0])>1e-8&&r(E[1]-y[0][1])>1e-8)&&y.push(E)}if(v>2&&!y.length)break}if(2!==y.length)y=null;else if(!l){var T=F.getPart(t,y[0][0],y[1][0]),C=F.getPart(e,y[0][1],y[1][1]);(r(C[2]-T[2])>s||r(C[3]-T[3])>s||r(C[4]-T[4])>s||r(C[5]-T[5])>s)&&(y=null)}return y}return{getIntersections:function(t){var e=this.getValues(),n=t&&t!==this&&t.getValues();return n?a(e,n,this,t,[]):l(e,this,[])},statics:{getOverlaps:c,getIntersections:function(t,e,n,r,i,s){var o=!e;o&&(e=t);for(var c=t.length,u=e.length,h=new Array(c),d=o?h:new Array(u),f=[],m=0;m<c;m++)h[m]=t[m].getValues(r);if(!o)for(m=0;m<u;m++)d[m]=e[m].getValues(i);for(var g=p.findCurveBoundsCollisions(h,d,1e-7),y=0;y<c;y++){var _=t[y],v=h[y];o&&l(v,_,f,n);var b=g[y];if(b)for(var w=0;w<b.length;w++){if(s&&f.length)return f;var x=b[w];(!o||x>y)&&a(v,d[x],_,e[x],f,n)}}return f},getCurveLineIntersections:i,getTimesWithTangent:function(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=e.normalize(),h=u.x,d=u.y,f=3*l-9*o+9*i-3*n,p=3*c-9*a+9*s-3*r,m=6*o-12*i+6*n,y=6*a-12*s+6*r,_=3*i-3*n,v=3*s-3*r,b=2*f*d-2*p*h,w=[];if(Math.abs(b)<g.CURVETIME_EPSILON){if(0!=(b=f*y-p*m)){var x=-(f*v-p*_)/b;x>=0&&x<=1&&w.push(x)}}else{var S=(m*m-4*f*_)*d*d+(-2*m*y+4*p*_+4*f*v)*h*d+(y*y-4*p*v)*h*h,E=m*d-y*h;if(S>=0&&0!=b){var A=Math.sqrt(S),T=-(E+A)/b,C=(-E+A)/b;T>=0&&T<=1&&w.push(T),C>=0&&C<=1&&w.push(C)}}return w}}}}),B=u.extend({_class:"CurveLocation",initialize:function(t,e,n,r,i){if(e>=.99999999){var s=t.getNext();s&&(e=0,t=s)}this._setCurve(t),this._time=e,this._point=n||t.getPointAtTime(e),this._overlap=r,this._distance=i,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),n=this.getTime();0===n?t=e._segment1:1===n?t=e._segment2:null!=n&&(t=e.getPartLength(0,n)<e.getPartLength(n,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;function n(t){var n=t&&t.getCurve();if(n&&null!=(e._time=n.getTimeOf(e._point)))return e._setCurve(n),n}return t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null),this._curve||n(this._segment)||n(this._segment1)||n(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&null==e?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(null==t){t=0;var e=this.getPath(),n=this.getIndex();if(e&&null!=n)for(var r=e.getCurves(),i=0;i<n;i++)t+=r[i].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(null==t){var e=this.getCurve(),n=this.getTime();this._curveOffset=t=null!=n&&e&&e.getPartLength(0,n)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,n=t&&t.splitAtTime(this.getTime());return n&&this._setSegment(e.getLastSegment()),n},equals:function(t,e){var n=this===t;if(!n&&t instanceof B){var r=this.getCurve(),i=t.getCurve(),s=r._path;if(s===i._path){var o=Math.abs,a=o(this.getOffset()-t.getOffset()),l=!e&&this._intersection,c=!e&&t._intersection;n=(a<1e-7||s&&o(s.getLength()-a)<1e-7)&&(!l&&!c||l&&c&&l.equals(c,!0))}}return n},toString:function(){var t=[],e=this.getPoint(),n=m.instance;e&&t.push("point: "+e);var r=this.getIndex();null!=r&&t.push("index: "+r);var i=this.getTime();return null!=i&&t.push("time: "+n.number(i)),null!=this._distance&&t.push("distance: "+n.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),n=t.getCurve();return!(e.isStraight()&&n.isStraight()&&e.getLine().intersect(n.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),n=t.getTime(),r=1e-8,i=1-r,s=e>=r&&e<=i,o=n>=r&&n<=i;if(s&&o)return!this.isTouching();var a=this.getCurve(),l=a&&e<r?a.getPrevious():a,c=t.getCurve(),u=c&&n<r?c.getPrevious():c;if(e>i&&(a=a.getNext()),n>i&&(c=c.getNext()),!(l&&a&&u&&c))return!1;var h=[];function d(t,e){var n=t.getValues(),r=F.classify(n).roots||F.getPeaks(n),i=r.length,s=F.getLength(n,e&&i?r[i-1]:0,!e&&i?r[0]:1);h.push(i?s:s/32)}function f(t,e,n){return e<n?t>e&&t<n:t>e||t<n}s||(d(l,!0),d(a,!1)),o||(d(u,!0),d(c,!1));var p=this.getPoint(),m=Math.min.apply(Math,h),g=s?a.getTangentAtTime(e):a.getPointAt(m).subtract(p),y=s?g.negate():l.getPointAt(-m).subtract(p),_=o?c.getTangentAtTime(n):c.getPointAt(m).subtract(p),v=o?_.negate():u.getPointAt(-m).subtract(p),b=y.getAngle(),w=g.getAngle(),x=v.getAngle(),S=_.getAngle();return!!(s?f(b,x,S)^f(w,x,S)&&f(b,S,x)^f(w,S,x):f(x,b,w)^f(S,b,w)&&f(x,w,b)^f(S,w,b))},hasOverlap:function(){return!!this._overlap}},u.each(F._evaluateMethods,function(t){var e=t+"At";this[t]=function(){var t=this.getCurve(),n=this.getTime();return null!=n&&t&&t[e](n,!0)}},{preserve:!0}),new function(){function t(t,e,n){var r=t.length,i=0,s=r-1;function o(n,i){for(var s=n+i;s>=-1&&s<=r;s+=i){var o=t[(s%r+r)%r];if(!e.getPoint().isClose(o.getPoint(),1e-7))break;if(e.equals(o))return o}return null}for(;i<=s;){var a,l=i+s>>>1,c=t[l];if(n&&(a=e.equals(c)?c:o(l,-1)||o(l,1)))return e._overlap&&(a._overlap=a._intersection._overlap=!0),a;var u=e.getPath(),h=c.getPath();(u!==h?u._id-h._id:e.getIndex()+e.getTime()-(c.getIndex()+c.getTime()))<0?s=l-1:i=l+1}return t.splice(i,0,e),e}return{statics:{insert:t,expand:function(e){for(var n=e.slice(),r=e.length-1;r>=0;r--)t(n,e[r]._intersection,!1);return n}}}}),j=C.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var e,n,r;if(u.isPlainObject(t)?(n=t.segments,e=t.pathData):Array.isArray(t)?n=t:"string"==typeof t&&(e=t),n){var i=n[0];r=i&&Array.isArray(i[0])}else e&&(r=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));return new(r?V:U)(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e,n,r,i=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),s=!1,o=new _,a=new _;function l(t,n){var r=+e[t];return s&&(r+=o[n]),r}function c(t){return new _(l(t,"x"),l(t+1,"y"))}this.clear();for(var u=0,h=i&&i.length;u<h;u++){var d=i[u],f=d[0],p=f.toLowerCase(),m=(e=d.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&e.length;switch(s=f===p,"z"!==n||/[mz]/.test(p)||this.moveTo(o),p){case"m":case"l":for(var g="m"===p,y=0;y<m;y+=2)this[g?"moveTo":"lineTo"](o=c(y)),g&&(a=o,g=!1);r=o;break;case"h":case"v":var v="h"===p?"x":"y";for(o=o.clone(),y=0;y<m;y++)o[v]=l(y,v),this.lineTo(o);r=o;break;case"c":for(y=0;y<m;y+=6)this.cubicCurveTo(c(y),r=c(y+2),o=c(y+4));break;case"s":for(y=0;y<m;y+=4)this.cubicCurveTo(/[cs]/.test(n)?o.multiply(2).subtract(r):o,r=c(y),o=c(y+2)),n=p;break;case"q":for(y=0;y<m;y+=4)this.quadraticCurveTo(r=c(y),o=c(y+2));break;case"t":for(y=0;y<m;y+=2)this.quadraticCurveTo(r=/[qt]/.test(n)?o.multiply(2).subtract(r):o,o=c(y)),n=p;break;case"a":for(y=0;y<m;y+=7)this.arcTo(o=c(y+5),new b(+e[y],+e[y+1]),+e[y+2],+e[y+4],+e[y+3]);break;case"z":this.closePath(1e-12),o=a}n=p}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!("evenodd"===this.getFillRule()?1&e.windingL||1&e.windingR:e.winding)},getIntersections:function(t,e,n,r){var i=this===t||!t,s=this._matrix._orNullIfIdentity(),o=i?s:(n||t._matrix)._orNullIfIdentity();return i||this.getBounds(s).intersects(t.getBounds(o),1e-12)?F.getIntersections(this.getCurves(),!i&&t.getCurves(),e,s,o,r):[]},getCrossings:function(t){return this.getIntersections(t,function(t){return t.isCrossing()})},getNearestLocation:function(){for(var t=_.read(arguments),e=this.getCurves(),n=1/0,r=null,i=0,s=e.length;i<s;i++){var o=e[i].getNearestLocation(t);o._distance<n&&(n=o._distance,r=o)}return r},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,e,n){var r=!this._children,i=r?"_segments":"_children",s=t[i],o=e[i],a=this[i];if(!s||!o||s.length!==o.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+e);var l=a.length,c=o.length;if(l<c)for(var u=r?N:U,h=l;h<c;h++)this.add(new u);else l>c&&this[r?"removeSegments":"removeChildren"](c,l);for(h=0;h<c;h++)a[h].interpolate(s[h],o[h],n);r&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var n=this._children||[this],r=t._children?t._children.slice():[t],i=n.length,s=r.length,o=[],a=0;e=!0;for(var l=p.findItemBoundsCollisions(n,r,g.GEOMETRIC_EPSILON),c=i-1;c>=0&&e;c--){var u=n[c];e=!1;var h=l[c];if(h)for(var d=h.length-1;d>=0&&!e;d--)u.compare(r[h[d]])&&(o[h[d]]||(o[h[d]]=!0,a++),e=!0)}e=e&&a===s}return e}}),U=j.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[],this._version=0;var e=arguments,n=Array.isArray(t)?"object"==typeof t[0]?t:e:!t||t.size!==a||t.x===a&&t.point===a?null:e;n&&n.length>0?this.setSegments(n):(this._curves=a,this._segmentSelection=0,n||"string"!=typeof t||(this.setPathData(t),t=null)),this._initialize(!n&&t)},_equals:function(t){return this._closed===t._closed&&u.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(e){if(t.base.call(this,e),8&e){if(this._length=this._area=a,32&e)this._version++;else if(this._curves)for(var n=0,r=this._curves.length;n<r;n++)this._curves[n]._changed()}else 64&e&&(this._bounds=a)},getStyle:function(){var t=this._parent;return(t instanceof V?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var e=this.isFullySelected(),n=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=a,n){var r=t[n-1];"boolean"==typeof r&&(this.setClosed(r),n--),this._add(N.readList(t,0,{},n))}e&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var n=this._countCurves();t=this._curves=new Array(n);for(var r=0;r<n;r++)t[r]=new F(this,e[r],e[r+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new F(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var n,r,i,s,o,a,l,c,u=this._segments,h=u.length,d=new m(e),f=new Array(6),p=!0,g=[];function y(e,u){if(e._transformCoordinates(t,f),n=f[0],r=f[1],p)g.push("M"+d.pair(n,r)),p=!1;else if(a=f[3],(o=f[2])===n&&a===r&&l===i&&c===s){if(!u){var h=n-i,m=r-s;g.push(0===h?"v"+d.number(m):0===m?"h"+d.number(h):"l"+d.pair(h,m))}}else g.push("c"+d.pair(l-i,c-s)+" "+d.pair(o-i,a-s)+" "+d.pair(n-i,r-s));i=n,s=r,l=f[4],c=f[5]}if(!h)return"";for(var _=0;_<h;_++)y(u[_]);return this._closed&&h>0&&(y(u[0],!0),g.push("z")),g.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,n=new Array(6),r=0,i=e.length;r<i;r++)e[r]._transformCoordinates(t,n,!0);return!0},_add:function(t,e){for(var n=this._segments,r=this._curves,i=t.length,s=null==e,o=(e=s?n.length:e,0);o<i;o++){var a=t[o];a._path&&(a=t[o]=a.clone()),a._path=this,a._index=e+o,a._selection&&this._updateSelection(a,0,a._selection)}if(s)u.push(n,t);else{n.splice.apply(n,[e,0].concat(t)),o=e+i;for(var l=n.length;o<l;o++)n[o]._index=o}if(r){var c=this._countCurves(),h=e>0&&e+i-1===c?e-1:e,d=h,f=Math.min(h+i,c);for(t._curves&&(r.splice.apply(r,[h,0].concat(t._curves)),d+=t._curves.length),o=d;o<f;o++)r.splice(o,0,new F(this,null,null));this._adjustCurves(h,f)}return this._changed(41),t},_adjustCurves:function(t,e){for(var n,r=this._segments,i=this._curves,s=t;s<e;s++)(n=i[s])._path=this,n._segment1=r[s],n._segment2=r[s+1]||r[0],n._changed();(n=i[this._closed&&!t?r.length-1:t-1])&&(n._segment2=r[t]||r[0],n._changed()),(n=i[e])&&(n._segment1=r[e],n._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&"number"!=typeof t?this._add(N.readList(e)):this._add([N.read(e)])[0]},insert:function(t,e){var n=arguments;return n.length>2&&"number"!=typeof e?this._add(N.readList(n,1),t):this._add([N.read(n,1)],t)[0]},addSegment:function(){return this._add([N.read(arguments)])[0]},insertSegment:function(t){return this._add([N.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(N.readList(t))},insertSegments:function(t,e){return this._add(N.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,n){t=t||0,e=u.pick(e,this._segments.length);var r=this._segments,i=this._curves,s=r.length,o=r.splice(t,e-t),a=o.length;if(!a)return o;for(var l=0;l<a;l++){var c=o[l];c._selection&&this._updateSelection(c,c._selection,0),c._index=c._path=null}l=t;for(var h=r.length;l<h;l++)r[l]._index=l;if(i){var d=t>0&&e===s+(this._closed?1:0)?t-1:t;for(l=(i=i.splice(d,a)).length-1;l>=0;l--)i[l]._path=null;n&&(o._curves=i.slice(1)),this._adjustCurves(d,d)}return this._changed(41),o},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)t[e].clearHandles()},getLength:function(){if(null==this._length){for(var t=this.getCurves(),e=0,n=0,r=t.length;n<r;n++)e+=t[n].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(null==t){var e=this._segments,n=this._closed;t=0;for(var r=0,i=e.length;r<i;r++){var s=r+1===i;t+=F.getArea(F.getValues(e[r],e[s?0:r+1],null,s&&!n))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===7*t},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){1&e||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,n=e.length,r=t?7:0;this._segmentSelection=r*n;for(var i=0;i<n;i++)e[i]._selection=r},_updateSelection:function(t,e,n){t._selection=n,(this._segmentSelection+=n-e)>0&&this.setSelected(!0)},divideAt:function(t){var e,n=this.getLocationAt(t);return n&&(e=n.getCurve().divideAt(n.getCurveOffset()))?e._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),n=e&&e.index,r=e&&e.time;r>.99999999&&(n++,r=0);var i=this.getCurves();if(n>=0&&n<i.length){r>=1e-8&&i[n++].divideAtTime(r);var s,o=this.removeSegments(n,this._segments.length,!0);return this._closed?(this.setClosed(!1),s=this):((s=new U(C.NO_INSERT)).insertAbove(this),s.copyAttributes(this)),s._add(o,0),this.addSegment(o[0]),s}return null},split:function(t,e){var n,r=e===a?t:(n=this.getCurves()[t])&&n.getLocationAtTime(e);return null!=r?this.splitAt(r):null},join:function(t,e){var n=e||0;if(t&&t!==this){var r=t._segments,i=this.getLastSegment(),s=t.getLastSegment();if(!s)return this;i&&i._point.isClose(s._point,n)&&t.reverse();var o=t.getFirstSegment();if(i&&i._point.isClose(o._point,n))i.setHandleOut(o._handleOut),this._add(r.slice(1));else{var a=this.getFirstSegment();a&&a._point.isClose(o._point,n)&&t.reverse(),s=t.getLastSegment(),a&&a._point.isClose(s._point,n)?(a.setHandleIn(s._handleIn),this._add(r.slice(0,r.length-1),0)):this._add(r.slice())}t._closed&&this._add([r[0]]),t.remove()}var l=this.getFirstSegment(),c=this.getLastSegment();return l!==c&&l._point.isClose(c._point,n)&&(l.setHandleIn(c._handleIn),c.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),n=t&&t.simplify,r=n?1e-7:0,i=e.length-1;i>=0;i--){var s=e[i];!s.hasHandles()&&(!s.hasLength(r)||n&&s.isCollinear(s.getNext()))&&s.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var n=this._segments[t],r=n._handleIn;n._handleIn=n._handleOut,n._handleOut=r,n._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new z(this,t||.25,256,!0).parts,n=e.length,r=[],i=0;i<n;i++)r.push(new N(e[i].curve.slice(0,2)));!this._closed&&n>0&&r.push(new N(e[n-1].curve.slice(6))),this.setSegments(r)},simplify:function(t){var e=new $(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var e=this,n=t||{},r=n.type||"asymmetric",i=this._segments,s=i.length,o=this._closed;function l(t,n){var r=t&&t.index;if(null!=r){var i=t.path;if(i&&i!==e)throw new Error(t._class+" "+r+" of "+i+" is not part of "+e);n&&t instanceof F&&r++}else r="number"==typeof t?t:n;return Math.min(r<0&&o?r%s:r<0?r+s:r,s-1)}var c=o&&n.from===a&&n.to===a,u=l(n.from,0),h=l(n.to,s-1);if(u>h)if(o)u-=s;else{var d=u;u=h,h=d}if(/^(?:asymmetric|continuous)$/.test(r)){var f="asymmetric"===r,p=Math.min,m=h-u+1,g=m-1,y=c?p(m,4):1,_=y,v=y,b=[];if(o||(_=p(1,u),v=p(1,s-h-1)),(g+=_+v)<=1)return;for(var w=0,x=u-_;w<=g;w++,x++)b[w]=i[(x<0?x+s:x)%s]._point;var S=b[0]._x+2*b[1]._x,E=b[0]._y+2*b[1]._y,A=2,T=g-1,C=[S],M=[E],O=[A],P=[],D=[];for(w=1;w<g;w++){var R=w<T,L=R?4:f?3:8,I=R?2:f?0:1,N=(R||f?1:2)/A;A=O[w]=(R?4:f?2:7)-N,S=C[w]=L*b[w]._x+I*b[w+1]._x-N*S,E=M[w]=L*b[w]._y+I*b[w+1]._y-N*E}for(P[T]=C[T]/O[T],D[T]=M[T]/O[T],w=g-2;w>=0;w--)P[w]=(C[w]-P[w+1])/O[w],D[w]=(M[w]-D[w+1])/O[w];P[g]=(3*b[g]._x-P[T])/2,D[g]=(3*b[g]._y-D[T])/2,w=_;var k=g-v;for(x=u;w<=k;w++,x++){var B=i[x<0?x+s:x],j=B._point,U=P[w]-j._x,V=D[w]-j._y;(c||w<k)&&B.setHandleOut(U,V),(c||w>_)&&B.setHandleIn(-U,-V)}}else for(w=u;w<=h;w++)i[w<0?w+s:w].smooth(n,!c&&w===u,!c&&w===h)},toShape:function(t){if(!this._closed)return null;var e,n,r,i,s,o,l,c=this._segments;function u(t,e){var n=c[t],r=n.getNext(),i=c[e],s=i.getNext();return n._handleOut.isZero()&&r._handleIn.isZero()&&i._handleOut.isZero()&&s._handleIn.isZero()&&r._point.subtract(n._point).isCollinear(s._point.subtract(i._point))}function h(t){var e=c[t],n=e.getNext(),r=e._handleOut,i=n._handleIn,s=.5522847498307936;if(r.isOrthogonal(i)){var o=e._point,a=n._point,l=new A(o,r,!0).intersect(new A(a,i,!0),!0);return l&&g.isZero(r.getLength()/l.subtract(o).getLength()-s)&&g.isZero(i.getLength()/l.subtract(a).getLength()-s)}return!1}function d(t,e){return c[t]._point.getDistance(c[e]._point)}if(!this.hasHandles()&&4===c.length&&u(0,2)&&u(1,3)&&(o=(s=c[1]).getPrevious(),l=s.getNext(),o._handleOut.isZero()&&s._handleIn.isZero()&&s._handleOut.isZero()&&l._handleIn.isZero()&&s._point.subtract(o._point).isOrthogonal(l._point.subtract(s._point)))?(e=P.Rectangle,n=new b(d(0,3),d(0,1)),i=c[1]._point.add(c[2]._point).divide(2)):8===c.length&&h(0)&&h(2)&&h(4)&&h(6)&&u(1,5)&&u(3,7)?(e=P.Rectangle,r=(n=new b(d(1,6),d(0,3))).subtract(new b(d(0,7),d(1,2))).divide(2),i=c[3]._point.add(c[4]._point).divide(2)):4===c.length&&h(0)&&h(1)&&h(2)&&h(3)&&(g.isZero(d(0,2)-d(1,3))?(e=P.Circle,r=d(0,2)/2):(e=P.Ellipse,r=new b(d(2,0)/2,d(3,1)/2)),i=c[1]._point),e){var f=this.getPosition(!0),p=new e({center:f,size:n,radius:r,insert:!1});return p.copyAttributes(this,!0),p._matrix.prepend(this._matrix),p.rotate(i.subtract(f).getAngle()+90),(t===a||t)&&p.insertAbove(this),p}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof V)return t.base.call(this,e);var n=this.getCurves(),r=e.getCurves(),i=n.length,s=r.length;if(!i||!s)return i==s;for(var o,a,l=n[0].getValues(),c=[],u=0,h=0,d=0;d<s;d++){var f=r[d].getValues();if(c.push(f),g=F.getOverlaps(l,f)){o=!d&&g[0][0]>0?s-1:d,a=g[0][1];break}}var p,m=Math.abs;for(f=c[o];l&&f;){var g;if((g=F.getOverlaps(l,f))&&m(g[0][0]-h)<1e-8){1===(h=g[1][0])&&(l=++u<i?n[u].getValues():null,h=0);var y=g[0][1];if(m(y-a)<1e-8){if(p||(p=[o,y]),1===(a=g[1][1])&&(++o>=s&&(o=0),f=c[o]||r[o].getValues(),a=0),!l)return p[0]===o&&p[1]===a;continue}}break}return!1},_hitTestSelf:function(t,e,n,r){var i,s,o,a,l,c,u=this,h=this.getStyle(),d=this._segments,f=d.length,p=this._closed,m=e._tolerancePadding,g=m,y=e.stroke&&h.hasStroke(),_=e.fill&&h.hasFill(),v=e.curves,b=y?h.getStrokeWidth()/2:_&&e.tolerance>0||v?0:null;function w(e,n){return t.subtract(e).divide(n).length<=1}function x(t,n,r){if(!e.selected||n.isSelected()){var i=t._point;if(n!==i&&(n=n.add(i)),w(n,g))return new I(r,u,{segment:t,point:n})}}function S(t,n){return(n||e.segments)&&x(t,t._point,"segment")||!n&&e.handles&&(x(t,t._handleIn,"handle-in")||x(t,t._handleOut,"handle-out"))}function E(t){a.add(t)}function A(e){var n,l=p||e._index>0&&e._index<f-1;return"round"===(l?i:s)?w(e._point,g):(a=new U({internal:!0,closed:!0}),l?e.isSmooth()||U._addBevelJoin(e,i,b,o,null,r,E,!0):"square"===s&&U._addSquareCap(e,s,b,null,r,E,!0),a.isEmpty()?void 0:a.contains(t)||(n=a.getNearestLocation(t))&&w(n.getPoint(),m))}if(null!==b&&(b>0?(i=h.getStrokeJoin(),s=h.getStrokeCap(),o=h.getMiterLimit(),g=g.add(U._getStrokePadding(b,r))):i=s="round"),!e.ends||e.segments||p){if(e.segments||e.handles)for(var T=0;T<f;T++)if(c=S(d[T]))return c}else if(c=S(d[0],!0)||S(d[f-1],!0))return c;if(null!==b){if(l=this.getNearestLocation(t)){var C=l.getTime();0===C||1===C&&f>1?A(l.getSegment())||(l=null):w(l.getPoint(),g)||(l=null)}if(!l&&"miter"===i&&f>1)for(T=0;T<f;T++){var M=d[T];if(t.getDistance(M._point)<=o*b&&A(M)){l=M.getLocation();break}}}return!l&&_&&this._contains(t)||l&&!y&&!v?new I("fill",this):l?new I(y?"stroke":"curve",this,{location:l,point:l.getPoint()}):null}},u.each(F._evaluateMethods,function(t){this[t+"At"]=function(e){var n=this.getLocationAt(e);return n&&n[t]()}},{beans:!1,getLocationOf:function(){for(var t=_.read(arguments),e=this.getCurves(),n=0,r=e.length;n<r;n++){var i=e[n].getLocationOf(t);if(i)return i}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if("number"==typeof t){for(var e=this.getCurves(),n=0,r=0,i=e.length;r<i;r++){var s=n,o=e[r];if((n+=o.getLength())>t)return o.getLocationAt(t-s)}if(e.length>0&&t<=this.getLength())return new B(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=_.read(arguments);if(t.isZero())return[];for(var e=[],n=0,r=this.getCurves(),i=0,s=r.length;i<s;i++){for(var o=r[i],a=o.getTimesWithTangent(t),l=0,c=a.length;l<c;l++){var u=n+o.getOffsetAtTime(a[l]);e.indexOf(u)<0&&e.push(u)}n+=o.length}return e}}),new function(){function t(t,e,n){var r,i,s,o,a,l,c,u,h=e._segments,d=h.length,f=new Array(6),p=!0;function m(e){if(n)e._transformCoordinates(n,f),r=f[0],i=f[1];else{var h=e._point;r=h._x,i=h._y}var d;p?(t.moveTo(r,i),p=!1):(n?(a=f[2],l=f[3]):(a=r+(d=e._handleIn)._x,l=i+d._y),a===r&&l===i&&c===s&&u===o?t.lineTo(r,i):t.bezierCurveTo(c,u,a,l,r,i)),s=r,o=i,n?(c=f[4],u=f[5]):(c=s+(d=e._handleOut)._x,u=o+d._y)}for(var g=0;g<d;g++)m(h[g]);e._closed&&d>0&&m(h[0])}return{_draw:function(e,n,r,i){var s=n.dontStart,o=n.dontFinish||n.clip,a=this.getStyle(),l=a.hasFill(),c=a.hasStroke(),u=a.getDashArray(),h=!dt.support.nativeDash&&c&&u&&u.length;function d(t){return u[(t%h+h)%h]}if(s||e.beginPath(),(l||c&&!h||o)&&(t(e,this,i),this._closed&&e.closePath()),!o&&(l||c)&&(this._setStyles(e,n,r),l&&(e.fill(a.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),c)){if(h){s||e.beginPath();for(var f,p=new z(this,.25,32,!1,i),m=p.length,g=-a.getDashOffset(),y=0;g>0;)g-=d(y--)+d(y--);for(;g<m;)f=g+d(y++),(g>0||f>0)&&p.drawPart(e,Math.max(g,0),Math.max(f,0)),g=f+d(y++)}e.stroke()}},_drawSelected:function(e,n){e.beginPath(),t(e,this,n),e.stroke(),function(t,e,n,r){if(!(r<=0))for(var i,s,o=r/2,a=r-2,l=o-1,c=new Array(6),u=0,h=e.length;u<h;u++){var d=e[u],f=d._selection;if(d._transformCoordinates(n,c),i=c[0],s=c[1],2&f&&m(2),4&f&&m(4),t.fillRect(i-o,s-o,r,r),a>0&&!(1&f)){var p=t.fillStyle;t.fillStyle="#ffffff",t.fillRect(i-l,s-l,a,a),t.fillStyle=p}}function m(e){var n=c[e],r=c[e+1];i==n&&s==r||(t.beginPath(),t.moveTo(i,s),t.lineTo(n,r),t.stroke(),t.beginPath(),t.arc(n,r,o,0,2*Math.PI,!0),t.fill())}}(e,this._segments,n,dt.settings.handleSize)}}},new function(){function t(t){var e=t._segments;if(!e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var t=this._segments;1===t.length&&this.removeSegment(0),t.length||this._add([new N(_.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new N(_.read(arguments))])},cubicCurveTo:function(){var e=arguments,n=_.read(e),r=_.read(e),i=_.read(e),s=t(this);s.setHandleOut(n.subtract(s._point)),this._add([new N(i,r.subtract(i))])},quadraticCurveTo:function(){var e=arguments,n=_.read(e),r=_.read(e),i=t(this)._point;this.cubicCurveTo(n.add(i.subtract(n).multiply(1/3)),n.add(r.subtract(n).multiply(1/3)),r)},curveTo:function(){var e=arguments,n=_.read(e),r=_.read(e),i=u.pick(u.read(e),.5),s=1-i,o=t(this)._point,a=n.subtract(o.multiply(s*s)).subtract(r.multiply(i*i)).divide(2*i*s);if(a.isNaN())throw new Error("Cannot put a curve through points with parameter = "+i);this.quadraticCurveTo(a,r)},arcTo:function(){var e,n,r,i,s=arguments,o=Math.abs,a=Math.sqrt,l=t(this),c=l._point,h=_.read(s),d=u.peek(s);if("boolean"==typeof(v=u.pick(d,!0)))var f=(x=c.add(h).divide(2)).add(x.subtract(c).rotate(v?-90:90));else if(u.remain(s)<=2)f=h,h=_.read(s);else if(!c.equals(h)){var p=b.read(s),m=g.isZero;if(m(p.width)||m(p.height))return this.lineTo(h);var y=u.read(s),v=!!u.read(s),w=!!u.read(s),x=c.add(h).divide(2),S=(Z=c.subtract(x).rotate(-y)).x,T=Z.y,C=o(p.width),M=o(p.height),O=C*C,P=M*M,D=S*S,R=T*T,L=a(D/O+R/P);if(L>1&&(O=(C*=L)*C,P=(M*=L)*M),o(L=(O*P-O*R-P*D)/(O*R+P*D))<1e-12&&(L=0),L<0)throw new Error("Cannot create an arc with the given arguments");e=new _(C*T/M,-M*S/C).multiply((w===v?-1:1)*a(L)).rotate(y).add(x),n=(r=(i=(new E).translate(e).rotate(y).scale(C,M))._inverseTransform(c)).getDirectedAngle(i._inverseTransform(h)),!v&&n>0?n-=360:v&&n<0&&(n+=360)}if(f){var I=new A(c.add(f).divide(2),f.subtract(c).rotate(90),!0),k=new A(f.add(h).divide(2),h.subtract(f).rotate(90),!0),F=new A(c,h),B=F.getSide(f);if(!(e=I.intersect(k,!0))){if(!B)return this.lineTo(h);throw new Error("Cannot create an arc with the given arguments")}n=(r=c.subtract(e)).getDirectedAngle(h.subtract(e));var j=F.getSide(e,!0);0===j?n=B*o(n):B===j&&(n+=n<0?360:-360)}if(n){for(var U=1e-7,V=o(n),z=V>=360?4:Math.ceil((V-U)/90),$=n/z,H=$*Math.PI/360,G=4/3*Math.sin(H)/(1+Math.cos(H)),W=[],q=0;q<=z;q++){var Z=h,Y=null;if(q<z&&(Y=r.rotate(90).multiply(G),i?(Z=i._transformPoint(r),Y=i._transformPoint(r.add(Y)).subtract(Z)):Z=e.add(r)),q){var J=r.rotate(-90).multiply(G);i&&(J=i._transformPoint(r.add(J)).subtract(Z)),W.push(new N(Z,J,Y))}else l.setHandleOut(Y);r=r.rotate($)}this._add(W)}},lineBy:function(){var e=_.read(arguments),n=t(this)._point;this.lineTo(n.add(e))},curveBy:function(){var e=arguments,n=_.read(e),r=_.read(e),i=u.read(e),s=t(this)._point;this.curveTo(s.add(n),s.add(r),i)},cubicCurveBy:function(){var e=arguments,n=_.read(e),r=_.read(e),i=_.read(e),s=t(this)._point;this.cubicCurveTo(s.add(n),s.add(r),s.add(i))},quadraticCurveBy:function(){var e=arguments,n=_.read(e),r=_.read(e),i=t(this)._point;this.quadraticCurveTo(i.add(n),i.add(r))},arcBy:function(){var e=arguments,n=t(this)._point,r=n.add(_.read(e)),i=u.pick(u.peek(e),!0);this.arcTo(r,"boolean"==typeof i?i:n.add(_.read(e)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(t,e){return U[e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds"](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,n,r,i,s){var o=t[0];if(!o)return new x;var a=new Array(6),l=o._transformCoordinates(r,new Array(6)),c=l.slice(0,2),u=c.slice(),h=new Array(2);function d(t){t._transformCoordinates(r,a);for(var e=0;e<2;e++)F._addBounds(l[e],l[e+4],a[e+2],a[e],e,s?s[e]:0,c,u,h);var n=l;l=a,a=n}for(var f=1,p=t.length;f<p;f++)d(t[f]);return e&&d(o),new x(c[0],c[1],u[0]-c[0],u[1]-c[1])},getStrokeBounds:function(t,e,n,r,i){var s=n.getStyle(),o=s.hasStroke(),a=s.getStrokeWidth(),l=o&&n._getStrokeMatrix(r,i),c=o&&U._getStrokePadding(a,l),u=U.getBounds(t,e,n,r,i,c);if(!o)return u;var h=a/2,d=s.getStrokeJoin(),f=s.getStrokeCap(),p=s.getMiterLimit(),m=new x(new b(c));function g(t){u=u.include(t)}function y(t){u=u.unite(m.setCenter(t._point.transform(r)))}function _(t,e){"round"===e||t.isSmooth()?y(t):U._addBevelJoin(t,e,h,p,r,l,g)}function v(t,e){"round"===e?y(t):U._addSquareCap(t,e,h,r,l,g)}var w=t.length-(e?0:1);if(w>0){for(var S=1;S<w;S++)_(t[S],d);e?_(t[0],d):(v(t[0],f),v(t[t.length-1],f))}return u},_getStrokePadding:function(t,e){if(!e)return[t,t];var n=new _(t,0).transform(e),r=new _(0,t).transform(e),i=n.getAngleInRadians(),s=n.getLength(),o=r.getLength(),a=Math.sin(i),l=Math.cos(i),c=Math.tan(i),u=Math.atan2(o*c,s),h=Math.atan2(o,c*s);return[Math.abs(s*Math.cos(u)*l+o*Math.sin(u)*a),Math.abs(o*Math.sin(h)*l+s*Math.cos(h)*a)]},_addBevelJoin:function(t,e,n,r,i,s,o,a){var l=t.getCurve(),c=l.getPrevious(),u=l.getPoint1().transform(i),h=c.getNormalAtTime(1).multiply(n).transform(s),d=l.getNormalAtTime(0).multiply(n).transform(s),f=h.getDirectedAngle(d);if((f<0||f>=180)&&(h=h.negate(),d=d.negate()),a&&o(u),o(u.add(h)),"miter"===e){var p=new A(u.add(h),new _(-h.y,h.x),!0).intersect(new A(u.add(d),new _(-d.y,d.x),!0),!0);p&&u.getDistance(p)<=r*n&&o(p)}o(u.add(d))},_addSquareCap:function(t,e,n,r,i,s,o){var a=t._point.transform(r),l=t.getLocation(),c=l.getNormal().multiply(0===l.getTime()?n:-n).transform(i);"square"===e&&(o&&(s(a.subtract(c)),s(a.add(c))),a=a.add(c.rotate(-90))),s(a.add(c)),s(a.subtract(c))},getHandleBounds:function(t,e,n,r,i){var s,o,a=n.getStyle();if(i.stroke&&a.hasStroke()){var l=n._getStrokeMatrix(r,i),c=a.getStrokeWidth()/2,u=c;"miter"===a.getStrokeJoin()&&(u=c*a.getMiterLimit()),"square"===a.getStrokeCap()&&(u=Math.max(u,c*Math.SQRT2)),s=U._getStrokePadding(c,l),o=U._getStrokePadding(u,l)}for(var h=new Array(6),d=1/0,f=-d,p=d,m=f,g=0,y=t.length;g<y;g++){t[g]._transformCoordinates(r,h);for(var _=0;_<6;_+=2){var v=_?s:o,b=v?v[0]:0,w=v?v[1]:0,S=h[_],E=h[_+1],A=S-b,T=S+b,C=E-w,M=E+w;A<d&&(d=A),T>f&&(f=T),C<p&&(p=C),M>m&&(m=M)}}return new x(d,p,f-d,m-p)}}});U.inject({statics:new function(){var t=.5522847498307936,e=[new N([-1,0],[0,t],[0,-t]),new N([0,-1],[-t,0],[t,0]),new N([1,0],[0,-t],[0,t]),new N([0,1],[t,0],[-t,0])];function n(t,e,n){var r=u.getNamed(n),i=new U(r&&0==r.insert&&C.NO_INSERT);return i._add(t),i._closed=e,i.set(r,{insert:!0})}function r(t,r,i){for(var s=new Array(4),o=0;o<4;o++){var a=e[o];s[o]=new N(a._point.multiply(r).add(t),a._handleIn.multiply(r),a._handleOut.multiply(r))}return n(s,!0,i)}return{Line:function(){var t=arguments;return n([new N(_.readNamed(t,"from")),new N(_.readNamed(t,"to"))],!1,t)},Circle:function(){var t=arguments,e=_.readNamed(t,"center"),n=u.readNamed(t,"radius");return r(e,new b(n),t)},Rectangle:function(){var e,r=arguments,i=x.readNamed(r,"rectangle"),s=b.readNamed(r,"radius",0,{readNull:!0}),o=i.getBottomLeft(!0),a=i.getTopLeft(!0),l=i.getTopRight(!0),c=i.getBottomRight(!0);if(!s||s.isZero())e=[new N(o),new N(a),new N(l),new N(c)];else{var u=(s=b.min(s,i.getSize(!0).divide(2))).width,h=s.height,d=u*t,f=h*t;e=[new N(o.add(u,0),null,[-d,0]),new N(o.subtract(0,h),[0,f]),new N(a.add(0,h),null,[0,-f]),new N(a.add(u,0),[-d,0],null),new N(l.subtract(u,0),null,[d,0]),new N(l.add(0,h),[0,-f],null),new N(c.subtract(0,h),null,[0,f]),new N(c.subtract(u,0),[d,0])]}return n(e,!0,r)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=arguments,e=P._readEllipse(t);return r(e.center,e.radius,t)},Oval:"#Ellipse",Arc:function(){var t=arguments,e=_.readNamed(t,"from"),n=_.readNamed(t,"through"),r=_.readNamed(t,"to"),i=u.getNamed(t),s=new U(i&&0==i.insert&&C.NO_INSERT);return s.moveTo(e),s.arcTo(n,r),s.set(i)},RegularPolygon:function(){for(var t=arguments,e=_.readNamed(t,"center"),r=u.readNamed(t,"sides"),i=u.readNamed(t,"radius"),s=360/r,o=r%3==0,a=new _(0,o?-i:i),l=o?-1:.5,c=new Array(r),h=0;h<r;h++)c[h]=new N(e.add(a.rotate((h+l)*s)));return n(c,!0,t)},Star:function(){for(var t=arguments,e=_.readNamed(t,"center"),r=2*u.readNamed(t,"points"),i=u.readNamed(t,"radius1"),s=u.readNamed(t,"radius2"),o=360/r,a=new _(0,-1),l=new Array(r),c=0;c<r;c++)l[c]=new N(e.add(a.rotate(o*c).multiply(c%2?s:i)));return n(l,!0,t)}}}});var V=j.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||("string"==typeof t?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function t(e,n){var r=n,i=r[0];i&&"number"==typeof i[0]&&(r=[r]);for(var s=n.length-1;s>=0;s--){var o=r[s];r!==n||o instanceof U||(r=u.slice(r)),Array.isArray(o)?r[s]=new U({segments:o,insert:!1}):o instanceof V&&(r.splice.apply(r,[s,1].concat(o.removeChildren())),o.remove())}return t.base.call(this,e,r)},reduce:function t(e){for(var n=this._children,r=n.length-1;r>=0;r--){var i;(i=n[r].reduce(e)).isEmpty()&&i.remove()}return n.length?t.base.call(this):((i=new U(C.NO_INSERT)).copyAttributes(this),i.insertAbove(this),this.remove(),i)},isClosed:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,n=0,r=e.length;n<r;n++)e[n].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],n=0,r=t.length;n<r;n++)u.push(e,t[n].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,n=0,r=t.length;n<r;n++)e+=t[n].getArea();return e},getLength:function(){for(var t=this._children,e=0,n=0,r=t.length;n<r;n++)e+=t[n].getLength();return e},getPathData:function(t,e){for(var n=this._children,r=[],i=0,s=n.length;i<s;i++){var o=n[i],a=o._matrix;r.push(o.getPathData(t&&!a.isIdentity()?t.appended(a):t,e))}return r.join("")},_hitTestChildren:function t(e,n,r){return t.base.call(this,e,n.class===U||"path"===n.type?n:u.set({},n,{fill:!1}),r)},_draw:function(t,e,n,r){var i=this._children;if(i.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var s=0,o=i.length;s<o;s++)i[s].draw(t,e,r);if(!e.clip){this._setStyles(t,e,n);var a=this._style;a.hasFill()&&(t.fill(a.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),a.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,n){for(var r=this._children,i=0,s=r.length;i<s;i++){var o=r[i],a=o._matrix;n[o._id]||o._drawSelected(t,a.isIdentity()?e:e.appended(a))}}},new function(){function t(t,e){var n=t._children;if(e&&!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return u.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(e){this[e]=function(){var n=t(this,!0);n[e].apply(n,arguments)}},{moveTo:function(){var e=t(this),n=e&&e.isEmpty()?e:new U(C.NO_INSERT);n!==e&&this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){var e=t(this,!0),n=e&&e.getLastSegment(),r=_.read(arguments);this.moveTo(n?r.add(n._point):r)},closePath:function(e){t(this,!0).closePath(e)}})},u.each(["reverse","flatten","simplify","smooth"],function(t){this[t]=function(e){for(var n,r=this._children,i=0,s=r.length;i<s;i++)n=r[i][t](e)||n;return n}},{}));j.inject(new function(){var t=Math.min,e=Math.max,n=Math.abs,r={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function i(t){return t._children||[t]}function s(t,e){var n=t.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(e){for(var r=i(n),s=0,o=r.length;s<o;s++)(t=r[s])._closed||t.isEmpty()||(t.closePath(1e-12),t.getFirstSegment().setHandleIn(0,0),t.getLastSegment().setHandleOut(0,0));n=n.resolveCrossings().reorient("nonzero"===n.getFillRule(),!0)}return n}function o(t,e,n,r,i){var s=new V(C.NO_INSERT);return s.addChildren(t,!0),s=s.reduce({simplify:e}),i&&0==i.insert||s.insertAbove(r&&n.isSibling(r)&&n.getIndex()<r.getIndex()?r:n),s.copyAttributes(n,!0),s}function l(t){return t.hasOverlap()||t.isCrossing()}function c(t,e,n,a){if(a&&(0==a.trace||a.stroke)&&/^(subtract|intersect)$/.test(n))return h(t,e,n);var c=s(t,!0),d=e&&t!==e&&s(e,!0),f=r[n];f[n]=!0,d&&(f.subtract||f.exclude)^d.isClockwise()^c.isClockwise()&&d.reverse();var g,_=y(B.expand(c.getIntersections(d,l))),w=i(c),x=d&&i(d),S=[],E=[];function A(t){for(var e=0,n=t.length;e<n;e++){var r=t[e];u.push(S,r._segments),u.push(E,r.getCurves()),r._overlapsOnly=!0}}function T(t){for(var e=[],n=0,r=t&&t.length;n<r;n++)e.push(E[t[n]]);return e}if(_.length){A(w),x&&A(x);for(var C=new Array(E.length),M=0,O=E.length;M<O;M++)C[M]=E[M].getValues();var P=p.findCurveBoundsCollisions(C,C,0,!0),D={};for(M=0;M<E.length;M++){var R=E[M],L=R._path._id;(D[L]=D[L]||{})[R.getIndex()]={hor:T(P[M].hor),ver:T(P[M].ver)}}for(M=0,O=_.length;M<O;M++)v(_[M]._segment,c,d,D,f);for(M=0,O=S.length;M<O;M++){var I=S[M],N=I._intersection;I._winding||v(I,c,d,D,f),N&&N._overlap||(I._path._overlapsOnly=!1)}g=b(S,f)}else g=m(x?w.concat(x):w.slice(),function(t){return!!f[t]});return o(g,!0,t,e,a)}function h(t,e,n){var r=s(t),i=s(e),a=r.getIntersections(i,l),c="subtract"===n,u="divide"===n,h={},d=[];function f(t){if(!h[t._id]&&(u||i.contains(t.getPointAt(t.getLength()/2))^c))return d.unshift(t),h[t._id]=!0}for(var p=a.length-1;p>=0;p--){var m=a[p].split();m&&(f(m)&&m.getFirstSegment().setHandleIn(0,0),r.getLastSegment().setHandleOut(0,0))}return f(r),o(d,!1,t,e)}function d(t,e){for(var n=t;n;){if(n===e)return;n=n._previous}for(;t._next&&t._next!==e;)t=t._next;if(!t._next){for(;e._previous;)e=e._previous;t._next=e,e._previous=t}}function f(t){for(var e=t.length-1;e>=0;e--)t[e].clearHandles()}function m(t,e,r){var i=t&&t.length;if(i){var s=u.each(t,function(t,e){this[t._id]={container:null,winding:t.isClockwise()?1:-1,index:e}},{}),o=t.slice().sort(function(t,e){return n(e.getArea())-n(t.getArea())}),a=o[0],l=p.findItemBoundsCollisions(o,null,g.GEOMETRIC_EPSILON);null==r&&(r=a.isClockwise());for(var c=0;c<i;c++){var h=o[c],d=s[h._id],f=0,m=l[c];if(m)for(var y=null,_=m.length-1;_>=0;_--)if(m[_]<c){y=y||h.getInteriorPoint();var v=o[m[_]];if(v.contains(y)){var b=s[v._id];d.winding+=f=b.winding,d.container=b.exclude?b.container:v;break}}if(e(d.winding)===e(f))d.exclude=!0,t[d.index]=null;else{var w=d.container;h.setClockwise(w?!w.isClockwise():r)}}}return t}function y(t,e,n){var r,i,s,o=e&&[],a=!1,l=n||[],c=n&&{};function u(t){return t._path._id+"."+t._segment1._index}for(var h=(n&&n.length)-1;h>=0;h--)(p=n[h])._path&&(c[u(p)]=!0);for(h=t.length-1;h>=0;h--){var p,m,g=t[h],y=g._time,_=y,v=e&&!e(g);if((p=g._curve)&&(p!==i?(a=!p.hasHandles()||c&&c[u(p)],r=[],s=null,i=p):s>=1e-8&&(y/=s)),v)r&&r.push(g);else{if(e&&o.unshift(g),s=_,y<1e-8)m=p._segment1;else if(y>.99999999)m=p._segment2;else{var b=p.divideAtTime(y,!0);a&&l.push(p,b),m=b._segment1;for(var w=r.length-1;w>=0;w--){var x=r[w];x._time=(x._time-y)/(1-y)}}g._setSegment(m);var S=m._intersection,E=g._intersection;if(S){d(S,E);for(var A=S;A;)d(A._intersection,S),A=A._next}else m._intersection=E}}return n||f(l),o||t}function _(r,i,s,o,a){var l,c,u=Array.isArray(i)?i:i[s?"hor":"ver"],h=s?1:0,d=1^h,f=[r.x,r.y],p=f[h],m=f[d],g=1e-6,y=p-1e-9,v=p+1e-9,b=0,w=0,x=0,S=0,E=!1,A=!1,T=1,C=[];function M(n){var c=n[d+0],u=n[d+6];if(!(m<t(c,u)||m>e(c,u))){var f=n[h+0],b=n[h+2],w=n[h+4],A=n[h+6];if(c!==u){var M=m===c?0:m===u||y>e(f,b,w,A)||v<t(f,b,w,A)?1:F.solveCubic(n,d,m,C,0,1)>0?C[0]:1,O=0===M?f:1===M?A:F.getPoint(n,M)[s?"y":"x"],P=c>u?1:-1,D=l[h+6];return m!==c?(O<y?x+=P:O>v?S+=P:E=!0,O>p-g&&O<p+g&&(T/=2)):(P!==(l[d]>l[d+6]?1:-1)?f<y?x+=P:f>v&&(S+=P):f!=D&&(D<v&&O>v?(S+=P,E=!0):D>y&&O<y&&(x+=P,E=!0)),T/=4),l=n,!a&&O>y&&O<v&&0===F.getTangent(n,M)[s?"x":"y"]&&_(r,i,!s,o,!0)}(f<v&&A>y||A<v&&f>y)&&(E=!0)}}function O(n){var r=n[d+0],i=n[d+2],o=n[d+4],a=n[d+6];if(m<=e(r,i,o,a)&&m>=t(r,i,o,a))for(var l,c=n[h+0],u=n[h+2],f=n[h+4],p=n[h+6],g=y>e(c,u,f,p)||v<t(c,u,f,p)?[n]:F.getMonoCurves(n,s),_=0,b=g.length;_<b;_++)if(l=M(g[_]))return l}for(var P=0,D=u.length;P<D;P++){var R,L=u[P],I=L._path,N=L.getValues();if(!(P&&u[P-1]._path===I||(l=null,I._closed||(c=F.getValues(I.getLastCurve().getSegment2(),L.getSegment1(),null,!o))[d]!==c[d+6]&&(l=c),l))){l=N;for(var k=I.getLastCurve();k&&k!==L;){var B=k.getValues();if(B[d]!==B[d+6]){l=B;break}k=k.getPrevious()}}if(R=O(N))return R;if(P+1===D||u[P+1]._path!==I){if(c&&(R=O(c)))return R;!E||x||S||(x=S=I.isClockwise(o)^s?1:-1),b+=x,w+=S,x=S=0,E&&(A=!0,E=!1),c=null}}return b=n(b),w=n(w),{winding:e(b,w),windingL:b,windingR:w,quality:T,onPath:A}}function v(t,e,r,i,s){var o=[],a=t,l=0;do{if(v=t.getCurve()){var c=v.getLength();o.push({segment:t,curve:v,length:c}),l+=c}t=t.getNext()}while(t&&!t._intersection&&t!==a);for(var u=[.5,.25,.75],h={winding:0,quality:-1},d=0;d<u.length&&h.quality<.5;d++){c=l*u[d];for(var f=0,p=o.length;f<p;f++){var m=o[f],y=m.length;if(c<=y){var v,b=(v=m.curve)._path,w=b._parent,x=w instanceof V?w:b,S=g.clamp(v.getTimeAt(c),.001,.999),E=v.getPointAtTime(S),A=n(v.getTangentAtTime(S).y)<Math.SQRT1_2,T=null;if(s.subtract&&r){var C=(x===e?r:e)._getWinding(E,A,!0);if(x===e&&C.winding||x===r&&!C.winding){if(C.quality<1)continue;T={winding:0,quality:1}}}(T=T||_(E,i[b._id][v.getIndex()],A,!0)).quality>h.quality&&(h=T);break}c-=y}}for(f=o.length-1;f>=0;f--)o[f].segment._winding=h}function b(t,e){var n,r=[];function i(t){var n;return!(!t||t._visited||e&&(!e[(n=t._winding||{}).winding]||e.unite&&2===n.winding&&n.windingL&&n.windingR))}function s(t){if(t)for(var e=0,r=n.length;e<r;e++)if(t===n[e])return!0;return!1}function o(t){for(var e=t._segments,n=0,r=e.length;n<r;n++)e[n]._visited=!0}function a(t,e){var r=t._intersection,o=r,a=[];function l(r,o){for(;r&&r!==o;){var l=r._segment,c=l&&l._path;if(c){var u=l.getNext()||c.getFirstSegment(),h=u._intersection;l!==t&&(s(l)||s(u)||u&&i(l)&&(i(u)||h&&i(h._segment)))&&a.push(l),e&&n.push(l)}r=r._next}}if(e&&(n=[t]),r){for(l(r);r&&r._previous;)r=r._previous;l(r,o)}return a}t.sort(function(t,e){var n=t._intersection,r=e._intersection,i=!(!n||!n._overlap),s=t._path,o=e._path;return i^!(!r||!r._overlap)?i?1:-1:!n^!r?n?1:-1:s!==o?s._id-o._id:t._index-e._index});for(var l=0,c=t.length;l<c;l++){var u,h,d,f=t[l],p=i(f),m=null,g=!1,y=!0,_=[];if(p&&f._path._overlapsOnly){var v=f._path,b=f._intersection._segment._path;v.compare(b)&&(v.getArea()&&r.push(v.clone(!1)),o(v),o(b),p=!1)}for(;p;){var w=!m,x=a(f,w),S=x.shift(),E=!(g=!w&&(s(f)||s(S)))&&S;if(w&&(m=new U(C.NO_INSERT),u=null),g){(f.isFirst()||f.isLast())&&(y=f._path._closed),f._visited=!0;break}if(E&&u&&(_.push(u),u=null),u||(E&&x.push(f),u={start:m._segments.length,crossings:x,visited:h=[],handleIn:d}),E&&(f=S),!i(f)){m.removeSegments(u.start);for(var A=0,T=h.length;A<T;A++)h[A]._visited=!1;h.length=0;do{(f=u&&u.crossings.shift())&&f._path||(f=null,(u=_.pop())&&(h=u.visited,d=u.handleIn))}while(u&&!i(f));if(!f)break}var M=f.getNext();m.add(new N(f._point,d,M&&f._handleOut)),f._visited=!0,h.push(f),f=M||f._path.getFirstSegment(),d=M&&M._handleIn}g&&(y&&(m.getFirstSegment().setHandleIn(d),m.setClosed(y)),0!==m.getArea()&&r.push(m))}return r}return{_getWinding:function(t,e,n){return _(t,this.getCurves(),e,n)},unite:function(t,e){return c(this,t,"unite",e)},intersect:function(t,e){return c(this,t,"intersect",e)},subtract:function(t,e){return c(this,t,"subtract",e)},exclude:function(t,e){return c(this,t,"exclude",e)},divide:function(t,e){return e&&(0==e.trace||e.stroke)?h(this,t,"divide"):o([this.subtract(t,e),this.intersect(t,e)],!0,this,t,e)},resolveCrossings:function(){var t=this._children,e=t||[this];function n(t,e){var n=t&&t._intersection;return n&&n._overlap&&n._path===e}var r=!1,i=!1,s=this.getIntersections(null,function(t){return t.hasOverlap()&&(r=!0)||t.isCrossing()&&(i=!0)}),o=r&&i&&[];if(s=B.expand(s),r)for(var a=y(s,function(t){return t.hasOverlap()},o),l=a.length-1;l>=0;l--){var c=a[l],h=c._path,d=c._segment,p=d.getPrevious(),m=d.getNext();n(p,h)&&n(m,h)&&(d.remove(),p._handleOut._set(0,0),m._handleIn._set(0,0),p===d||p.getCurve().hasLength()||(m._handleIn.set(p._handleIn),p.remove()))}i&&(y(s,r&&function(t){var e=t.getCurve(),n=t.getSegment(),r=t._intersection,i=r._curve,s=r._segment;if(e&&i&&e._path&&i._path)return!0;n&&(n._intersection=null),s&&(s._intersection=null)},o),o&&f(o),e=b(u.each(e,function(t){u.push(this,t._segments)},[])));var g,_=e.length;return _>1&&t?(e!==t&&this.setChildren(e),g=this):1!==_||t||(e[0]!==this&&this.setSegments(e[0].removeSegments()),g=this),g||((g=new V(C.NO_INSERT)).addChildren(e),(g=g.reduce()).copyAttributes(this),this.replaceWith(g)),g},reorient:function(t,e){var n=this._children;return n&&n.length?this.setChildren(m(this.removeChildren(),function(e){return!!(t?e:1&e)},e)):e!==a&&this.setClockwise(e),this},getInteriorPoint:function(){var n=this.getBounds().getCenter(!0);if(!this.contains(n)){for(var r=this.getCurves(),i=n.y,s=[],o=[],a=0,l=r.length;a<l;a++){var c=r[a].getValues(),u=c[1],h=c[3],d=c[5],f=c[7];if(i>=t(u,h,d,f)&&i<=e(u,h,d,f))for(var p=F.getMonoCurves(c),m=0,g=p.length;m<g;m++){var y=p[m],_=y[1],v=y[7];if(_!==v&&(i>=_&&i<=v||i>=v&&i<=_)){var b=i===_?y[0]:i===v?y[6]:1===F.solveCubic(y,1,i,o,0,1)?F.getPoint(y,o[0]).x:(y[0]+y[6])/2;s.push(b)}}}s.length>1&&(s.sort(function(t,e){return t-e}),n.x=(s[0]+s[1])/2)}return n}}});var z=u.extend({_class:"PathFlattener",initialize:function(t,e,n,r,i){var s,o=[],a=[],l=0,c=1/(n||32),u=t._segments,h=u[0];function d(t,e){var n=F.getValues(t,e,i);o.push(n),f(n,t._index,0,1)}function f(t,n,i,s){if(!(s-i>c)||r&&F.isStraight(t)||F.isFlatEnough(t,e||.25)){var o=t[6]-t[0],u=t[7]-t[1],h=Math.sqrt(o*o+u*u);h>0&&a.push({offset:l+=h,curve:t,index:n,time:s})}else{var d=F.subdivide(t,.5),p=(i+s)/2;f(d[0],n,i,p),f(d[1],n,p,s)}}for(var p=1,m=u.length;p<m;p++)d(h,s=u[p]),h=s;t._closed&&d(s||h,u[0]),this.curves=o,this.parts=a,this.length=l,this.index=0},_get:function(t){for(var e,n=this.parts,r=n.length,i=this.index;e=i,i&&!(n[--i].offset<t););for(;e<r;e++){var s=n[e];if(s.offset>=t){this.index=e;var o=n[e-1],a=o&&o.index===s.index?o.time:0,l=o?o.offset:0;return{index:s.index,time:a+(s.time-a)*(t-l)/(s.offset-l)}}}return{index:n[r-1].index,time:1}},drawPart:function(t,e,n){for(var r=this._get(e),i=this._get(n),s=r.index,o=i.index;s<=o;s++){var a=F.getPart(this.curves[s],s===r.index?r.time:0,s===i.index?i.time:1);s===r.index&&t.moveTo(a[0],a[1]),t.bezierCurveTo.apply(t,a.slice(2))}}},u.each(F._evaluateMethods,function(t){this[t+"At"]=function(e){var n=this._get(e);return F[t](this.curves[n.index],n.time)}},{})),$=u.extend({initialize:function(t){for(var e,n=this.points=[],r=t._segments,i=t._closed,s=0,o=r.length;s<o;s++){var a=r[s].point;e&&e.equals(a)||n.push(e=a.clone())}i&&(n.unshift(n[n.length-1]),n.push(n[1])),this.closed=i},fit:function(t){var e=this.points,n=e.length,r=null;return n>0&&(r=[new N(e[0])],n>1&&(this.fitCubic(r,t,0,n-1,e[1].subtract(e[0]),e[n-2].subtract(e[n-1])),this.closed&&(r.shift(),r.pop()))),r},fitCubic:function(t,e,n,r,i,s){var o=this.points;if(r-n!=1){for(var a,l=this.chordLengthParameterize(n,r),c=Math.max(e,e*e),u=!0,h=0;h<=4;h++){var d=this.generateBezier(n,r,l,i,s),f=this.findMaxError(n,r,d,l);if(f.error<e&&u)return void this.addCurve(t,d);if(a=f.index,f.error>=c)break;u=this.reparameterize(n,r,l,d),c=f.error}var p=o[a-1].subtract(o[a+1]);this.fitCubic(t,e,n,a,i,p),this.fitCubic(t,e,a,r,p.negate(),s)}else{var m=o[n],g=o[r],y=m.getDistance(g)/3;this.addCurve(t,[m,m.add(i.normalize(y)),g.add(s.normalize(y)),g])}},addCurve:function(t,e){t[t.length-1].setHandleOut(e[1].subtract(e[0])),t.push(new N(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,n,r,i){for(var s=1e-12,o=Math.abs,a=this.points,l=a[t],c=a[e],u=[[0,0],[0,0]],h=[0,0],d=0,f=e-t+1;d<f;d++){var p=n[d],m=1-p,g=3*p*m,y=m*m*m,_=g*m,v=g*p,b=p*p*p,w=r.normalize(_),x=i.normalize(v),S=a[t+d].subtract(l.multiply(y+_)).subtract(c.multiply(v+b));u[0][0]+=w.dot(w),u[0][1]+=w.dot(x),u[1][0]=u[0][1],u[1][1]+=x.dot(x),h[0]+=w.dot(S),h[1]+=x.dot(S)}var E,A,T=u[0][0]*u[1][1]-u[1][0]*u[0][1];if(o(T)>s)E=(h[0]*u[1][1]-h[1]*u[0][1])/T,A=(u[0][0]*h[1]-u[1][0]*h[0])/T;else{var C=u[0][0]+u[0][1],M=u[1][0]+u[1][1];E=A=o(C)>s?h[0]/C:o(M)>s?h[1]/M:0}var O,P,D=c.getDistance(l),R=s*D;if(E<R||A<R)E=A=D/3;else{var L=c.subtract(l);O=r.normalize(E),P=i.normalize(A),O.dot(L)-P.dot(L)>D*D&&(E=A=D/3,O=P=null)}return[l,l.add(O||r.normalize(E)),c.add(P||i.normalize(A)),c]},reparameterize:function(t,e,n,r){for(var i=t;i<=e;i++)n[i-t]=this.findRoot(r,this.points[i],n[i-t]);i=1;for(var s=n.length;i<s;i++)if(n[i]<=n[i-1])return!1;return!0},findRoot:function(t,e,n){for(var r=[],i=[],s=0;s<=2;s++)r[s]=t[s+1].subtract(t[s]).multiply(3);for(s=0;s<=1;s++)i[s]=r[s+1].subtract(r[s]).multiply(2);var o=this.evaluate(3,t,n),a=this.evaluate(2,r,n),l=this.evaluate(1,i,n),c=o.subtract(e),u=a.dot(a)+c.dot(l);return g.isMachineZero(u)?n:n-c.dot(a)/u},evaluate:function(t,e,n){for(var r=e.slice(),i=1;i<=t;i++)for(var s=0;s<=t-i;s++)r[s]=r[s].multiply(1-n).add(r[s+1].multiply(n));return r[0]},chordLengthParameterize:function(t,e){for(var n=[0],r=t+1;r<=e;r++)n[r-t]=n[r-t-1]+this.points[r].getDistance(this.points[r-1]);r=1;for(var i=e-t;r<=i;r++)n[r]/=n[i];return n},findMaxError:function(t,e,n,r){for(var i=Math.floor((e-t+1)/2),s=0,o=t+1;o<e;o++){var a=this.evaluate(3,n,r[o-t]).subtract(this.points[o]),l=a.x*a.x+a.y*a.y;l>=s&&(s=l,i=o)}return{error:s,index:i}}}),H=C.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(t){this._content="",this._lines=[];var e=t&&u.isPlainObject(t)&&t.x===a&&t.y===a;this._initialize(e&&t,!e&&_.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),G=H.extend({_class:"PointText",initialize:function(){H.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new v(t.x,t.y,this,"setPoint")},setPoint:function(){var t=_.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,n){if(this._content){this._setStyles(t,e,n);var r=this._lines,i=this._style,s=i.hasFill(),o=i.hasStroke(),a=i.getLeading(),l=t.shadowColor;t.font=i.getFontStyle(),t.textAlign=i.getJustification();for(var c=0,u=r.length;c<u;c++){t.shadowColor=l;var h=r[c];s&&(t.fillText(h,0,0),t.shadowColor="rgba(0,0,0,0)"),o&&t.strokeText(h,0,0),t.translate(0,a)}}},_getBounds:function(t,e){var n=this._style,r=this._lines,i=r.length,s=n.getJustification(),o=n.getLeading(),a=this.getView().getTextWidth(n.getFontStyle(),r),l=0;"left"!==s&&(l-=a/("center"===s?2:1));var c=new x(l,i?-.75*o:0,a,i*o);return t?t._transformBounds(c,c):c}}),W=u.extend(new function(){var t,e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},n={},r={transparent:[0,0,0,0]};function i(e){var n,i=e.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||e.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),s="rgb";if(i){var o=i[4]?4:3;n=new Array(o);for(var a=0;a<o;a++){var c=i[a+1];n[a]=parseInt(1==c.length?c+c:c,16)/255}}else if(i=e.match(/^(rgb|hsl)a?\((.*)\)$/)){s=i[1],n=i[2].trim().split(/[,\s]+/g);for(var u="hsl"===s,h=(a=0,Math.min(n.length,4));a<h;a++){var d=n[a];if(c=parseFloat(d),u)if(0===a){var f=d.match(/([a-z]*)$/)[1];c*={turn:360,rad:180/Math.PI,grad:.9}[f]||1}else a<3&&(c/=100);else a<3&&(c/=/%$/.test(d)?100:255);n[a]=c}}else{var p=r[e];if(!p)if(l){t||((t=lt.getContext(1,1)).globalCompositeOperation="copy"),t.fillStyle="rgba(0,0,0,0)",t.fillStyle=e,t.fillRect(0,0,1,1);var m=t.getImageData(0,0,1,1).data;p=r[e]=[m[0]/255,m[1]/255,m[2]/255]}else p=[0,0,0];n=p.slice()}return[s,n]}var s=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],o={"rgb-hsb":function(t,e,n){var r=Math.max(t,e,n),i=r-Math.min(t,e,n);return[0===i?0:60*(r==t?(e-n)/i+(e<n?6:0):r==e?(n-t)/i+2:(t-e)/i+4),0===r?0:i/r,r]},"hsb-rgb":function(t,e,n){var r,i=(t=(t/60%6+6)%6)-(r=Math.floor(t)),o=[n,n*(1-e),n*(1-e*i),n*(1-e*(1-i))];return[o[(r=s[r])[0]],o[r[1]],o[r[2]]]},"rgb-hsl":function(t,e,n){var r=Math.max(t,e,n),i=Math.min(t,e,n),s=r-i,o=0===s,a=(r+i)/2;return[o?0:60*(r==t?(e-n)/s+(e<n?6:0):r==e?(n-t)/s+2:(t-e)/s+4),o?0:a<.5?s/(r+i):s/(2-r-i),a]},"hsl-rgb":function(t,e,n){if(0===e)return[n,n,n];for(var r=[(t=(t/360%1+1)%1)+1/3,t,t-1/3],i=n<.5?n*(1+e):n+e-n*e,s=2*n-i,o=[],a=0;a<3;a++){var l=r[a];l<0&&(l+=1),l>1&&(l-=1),o[a]=6*l<1?s+6*(i-s)*l:2*l<1?i:3*l<2?s+(i-s)*(2/3-l)*6:s}return o},"rgb-gray":function(t,e,n){return[.2989*t+.587*e+.114*n]},"gray-rgb":function(t){return[t,t,t]},"gray-hsb":function(t){return[0,0,t]},"gray-hsl":function(t){return[0,0,t]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return u.each(e,function(t,r){n[r]=[],u.each(t,function(t,i){var s=u.capitalize(t),o=/^(hue|saturation)$/.test(t),a=n[r][i]="gradient"===r?"gradient"===t?function(t){var e=this._components[0];return e!==(t=q.read(Array.isArray(t)?t:arguments,0,{readNull:!0}))&&(e&&e._removeOwner(this),t&&t._addOwner(this)),t}:function(){return _.read(arguments,0,{readNull:"highlight"===t,clone:!0})}:function(t){return null==t||isNaN(t)?0:+t};this["get"+s]=function(){return this._type===r||o&&/^hs[bl]$/.test(this._type)?this._components[i]:this._convert(r)[i]},this["set"+s]=function(t){this._type===r||o&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(r),this._properties=e[r],this._type=r),this._components[i]=a.call(this,t),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function t(r){var s,o,a,l,c=arguments,h=this.__read,d=0;Array.isArray(r)&&(r=(c=r)[0]);var f=null!=r&&typeof r;if("string"===f&&r in e&&(s=r,r=c[1],Array.isArray(r)?(o=r,a=c[2]):(h&&(d=1),c=u.slice(c,1),f=typeof r)),!o){if(l="number"===f?c:"object"===f&&null!=r.length?r:null){s||(s=l.length>=3?"rgb":"gray");var p=e[s].length;a=l[p],h&&(d+=l===arguments?p+(null!=a?1:0):1),l.length>p&&(l=u.slice(l,0,p))}else if("string"===f){var m=i(r);s=m[0],4===(o=m[1]).length&&(a=o[3],o.length--)}else if("object"===f)if(r.constructor===t){if(s=r._type,o=r._components.slice(),a=r._alpha,"gradient"===s)for(var g=1,y=o.length;g<y;g++){var _=o[g];_&&(o[g]=_.clone())}}else if(r.constructor===q)s="gradient",l=c;else{var v=e[s="hue"in r?"lightness"in r?"hsl":"hsb":"gradient"in r||"stops"in r||"radial"in r?"gradient":"gray"in r?"gray":"rgb"],b=n[s];for(this._components=o=[],g=0,y=v.length;g<y;g++)null==(w=r[v[g]])&&!g&&"gradient"===s&&"stops"in r&&(w={stops:r.stops,radial:r.radial}),null!=(w=b[g].call(this,w))&&(o[g]=w);a=r.alpha}h&&s&&(d=1)}if(this._type=s||"rgb",!o)for(this._components=o=[],g=0,y=(b=n[this._type]).length;g<y;g++){var w;null!=(w=b[g].call(this,l&&l[g]))&&(o[g]=w)}return this._components=o,this._properties=e[this._type],this._alpha=a,h&&(this.__read=d),this},set:"#initialize",_serialize:function(t,e){var n=this.getComponents();return u.serialize(/^(gray|rgb)$/.test(this._type)?n:[this._type].concat(n),t,!0,e)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(t){var e;return this._type===t?this._components.slice():(e=o[this._type+"-"+t])?e.apply(this,this._components):o["rgb-"+t].apply(this,o[this._type+"-rgb"].apply(this,this._components))},convert:function(t){return new W(t,this._convert(t),this._alpha)},getType:function(){return this._type},setType:function(t){this._components=this._convert(t),this._properties=e[t],this._type=t},getComponents:function(){var t=this._components.slice();return null!=this._alpha&&t.push(this._alpha),t},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(t){this._alpha=null==t?null:Math.min(Math.max(t,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(t){var e=u.isPlainValue(t,!0)?W.read(arguments):t;return e===this||e&&this._class===e._class&&this._type===e._type&&this.getAlpha()===e.getAlpha()&&u.equals(this._components,e._components)||!1},toString:function(){for(var t=this._properties,e=[],n="gradient"===this._type,r=m.instance,i=0,s=t.length;i<s;i++){var o=this._components[i];null!=o&&e.push(t[i]+": "+(n?o:r.number(o)))}return null!=this._alpha&&e.push("alpha: "+r.number(this._alpha)),"{ "+e.join(", ")+" }"},toCSS:function(t){var e=this._convert("rgb"),n=t||null==this._alpha?1:this._alpha;function r(t){return Math.round(255*(t<0?0:t>1?1:t))}return e=[r(e[0]),r(e[1]),r(e[2])],n<1&&e.push(n<0?0:n),t?"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1):(4==e.length?"rgba(":"rgb(")+e.join(",")+")"},toCanvasStyle:function(t,e){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var n,r=this._components,i=r[0],s=i._stops,o=r[1],a=r[2],l=r[3],c=e&&e.inverted();if(c&&(o=c._transformPoint(o),a=c._transformPoint(a),l&&(l=c._transformPoint(l))),i._radial){var u=a.getDistance(o);if(l){var h=l.subtract(o);h.getLength()>u&&(l=o.add(h.normalize(u-.1)))}var d=l||o;n=t.createRadialGradient(d.x,d.y,0,o.x,o.y,u)}else n=t.createLinearGradient(o.x,o.y,a.x,a.y);for(var f=0,p=s.length;f<p;f++){var m=s[f],g=m._offset;n.addColorStop(null==g?f/(p-1):g,m._color.toCanvasStyle())}return this._canvasStyle=n},transform:function(t){if("gradient"===this._type){for(var e=this._components,n=1,r=e.length;n<r;n++){var i=e[n];t._transformPoint(i,i,!0)}this._changed()}},statics:{_types:e,random:function(){var t=Math.random;return new W(t(),t(),t())},_setOwner:function(t,e,n){return t&&(t._owner&&e&&t._owner!==e&&(t=t.clone()),!t._owner^!e&&(t._owner=e||null,t._setter=n||null)),t}}})},new function(){return u.each({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e}},function(t,e){this[e]=function(e){e=W.read(arguments);for(var n=this._type,r=this._components,i=e._convert(n),s=0,o=r.length;s<o;s++)i[s]=t(r[s],i[s]);return new W(n,i,null!=this._alpha?t(this._alpha,e.getAlpha()):null)}},{})}),q=u.extend({_class:"Gradient",initialize:function(t,e){this._id=y.get(),t&&u.isPlainObject(t)&&(this.set(t),t=e=null),null==this._stops&&this.setStops(t||["white","black"]),null==this._radial&&this.setRadial("string"==typeof e&&"radial"===e||e||!1)},_serialize:function(t,e){return e.add(this,function(){return u.serialize([this._stops,this._radial],t,!0,e)})},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var e=this._owners?this._owners.indexOf(t):-1;-1!=e&&(this._owners.splice(e,1),this._owners.length||(this._owners=a))},clone:function(){for(var t=[],e=0,n=this._stops.length;e<n;e++)t[e]=this._stops[e].clone();return new q(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var e=this._stops;if(e)for(var n=0,r=e.length;n<r;n++)e[n]._owner=a;for(n=0,r=(e=this._stops=Z.readList(t,0,{clone:!0})).length;n<r;n++)e[n]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,n=t._stops,r=e.length;if(r===n.length){for(var i=0;i<r;i++)if(!e[i].equals(n[i]))return!1;return!0}}return!1}}),Z=u.extend({_class:"GradientStop",initialize:function(t,e){var n=t,r=e;"object"==typeof t&&e===a&&(Array.isArray(t)&&"number"!=typeof t[0]?(n=t[0],r=t[1]):("color"in t||"offset"in t||"rampPoint"in t)&&(n=t.color,r=t.offset||t.rampPoint||0)),this.setColor(n),this.setOffset(r)},clone:function(){return new Z(this._color.clone(),this._offset)},_serialize:function(t,e){var n=this._color,r=this._offset;return u.serialize(null==r?[n]:[n,r],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){W._setOwner(this._color,null),this._color=W._setOwner(W.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),Y=u.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new _,selectedColor:null},e=u.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),n=u.set({},e,{fillColor:new W}),r={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},i={beans:!0},s={_class:"Style",beans:!0,initialize:function(r,i,s){this._values={},this._owner=i,this._project=i&&i._project||s||dt.project,this._defaults=!i||i instanceof M?e:i instanceof H?n:t,r&&this.set(r)}};return u.each(e,function(t,e){var n=/Color$/.test(e),o="shadowOffset"===e,l=u.capitalize(e),c=r[e],h="set"+l,d="get"+l;s[h]=function(t){var r=this._owner,i=r&&r._children,s=i&&i.length>0&&!(r instanceof V);if(s)for(var o=0,a=i.length;o<a;o++)i[o]._style[h](t);if(("selectedColor"===e||!s)&&e in this._defaults){var l=this._values[e];l!==t&&(n&&(l&&(W._setOwner(l,null),l._canvasStyle=null),t&&t.constructor===W&&(t=W._setOwner(t,r,s&&h))),this._values[e]=t,r&&r._changed(c||129))}},s[d]=function(t){var r=this._owner,i=r&&r._children,s=i&&i.length>0&&!(r instanceof V);if(s&&!t)for(var l=0,c=i.length;l<c;l++){var f=i[l]._style[d]();if(l){if(!u.equals(p,f))return a}else p=f}else if(e in this._defaults){var p;if((p=this._values[e])===a)(p=this._defaults[e])&&p.clone&&(p=p.clone());else{var m=n?W:o?_:null;!m||p&&p.constructor===m||(this._values[e]=p=m.read([p],0,{readNull:!0,clone:!0}))}}return p&&n&&(p=W._setOwner(p,r,s&&h)),p},i[d]=function(t){return this._style[d](t)},i[h]=function(t){this._style[h](t)}}),u.each({Font:"FontFamily",WindingRule:"FillRule"},function(t,e){var n="get"+e,r="set"+e;s[n]=i[n]="#get"+t,s[r]=i[r]="#set"+t}),C.inject(i),s},{set:function(t){var e=t instanceof Y,n=e?t._values:t;if(n)for(var r in n)if(r in this._defaults){var i=n[r];this[r]=i&&e&&i.clone?i.clone():i}},equals:function(t){function e(t,e,n){var r=t._values,i=e._values,s=e._defaults;for(var o in r){var l=i[o];if(!(n&&o in i||u.equals(r[o],l===a?s[o]:l)))return!1}return!0}return t===this||t&&this._class===t._class&&e(this,t)&&e(t,this,!0)||!1},_dispose:function(){var t;(t=this.getFillColor())&&(t._canvasStyle=null),(t=this.getStrokeColor())&&(t._canvasStyle=null),(t=this.getShadowColor())&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),null!=e?e:1.2*n}}),J=new function(){function t(t,e,n,r){for(var i=["","webkit","moz","Moz","ms","o"],s=e[0].toUpperCase()+e.substring(1),o=0;o<6;o++){var a=i[o],l=a?a+s:e;if(l in t){if(!n)return t[l];t[l]=r;break}}}return{getStyles:function(t){var e=t&&9!==t.nodeType?t.ownerDocument:t,n=e&&e.defaultView;return n&&n.getComputedStyle(t,"")},getBounds:function(t,e){var n,r=t.ownerDocument,i=r.body,s=r.documentElement;try{n=t.getBoundingClientRect()}catch(c){n={left:0,top:0,width:0,height:0}}var o=n.left-(s.clientLeft||i.clientLeft||0),a=n.top-(s.clientTop||i.clientTop||0);if(!e){var l=r.defaultView;o+=l.pageXOffset||s.scrollLeft||i.scrollLeft,a+=l.pageYOffset||s.scrollTop||i.scrollTop}return new x(o,a,n.width,n.height)},getViewportBounds:function(t){var e=t.ownerDocument,n=e.defaultView,r=e.documentElement;return new x(0,0,n.innerWidth||r.clientWidth,n.innerHeight||r.clientHeight)},getOffset:function(t,e){return J.getBounds(t,e).getPoint()},getSize:function(t){return J.getBounds(t,!0).getSize()},isInvisible:function(t){return J.getSize(t).equals(new b(0,0))},isInView:function(t){return!J.isInvisible(t)&&J.getViewportBounds(t).intersects(J.getBounds(t,!0))},isInserted:function(t){return c.body.contains(t)},getPrefixed:function(e,n){return e&&t(e,n)},setPrefixed:function(e,n,r){if("object"==typeof n)for(var i in n)t(e,i,!0,n[i]);else t(e,n,!0,r)}}},K={add:function(t,e){if(t)for(var n in e)for(var r=e[n],i=n.split(/[\s,]+/g),s=0,o=i.length;s<o;s++){var a=i[s];t.addEventListener(a,r,t===c&&("touchstart"===a||"touchmove"===a)&&{passive:!1})}},remove:function(t,e){if(t)for(var n in e)for(var r=e[n],i=n.split(/[\s,]+/g),s=0,o=i.length;s<o;s++)t.removeEventListener(i[s],r,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new _(e.pageX||e.clientX+c.documentElement.scrollLeft,e.pageY||e.clientY+c.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return K.getPoint(t).subtract(J.getOffset(e||K.getTarget(t)))}};K.requestAnimationFrame=new function(){var t,e=J.getPrefixed(l,"requestAnimationFrame"),n=!1,r=[];function i(){var t=r;r=[];for(var s=0,o=t.length;s<o;s++)t[s]();(n=e&&r.length)&&e(i)}return function(s){r.push(s),e?n||(e(i),n=!0):t||(t=setInterval(i,1e3/60))}};var X=u.extend(h,{_class:"View",initialize:function t(e,n){function r(t){return n[t]||parseInt(n.getAttribute(t),10)}function i(){var t=J.getSize(n);return t.isNaN()||t.isZero()?new b(r("width"),r("height")):t}var s;if(l&&n){this._id=n.getAttribute("id"),null==this._id&&n.setAttribute("id",this._id="paper-view-"+t._id++),K.add(n,this._viewEvents);var o="none";if(J.setPrefixed(n.style,{userDrag:o,userSelect:o,touchCallout:o,contentZooming:o,tapHighlightColor:"rgba(0,0,0,0)"}),d.hasAttribute(n,"resize")){var a=this;K.add(l,this._windowEvents={resize:function(){a.setViewSize(i())}})}if(s=i(),d.hasAttribute(n,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var u=this._stats.domElement,h=u.style,f=J.getOffset(n);h.position="absolute",h.left=f.x+"px",h.top=f.y+"px",c.body.appendChild(u)}}else s=new b(n),n=null;this._project=e,this._scope=e._scope,this._element=n,this._pixelRatio||(this._pixelRatio=l&&l.devicePixelRatio||1),this._setElementSize(s.width,s.height),this._viewSize=s,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new E)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!dt.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;X._focused===this&&(X._focused=null),X._views.splice(X._views.indexOf(this),1),delete X._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),K.remove(this._element,this._viewEvents),K.remove(l,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:u.each(C._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(t){this[t]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;K.requestAnimationFrame(function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;J.getPrefixed(c,"hidden")&&"true"!==d.getAttribute(e,"keepalive")||!J.isInView(e)||t._handleFrame()}t._autoUpdate&&t.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){dt=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new u({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var n=this._frameItems;e?(n[t._id]={item:t,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete n[t._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var n=this._frameItems[e];n.item.emit("frame",new u(t,{time:n.time+=t.delta,count:n.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=a},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var t=this._viewSize;return new w(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=b.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var n=this._element;n&&(n.width!==t&&(n.width=t),n.height!==e&&(n.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new x(new _,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return J.isInView(this._element)},isInserted:function(){return J.isInserted(this._element)},getPixelSize:function(t){var e,n=this._element;if(n){var r=n.parentNode,i=c.createElement("div");i.style.fontSize=t,r.appendChild(i),e=parseFloat(J.getStyles(i).fontSize),r.removeChild(i)}else e=parseFloat(e);return e},getTextWidth:function(t,e){return 0}},u.each(["rotate","scale","shear","skew"],function(t){var e="rotate"===t;this[t]=function(){var n=arguments,r=(e?u:_).read(n),i=_.read(n,0,{readNull:!0});return this.transform((new E)[t](r,i||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new E;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=_.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform((new E).scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();null!=e&&null!=t&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new v(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=_.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(_.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(_.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(_.read(arguments))},getEventPoint:function(t){return this.viewToProject(K.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){return c&&"string"==typeof e&&(e=c.getElementById(e)),new(l?Q:X)(t,e)}}},new function(){if(l){var t,e,n,r,i,s=!1,o=!1,a=l.navigator;a.pointerEnabled||a.msPointerEnabled?(n="pointerdown MSPointerDown",r="pointermove MSPointerMove",i="pointerup pointercancel MSPointerUp MSPointerCancel"):(n="touchstart",r="touchmove",i="touchend touchcancel","ontouchstart"in l&&a.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(n+=" mousedown",r+=" mousemove",i+=" mouseup"));var u={},h={mouseout:function(t){var e=X._focused,n=K.getRelatedTarget(t);if(e&&(!n||"HTML"===n.nodeName)){var r=K.getOffset(t,e._element),i=r.x,s=Math.abs,o=s(i),a=o-(1<<25);r.x=s(a)<o?a*(i<0?-1:1):i,C(e,t,e.viewToProject(r))}},scroll:T};u[n]=function(t){var e=X._focused=A(t);s||(s=!0,e._handleMouseEvent("mousedown",t))},h[r]=function(n){var r=X._focused;if(!o){var i=A(n);i?r!==i&&(r&&C(r,n),t||(t=r),r=X._focused=e=i):e&&e===r&&(t&&!t.isInserted()&&(t=null),r=X._focused=t,t=null,T())}r&&C(r,n)},h[n]=function(){o=!0},h[i]=function(t){var e=X._focused;e&&s&&e._handleMouseEvent("mouseup",t),o=s=!1},K.add(c,h),K.add(l,{load:T});var d,f,p,m,g,y,_,v,b=!1,w=!1,x={doubleclick:"click",mousedrag:"mousemove"},S=!1,E={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:u,_handleMouseEvent:function(t,e,n){var r=this._itemEvents,i=r.native[t],o="mousemove"===t,a=this._scope.tool,l=this;function c(t){return r.virtual[t]||l.responds(t)||a&&a.responds(t)}o&&s&&c("mousedrag")&&(t="mousedrag"),n||(n=this.getEventPoint(e));var u=this.getBounds().contains(n),h=i&&u&&l._project.hitTest(n,{tolerance:0,fill:!0,stroke:!0}),x=h&&h.item||null,E=!1,A={};if(A[t.substr(5)]=!0,i&&x!==m&&(m&&M(m,null,"mouseleave",e,n),x&&M(x,null,"mouseenter",e,n),m=x),S^u&&(M(this,null,u?"mouseenter":"mouseleave",e,n),E=!0),!u&&!A.drag||n.equals(f)||(O(this,x,o?t:"mousemove",e,n,f),E=!0),S=u,A.down&&u||A.up&&d){if(O(this,x,t,e,n,d),A.down){if(v=x===y&&Date.now()-_<300,p=y=x,!w&&x){for(var T=x;T&&!T.responds("mousedrag");)T=T._parent;T&&(g=x)}d=n}else A.up&&(w||x!==p||(_=Date.now(),O(this,x,v?"doubleclick":"click",e,n,d),v=!1),p=g=null);S=!1,E=!0}f=n,E&&a&&(b=a._handleMouseEvent(t,e,n,A)||b),!1!==e.cancelable&&(b&&!A.move||A.down&&c("mouseup"))&&e.preventDefault()},_handleKeyEvent:function(t,e,n,r){var i,s=this._scope,o=s.tool;function a(o){o.responds(t)&&(dt=s,o.emit(t,i=i||new et(t,e,n,r)))}this.isVisible()&&(a(this),o&&o.responds(t)&&a(o))},_countItemEvent:function(t,e){var n=this._itemEvents,r=n.native,i=n.virtual;for(var s in E)r[s]=(r[s]||0)+(E[s][t]||0)*e;i[t]=(i[t]||0)+e},statics:{updateFocus:T,_resetState:function(){s=o=b=S=!1,t=e=d=f=p=m=g=y=_=v=null}}}}function A(t){var e=K.getTarget(t);return e.getAttribute&&X._viewsById[e.getAttribute("id")]}function T(){var t=X._focused;if(!t||!t.isVisible())for(var n=0,r=X._views.length;n<r;n++)if((t=X._views[n]).isVisible()){X._focused=e=t;break}}function C(t,e,n){t._handleMouseEvent("mousemove",e,n)}function M(t,e,n,r,i,s,o){var a,l=!1;function c(t,n){if(t.responds(n)){if(a||(a=new rt(n,r,i,e||t,s?i.subtract(s):null)),t.emit(n,a)&&(b=!0,a.prevented&&(w=!0),a.stopped))return l=!0}else{var o=x[n];if(o)return c(t,o)}}for(;t&&t!==o&&!c(t,n);)t=t._parent;return l}function O(t,e,n,r,i,s){return t._project.removeOn(n),w=b=!1,g&&M(g,null,n,r,i,s)||e&&e!==g&&!e.isDescendant(g)&&M(e,null,"mousedrag"===n?"mousemove":n,r,i,s,g)||M(t,g||e||t,n,r,i,s)}}),Q=X.extend({_class:"CanvasView",initialize:function(t,e){if(!(e instanceof l.HTMLCanvasElement)){var n=b.read(arguments,1);if(n.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+u.slice(arguments,1));e=lt.getCanvas(n)}var r=this._context=e.getContext("2d");if(r.save(),this._pixelRatio=1,!/^off|false$/.test(d.getAttribute(e,"hidpi"))){var i=l.devicePixelRatio||1,s=J.getPrefixed(r,"backingStorePixelRatio")||1;this._pixelRatio=i/s}X.call(this,t,e),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,n){var r=this._pixelRatio;if(t.base.call(this,e*r,n*r),1!==r){var i=this._element,s=this._context;if(!d.hasAttribute(i,"resize")){var o=i.style;o.width=e+"px",o.height=n+"px"}s.restore(),s.save(),s.scale(r,r)}},getContext:function(){return this._context},getPixelSize:function t(e){var n,r=dt.agent;if(r&&r.firefox)n=t.base.call(this,e);else{var i=this._context,s=i.font;i.font=e+" serif",n=parseFloat(i.font),i.font=s}return n},getTextWidth:function(t,e){var n=this._context,r=n.font,i=0;n.font=t;for(var s=0,o=e.length;s<o;s++)i=Math.max(i,n.measureText(e[s]).width);return n.font=r,i},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,n=this._viewSize;return e.clearRect(0,0,n.width+1,n.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),tt=u.extend({_class:"Event",initialize:function(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return nt.modifiers}}),et=tt.extend({_class:"KeyEvent",initialize:function(t,e,n,r){this.type=t,this.event=e,this.key=n,this.character=r},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),nt=new function(){var t,e,n={"\t":"tab"," ":"space","\b":"backspace","\x7f":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},r={tab:"\t",space:" ",enter:"\r"},i={},s={},o=new u({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var t=dt&&dt.agent;return t&&t.mac?this.meta:this.control}}});function h(t){var e=t.key||t.keyIdentifier;return e=/^U\+/.test(e)?String.fromCharCode(parseInt(e.substr(2),16)):/^Arrow[A-Z]/.test(e)?e.substr(5):"Unidentified"===e||e===a?String.fromCharCode(t.keyCode):e,n[e]||(e.length>1?u.hyphenate(e):e.toLowerCase())}function d(e,n,r,a){var l,c=X._focused;if(i[n]=e,e?s[n]=r:delete s[n],n.length>1&&(l=u.camelize(n))in o){o[l]=e;var h=dt&&dt.agent;if("meta"===l&&h&&h.mac)if(e)t={};else{for(var f in t)f in s&&d(!1,f,t[f],a);t=null}}else e&&t&&(t[n]=r);c&&c._handleKeyEvent(e?"keydown":"keyup",a,n,r)}return K.add(c,{keydown:function(t){var n=h(t),i=dt&&dt.agent;n.length>1||i&&i.chrome&&(t.altKey||i.mac&&t.metaKey||!i.mac&&t.ctrlKey)?d(!0,n,r[n]||(n.length>1?"":n),t):e=n},keypress:function(t){if(e){var n=h(t),r=t.charCode,i=r>=32?String.fromCharCode(r):n.length>1?"":n;n!==e&&(n=i.toLowerCase()),d(!0,n,i,t),e=null}},keyup:function(t){var e=h(t);e in s&&d(!1,e,s[e],t)}}),K.add(l,{blur:function(t){for(var e in s)d(!1,e,s[e],t)}}),{modifiers:o,isDown:function(t){return!!i[t]}}},rt=tt.extend({_class:"MouseEvent",initialize:function(t,e,n,r,i){this.type=t,this.event=e,this.point=n,this.target=r,this.delta=i},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),it=tt.extend({_class:"ToolEvent",_item:null,initialize:function(t,e,n){this.tool=t,this.type=e,this.event=n},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,n=e._parent;/^(Group|CompoundPath)$/.test(n._class);)e=n,n=n._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),st=f.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(t){f.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,null!=t&&null!=this._maxDistance&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,null!=this._minDistance&&null!=t&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,n,r){dt=this._scope,r.drag&&!this.responds(t)&&(t="mousemove");var i=r.move||r.drag,s=this.responds(t),o=this.minDistance,a=this.maxDistance,l=!1,c=this;function u(t,e){var s=n,o=i?c._point:c._downPoint||s;if(i){if(c._moveCount>=0&&s.equals(o))return!1;if(o&&(null!=t||null!=e)){var a=s.subtract(o),l=a.getLength();if(l<(t||0))return!1;e&&(s=o.add(a.normalize(Math.min(l,e))))}c._moveCount++}return c._point=s,c._lastPoint=o||s,r.down&&(c._moveCount=-1,c._downPoint=s,c._downCount++),!0}function h(){s&&(l=c.emit(t,new it(c,t,e))||l)}if(r.down)u(),h();else if(r.up)u(null,a),h();else if(s)for(;u(o,a);)h();return l}}),ot=u.extend(h,{_class:"Tween",statics:{easings:new u({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:2*(2-t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(e,n,r,i,s,o){this.object=e;var a=typeof s,l="function"===a;this.type=l?a:"string"===a?s:"linear",this.easing=l?s:t.easings[this.type],this.duration=i,this.running=!1,this._then=null,this._startTime=null;var c=n||r;this._keys=c?Object.keys(c):[],this._parsedKeys=this._parseKeys(this._keys),this._from=c&&this._getState(n),this._to=c&&this._getState(r),!1!==o&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),n=this._keys,r=function(n){return"function"==typeof n?n(e,t):n},i=0,s=n&&n.length;i<s;i++){var o=n[i],a=r(this._from[o]),l=r(this._to[o]),c=a&&l&&a.__add&&l.__add?l.__subtract(a).__multiply(e).__add(a):(l-a)*e+a;this._setProperty(this._parsedKeys[o],c)}this.responds("update")&&this.emit("update",new u({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,n=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(n)},_getState:function(t){for(var e=this._keys,n={},r=0,i=e.length;r<i;r++){var s,o=e[r],a=this._parsedKeys[o],l=this._getProperty(a);if(t){var c=this._resolveValue(l,t[o]);this._setProperty(a,c),s=(s=this._getProperty(a))&&s.clone?s.clone():s,this._setProperty(a,l)}else s=l&&l.clone?l.clone():l;n[o]=s}return n},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&2===e.length){var n=e[0];return n&&n.match&&n.match(/^[+\-\*\/]=/)?this._calculate(t,n[0],e[1]):e}if("string"==typeof e){var r=e.match(/^[+\-*/]=(.*)/);if(r){var i=JSON.parse(r[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],i)}}}return e},_calculate:function(t,e,n){return dt.PaperScript.calculateBinary(t,e,n)},_parseKeys:function(t){for(var e={},n=0,r=t.length;n<r;n++){var i=t[n],s=i.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[i]=s.split("/")}return e},_getProperty:function(t,e){for(var n=this.object,r=0,i=t.length-(e||0);r<i&&n;r++)n=n[t[r]];return n},_setProperty:function(t,e){var n=this._getProperty(t,1);n&&(n[t[t.length-1]]=e)}}),at=function(t){var e=new o.XMLHttpRequest;return e.open((t.method||"get").toUpperCase(),t.url,u.pick(t.async,!0)),t.mimeType&&e.overrideMimeType(t.mimeType),e.onload=function(){var n=e.status;0===n||200===n?t.onLoad&&t.onLoad.call(e,e.responseText):e.onerror()},e.onerror=function(){var n=e.status,r='Could not load "'+t.url+'" (Status: '+n+")";if(!t.onError)throw new Error(r);t.onError(r,n)},e.send(null)},lt=u.exports.CanvasProvider={canvases:[],getCanvas:function(t,e){if(!l)return null;var n,r=!0;"object"==typeof t&&(e=t.height,t=t.width),this.canvases.length?n=this.canvases.pop():(n=c.createElement("canvas"),r=!1);var i=n.getContext("2d");if(!i)throw new Error("Canvas "+n+" is unable to provide a 2D context.");return n.width===t&&n.height===e?r&&i.clearRect(0,0,t+1,e+1):(n.width=t,n.height=e),i.save(),n},getContext:function(t,e){var n=this.getCanvas(t,e);return n?n.getContext("2d"):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},ct=new function(){var t,e,n,r,i,s,o,a,l,c,h,d=Math.min,f=Math.max,p=Math.abs;function m(t,e,n){return.2989*t+.587*e+.114*n}function g(t,e,n,r){var i=r-m(t,e,n),s=(r=m(l=t+i,c=e+i,h=n+i),d(l,c,h)),o=f(l,c,h);if(s<0){var a=r-s;l=r+(l-r)*r/a,c=r+(c-r)*r/a,h=r+(h-r)*r/a}if(o>255){var u=255-r,p=o-r;l=r+(l-r)*u/p,c=r+(c-r)*u/p,h=r+(h-r)*u/p}}function y(t,e,n){return f(t,e,n)-d(t,e,n)}function _(t,e,n,r){var i,s=[t,e,n],o=f(t,e,n),a=d(t,e,n);i=0===d(a=a===t?0:a===e?1:2,o=o===t?0:o===e?1:2)?1===f(a,o)?2:1:0,s[o]>s[a]?(s[i]=(s[i]-s[a])*r/(s[o]-s[a]),s[o]=r):s[i]=s[o]=0,s[a]=0,l=s[0],c=s[1],h=s[2]}var v={multiply:function(){l=i*t/255,c=s*e/255,h=o*n/255},screen:function(){l=i+t-i*t/255,c=s+e-s*e/255,h=o+n-o*n/255},overlay:function(){l=i<128?2*i*t/255:255-2*(255-i)*(255-t)/255,c=s<128?2*s*e/255:255-2*(255-s)*(255-e)/255,h=o<128?2*o*n/255:255-2*(255-o)*(255-n)/255},"soft-light":function(){var r=t*i/255;l=r+i*(255-(255-i)*(255-t)/255-r)/255,c=(r=e*s/255)+s*(255-(255-s)*(255-e)/255-r)/255,h=(r=n*o/255)+o*(255-(255-o)*(255-n)/255-r)/255},"hard-light":function(){l=t<128?2*t*i/255:255-2*(255-t)*(255-i)/255,c=e<128?2*e*s/255:255-2*(255-e)*(255-s)/255,h=n<128?2*n*o/255:255-2*(255-n)*(255-o)/255},"color-dodge":function(){l=0===i?0:255===t?255:d(255,255*i/(255-t)),c=0===s?0:255===e?255:d(255,255*s/(255-e)),h=0===o?0:255===n?255:d(255,255*o/(255-n))},"color-burn":function(){l=255===i?255:0===t?0:f(0,255-255*(255-i)/t),c=255===s?255:0===e?0:f(0,255-255*(255-s)/e),h=255===o?255:0===n?0:f(0,255-255*(255-o)/n)},darken:function(){l=i<t?i:t,c=s<e?s:e,h=o<n?o:n},lighten:function(){l=i>t?i:t,c=s>e?s:e,h=o>n?o:n},difference:function(){(l=i-t)<0&&(l=-l),(c=s-e)<0&&(c=-c),(h=o-n)<0&&(h=-h)},exclusion:function(){l=i+t*(255-i-i)/255,c=s+e*(255-s-s)/255,h=o+n*(255-o-o)/255},hue:function(){_(t,e,n,y(i,s,o)),g(l,c,h,m(i,s,o))},saturation:function(){_(i,s,o,y(t,e,n)),g(l,c,h,m(i,s,o))},luminosity:function(){g(i,s,o,m(t,e,n))},color:function(){g(t,e,n,m(i,s,o))},add:function(){l=d(i+t,255),c=d(s+e,255),h=d(o+n,255)},subtract:function(){l=f(i-t,0),c=f(s-e,0),h=f(o-n,0)},average:function(){l=(i+t)/2,c=(s+e)/2,h=(o+n)/2},negation:function(){l=255-p(255-t-i),c=255-p(255-e-s),h=255-p(255-n-o)}},b=this.nativeModes=u.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(t){this[t]=!0},{}),w=lt.getContext(1,1);w&&(u.each(v,function(t,e){var n="darken"===e,r=!1;w.save();try{w.fillStyle=n?"#300":"#a00",w.fillRect(0,0,1,1),w.globalCompositeOperation=e,w.globalCompositeOperation===e&&(w.fillStyle=n?"#a00":"#300",w.fillRect(0,0,1,1),r=w.getImageData(0,0,1,1).data[0]!==n?170:51)}catch(i){}w.restore(),b[e]=r}),lt.release(w)),this.process=function(u,d,f,p,m){var g=d.canvas,y="normal"===u;if(y||b[u])f.save(),f.setTransform(1,0,0,1,0,0),f.globalAlpha=p,y||(f.globalCompositeOperation=u),f.drawImage(g,m.x,m.y),f.restore();else{var _=v[u];if(!_)return;for(var w=f.getImageData(m.x,m.y,g.width,g.height),x=w.data,S=d.getImageData(0,0,g.width,g.height).data,E=0,A=x.length;E<A;E+=4){t=S[E],i=x[E],e=S[E+1],s=x[E+1],n=S[E+2],o=x[E+2],r=S[E+3],a=x[E+3],_();var T=r*p/255,C=1-T;x[E]=T*l+C*i,x[E+1]=T*c+C*s,x[E+2]=T*h+C*o,x[E+3]=r*p+C*a}f.putImageData(w,m.x,m.y)}}},ut=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",n="http://www.w3.org/1999/xlink",r={href:n,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function i(t,e,n){for(var i in e){var s=e[i],o=r[i];"number"==typeof s&&n&&(s=n.number(s)),o?t.setAttributeNS(o,i,s):t.setAttribute(i,s)}return t}return{svg:t,xmlns:e,xlink:n,create:function(e,n,r){return i(c.createElementNS(t,e),n,r)},get:function(t,e){var n=r[e],i=n?t.getAttributeNS(n,e):t.getAttribute(e);return"null"===i?null:i},set:i}},ht=u.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof j||t instanceof P||t instanceof H)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(t,e){var n=u.capitalize(e),r=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:r,fromSVG:r&&u.each(r,function(t,e){this[t]=e},{}),exportFilter:t[3],get:"get"+n,set:"set"+n}},{});new function(){var t;function e(e,n,r){var i,s=new u,o=e.getTranslation();if(n&&(e.isInvertible()?(i=(e=e._shiftless())._inverseTransform(o),o=null):i=new _,s[r?"cx":"x"]=i.x,s[r?"cy":"y"]=i.y),!e.isIdentity()){var a=e.decompose();if(a){var l=[],c=a.rotation,h=a.scaling,d=a.skewing;o&&!o.isZero()&&l.push("translate("+t.point(o)+")"),c&&l.push("rotate("+t.number(c)+")"),g.isZero(h.x-1)&&g.isZero(h.y-1)||l.push("scale("+t.point(h)+")"),d.x&&l.push("skewX("+t.number(d.x)+")"),d.y&&l.push("skewY("+t.number(d.y)+")"),s.transform=l.join(" ")}else s.transform="matrix("+e.getValues().join(",")+")"}return s}function n(n,r){for(var i=e(n._matrix),s=n._children,o=ut.create("g",i,t),a=0,c=s.length;a<c;a++){var u=s[a],d=h(u,r);if(d)if(u.isClipMask()){var f=ut.create("clipPath");f.appendChild(d),l(u,f,"clip"),ut.set(o,{"clip-path":"url(#"+f.id+")"})}else o.appendChild(d)}return o}function r(n){var r=n._type,i=n._radius,s=e(n._matrix,!0,"rectangle"!==r);if("rectangle"===r){r="rect";var o=n._size,a=o.width,l=o.height;s.x-=a/2,s.y-=l/2,s.width=a,s.height=l,i.isZero()&&(i=null)}return i&&("circle"===r?s.r=i:(s.rx=i.width,s.ry=i.height)),ut.create(r,s,t)}var i,s={Group:n,Layer:n,Raster:function(n,r){var i=e(n._matrix,!0),s=n.getSize(),o=n.getImage();return i.x-=s.width/2,i.y-=s.height/2,i.width=s.width,i.height=s.height,i.href=0==r.embedImages&&o&&o.src||n.toDataURL(),ut.create("image",i,t)},Path:function(n,i){var s=i.matchShapes;if(s){var o=n.toShape(!1);if(o)return r(o)}var a,l=n._segments,c=l.length,u=e(n._matrix);if(s&&c>=2&&!n.hasHandles())if(c>2){a=n._closed?"polygon":"polyline";for(var h=[],d=0;d<c;d++)h.push(t.point(l[d]._point));u.points=h.join(" ")}else{a="line";var f=l[0]._point,p=l[1]._point;u.set({x1:f.x,y1:f.y,x2:p.x,y2:p.y})}else a="path",u.d=n.getPathData(null,i.precision);return ut.create(a,u,t)},Shape:r,CompoundPath:function(n,r){var i=e(n._matrix),s=n.getPathData(null,r.precision);return s&&(i.d=s),ut.create("path",i,t)},SymbolItem:function(n,r){var i=e(n._matrix,!0),s=n._definition,o=a(s,"symbol"),c=s._item,u=c.getStrokeBounds();return o||((o=ut.create("symbol",{viewBox:t.rectangle(u)})).appendChild(h(c,r)),l(s,o,"symbol")),i.href="#"+o.id,i.x+=u.x,i.y+=u.y,i.width=u.width,i.height=u.height,i.overflow="visible",ut.create("use",i,t)},PointText:function(n){var r=ut.create("text",e(n._matrix,!0),t);return r.textContent=n._content,r}};function a(t,e){return i||(i={ids:{},svgs:{}}),t&&i.svgs[e+"-"+(t._id||t.__id||(t.__id=y.get("svg")))]}function l(t,e,n){i||a();var r=i.ids[n]=(i.ids[n]||0)+1;e.id=n+"-"+r,i.svgs[n+"-"+(t._id||t.__id)]=e}function c(t,e){var n=t,r=null;if(i){for(var s in n="svg"===t.nodeName.toLowerCase()&&t,i.svgs)r||(n||(n=ut.create("svg")).appendChild(t),r=n.insertBefore(ut.create("defs"),n.firstChild)),r.appendChild(i.svgs[s]);i=null}return e.asString?(new o.XMLSerializer).serializeToString(n):n}function h(e,n,r){var i=s[e._class],o=i&&i(e,n);if(o){var c=n.onExport;c&&(o=c(e,o,n)||o);var h=JSON.stringify(e._data);h&&"{}"!==h&&"null"!==h&&o.setAttribute("data-paper-data",h)}return o&&function(e,n,r){var i={},s=!r&&e.getParent(),o=[];return null!=e._name&&(i.id=e._name),u.each(ht,function(n){var r=n.get,c=n.type,h=e[r]();if(n.exportFilter?n.exportFilter(e,h):!s||!u.equals(s[r](),h)){if("color"===c&&null!=h){var d=h.getAlpha();d<1&&(i[n.attribute+"-opacity"]=d)}"style"===c?o.push(n.attribute+": "+h):i[n.attribute]=null==h?"none":"color"===c?h.gradient?function(e){var n=a(e,"color");if(!n){var r,i=e.getGradient(),s=i._radial,o=e.getOrigin(),c=e.getDestination();if(s){r={cx:o.x,cy:o.y,r:o.getDistance(c)};var u=e.getHighlight();u&&(r.fx=u.x,r.fy=u.y)}else r={x1:o.x,y1:o.y,x2:c.x,y2:c.y};r.gradientUnits="userSpaceOnUse",n=ut.create((s?"radial":"linear")+"Gradient",r,t);for(var h=i._stops,d=0,f=h.length;d<f;d++){var p=h[d],m=p._color,g=m.getAlpha(),y=p._offset;r={offset:null==y?d/(f-1):y},m&&(r["stop-color"]=m.toCSS(!0)),g<1&&(r["stop-opacity"]=g),n.appendChild(ut.create("stop",r,t))}l(e,n,"color")}return"url(#"+n.id+")"}(h):h.toCSS(!0):"array"===c?h.join(","):"lookup"===c?n.toSVG[h]:h}}),o.length&&(i.style=o.join(";")),1===i.opacity&&delete i.opacity,e._visible||(i.visibility="hidden"),ut.set(n,i,t)}(e,o,r)}function d(e){return e||(e={}),t=new m(e.precision),e}C.inject({exportSVG:function(t){return c(h(this,t=d(t),!0),t)}}),T.inject({exportSVG:function(n){n=d(n);var r=this._children,i=this.getView(),s=u.pick(n.bounds,"view"),o=n.matrix||"view"===s&&i._matrix,a=o&&E.read([o]),l="view"===s?new x([0,0],i.getViewSize()):"content"===s?C._getBounds(r,a,{stroke:!0}).rect:x.read([s],0,{readNull:!0}),f={version:"1.1",xmlns:ut.svg,"xmlns:xlink":ut.xlink};l&&(f.width=l.width,f.height=l.height,(l.x||0===l.x||l.y||0===l.y)&&(f.viewBox=t.rectangle(l)));var p=ut.create("svg",f,t),m=p;a&&!a.isIdentity()&&(m=p.appendChild(ut.create("g",e(a),t)));for(var g=0,y=r.length;g<y;g++)m.appendChild(h(r[g],n,!0));return c(p,n)}})},new function(){var t,e={};function n(e,n,r,i,s,o){var a=ut.get(e,n)||o,l=null==a?i?null:r?"":0:r?a:parseFloat(a);return/%\s*$/.test(a)?l/100*(s?1:t[/x|^width/.test(n)?"width":"height"]):l}function r(t,e,r,i,s,o,a){return e=n(t,e||"x",!1,i,s,o),r=n(t,r||"y",!1,i,s,a),!i||null!=e&&null!=r?new _(e,r):null}function i(t,e,r,i,s){return e=n(t,e||"width",!1,i,s),r=n(t,r||"height",!1,i,s),!i||null!=e&&null!=r?new b(e,r):null}function s(t,e,n){return"none"===t?null:"number"===e?parseFloat(t):"array"===e?t?t.split(/[\s,]+/g).map(parseFloat):[]:"color"===e?S(t)||t:"lookup"===e?n[t]:t}function h(t,e,n,r){var i=t.childNodes,s="clippath"===e,o="defs"===e,a=new M,l=a._project,c=l._currentStyle,u=[];if(s||o||(a=w(a,t,r),l._currentStyle=a._style.clone()),r)for(var h=t.querySelectorAll("defs"),d=0,f=h.length;d<f;d++)A(h[d],n,!1);for(d=0,f=i.length;d<f;d++){var p,m=i[d];1!==m.nodeType||/^defs$/i.test(m.nodeName)||!(p=A(m,n,!1))||p instanceof L||u.push(p)}return a.addChildren(u),s&&(a=w(a.reduce(),t,r)),l._currentStyle=c,(s||o)&&(a.remove(),a=null),a}function d(t,e){for(var n=t.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),r=[],i=0,s=n.length;i<s;i+=2)r.push(new _(parseFloat(n[i]),parseFloat(n[i+1])));var o=new U(r);return"polygon"===e&&o.closePath(),o}function f(t,i){var s,o=(n(t,"href",!0)||"").substring(1),a="radialgradient"===i;if(o)(s=e[o].getGradient())._radial^a&&((s=s.clone())._radial=a);else{for(var l=t.childNodes,c=[],u=0,h=l.length;u<h;u++){var d=l[u];1===d.nodeType&&c.push(w(new Z,d))}s=new q(c,a)}var f,p,m,g="userSpaceOnUse"!==n(t,"gradientUnits",!0);return a?(p=(f=r(t,"cx","cy",!1,g,"50%","50%")).add(n(t,"r",!1,!1,g,"50%"),0),m=r(t,"fx","fy",!0,g)):(f=r(t,"x1","y1",!1,g,"0%","0%"),p=r(t,"x2","y2",!1,g,"100%","0%")),w(new W(s,f,p,m),t)._scaleToBounds=g,null}var p={"#document":function(t,e,n,r){for(var i=t.childNodes,s=0,o=i.length;s<o;s++){var a=i[s];if(1===a.nodeType)return A(a,n,r)}},g:h,svg:h,clippath:h,polygon:d,polyline:d,path:function(t){return j.create(t.getAttribute("d"))},lineargradient:f,radialgradient:f,image:function(t){var e=new D(n(t,"href",!0));return e.on("load",function(){var e=i(t);this.setSize(e);var n=r(t).add(e.divide(2));this._matrix.append((new E).translate(n))}),e},symbol:function(t,e,n,r){return new L(h(t,e,n,r),!0)},defs:h,use:function(t){var i=(n(t,"href",!0)||"").substring(1),s=e[i],o=r(t);return s?s instanceof L?s.place(o):s.clone().translate(o):null},circle:function(t){return new P.Circle(r(t,"cx","cy"),n(t,"r"))},ellipse:function(t){return new P.Ellipse({center:r(t,"cx","cy"),radius:i(t,"rx","ry")})},rect:function(t){return new P.Rectangle(new x(r(t),i(t)),i(t,"rx","ry"))},line:function(t){return new U.Line(r(t,"x1","y1"),r(t,"x2","y2"))},text:function(t){var e=new G(r(t).add(r(t,"dx","dy")));return e.setContent(t.textContent.trim()||""),e},switch:h};function m(t,e,n,r){if(t.transform){for(var i=(r.getAttribute(n)||"").split(/\)\s*/g),s=new E,o=0,a=i.length;o<a;o++){var l=i[o];if(!l)break;for(var c=l.split(/\(\s*/),u=c[0],h=c[1].split(/[\s,]+/g),d=0,f=h.length;d<f;d++)h[d]=parseFloat(h[d]);switch(u){case"matrix":s.append(new E(h[0],h[1],h[2],h[3],h[4],h[5]));break;case"rotate":s.rotate(h[0],h[1]||0,h[2]||0);break;case"translate":s.translate(h[0],h[1]||0);break;case"scale":s.scale(h);break;case"skewX":s.skew(h[0],0);break;case"skewY":s.skew(0,h[0])}}t.transform(s)}}function g(t,e,n){var r="fill-opacity"===n?"getFillColor":"getStrokeColor",i=t[r]&&t[r]();i&&i.setAlpha(parseFloat(e))}var y=u.set(u.each(ht,function(t){this[t.attribute]=function(e,n){if(e[t.set]&&(e[t.set](s(n,t.type,t.fromSVG)),"color"===t.type)){var r=e[t.get]();if(r&&r._scaleToBounds){var i=e.getBounds();r.transform((new E).translate(i.getPoint()).scale(i.getSize()))}}}},{}),{id:function(t,n){e[n]=t,t.setName&&t.setName(n)},"clip-path":function(t,e){var n=S(e);if(n){if((n=n.clone()).setClipMask(!0),!(t instanceof M))return new M(n,t);t.insertChild(0,n)}},gradientTransform:m,transform:m,"fill-opacity":g,"stroke-opacity":g,visibility:function(t,e){t.setVisible&&t.setVisible("visible"===e)},display:function(t,e){t.setVisible&&t.setVisible(null!==e)},"stop-color":function(t,e){t.setColor&&t.setColor(e)},"stop-opacity":function(t,e){t._color&&t._color.setAlpha(parseFloat(e))},offset:function(t,e){if(t.setOffset){var n=e.match(/(.*)%$/);t.setOffset(n?n[1]/100:parseFloat(e))}},viewBox:function(t,e,n,r,o){var a,l=new x(s(e,"array")),c=i(r,null,null,!0);if(t instanceof M){var u=c?c.divide(l.getSize()):1,h=(new E).scale(u).translate(l.getPoint().negate());a=t}else t instanceof L&&(c&&l.setSize(c),a=t._item);if(a){if("visible"!==v(r,"overflow",o)){var d=new P.Rectangle(l);d.setClipMask(!0),a.addChild(d)}h&&a.transform(h)}}});function v(t,e,n){var r=t.attributes[e],i=r&&r.value;if(!i&&t.style){var s=u.camelize(e);(i=t.style[s])||n.node[s]===n.parent[s]||(i=n.node[s])}return i?"none"===i?null:i:a}function w(t,e,n){var r=e.parentNode,i={node:J.getStyles(e)||{},parent:!n&&!/^defs$/i.test(r.tagName)&&J.getStyles(r)||{}};return u.each(y,function(n,r){var s=v(e,r,i);t=s!==a&&n(t,s,r,e,i)||t}),t}function S(t){var n=t&&t.match(/\((?:["'#]*)([^"')]+)/),r=n&&n[1],i=r&&e[l?r.replace(l.location.href.split("#")[0]+"#",""):r];return i&&i._scaleToBounds&&((i=i.clone())._scaleToBounds=!0),i}function A(n,r,s){var o,a,l,h=n.nodeName.toLowerCase(),d="#document"!==h,f=c.body;s&&d&&(t=dt.getView().getSize(),t=i(n,null,null,!0)||t,o=ut.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),a=n.parentNode,l=n.nextSibling,o.appendChild(n),f.appendChild(o));var m=dt.settings,g=m.applyMatrix,y=m.insertItems;m.applyMatrix=!1,m.insertItems=!1;var _=p[h],v=_&&_(n,h,r,s)||null;if(m.insertItems=y,m.applyMatrix=g,v){!d||v instanceof M||(v=w(v,n,s));var b=r.onImport,x=d&&n.getAttribute("data-paper-data");b&&(v=b(n,v,r)||v),r.expandShapes&&v instanceof P&&(v.remove(),v=v.toPath()),x&&(v._data=JSON.parse(x))}return o&&(f.removeChild(o),a&&(l?a.insertBefore(n,l):a.appendChild(n))),s&&(e={},v&&u.pick(r.applyMatrix,g)&&v.matrix.apply(!0,!0)),v}function O(t,e,n){if(!t)return null;e="function"==typeof e?{onLoad:e}:e||{};var r=dt,i=null;function s(s){try{var c="object"==typeof s?s:(new o.DOMParser).parseFromString(s.trim(),"image/svg+xml");if(!c.nodeName)throw c=null,new Error("Unsupported SVG source: "+t);dt=r,i=A(c,e,!0),e&&!1===e.insert||n._insertItem(a,i);var u=e.onLoad;u&&u(i,s)}catch(h){l(h)}}function l(t,n){var r=e.onError;if(!r)throw new Error(t);r(t,n)}if("string"!=typeof t||/^[\s\S]*</.test(t)){if("undefined"!=typeof File&&t instanceof File){var u=new FileReader;return u.onload=function(){s(u.result)},u.onerror=function(){l(u.error)},u.readAsText(t)}s(t)}else{var h=c.getElementById(t);h?s(h):at({url:t,async:!0,onLoad:s,onError:l})}return i}C.inject({importSVG:function(t,e){return O(t,e,this)}}),T.inject({importSVG:function(t,e){return this.activate(),O(t,e,this)}})},u.exports.PaperScript=(function(){var t,e,h,f=this,p=f.acorn;if(!p)try{p=n(8805)}catch(C){}function m(t,e){return(f.acorn||p).parse(t,e)}p||(p=t=e={},h=function(t){"use strict";var e,n,r,i;t.version="0.5.0",t.parse=function(t,i){return n=String(t),r=n.length,o(i),qt(),function(t){y=_=a,e.locations&&(v=new Wt),b=x=null,w=[],Xt();var n=t||ue(),r=!0;for(t||(n.body=[]);d!==D;){var i=xe();n.body.push(i),r&&fe(i)&&ae(!0),r=!1}return de(n,"Program")}(e.program)};var s=t.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function o(t){for(var n in e=t||{},s)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=s[n]);i=e.sourceFile||null}var a,l,c,u,h,d,f,p,m,g,y,_,v,b,w,x,S=t.getLineInfo=function(t,e){for(var n=1,r=0;;){$t.lastIndex=r;var i=$t.exec(t);if(!(i&&i.index<e))break;++n,r=i.index+i[0].length}return{line:n,column:e-r}};function E(t,e){var r=S(n,t),i=new SyntaxError(e+=" ("+r.line+":"+r.column+")");throw i.pos=t,i.loc=r,i.raisedAt=a,i}t.tokenize=function(t,i){n=String(t),r=n.length,o(i),qt();var s={};function y(t){return _=c,Xt(t),s.start=l,s.end=c,s.startLoc=u,s.endLoc=h,s.type=d,s.value=f,s}return y.jumpTo=function(t,r){var i;if(a=t,e.locations)for(m=1,g=$t.lastIndex=0;(i=$t.exec(n))&&i.index<t;)++m,g=i.index+i[0].length;p=r,Kt()},y};var A=[],T={type:"num"},M={type:"regexp"},O={type:"string"},P={type:"name"},D={type:"eof"},R={keyword:"break"},L={keyword:"case",beforeExpr:!0},I={keyword:"catch"},N={keyword:"continue"},k={keyword:"debugger"},F={keyword:"default"},B={keyword:"do",isLoop:!0},j={keyword:"else",beforeExpr:!0},U={keyword:"finally"},V={keyword:"for",isLoop:!0},z={keyword:"function"},$={keyword:"if"},H={keyword:"return",beforeExpr:!0},G={keyword:"switch"},W={keyword:"throw",beforeExpr:!0},q={keyword:"try"},Z={keyword:"var"},Y={keyword:"while",isLoop:!0},J={keyword:"with"},K={keyword:"new",beforeExpr:!0},X={keyword:"this"},Q={keyword:"null",atomValue:null},tt={keyword:"true",atomValue:!0},et={keyword:"false",atomValue:!1},nt={keyword:"in",binop:7,beforeExpr:!0},rt={break:R,case:L,catch:I,continue:N,debugger:k,default:F,do:B,else:j,finally:U,for:V,function:z,if:$,return:H,switch:G,throw:W,try:q,var:Z,while:Y,with:J,null:Q,true:tt,false:et,new:K,in:nt,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:X,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},it={type:"[",beforeExpr:!0},st={type:"]"},ot={type:"{",beforeExpr:!0},at={type:"}"},lt={type:"(",beforeExpr:!0},ct={type:")"},ut={type:",",beforeExpr:!0},ht={type:";",beforeExpr:!0},dt={type:":",beforeExpr:!0},ft={type:"."},pt={type:"?",beforeExpr:!0},mt={binop:10,beforeExpr:!0},gt={isAssign:!0,beforeExpr:!0},yt={isAssign:!0,beforeExpr:!0},_t={postfix:!0,prefix:!0,isUpdate:!0},vt={prefix:!0,beforeExpr:!0},bt={binop:1,beforeExpr:!0},wt={binop:2,beforeExpr:!0},xt={binop:3,beforeExpr:!0},St={binop:4,beforeExpr:!0},Et={binop:5,beforeExpr:!0},At={binop:6,beforeExpr:!0},Tt={binop:7,beforeExpr:!0},Ct={binop:8,beforeExpr:!0},Mt={binop:9,prefix:!0,beforeExpr:!0},Ot={binop:10,beforeExpr:!0};for(var Pt in t.tokTypes={bracketL:it,bracketR:st,braceL:ot,braceR:at,parenL:lt,parenR:ct,comma:ut,semi:ht,colon:dt,dot:ft,question:pt,slash:mt,eq:gt,name:P,eof:D,num:T,regexp:M,string:O},rt)t.tokTypes["_"+Pt]=rt[Pt];function Dt(t){t=t.split(" ");var e="",n=[];t:for(var r=0;r<t.length;++r){for(var i=0;i<n.length;++i)if(n[i][0].length==t[r].length){n[i].push(t[r]);continue t}n.push([t[r]])}function s(t){if(1==t.length)return e+="return str === "+JSON.stringify(t[0])+";";e+="switch(str){";for(var n=0;n<t.length;++n)e+="case "+JSON.stringify(t[n])+":";e+="return true}return false;"}if(n.length>3){for(n.sort(function(t,e){return e.length-t.length}),e+="switch(str.length){",r=0;r<n.length;++r){var o=n[r];e+="case "+o[0].length+":",s(o)}e+="}"}else s(t);return new Function("str",e)}var Rt,Lt=Dt("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),It=Dt("class enum extends super const export import"),Nt=Dt("implements interface let package private protected public static yield"),kt=Dt("eval arguments"),Ft=Dt("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Bt=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,jt="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",Ut=new RegExp("["+jt+"]"),Vt=new RegExp("["+jt+"\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u0620-\u0649\u0672-\u06d3\u06e7-\u06e8\u06fb-\u06fc\u0730-\u074a\u0800-\u0814\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0840-\u0857\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962-\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09d7\u09df-\u09e0\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5f-\u0b60\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2-\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d46-\u0d48\u0d57\u0d62-\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e34-\u0e3a\u0e40-\u0e45\u0e50-\u0e59\u0eb4-\u0eb9\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f41-\u0f47\u0f71-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1029\u1040-\u1049\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u170e-\u1710\u1720-\u1730\u1740-\u1750\u1772\u1773\u1780-\u17b2\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1920-\u192b\u1930-\u193b\u1951-\u196d\u19b0-\u19c0\u19c8-\u19c9\u19d0-\u19d9\u1a00-\u1a15\u1a20-\u1a53\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b46-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1bb0-\u1bb9\u1be6-\u1bf3\u1c00-\u1c22\u1c40-\u1c49\u1c5b-\u1c7d\u1cd0-\u1cd2\u1d00-\u1dbe\u1e01-\u1f15\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2d81-\u2d96\u2de0-\u2dff\u3021-\u3028\u3099\u309a\ua640-\ua66d\ua674-\ua67d\ua69f\ua6f0-\ua6f1\ua7f8-\ua800\ua806\ua80b\ua823-\ua827\ua880-\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8f3-\ua8f7\ua900-\ua909\ua926-\ua92d\ua930-\ua945\ua980-\ua983\ua9b3-\ua9c0\uaa00-\uaa27\uaa40-\uaa41\uaa4c-\uaa4d\uaa50-\uaa59\uaa7b\uaae0-\uaae9\uaaf2-\uaaf3\uabc0-\uabe1\uabec\uabed\uabf0-\uabf9\ufb20-\ufb28\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]"),zt=/[\n\r\u2028\u2029]/,$t=/\r\n|[\n\r\u2028\u2029]/g,Ht=t.isIdentifierStart=function(t){return t<65?36===t:t<91||(t<97?95===t:t<123||t>=170&&Ut.test(String.fromCharCode(t)))},Gt=t.isIdentifierChar=function(t){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||t>=170&&Vt.test(String.fromCharCode(t))))};function Wt(){this.line=m,this.column=a-g}function qt(){m=1,a=g=0,p=!0,Kt()}function Zt(t,n){c=a,e.locations&&(h=new Wt),d=t,Kt(),f=n,p=t.beforeExpr}function Yt(){var t,r=e.onComment&&e.locations&&new Wt,i=a,s=n.indexOf("*/",a+=2);if(-1===s&&E(a-2,"Unterminated comment"),a=s+2,e.locations)for($t.lastIndex=i;(t=$t.exec(n))&&t.index<a;)++m,g=t.index+t[0].length;e.onComment&&e.onComment(!0,n.slice(i+2,s),i,a,r,e.locations&&new Wt)}function Jt(){for(var t=a,i=e.onComment&&e.locations&&new Wt,s=n.charCodeAt(a+=2);a<r&&10!==s&&13!==s&&8232!==s&&8233!==s;)++a,s=n.charCodeAt(a);e.onComment&&e.onComment(!1,n.slice(t+2,a),t,a,i,e.locations&&new Wt)}function Kt(){for(;a<r;){var t=n.charCodeAt(a);if(32===t)++a;else if(13===t)++a,10===(i=n.charCodeAt(a))&&++a,e.locations&&(++m,g=a);else if(10===t||8232===t||8233===t)++a,e.locations&&(++m,g=a);else if(t>8&&t<14)++a;else if(47===t){var i;if(42===(i=n.charCodeAt(a+1)))Yt();else{if(47!==i)break;Jt()}}else if(160===t)++a;else{if(!(t>=5760&&Bt.test(String.fromCharCode(t))))break;++a}}}function Xt(t){if(t?a=l+1:l=a,e.locations&&(u=new Wt),t)return te();if(a>=r)return Zt(D);var i=n.charCodeAt(a);if(Ht(i)||92===i)return se();var s=function(t){switch(t){case 46:return function(){var t=n.charCodeAt(a+1);return t>=48&&t<=57?ne(!0):(++a,Zt(ft))}();case 40:return++a,Zt(lt);case 41:return++a,Zt(ct);case 59:return++a,Zt(ht);case 44:return++a,Zt(ut);case 91:return++a,Zt(it);case 93:return++a,Zt(st);case 123:return++a,Zt(ot);case 125:return++a,Zt(at);case 58:return++a,Zt(dt);case 63:return++a,Zt(pt);case 48:var i=n.charCodeAt(a+1);if(120===i||88===i)return function(){a+=2;var t=ee(16);return null==t&&E(l+2,"Expected hexadecimal number"),Ht(n.charCodeAt(a))&&E(a,"Identifier directly after number"),Zt(T,t)}();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ne(!1);case 34:case 39:return function(t){a++;for(var i="";;){a>=r&&E(l,"Unterminated string constant");var s=n.charCodeAt(a);if(s===t)return++a,Zt(O,i);if(92===s){s=n.charCodeAt(++a);var o=/^[0-7]+/.exec(n.slice(a,a+3));for(o&&(o=o[0]);o&&parseInt(o,8)>255;)o=o.slice(0,-1);if("0"===o&&(o=null),++a,o)x&&E(a-2,"Octal literal in strict mode"),i+=String.fromCharCode(parseInt(o,8)),a+=o.length-1;else switch(s){case 110:i+="\n";break;case 114:i+="\r";break;case 120:i+=String.fromCharCode(re(2));break;case 117:i+=String.fromCharCode(re(4));break;case 85:i+=String.fromCharCode(re(8));break;case 116:i+="\t";break;case 98:i+="\b";break;case 118:i+="\v";break;case 102:i+="\f";break;case 48:i+="\0";break;case 13:10===n.charCodeAt(a)&&++a;case 10:e.locations&&(g=a,++m);break;default:i+=String.fromCharCode(s)}}else 13!==s&&10!==s&&8232!==s&&8233!==s||E(l,"Unterminated string constant"),i+=String.fromCharCode(s),++a}}(t);case 47:return function(){var t=n.charCodeAt(a+1);return p?(++a,te()):61===t?Qt(yt,2):Qt(mt,1)}();case 37:case 42:return 61===n.charCodeAt(a+1)?Qt(yt,2):Qt(Ot,1);case 124:case 38:return function(t){var e=n.charCodeAt(a+1);return e===t?Qt(124===t?bt:wt,2):61===e?Qt(yt,2):Qt(124===t?xt:Et,1)}(t);case 94:return 61===n.charCodeAt(a+1)?Qt(yt,2):Qt(St,1);case 43:case 45:return function(t){var e=n.charCodeAt(a+1);return e===t?45==e&&62==n.charCodeAt(a+2)&&zt.test(n.slice(_,a))?(a+=3,Jt(),Kt(),Xt()):Qt(_t,2):61===e?Qt(yt,2):Qt(Mt,1)}(t);case 60:case 62:return function(t){var e=n.charCodeAt(a+1),r=1;return e===t?(r=62===t&&62===n.charCodeAt(a+2)?3:2,61===n.charCodeAt(a+r)?Qt(yt,r+1):Qt(Ct,r)):33==e&&60==t&&45==n.charCodeAt(a+2)&&45==n.charCodeAt(a+3)?(a+=4,Jt(),Kt(),Xt()):(61===e&&(r=61===n.charCodeAt(a+2)?3:2),Qt(Tt,r))}(t);case 61:case 33:return function(t){return 61===n.charCodeAt(a+1)?Qt(At,61===n.charCodeAt(a+2)?3:2):Qt(61===t?gt:vt,1)}(t);case 126:return Qt(vt,1)}return!1}(i);if(!1===s){var o=String.fromCharCode(i);if("\\"===o||Ut.test(o))return se();E(a,"Unexpected character '"+o+"'")}return s}function Qt(t,e){var r=n.slice(a,a+e);a+=e,Zt(t,r)}function te(){for(var t,e,i=a;;){a>=r&&E(i,"Unterminated regular expression");var s=n.charAt(a);if(zt.test(s)&&E(i,"Unterminated regular expression"),t)t=!1;else{if("["===s)e=!0;else if("]"===s&&e)e=!1;else if("/"===s&&!e)break;t="\\"===s}++a}var o=n.slice(i,a);++a;var l=ie();l&&!/^[gmsiy]*$/.test(l)&&E(i,"Invalid regexp flag");try{var c=new RegExp(o,l)}catch(C){C instanceof SyntaxError&&E(i,C.message),E(C)}return Zt(M,c)}function ee(t,e){for(var r=a,i=0,s=0,o=null==e?1/0:e;s<o;++s){var l,c=n.charCodeAt(a);if((l=c>=97?c-97+10:c>=65?c-65+10:c>=48&&c<=57?c-48:1/0)>=t)break;++a,i=i*t+l}return a===r||null!=e&&a-r!==e?null:i}function ne(t){var e=a,r=!1,i=48===n.charCodeAt(a);t||null!==ee(10)||E(e,"Invalid number"),46===n.charCodeAt(a)&&(++a,ee(10),r=!0);var s=n.charCodeAt(a);69!==s&&101!==s||(43!==(s=n.charCodeAt(++a))&&45!==s||++a,null===ee(10)&&E(e,"Invalid number"),r=!0),Ht(n.charCodeAt(a))&&E(a,"Identifier directly after number");var o,l=n.slice(e,a);return r?o=parseFloat(l):i&&1!==l.length?/[89]/.test(l)||x?E(e,"Invalid number"):o=parseInt(l,8):o=parseInt(l,10),Zt(T,o)}function re(t){var e=ee(16,t);return null===e&&E(l,"Bad character escape sequence"),e}function ie(){Rt=!1;for(var t,e=!0,r=a;;){var i=n.charCodeAt(a);if(Gt(i))Rt&&(t+=n.charAt(a)),++a;else{if(92!==i)break;Rt||(t=n.slice(r,a)),Rt=!0,117!=n.charCodeAt(++a)&&E(a,"Expecting Unicode escape sequence \\uXXXX"),++a;var s=re(4),o=String.fromCharCode(s);o||E(a-1,"Invalid Unicode escape"),(e?Ht(s):Gt(s))||E(a-4,"Invalid Unicode escape"),t+=o}e=!1}return Rt?t:n.slice(r,a)}function se(){var t=ie(),e=P;return!Rt&&Ft(t)&&(e=rt[t]),Zt(e,t)}function oe(){y=l,_=c,v=h,Xt()}function ae(t){if(x=t,a=l,e.locations)for(;a<g;)g=n.lastIndexOf("\n",g-2)+1,--m;Kt(),Xt()}function le(){this.type=null,this.start=l,this.end=null}function ce(){this.start=u,this.end=null,null!==i&&(this.source=i)}function ue(){var t=new le;return e.locations&&(t.loc=new ce),e.directSourceFile&&(t.sourceFile=e.directSourceFile),e.ranges&&(t.range=[l,0]),t}function he(t){var n=new le;return n.start=t.start,e.locations&&(n.loc=new ce,n.loc.start=t.loc.start),e.ranges&&(n.range=[t.range[0],0]),n}function de(t,n){return t.type=n,t.end=_,e.locations&&(t.loc.end=v),e.ranges&&(t.range[1]=_),t}function fe(t){return e.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value}function pe(t){if(d===t)return oe(),!0}function me(){return!e.strictSemicolons&&(d===D||d===at||zt.test(n.slice(_,l)))}function ge(){pe(ht)||me()||_e()}function ye(t){d===t?oe():_e()}function _e(){E(l,"Unexpected token")}function ve(t){"Identifier"!==t.type&&"MemberExpression"!==t.type&&E(t.start,"Assigning to rvalue"),x&&"Identifier"===t.type&&kt(t.name)&&E(t.start,"Assigning to "+t.name+" in strict mode")}var be={kind:"loop"},we={kind:"switch"};function xe(){(d===mt||d===yt&&"/="==f)&&Xt(!0);var t=d,r=ue();switch(t){case R:case N:oe();var i=t===R;pe(ht)||me()?r.label=null:d!==P?_e():(r.label=Fe(),ge());for(var s=0;s<w.length;++s){var o=w[s];if(null==r.label||o.name===r.label.name){if(null!=o.kind&&(i||"loop"===o.kind))break;if(r.label&&i)break}}return s===w.length&&E(r.start,"Unsyntactic "+t.keyword),de(r,i?"BreakStatement":"ContinueStatement");case k:return oe(),ge(),de(r,"DebuggerStatement");case B:return oe(),w.push(be),r.body=xe(),w.pop(),ye(Y),r.test=Se(),ge(),de(r,"DoWhileStatement");case V:if(oe(),w.push(be),ye(lt),d===ht)return Ae(r,null);if(d===Z){var a=ue();return oe(),Ce(a,!0),de(a,"VariableDeclaration"),1===a.declarations.length&&pe(nt)?Te(r,a):Ae(r,a)}return a=Me(!1,!0),pe(nt)?(ve(a),Te(r,a)):Ae(r,a);case z:return oe(),Ne(r,!0);case $:return oe(),r.test=Se(),r.consequent=xe(),r.alternate=pe(j)?xe():null,de(r,"IfStatement");case H:return b||e.allowReturnOutsideFunction||E(l,"'return' outside of function"),oe(),pe(ht)||me()?r.argument=null:(r.argument=Me(),ge()),de(r,"ReturnStatement");case G:oe(),r.discriminant=Se(),r.cases=[],ye(ot),w.push(we);for(var c,u;d!=at;)if(d===L||d===F){var h=d===L;c&&de(c,"SwitchCase"),r.cases.push(c=ue()),c.consequent=[],oe(),h?c.test=Me():(u&&E(y,"Multiple default clauses"),u=!0,c.test=null),ye(dt)}else c||_e(),c.consequent.push(xe());return c&&de(c,"SwitchCase"),oe(),w.pop(),de(r,"SwitchStatement");case W:return oe(),zt.test(n.slice(_,l))&&E(_,"Illegal newline after throw"),r.argument=Me(),ge(),de(r,"ThrowStatement");case q:if(oe(),r.block=Ee(),r.handler=null,d===I){var p=ue();oe(),ye(lt),p.param=Fe(),x&&kt(p.param.name)&&E(p.param.start,"Binding "+p.param.name+" in strict mode"),ye(ct),p.guard=null,p.body=Ee(),r.handler=de(p,"CatchClause")}return r.guardedHandlers=A,r.finalizer=pe(U)?Ee():null,r.handler||r.finalizer||E(r.start,"Missing catch or finally clause"),de(r,"TryStatement");case Z:return oe(),Ce(r),ge(),de(r,"VariableDeclaration");case Y:return oe(),r.test=Se(),w.push(be),r.body=xe(),w.pop(),de(r,"WhileStatement");case J:return x&&E(l,"'with' in strict mode"),oe(),r.object=Se(),r.body=xe(),de(r,"WithStatement");case ot:return Ee();case ht:return oe(),de(r,"EmptyStatement");default:var m=f,g=Me();if(t===P&&"Identifier"===g.type&&pe(dt)){for(s=0;s<w.length;++s)w[s].name===m&&E(g.start,"Label '"+m+"' is already declared");return w.push({name:m,kind:d.isLoop?"loop":d===G?"switch":null}),r.body=xe(),w.pop(),r.label=g,de(r,"LabeledStatement")}return r.expression=g,ge(),de(r,"ExpressionStatement")}}function Se(){ye(lt);var t=Me();return ye(ct),t}function Ee(t){var e,n=ue(),r=!0,i=!1;for(n.body=[],ye(ot);!pe(at);){var s=xe();n.body.push(s),r&&t&&fe(s)&&(e=i,ae(i=!0)),r=!1}return i&&!e&&ae(!1),de(n,"BlockStatement")}function Ae(t,e){return t.init=e,ye(ht),t.test=d===ht?null:Me(),ye(ht),t.update=d===ct?null:Me(),ye(ct),t.body=xe(),w.pop(),de(t,"ForStatement")}function Te(t,e){return t.left=e,t.right=Me(),ye(ct),t.body=xe(),w.pop(),de(t,"ForInStatement")}function Ce(t,e){for(t.declarations=[],t.kind="var";;){var n=ue();if(n.id=Fe(),x&&kt(n.id.name)&&E(n.id.start,"Binding "+n.id.name+" in strict mode"),n.init=pe(gt)?Me(!0,e):null,t.declarations.push(de(n,"VariableDeclarator")),!pe(ut))break}return t}function Me(t,e){var n=Oe(e);if(!t&&d===ut){var r=he(n);for(r.expressions=[n];pe(ut);)r.expressions.push(Oe(e));return de(r,"SequenceExpression")}return n}function Oe(t){var e=function(t){var e=function(t){return Pe(De(),-1,t)}(t);if(pe(pt)){var n=he(e);return n.test=e,n.consequent=Me(!0),ye(dt),n.alternate=Me(!0,t),de(n,"ConditionalExpression")}return e}(t);if(d.isAssign){var n=he(e);return n.operator=f,n.left=e,oe(),n.right=Oe(t),ve(e),de(n,"AssignmentExpression")}return e}function Pe(t,e,n){var r=d.binop;if(null!=r&&(!n||d!==nt)&&r>e){var i=he(t);i.left=t,i.operator=f;var s=d;return oe(),i.right=Pe(De(),r,n),Pe(de(i,s===bt||s===wt?"LogicalExpression":"BinaryExpression"),e,n)}return t}function De(){if(d.prefix){var t=ue(),e=d.isUpdate;return t.operator=f,t.prefix=!0,p=!0,oe(),t.argument=De(),e?ve(t.argument):x&&"delete"===t.operator&&"Identifier"===t.argument.type&&E(t.start,"Deleting local variable in strict mode"),de(t,e?"UpdateExpression":"UnaryExpression")}for(var n=Re(Le());d.postfix&&!me();)(t=he(n)).operator=f,t.prefix=!1,t.argument=n,ve(n),oe(),n=de(t,"UpdateExpression");return n}function Re(t,e){var n;return pe(ft)?((n=he(t)).object=t,n.property=Fe(!0),n.computed=!1,Re(de(n,"MemberExpression"),e)):pe(it)?((n=he(t)).object=t,n.property=Me(),n.computed=!0,ye(st),Re(de(n,"MemberExpression"),e)):!e&&pe(lt)?((n=he(t)).callee=t,n.arguments=ke(ct,!1),Re(de(n,"CallExpression"),e)):t}function Le(){switch(d){case X:var t=ue();return oe(),de(t,"ThisExpression");case P:return Fe();case T:case O:case M:return(t=ue()).value=f,t.raw=n.slice(l,c),oe(),de(t,"Literal");case Q:case tt:case et:return(t=ue()).value=d.atomValue,t.raw=d.keyword,oe(),de(t,"Literal");case lt:var r=u,i=l;oe();var s=Me();return s.start=i,s.end=c,e.locations&&(s.loc.start=r,s.loc.end=h),e.ranges&&(s.range=[i,c]),ye(ct),s;case it:return t=ue(),oe(),t.elements=ke(st,!0,!0),de(t,"ArrayExpression");case ot:return function(){var t=ue(),n=!0,r=!1;for(t.properties=[],oe();!pe(at);){if(n)n=!1;else if(ye(ut),e.allowTrailingCommas&&pe(at))break;var i,s={key:Ie()},o=!1;if(pe(dt)?(s.value=Me(!0),i=s.kind="init"):e.ecmaVersion>=5&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(o=r=!0,i=s.kind=s.key.name,s.key=Ie(),d!==lt&&_e(),s.value=Ne(ue(),!1)):_e(),"Identifier"===s.key.type&&(x||r))for(var a=0;a<t.properties.length;++a){var l=t.properties[a];if(l.key.name===s.key.name){var c=i==l.kind||o&&"init"===l.kind||"init"===i&&("get"===l.kind||"set"===l.kind);c&&!x&&"init"===i&&"init"===l.kind&&(c=!1),c&&E(s.key.start,"Redefinition of property")}}t.properties.push(s)}return de(t,"ObjectExpression")}();case z:return t=ue(),oe(),Ne(t,!1);case K:return function(){var t=ue();return oe(),t.callee=Re(Le(),!0),t.arguments=pe(lt)?ke(ct,!1):A,de(t,"NewExpression")}();default:_e()}}function Ie(){return d===T||d===O?Le():Fe(!0)}function Ne(t,e){d===P?t.id=Fe():e?_e():t.id=null,t.params=[];var n=!0;for(ye(lt);!pe(ct);)n?n=!1:ye(ut),t.params.push(Fe());var r=b,i=w;if(b=!0,w=[],t.body=Ee(!0),b=r,w=i,x||t.body.body.length&&fe(t.body.body[0]))for(var s=t.id?-1:0;s<t.params.length;++s){var o=s<0?t.id:t.params[s];if((Nt(o.name)||kt(o.name))&&E(o.start,"Defining '"+o.name+"' in strict mode"),s>=0)for(var a=0;a<s;++a)o.name===t.params[a].name&&E(o.start,"Argument name clash in strict mode")}return de(t,e?"FunctionDeclaration":"FunctionExpression")}function ke(t,n,r){for(var i=[],s=!0;!pe(t);){if(s)s=!1;else if(ye(ut),n&&e.allowTrailingCommas&&pe(t))break;i.push(r&&d===ut?null:Me(!0))}return i}function Fe(t){var r=ue();return t&&"everywhere"==e.forbidReserved&&(t=!1),d===P?(!t&&(e.forbidReserved&&(3===e.ecmaVersion?Lt:It)(f)||x&&Nt(f))&&-1==n.slice(l,c).indexOf("\\")&&E(l,"The keyword '"+f+"' is reserved"),r.name=f):t&&d.keyword?r.name=d.keyword:_e(),p=!1,oe(),de(r,"Identifier")}},"object"==typeof t&&"object"==typeof e?h(t):(r=[t],(s="function"==typeof(i=h)?i.apply(t,r):i)===a||(e.exports=s)),p.version||(p=null));var g={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},y={"-":"__negate","+":"__self"},v=u.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(t){this["__"+t]="#"+t},{__self:function(){return this}});function w(t,e,n){var r=g[e];if(t&&t[r]){var i=t[r](n);return"!="===e?!i:i}switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;case"%":return t%n;case"==":return t==n;case"!=":return t!=n}}function x(t,e){var n=y[t];if(e&&e[n])return e[n]();switch(t){case"+":return+e;case"-":return-e}}function S(t,e){if(!t)return"";var n=[];function r(t){for(var e=0,r=n.length;e<r;e++){var i=n[e];if(i[0]>=t)break;t+=i[1]}return t}function i(e){return t.substring(r(e.range[0]),r(e.range[1]))}function s(e,i){for(var s=r(e.range[0]),o=r(e.range[1]),a=0,l=n.length-1;l>=0;l--)if(s>n[l][0]){a=l+1;break}n.splice(a,0,[s,i.length-o+s]),t=t.substring(0,s)+i+t.substring(o)}var a,u=(e=e||{}).url||"",h=e.sourceMaps,d=e.paperFeatures||{},f=e.source||t,p=e.offset||0,_=dt.agent,v=_.versionNumber,b=!1,w=/\r\n|\n|\r/gm;if(h&&(_.chrome&&v>=30||_.webkit&&v>=537.76||_.firefox&&v>=23||_.node)){if(_.node)p-=2;else if(l&&u&&!l.location.href.indexOf(u)){var x=c.getElementsByTagName("html")[0].innerHTML;p=x.substr(0,x.indexOf(t)+1).match(w).length+1}var S=["AA"+function(t){var e="";for(t=(Math.abs(t)<<1)+(t<0?1:0);t||!e;){var n=31&t;(t>>=5)&&(n|=32),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n]}return e}((b=p>0&&!(_.chrome&&v>=36||_.safari&&v>=600||_.firefox&&v>=40||_.node))?0:p)+"A"];S.length=(t.match(w)||[]).length+1+(b?p:0),a={version:3,file:u,names:[],mappings:S.join(";AACA"),sourceRoot:"",sources:[u],sourcesContent:[f]}}return!1===d.operatorOverloading&&!1===d.moduleExports||function e(n,o,a){if(n){for(var l in n)if("range"!==l&&"loc"!==l){var c=n[l];if(Array.isArray(c))for(var u=0,h=c.length;u<h;u++)e(c[u],n,a);else c&&"object"==typeof c&&e(c,n,a)}!1!==a.operatorOverloading&&function(e,n){switch(e.type){case"UnaryExpression":if(e.operator in y&&"Literal"!==e.argument.type){var o=i(e.argument);s(e,'$__("'+e.operator+'", '+o+")")}break;case"BinaryExpression":if(e.operator in g&&"Literal"!==e.left.type){var a=i(e.left),l=i(e.right),c=function(e,n){return t.substring(r(e.range[1]),r(n.range[0]))}(e.left,e.right),u=e.operator;s(e,"__$__("+a+","+c.replace(new RegExp("\\"+u),'"'+u+'"')+", "+l+")")}break;case"UpdateExpression":case"AssignmentExpression":var h=n&&n.type;if(!("ForStatement"===h||"BinaryExpression"===h&&/^[=!<>]/.test(n.operator)||"MemberExpression"===h&&n.computed))if("UpdateExpression"===e.type){var d=(o=i(e.argument))+" = "+(f="__$__("+o+', "'+e.operator[0]+'", 1)');e.prefix?d="("+d+")":"AssignmentExpression"!==h&&"VariableDeclarator"!==h&&"BinaryExpression"!==h||(i(n.left||n.id)===o&&(d=f),d=o+"; "+d),s(e,d)}else if(/^.=$/.test(e.operator)&&"Literal"!==e.left.type){a=i(e.left),l=i(e.right);var f=a+" = __$__("+a+', "'+e.operator[0]+'", '+l+")";s(e,/^\(.*\)$/.test(i(e))?"("+f+")":f)}}}(n,o),!1!==a.moduleExports&&function(t){switch(t.type){case"ExportDefaultDeclaration":s({range:[t.start,t.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var e=t.declaration,n=t.specifiers;if(e){var r=e.declarations;r&&(r.forEach(function(t){s(t,"module.exports."+i(t))}),s({range:[t.start,e.start+e.kind.length]},""))}else if(n){var o=n.map(function(t){var e=i(t);return"module.exports."+e+" = "+e+"; "}).join("");o&&s(t,o)}}}(n)}}(m(t,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,d),a&&(b&&(t=new Array(p+1).join("\n")+t),/^(inline|both)$/.test(h)&&(t+="\n//# sourceMappingURL=data:application/json;base64,"+o.btoa(unescape(encodeURIComponent(JSON.stringify(a))))),t+="\n//# sourceURL="+(u||"paperscript")),{url:u,source:f,code:t,map:a}}function E(t,e,n){dt=e;var r,i=e.getView(),s=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(t)&&!/\bnew\s+Tool\b/.test(t)?new st:null,o=s?s._events:[],a=["onFrame","onResize"].concat(o),l=[],h=[],d="object"==typeof t?t:S(t,n);function f(e,n){for(var r in e)!n&&/^_/.test(r)||!new RegExp("([\\b\\s\\W]|^)"+r.replace(/\$/g,"\\$")+"\\b").test(t)||(l.push(r),h.push(e[r]))}t=d.code,f({__$__:w,$__:x,paper:e,tool:s},!0),f(e),t="var module = { exports: {} }; "+t,(y=u.each(a,function(e){new RegExp("\\s+"+e+"\\b").test(t)&&(l.push(e),this.push("module.exports."+e+" = "+e+";"))},[]).join("\n"))&&(t+="\n"+y),t+="\nreturn module.exports;";var p=dt.agent;if(c&&(p.chrome||p.firefox&&p.versionNumber<40)){var m=c.createElement("script"),g=c.head||c.getElementsByTagName("head")[0];p.firefox&&(t="\n"+t),m.appendChild(c.createTextNode("document.__paperscript__ = function("+l+") {"+t+"\n}")),g.appendChild(m),r=c.__paperscript__,delete c.__paperscript__,g.removeChild(m)}else r=Function(l,t);var y,v=(y=r&&r.apply(e,h))||{};return u.each(o,function(t){var e=v[t];e&&(s[t]=e)}),i&&(v.onResize&&i.setOnResize(v.onResize),i.emit("resize",{size:i.size,delta:new _}),v.onFrame&&i.setOnFrame(v.onFrame),i.requestUpdate()),y}function A(t){if(/^text\/(?:x-|)paperscript$/.test(t.type)&&"true"!==d.getAttribute(t,"ignore")){var e=d.getAttribute(t,"canvas"),n=c.getElementById(e),r=t.src||t.getAttribute("data-src"),i=d.hasAttribute(t,"async"),s="data-paper-scope";if(!n)throw new Error('Unable to find canvas with id "'+e+'"');var o=d.get(n.getAttribute(s))||(new d).setup(n);return n.setAttribute(s,o._id),r?at({url:r,async:i,mimeType:"text/plain",onLoad:function(t){E(t,o,r)}}):E(t.innerHTML,o,t.baseURI),t.setAttribute("data-paper-ignore","true"),o}}function T(){u.each(c&&c.getElementsByTagName("script"),A)}return _.inject(v),b.inject(v),W.inject(v),l&&("complete"===c.readyState?setTimeout(T):K.add(l,{load:T})),{compile:S,execute:E,load:function(t){return t?A(t):T()},parse:m,calculateBinary:w,calculateUnary:x}}).call(this);var dt=new(d.inject(u.exports,{Base:u,Numerical:g,Key:nt,DomEvent:K,DomElement:J,document:c,window:l,Symbol:L,PlacedSymbol:R}));return dt.agent.node&&n(858)(dt),(s="function"==typeof(i=dt)?i.call(e,n,e,t):i)===a||(t.exports=s),dt}).call(this,"object"==typeof self?self:null)},8512:(t,e,n)=>{"use strict";n.d(e,{X:()=>s});var r=n(5959),i=n(3895);class s extends r.xQ{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new i.N;return this._value}next(t){super.next(this._value=t)}}},8318:(t,e,n)=>{"use strict";n.d(e,{y:()=>c});var r=n(6673),i=n(5331),s=n(7498),o=n(6197),a=n(3392),l=n(1484);let c=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:o}=this,a=function(t,e,n){if(t){if(t instanceof r.L)return t;if(t[i.b])return t[i.b]()}return t||e||n?new r.L(t,e,n):new r.L(s.c)}(t,e,n);if(a.add(o?o.call(a,this.source):this.source||l.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),l.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(t){try{return this._subscribe(t)}catch(e){l.v.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:i}=t;if(e||i)return!1;t=n&&n instanceof r.L?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=u(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[o.L](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?a.y:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=u(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function u(t){if(t||(t=l.v.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},7498:(t,e,n)=>{"use strict";n.d(e,{c:()=>s});var r=n(1484),i=n(4294);const s={closed:!0,next(t){},error(t){if(r.v.useDeprecatedSynchronousErrorHandling)throw t;(0,i.z)(t)},complete(){}}},9829:(t,e,n)=>{"use strict";n.d(e,{L:()=>i});var r=n(6673);class i extends r.L{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}},6019:(t,e,n)=>{"use strict";n.d(e,{t:()=>c});var r=n(5959),i=n(8489),s=n(7570),o=n(9971),a=n(3895),l=n(9291);class c extends r.xQ{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new u(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,n=e?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;let c;if(this.closed)throw new a.N;if(this.isStopped||this.hasError?c=s.w.EMPTY:(this.observers.push(t),c=new l.W(this,t)),r&&t.add(t=new o.ht(t,r)),e)for(let s=0;s<i&&!t.closed;s++)t.next(n[s]);else for(let s=0;s<i&&!t.closed;s++)t.next(n[s].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),c}_getNow(){return(this.scheduler||i.c).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length;let s=0;for(;s<i&&!(t-r[s].time<n);)s++;return i>e&&(s=Math.max(s,i-e)),s>0&&r.splice(0,s),r}}class u{constructor(t,e){this.time=t,this.value=e}}},5959:(t,e,n)=>{"use strict";n.d(e,{Yc:()=>c,xQ:()=>u});var r=n(8318),i=n(6673),s=n(7570),o=n(3895),a=n(9291),l=n(5331);class c extends i.L{constructor(t){super(t),this.destination=t}}let u=(()=>{class t extends r.y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[l.b](){return new c(this)}lift(t){const e=new h(this,this);return e.operator=t,e}next(t){if(this.closed)throw new o.N;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new o.N;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new o.N;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new o.N;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new o.N;return this.hasError?(t.error(this.thrownError),s.w.EMPTY):this.isStopped?(t.complete(),s.w.EMPTY):(this.observers.push(t),new a.W(this,t))}asObservable(){const t=new r.y;return t.source=this,t}}return t.create=(t,e)=>new h(t,e),t})();class h extends u{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):s.w.EMPTY}}},9291:(t,e,n)=>{"use strict";n.d(e,{W:()=>i});var r=n(7570);class i extends r.w{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},6673:(t,e,n)=>{"use strict";n.d(e,{L:()=>c});var r=n(5024),i=n(7498),s=n(7570),o=n(5331),a=n(1484),l=n(4294);class c extends s.w{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=i.c;break;case 1:if(!t){this.destination=i.c;break}if("object"==typeof t){t instanceof c?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new u(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new u(this,t,e,n)}}[o.b](){return this}static create(t,e,n){const r=new c(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class u extends c{constructor(t,e,n,s){let o;super(),this._parentSubscriber=t;let a=this;(0,r.m)(e)?o=e:e&&(o=e.next,n=e.error,s=e.complete,e!==i.c&&(a=Object.create(e),(0,r.m)(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=n,this._complete=s}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;a.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=a.v;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,l.z)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,l.z)(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);a.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),a.v.useDeprecatedSynchronousErrorHandling)throw n;(0,l.z)(n)}}__tryOrSetError(t,e,n){if(!a.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return a.v.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):((0,l.z)(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}},7570:(t,e,n)=>{"use strict";n.d(e,{w:()=>a});var r=n(8470),i=n(2056),s=n(5024);const o=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let a=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:a,_unsubscribe:c,_subscriptions:u}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if((0,s.m)(c)){a&&(this._unsubscribe=void 0);try{c.call(this)}catch(h){e=h instanceof o?l(h.errors):[h]}}if((0,r.k)(u)){let t=-1,n=u.length;for(;++t<n;){const n=u[t];if((0,i.K)(n))try{n.unsubscribe()}catch(h){e=e||[],h instanceof o?e=e.concat(l(h.errors)):e.push(h)}}}if(e)throw new o(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof t){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}var e;return t.EMPTY=((e=new t).closed=!0,e),t})();function l(t){return t.reduce((t,e)=>t.concat(e instanceof o?e.errors:e),[])}},1484:(t,e,n)=>{"use strict";n.d(e,{v:()=>i});let r=!1;const i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=t},get useDeprecatedSynchronousErrorHandling(){return r}}},6882:(t,e,n)=>{"use strict";n.d(e,{IY:()=>o,Ds:()=>a,ft:()=>l});var r=n(6673),i=n(8318),s=n(6015);class o extends r.L{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class a extends r.L{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function l(t,e){if(e.closed)return;if(t instanceof i.y)return t.subscribe(e);let n;try{n=(0,s.s)(t)(e)}catch(r){e.error(r)}return n}},2875:(t,e,n)=>{"use strict";n.d(e,{c:()=>a,N:()=>l});var r=n(5959),i=n(8318),s=n(7570),o=n(1564);class a extends i.y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new s.w,t.add(this.source.subscribe(new c(this.getSubject(),this))),t.closed&&(this._connection=null,t=s.w.EMPTY)),t}refCount(){return(0,o.x)()(this)}}const l=(()=>{const t=a.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class c extends r.Yc{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}},653:(t,e,n)=>{"use strict";n.d(e,{E:()=>i,c:()=>s});var r=n(8318);const i=new r.y(t=>t.complete());function s(t){return t?function(t){return new r.y(e=>t.schedule(()=>e.complete()))}(t):i}},9764:(t,e,n)=>{"use strict";n.d(e,{D:()=>h});var r=n(8318),i=n(6015),s=n(7570),o=n(6197),a=n(2570),l=n(5686),c=n(5168),u=n(9653);function h(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[o.L]}(t))return function(t,e){return new r.y(n=>{const r=new s.w;return r.add(e.schedule(()=>{const i=t[o.L]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if((0,c.t)(t))return function(t,e){return new r.y(n=>{const r=new s.w;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if((0,u.z)(t))return(0,a.r)(t,e);if(function(t){return t&&"function"==typeof t[l.hZ]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new r.y(n=>{const r=new s.w;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[l.hZ](),r.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())}))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof r.y?t:new r.y((0,i.s)(t))}},9342:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var r=n(8318),i=n(625),s=n(2570);function o(t,e){return e?(0,s.r)(t,e):new r.y((0,i.V)(t))}},1906:(t,e,n)=>{"use strict";n.d(e,{T:()=>a});var r=n(8318),i=n(6163),s=n(7471),o=n(9342);function a(...t){let e=Number.POSITIVE_INFINITY,n=null,a=t[t.length-1];return(0,i.K)(a)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof a&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof r.y?t[0]:(0,s.J)(e)((0,o.n)(t,n))}},878:(t,e,n)=>{"use strict";n.d(e,{of:()=>o});var r=n(6163),i=n(9342),s=n(2570);function o(...t){let e=t[t.length-1];return(0,r.K)(e)?(t.pop(),(0,s.r)(t,e)):(0,i.n)(t)}},1225:(t,e,n)=>{"use strict";n.d(e,{_:()=>i});var r=n(8318);function i(t,e){return new r.y(e?n=>e.schedule(s,0,{error:t,subscriber:n}):e=>e.error(t))}function s({error:t,subscriber:e}){e.error(t)}},7727:(t,e,n)=>{"use strict";n.d(e,{K:()=>i});var r=n(6882);function i(t){return function(e){const n=new s(t),r=e.lift(n);return n.caught=r}}class s{constructor(t){this.selector=t}call(t,e){return e.subscribe(new o(t,this.selector,this.caught))}}class o extends r.Ds{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const i=new r.IY(this);this.add(i);const s=(0,r.ft)(n,i);s!==i&&this.add(s)}}}},436:(t,e,n)=>{"use strict";n.d(e,{b:()=>i});var r=n(3982);function i(t,e){return(0,r.zg)(t,e,1)}},7701:(t,e,n)=>{"use strict";n.d(e,{b:()=>s});var r=n(6673),i=n(8569);function s(t,e=i.P){return n=>n.lift(new o(t,e))}class o{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new a(t,this.dueTime,this.scheduler))}}class a extends r.L{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(l,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function l(t){t.debouncedNext()}},3835:(t,e,n)=>{"use strict";n.d(e,{h:()=>i});var r=n(6673);function i(t,e){return function(n){return n.lift(new s(t,e))}}class s{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new o(t,this.predicate,this.thisArg))}}class o extends r.L{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}},9996:(t,e,n)=>{"use strict";n.d(e,{U:()=>i});var r=n(6673);function i(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new s(t,e))}}class s{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new o(t,this.project,this.thisArg))}}class o extends r.L{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}},7471:(t,e,n)=>{"use strict";n.d(e,{J:()=>s});var r=n(3982),i=n(3392);function s(t=Number.POSITIVE_INFINITY){return(0,r.zg)(i.y,t)}},3982:(t,e,n)=>{"use strict";n.d(e,{zg:()=>o});var r=n(9996),i=n(9764),s=n(6882);function o(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?s=>s.pipe(o((n,s)=>(0,i.D)(t(n,s)).pipe((0,r.U)((t,r)=>e(n,t,s,r))),n)):("number"==typeof e&&(n=e),e=>e.lift(new a(t,n)))}class a{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new l(t,this.project,this.concurrent))}}class l extends s.Ds{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e)}_innerSub(t){const e=new s.IY(this),n=this.destination;n.add(e);const r=(0,s.ft)(t,e);r!==e&&n.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},9971:(t,e,n)=>{"use strict";n.d(e,{ht:()=>u,QV:()=>l});var r=n(6673),i=n(653),s=n(878),o=n(1225);let a=(()=>{class t{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return(0,s.of)(this.value);case"E":return(0,o._)(this.error);case"C":return(0,i.c)()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();function l(t,e=0){return function(n){return n.lift(new c(t,e))}}class c{constructor(t,e=0){this.scheduler=t,this.delay=e}call(t,e){return e.subscribe(new u(t,this.scheduler,this.delay))}}class u extends r.L{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(u.dispatch,this.delay,new h(t,this.destination)))}_next(t){this.scheduleMessage(a.createNext(t))}_error(t){this.scheduleMessage(a.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(a.createComplete()),this.unsubscribe()}}class h{constructor(t,e){this.notification=t,this.destination=e}}},1564:(t,e,n)=>{"use strict";n.d(e,{x:()=>i});var r=n(6673);function i(){return function(t){return t.lift(new s(t))}}class s{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new o(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class o extends r.L{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}},2023:(t,e,n)=>{"use strict";n.d(e,{R:()=>i});var r=n(6673);function i(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new s(t,e,n))}}class s{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new o(t,this.accumulator,this.seed,this.hasSeed))}}class o extends r.L{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}},1055:(t,e,n)=>{"use strict";n.d(e,{B:()=>a});var r=n(2875),i=n(1564),s=n(5959);function o(){return new s.xQ}function a(){return t=>{return(0,i.x)()((e=o,function(t){let n;n="function"==typeof e?e:function(){return e};const i=Object.create(t,r.N);return i.source=t,i.subjectFactory=n,i})(t));var e}}},4698:(t,e,n)=>{"use strict";n.d(e,{T:()=>i});var r=n(6673);function i(t){return e=>e.lift(new s(t))}class s{constructor(t){this.total=t}call(t,e){return e.subscribe(new o(t,this.total))}}class o extends r.L{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){++this.count>this.total&&this.destination.next(t)}}},4689:(t,e,n)=>{"use strict";n.d(e,{w:()=>o});var r=n(9996),i=n(9764),s=n(6882);function o(t,e){return"function"==typeof e?n=>n.pipe(o((n,s)=>(0,i.D)(t(n,s)).pipe((0,r.U)((t,r)=>e(n,t,s,r))))):e=>e.lift(new a(t))}class a{constructor(t){this.project=t}call(t,e){return e.subscribe(new l(t,this.project))}}class l extends s.Ds{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new s.IY(this),r=this.destination;r.add(n),this.innerSubscription=(0,s.ft)(t,n),this.innerSubscription!==n&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}},611:(t,e,n)=>{"use strict";n.d(e,{q:()=>o});var r=n(6673),i=n(8402),s=n(653);function o(t){return e=>0===t?(0,s.c)():e.lift(new a(t))}class a{constructor(t){if(this.total=t,this.total<0)throw new i.W}call(t,e){return e.subscribe(new l(t,this.total))}}class l extends r.L{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}},5416:(t,e,n)=>{"use strict";n.d(e,{R:()=>i});var r=n(6882);function i(t){return e=>e.lift(new s(t))}class s{constructor(t){this.notifier=t}call(t,e){const n=new o(t),i=(0,r.ft)(this.notifier,new r.IY(n));return i&&!n.seenValue?(n.add(i),e.subscribe(n)):n}}class o extends r.Ds{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}},2707:(t,e,n)=>{"use strict";n.d(e,{V:()=>c});var r=n(8569);const i=(()=>{function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t})();var s=n(6882);class o{constructor(t,e,n,r){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=r}call(t,e){return e.subscribe(new a(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}class a extends s.Ds{constructor(t,e,n,r,i){super(t),this.absoluteTimeout=e,this.waitFor=n,this.withObservable=r,this.scheduler=i,this.scheduleTimeout()}static dispatchTimeout(t){const{withObservable:e}=t;t._unsubscribeAndRecycle(),t.add((0,s.ft)(e,new s.IY(t)))}scheduleTimeout(){const{action:t}=this;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(a.dispatchTimeout,this.waitFor,this))}_next(t){this.absoluteTimeout||this.scheduleTimeout(),super._next(t)}_unsubscribe(){this.action=void 0,this.scheduler=null,this.withObservable=null}}var l=n(1225);function c(t,e=r.P){return function(t,e,n=r.P){return r=>{let i=(s=t)instanceof Date&&!isNaN(+s);var s;let a=i?+t-n.now():Math.abs(t);return r.lift(new o(a,i,e,n))}}(t,(0,l._)(new i),e)}},2728:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});var r=n(9829),i=n(7e3);function s(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new o(t,n))}}class o{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new a(t,this.observables,this.project))}}class a extends r.L{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const r=e.length;this.values=new Array(r);for(let i=0;i<r;i++)this.toRespond.push(i);for(let s=0;s<r;s++)this.add((0,i.D)(this,e[s],void 0,s))}notifyNext(t,e,n){this.values[n]=e;const r=this.toRespond;if(r.length>0){const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}},2570:(t,e,n)=>{"use strict";n.d(e,{r:()=>s});var r=n(8318),i=n(7570);function s(t,e){return new r.y(n=>{const r=new i.w;let s=0;return r.add(e.schedule(function(){s!==t.length?(n.next(t[s++]),n.closed||r.add(this.schedule())):n.complete()})),r})}},8277:(t,e,n)=>{"use strict";n.d(e,{o:()=>s});var r=n(7570);class i extends r.w{constructor(t,e){super()}schedule(t,e=0){return this}}class s extends i{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n,r=!1;try{this.work(t)}catch(i){r=!0,n=!!i&&i||new Error(i)}if(r)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}},1098:(t,e,n)=>{"use strict";n.d(e,{v:()=>i});let r=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class i extends r{constructor(t,e=r.now){super(t,()=>i.delegate&&i.delegate!==this?i.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return i.delegate&&i.delegate!==this?i.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}},8569:(t,e,n)=>{"use strict";n.d(e,{P:()=>i});var r=n(8277);const i=new(n(1098).v)(r.o)},8489:(t,e,n)=>{"use strict";n.d(e,{c:()=>l,N:()=>a});var r=n(8277);class i extends r.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}var s=n(1098);class o extends s.v{}const a=new o(i),l=a},5686:(t,e,n)=>{"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(e,{hZ:()=>i});const i=r()},6197:(t,e,n)=>{"use strict";n.d(e,{L:()=>r});const r=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")()},5331:(t,e,n)=>{"use strict";n.d(e,{b:()=>r});const r=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())()},8402:(t,e,n)=>{"use strict";n.d(e,{W:()=>r});const r=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})()},3895:(t,e,n)=>{"use strict";n.d(e,{N:()=>r});const r=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})()},4294:(t,e,n)=>{"use strict";function r(t){setTimeout(()=>{throw t},0)}n.d(e,{z:()=>r})},3392:(t,e,n)=>{"use strict";function r(t){return t}n.d(e,{y:()=>r})},8470:(t,e,n)=>{"use strict";n.d(e,{k:()=>r});const r=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))()},9653:(t,e,n)=>{"use strict";n.d(e,{z:()=>r});const r=t=>t&&"number"==typeof t.length&&"function"!=typeof t},5024:(t,e,n)=>{"use strict";function r(t){return"function"==typeof t}n.d(e,{m:()=>r})},2056:(t,e,n)=>{"use strict";function r(t){return null!==t&&"object"==typeof t}n.d(e,{K:()=>r})},5168:(t,e,n)=>{"use strict";function r(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}n.d(e,{t:()=>r})},6163:(t,e,n)=>{"use strict";function r(t){return t&&"function"==typeof t.schedule}n.d(e,{K:()=>r})},6015:(t,e,n)=>{"use strict";n.d(e,{s:()=>u});var r=n(625),i=n(4294),s=n(5686),o=n(6197),a=n(9653),l=n(5168),c=n(2056);const u=t=>{if(t&&"function"==typeof t[o.L])return u=t,t=>{const e=u[o.L]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if((0,a.z)(t))return(0,r.V)(t);if((0,l.t)(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,i.z),t);if(t&&"function"==typeof t[s.hZ])return e=t,t=>{const n=e[s.hZ]();for(;;){let e;try{e=n.next()}catch(r){return t.error(r),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=(0,c.K)(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,u}},625:(t,e,n)=>{"use strict";n.d(e,{V:()=>r});const r=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}},7e3:(t,e,n)=>{"use strict";n.d(e,{D:()=>a});var r=n(6673);class i extends r.L{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var s=n(6015),o=n(8318);function a(t,e,n,r,a=new i(t,n,r)){if(!a.closed)return e instanceof o.y?e.subscribe(a):(0,s.s)(e)(a)}},8805:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Node:()=>nt,Parser:()=>j,Position:()=>I,SourceLocation:()=>N,TokContext:()=>st,Token:()=>Et,TokenType:()=>g,defaultOptions:()=>F,getLineInfo:()=>k,isIdentifierChar:()=>m,isIdentifierStart:()=>p,isNewLine:()=>A,keywordTypes:()=>b,lineBreak:()=>S,lineBreakG:()=>E,nonASCIIwhitespace:()=>T,parse:()=>Ot,parseExpressionAt:()=>Pt,tokContexts:()=>ot,tokTypes:()=>x,tokenizer:()=>Dt,version:()=>Mt});var r={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},i="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",s={5:i,"5module":i+" export import",6:i+" const class extends export import super"},o=/^in(stanceof)?$/,a="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0560-\u0588\u05d0-\u05ea\u05ef-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u0860-\u086a\u08a0-\u08b4\u08b6-\u08bd\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u09fc\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0af9\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58-\u0c5a\u0c60\u0c61\u0c80\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d54-\u0d56\u0d5f-\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e86-\u0e8a\u0e8c-\u0ea3\u0ea5\u0ea7-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f5\u13f8-\u13fd\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1878\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1c80-\u1c88\u1c90-\u1cba\u1cbd-\u1cbf\u1ce9-\u1cec\u1cee-\u1cf3\u1cf5\u1cf6\u1cfa\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2118-\u211d\u2124\u2126\u2128\u212a-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309b-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312f\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fef\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua7bf\ua7c2-\ua7c6\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua8fd\ua8fe\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab67\uab70-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",l="\u200c\u200d\xb7\u0300-\u036f\u0387\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u07fd\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08d3-\u08e1\u08e3-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u09fe\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0afa-\u0aff\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c00-\u0c04\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d00-\u0d03\u0d3b\u0d3c\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19d0-\u19da\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1ab0-\u1abd\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf4\u1cf7-\u1cf9\u1dc0-\u1df9\u1dfb-\u1dff\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69e\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c5\ua8d0-\ua8d9\ua8e0-\ua8f1\ua8ff-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\ua9e5\ua9f0-\ua9f9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b-\uaa7d\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f",c=new RegExp("["+a+"]"),u=new RegExp("["+a+l+"]");a=l=null;var h=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,477,28,11,0,9,21,155,22,13,52,76,44,33,24,27,35,30,0,12,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,0,33,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,0,161,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,270,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,754,9486,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,15,7472,3104,541],d=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,525,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,4,9,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,232,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,792487,239];function f(t,e){for(var n=65536,r=0;r<e.length;r+=2){if((n+=e[r])>t)return!1;if((n+=e[r+1])>=t)return!0}}function p(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&c.test(String.fromCharCode(t)):!1!==e&&f(t,h)))}function m(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&u.test(String.fromCharCode(t)):!1!==e&&(f(t,h)||f(t,d)))))}var g=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function y(t,e){return new g(t,{beforeExpr:!0,binop:e})}var _={beforeExpr:!0},v={startsExpr:!0},b={};function w(t,e){return void 0===e&&(e={}),e.keyword=t,b[t]=new g(t,e)}var x={num:new g("num",v),regexp:new g("regexp",v),string:new g("string",v),name:new g("name",v),eof:new g("eof"),bracketL:new g("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new g("]"),braceL:new g("{",{beforeExpr:!0,startsExpr:!0}),braceR:new g("}"),parenL:new g("(",{beforeExpr:!0,startsExpr:!0}),parenR:new g(")"),comma:new g(",",_),semi:new g(";",_),colon:new g(":",_),dot:new g("."),question:new g("?",_),arrow:new g("=>",_),template:new g("template"),invalidTemplate:new g("invalidTemplate"),ellipsis:new g("...",_),backQuote:new g("`",v),dollarBraceL:new g("${",{beforeExpr:!0,startsExpr:!0}),eq:new g("=",{beforeExpr:!0,isAssign:!0}),assign:new g("_=",{beforeExpr:!0,isAssign:!0}),incDec:new g("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new g("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:y("||",1),logicalAND:y("&&",2),bitwiseOR:y("|",3),bitwiseXOR:y("^",4),bitwiseAND:y("&",5),equality:y("==/!=/===/!==",6),relational:y("</>/<=/>=",7),bitShift:y("<</>>/>>>",8),plusMin:new g("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:y("%",10),star:y("*",10),slash:y("/",10),starstar:new g("**",{beforeExpr:!0}),_break:w("break"),_case:w("case",_),_catch:w("catch"),_continue:w("continue"),_debugger:w("debugger"),_default:w("default",_),_do:w("do",{isLoop:!0,beforeExpr:!0}),_else:w("else",_),_finally:w("finally"),_for:w("for",{isLoop:!0}),_function:w("function",v),_if:w("if"),_return:w("return",_),_switch:w("switch"),_throw:w("throw",_),_try:w("try"),_var:w("var"),_const:w("const"),_while:w("while",{isLoop:!0}),_with:w("with"),_new:w("new",{beforeExpr:!0,startsExpr:!0}),_this:w("this",v),_super:w("super",v),_class:w("class",v),_extends:w("extends",_),_export:w("export"),_import:w("import",v),_null:w("null",v),_true:w("true",v),_false:w("false",v),_in:w("in",{beforeExpr:!0,binop:7}),_instanceof:w("instanceof",{beforeExpr:!0,binop:7}),_typeof:w("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:w("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:w("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},S=/\r\n?|\n|\u2028|\u2029/,E=new RegExp(S.source,"g");function A(t,e){return 10===t||13===t||!e&&(8232===t||8233===t)}var T=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,C=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,M=Object.prototype,O=M.hasOwnProperty,P=M.toString;function D(t,e){return O.call(t,e)}var R=Array.isArray||function(t){return"[object Array]"===P.call(t)};function L(t){return new RegExp("^(?:"+t.replace(/ /g,"|")+")$")}var I=function(t,e){this.line=t,this.column=e};I.prototype.offset=function(t){return new I(this.line,this.column+t)};var N=function(t,e,n){this.start=e,this.end=n,null!==t.sourceFile&&(this.source=t.sourceFile)};function k(t,e){for(var n=1,r=0;;){E.lastIndex=r;var i=E.exec(t);if(!(i&&i.index<e))return new I(n,e-r);++n,r=i.index+i[0].length}}var F={ecmaVersion:9,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function B(t,e){return 2|(t?4:0)|(e?8:0)}var j=function(t,e,n){this.options=t=function(t){var e={};for(var n in F)e[n]=t&&D(t,n)?t[n]:F[n];if(e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),R(e.onToken)){var r=e.onToken;e.onToken=function(t){return r.push(t)}}return R(e.onComment)&&(e.onComment=function(t,e){return function(n,r,i,s,o,a){var l={type:n?"Block":"Line",value:r,start:i,end:s};t.locations&&(l.loc=new N(this,o,a)),t.ranges&&(l.range=[i,s]),e.push(l)}}(e,e.onComment)),e}(t),this.sourceFile=t.sourceFile,this.keywords=L(s[t.ecmaVersion>=6?6:"module"===t.sourceType?"5module":5]);var i="";if(!0!==t.allowReserved){for(var o=t.ecmaVersion;!(i=r[o]);o--);"module"===t.sourceType&&(i+=" await")}this.reservedWords=L(i);var a=(i?i+" ":"")+r.strict;this.reservedWordsStrict=L(a),this.reservedWordsStrictBind=L(a+" "+r.strictBind),this.input=String(e),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(S).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=x.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},U={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};j.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},U.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},U.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},U.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},U.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},U.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},U.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},j.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},j.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=this,r=0;r<t.length;r++)n=t[r](n);return n},j.parse=function(t,e){return new this(e,t).parse()},j.parseExpressionAt=function(t,e,n){var r=new this(n,t,e);return r.nextToken(),r.parseExpression()},j.tokenizer=function(t,e){return new this(e,t)},Object.defineProperties(j.prototype,U);var V=j.prototype,z=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function $(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}V.strictDirective=function(t){for(;;){C.lastIndex=t,t+=C.exec(this.input)[0].length;var e=z.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2]))return!0;C.lastIndex=t+=e[0].length,t+=C.exec(this.input)[0].length,";"===this.input[t]&&t++}},V.eat=function(t){return this.type===t&&(this.next(),!0)},V.isContextual=function(t){return this.type===x.name&&this.value===t&&!this.containsEsc},V.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},V.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},V.canInsertSemicolon=function(){return this.type===x.eof||this.type===x.braceR||S.test(this.input.slice(this.lastTokEnd,this.start))},V.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},V.semicolon=function(){this.eat(x.semi)||this.insertSemicolon()||this.unexpected()},V.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},V.expect=function(t){this.eat(t)||this.unexpected()},V.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")},V.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;n>-1&&this.raiseRecoverable(n,"Parenthesized pattern")}},V.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,r=t.doubleProto;if(!e)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")},V.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},V.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var H=j.prototype;H.parseTopLevel=function(t){var e={};for(t.body||(t.body=[]);this.type!==x.eof;){var n=this.parseStatement(null,!0,e);t.body.push(n)}if(this.inModule)for(var r=0,i=Object.keys(this.undefinedExports);r<i.length;r+=1){var s=i[r];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var G={kind:"loop"},W={kind:"switch"};H.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;C.lastIndex=this.pos;var e=C.exec(this.input),n=this.pos+e[0].length,r=this.input.charCodeAt(n);if(91===r)return!0;if(t)return!1;if(123===r)return!0;if(p(r,!0)){for(var i=n+1;m(this.input.charCodeAt(i),!0);)++i;var s=this.input.slice(n,i);if(!o.test(s))return!0}return!1},H.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;C.lastIndex=this.pos;var t=C.exec(this.input),e=this.pos+t[0].length;return!(S.test(this.input.slice(this.pos,e))||"function"!==this.input.slice(e,e+8)||e+8!==this.input.length&&m(this.input.charAt(e+8)))},H.parseStatement=function(t,e,n){var r,i=this.type,s=this.startNode();switch(this.isLet(t)&&(i=x._var,r="let"),i){case x._break:case x._continue:return this.parseBreakContinueStatement(s,i.keyword);case x._debugger:return this.parseDebuggerStatement(s);case x._do:return this.parseDoStatement(s);case x._for:return this.parseForStatement(s);case x._function:return t&&(this.strict||"if"!==t&&"label"!==t)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!t);case x._class:return t&&this.unexpected(),this.parseClass(s,!0);case x._if:return this.parseIfStatement(s);case x._return:return this.parseReturnStatement(s);case x._switch:return this.parseSwitchStatement(s);case x._throw:return this.parseThrowStatement(s);case x._try:return this.parseTryStatement(s);case x._const:case x._var:return r=r||this.value,t&&"var"!==r&&this.unexpected(),this.parseVarStatement(s,r);case x._while:return this.parseWhileStatement(s);case x._with:return this.parseWithStatement(s);case x.braceL:return this.parseBlock(!0,s);case x.semi:return this.parseEmptyStatement(s);case x._export:case x._import:if(this.options.ecmaVersion>10&&i===x._import){C.lastIndex=this.pos;var o=C.exec(this.input);if(40===this.input.charCodeAt(this.pos+o[0].length))return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===x._import?this.parseImport(s):this.parseExport(s,n);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!t);var a=this.value,l=this.parseExpression();return i===x.name&&"Identifier"===l.type&&this.eat(x.colon)?this.parseLabeledStatement(s,a,l,t):this.parseExpressionStatement(s,l)}},H.parseBreakContinueStatement=function(t,e){var n="break"===e;this.next(),this.eat(x.semi)||this.insertSemicolon()?t.label=null:this.type!==x.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if(null==t.label||i.name===t.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(t.label&&n)break}}return r===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},H.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},H.parseDoStatement=function(t){return this.next(),this.labels.push(G),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(x._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(x.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},H.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(G),this.enterScope(0),this.expect(x.parenL),this.type===x.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===x._var||this.type===x._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),(this.type===x._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===r.declarations.length?(this.options.ecmaVersion>=9&&(this.type===x._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,r)):(e>-1&&this.unexpected(e),this.parseFor(t,r))}var s=new $,o=this.parseExpression(!0,s);return this.type===x._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===x._in?e>-1&&this.unexpected(e):t.await=e>-1),this.toAssignable(o,!1,s),this.checkLVal(o),this.parseForIn(t,o)):(this.checkExpressionErrors(s,!0),e>-1&&this.unexpected(e),this.parseFor(t,o))},H.parseFunctionStatement=function(t,e,n){return this.next(),this.parseFunction(t,Z|(n?0:Y),!1,e)},H.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(x._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")},H.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(x.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},H.parseSwitchStatement=function(t){var e;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(x.braceL),this.labels.push(W),this.enterScope(0);for(var n=!1;this.type!==x.braceR;)if(this.type===x._case||this.type===x._default){var r=this.type===x._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),r?e.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,e.test=null),this.expect(x.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},H.parseThrowStatement=function(t){return this.next(),S.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var q=[];H.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===x._catch){var e=this.startNode();if(this.next(),this.eat(x.parenL)){e.param=this.parseBindingAtom();var n="Identifier"===e.param.type;this.enterScope(n?32:0),this.checkLVal(e.param,n?4:2),this.expect(x.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0);e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(x._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},H.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},H.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(G),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")},H.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")},H.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},H.parseLabeledStatement=function(t,e,n,r){for(var i=0,s=this.labels;i<s.length;i+=1)s[i].name===e&&this.raise(n.start,"Label '"+e+"' is already declared");for(var o=this.type.isLoop?"loop":this.type===x._switch?"switch":null,a=this.labels.length-1;a>=0;a--){var l=this.labels[a];if(l.statementStart!==t.start)break;l.statementStart=this.start,l.kind=o}return this.labels.push({name:e,kind:o,statementStart:this.start}),t.body=this.parseStatement(r?-1===r.indexOf("label")?r+"label":r:"label"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")},H.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},H.parseBlock=function(t,e){for(void 0===t&&(t=!0),void 0===e&&(e=this.startNode()),e.body=[],this.expect(x.braceL),t&&this.enterScope(0);!this.eat(x.braceR);){var n=this.parseStatement(null);e.body.push(n)}return t&&this.exitScope(),this.finishNode(e,"BlockStatement")},H.parseFor=function(t,e){return t.init=e,this.expect(x.semi),t.test=this.type===x.semi?null:this.parseExpression(),this.expect(x.semi),t.update=this.type===x.parenR?null:this.parseExpression(),this.expect(x.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")},H.parseForIn=function(t,e){var n=this.type===x._in;return this.next(),"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==e.kind||"Identifier"!==e.declarations[0].id.type)?this.raise(e.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===e.type&&this.raise(e.start,"Invalid left-hand side in for-loop"),t.left=e,t.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(x.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,n?"ForInStatement":"ForOfStatement")},H.parseVar=function(t,e,n){for(t.declarations=[],t.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(x.eq)?r.init=this.parseMaybeAssign(e):"const"!==n||this.type===x._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===r.id.type||e&&(this.type===x._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(x.comma))break}return t},H.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLVal(t.id,"var"===e?1:2,!1)};var Z=1,Y=2;H.parseFunction=function(t,e,n,r){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===x.star&&e&Y&&this.unexpected(),t.generator=this.eat(x.star)),this.options.ecmaVersion>=8&&(t.async=!!r),e&Z&&(t.id=4&e&&this.type!==x.name?null:this.parseIdent(),!t.id||e&Y||this.checkLVal(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?1:2:3));var i=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(B(t.async,t.generator)),e&Z||(t.id=this.type===x.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n,!1),this.yieldPos=i,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(t,e&Z?"FunctionDeclaration":"FunctionExpression")},H.parseFunctionParams=function(t){this.expect(x.parenL),t.params=this.parseBindingList(x.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},H.parseClass=function(t,e){this.next();var n=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var r=this.startNode(),i=!1;for(r.body=[],this.expect(x.braceL);!this.eat(x.braceR);){var s=this.parseClassElement(null!==t.superClass);s&&(r.body.push(s),"MethodDefinition"===s.type&&"constructor"===s.kind&&(i&&this.raise(s.start,"Duplicate constructor in the same class"),i=!0))}return t.body=this.finishNode(r,"ClassBody"),this.strict=n,this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},H.parseClassElement=function(t){var e=this;if(this.eat(x.semi))return null;var n=this.startNode(),r=function(t,r){void 0===r&&(r=!1);var i=e.start,s=e.startLoc;return!(!e.eatContextual(t)||(e.type===x.parenL||r&&e.canInsertSemicolon())&&(n.key&&e.unexpected(),n.computed=!1,n.key=e.startNodeAt(i,s),n.key.name=t,e.finishNode(n.key,"Identifier"),1))};n.kind="method",n.static=r("static");var i=this.eat(x.star),s=!1;i||(this.options.ecmaVersion>=8&&r("async",!0)?(s=!0,i=this.options.ecmaVersion>=9&&this.eat(x.star)):r("get")?n.kind="get":r("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var o=n.key,a=!1;return n.computed||n.static||!("Identifier"===o.type&&"constructor"===o.name||"Literal"===o.type&&"constructor"===o.value)?n.static&&"Identifier"===o.type&&"prototype"===o.name&&this.raise(o.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(o.start,"Constructor can't have get/set modifier"),i&&this.raise(o.start,"Constructor can't be a generator"),s&&this.raise(o.start,"Constructor can't be an async method"),n.kind="constructor",a=t),this.parseClassMethod(n,i,s,a),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},H.parseClassMethod=function(t,e,n,r){return t.value=this.parseMethod(e,n,r),this.finishNode(t,"MethodDefinition")},H.parseClassId=function(t,e){this.type===x.name?(t.id=this.parseIdent(),e&&this.checkLVal(t.id,2,!1)):(!0===e&&this.unexpected(),t.id=null)},H.parseClassSuper=function(t){t.superClass=this.eat(x._extends)?this.parseExprSubscripts():null},H.parseExport=function(t,e){if(this.next(),this.eat(x.star))return this.expectContextual("from"),this.type!==x.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(x._default)){var n;if(this.checkExport(e,"default",this.lastTokStart),this.type===x._function||(n=this.isAsyncFunction())){var r=this.startNode();this.next(),n&&this.next(),t.declaration=this.parseFunction(r,4|Z,!1,n)}else if(this.type===x._class){var i=this.startNode();t.declaration=this.parseClass(i,"nullableID")}else t.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(null),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id.name,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==x.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var s=0,o=t.specifiers;s<o.length;s+=1){var a=o[s];this.checkUnreserved(a.local),this.checkLocalExport(a.local)}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},H.checkExport=function(t,e,n){t&&(D(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)},H.checkPatternExport=function(t,e){var n=e.type;if("Identifier"===n)this.checkExport(t,e.name,e.start);else if("ObjectPattern"===n)for(var r=0,i=e.properties;r<i.length;r+=1)this.checkPatternExport(t,i[r]);else if("ArrayPattern"===n)for(var s=0,o=e.elements;s<o.length;s+=1){var a=o[s];a&&this.checkPatternExport(t,a)}else"Property"===n?this.checkPatternExport(t,e.value):"AssignmentPattern"===n?this.checkPatternExport(t,e.left):"RestElement"===n?this.checkPatternExport(t,e.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(t,e.expression)},H.checkVariableExport=function(t,e){if(t)for(var n=0,r=e;n<r.length;n+=1)this.checkPatternExport(t,r[n].id)},H.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},H.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(x.braceL);!this.eat(x.braceR);){if(n)n=!1;else if(this.expect(x.comma),this.afterTrailingComma(x.braceR))break;var r=this.startNode();r.local=this.parseIdent(!0),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,this.checkExport(t,r.exported.name,r.exported.start),e.push(this.finishNode(r,"ExportSpecifier"))}return e},H.parseImport=function(t){return this.next(),this.type===x.string?(t.specifiers=q,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===x.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},H.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===x.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,2),t.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(x.comma))return t}if(this.type===x.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,2),t.push(this.finishNode(r,"ImportNamespaceSpecifier")),t}for(this.expect(x.braceL);!this.eat(x.braceR);){if(e)e=!1;else if(this.expect(x.comma),this.afterTrailingComma(x.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,2),t.push(this.finishNode(i,"ImportSpecifier"))}return t},H.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},H.isDirectiveCandidate=function(t){return"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var J=j.prototype;J.toAssignable=function(t,e,n){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=t.properties;r<i.length;r+=1){var s=i[r];this.toAssignable(s,e),"RestElement"!==s.type||"ArrayPattern"!==s.argument.type&&"ObjectPattern"!==s.argument.type||this.raise(s.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,n);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t},J.toAssignableList=function(t,e){for(var n=t.length,r=0;r<n;r++){var i=t[r];i&&this.toAssignable(i,e)}if(n){var s=t[n-1];6===this.options.ecmaVersion&&e&&s&&"RestElement"===s.type&&"Identifier"!==s.argument.type&&this.unexpected(s.argument.start)}return t},J.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},J.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==x.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},J.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case x.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(x.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case x.braceL:return this.parseObj(!0)}return this.parseIdent()},J.parseBindingList=function(t,e,n){for(var r=[],i=!0;!this.eat(t);)if(i?i=!1:this.expect(x.comma),e&&this.type===x.comma)r.push(null);else{if(n&&this.afterTrailingComma(t))break;if(this.type===x.ellipsis){var s=this.parseRestBinding();this.parseBindingListItem(s),r.push(s),this.type===x.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}var o=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(o),r.push(o)}return r},J.parseBindingListItem=function(t){return t},J.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(x.eq))return n;var r=this.startNodeAt(t,e);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},J.checkLVal=function(t,e,n){switch(void 0===e&&(e=0),t.type){case"Identifier":2===e&&"let"===t.name&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),n&&(D(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),0!==e&&5!==e&&this.declareName(t.name,e,t.start);break;case"MemberExpression":e&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ObjectPattern":for(var r=0,i=t.properties;r<i.length;r+=1)this.checkLVal(i[r],e,n);break;case"Property":this.checkLVal(t.value,e,n);break;case"ArrayPattern":for(var s=0,o=t.elements;s<o.length;s+=1){var a=o[s];a&&this.checkLVal(a,e,n)}break;case"AssignmentPattern":this.checkLVal(t.left,e,n);break;case"RestElement":this.checkLVal(t.argument,e,n);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,n);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var K=j.prototype;K.checkPropClash=function(t,e,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===t.type||this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r,i=t.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var s=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===r&&"init"===s&&(e.proto&&(n&&n.doubleProto<0?n.doubleProto=i.start:this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),e.proto=!0);else{var o=e[r="$"+r];o?("init"===s?this.strict&&o.init||o.get||o.set:o.init||o[s])&&this.raiseRecoverable(i.start,"Redefinition of property"):o=e[r]={init:!1,get:!1,set:!1},o[s]=!0}}},K.parseExpression=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(t,e);if(this.type===x.comma){var s=this.startNodeAt(n,r);for(s.expressions=[i];this.eat(x.comma);)s.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(s,"SequenceExpression")}return i},K.parseMaybeAssign=function(t,e,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var r=!1,i=-1,s=-1,o=-1;e?(i=e.parenthesizedAssign,s=e.trailingComma,o=e.shorthandAssign,e.parenthesizedAssign=e.trailingComma=e.shorthandAssign=-1):(e=new $,r=!0);var a=this.start,l=this.startLoc;this.type!==x.parenL&&this.type!==x.name||(this.potentialArrowAt=this.start);var c=this.parseMaybeConditional(t,e);if(n&&(c=n.call(this,c,a,l)),this.type.isAssign){var u=this.startNodeAt(a,l);return u.operator=this.value,u.left=this.type===x.eq?this.toAssignable(c,!1,e):c,r||$.call(e),e.shorthandAssign=-1,this.checkLVal(c),this.next(),u.right=this.parseMaybeAssign(t),this.finishNode(u,"AssignmentExpression")}return r&&this.checkExpressionErrors(e,!0),i>-1&&(e.parenthesizedAssign=i),s>-1&&(e.trailingComma=s),o>-1&&(e.shorthandAssign=o),c},K.parseMaybeConditional=function(t,e){var n=this.start,r=this.startLoc,i=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return i;if(this.eat(x.question)){var s=this.startNodeAt(n,r);return s.test=i,s.consequent=this.parseMaybeAssign(),this.expect(x.colon),s.alternate=this.parseMaybeAssign(t),this.finishNode(s,"ConditionalExpression")}return i},K.parseExprOps=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)||i.start===n&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,n,r,-1,t)},K.parseExprOp=function(t,e,n,r,i){var s=this.type.binop;if(null!=s&&(!i||this.type!==x._in)&&s>r){var o=this.type===x.logicalOR||this.type===x.logicalAND,a=this.value;this.next();var l=this.start,c=this.startLoc,u=this.parseExprOp(this.parseMaybeUnary(null,!1),l,c,s,i),h=this.buildBinary(e,n,t,u,a,o);return this.parseExprOp(h,e,n,r,i)}return t},K.buildBinary=function(t,e,n,r,i,s){var o=this.startNodeAt(t,e);return o.left=n,o.operator=i,o.right=r,this.finishNode(o,s?"LogicalExpression":"BinaryExpression")},K.parseMaybeUnary=function(t,e){var n,r=this.start,i=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),e=!0;else if(this.type.prefix){var s=this.startNode(),o=this.type===x.incDec;s.operator=this.value,s.prefix=!0,this.next(),s.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),o?this.checkLVal(s.argument):this.strict&&"delete"===s.operator&&"Identifier"===s.argument.type?this.raiseRecoverable(s.start,"Deleting local variable in strict mode"):e=!0,n=this.finishNode(s,o?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var a=this.startNodeAt(r,i);a.operator=this.value,a.prefix=!1,a.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(a,"UpdateExpression")}}return!e&&this.eat(x.starstar)?this.buildBinary(r,i,n,this.parseMaybeUnary(null,!1),"**",!1):n},K.parseExprSubscripts=function(t){var e=this.start,n=this.startLoc,r=this.parseExprAtom(t),i="ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);if(this.checkExpressionErrors(t)||i)return r;var s=this.parseSubscripts(r,e,n);return t&&"MemberExpression"===s.type&&(t.parenthesizedAssign>=s.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=s.start&&(t.parenthesizedBind=-1)),s},K.parseSubscripts=function(t,e,n,r){for(var i=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&"async"===this.input.slice(t.start,t.end);;){var s=this.parseSubscript(t,e,n,r,i);if(s===t||"ArrowFunctionExpression"===s.type)return s;t=s}},K.parseSubscript=function(t,e,n,r,i){var s=this.eat(x.bracketL);if(s||this.eat(x.dot)){var o=this.startNodeAt(e,n);o.object=t,o.property=s?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),o.computed=!!s,s&&this.expect(x.bracketR),t=this.finishNode(o,"MemberExpression")}else if(!r&&this.eat(x.parenL)){var a=new $,l=this.yieldPos,c=this.awaitPos,u=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var h=this.parseExprList(x.parenR,this.options.ecmaVersion>=8&&"Import"!==t.type,!1,a);if(i&&!this.canInsertSemicolon()&&this.eat(x.arrow))return this.checkPatternErrors(a,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=l,this.awaitPos=c,this.awaitIdentPos=u,this.parseArrowExpression(this.startNodeAt(e,n),h,!0);this.checkExpressionErrors(a,!0),this.yieldPos=l||this.yieldPos,this.awaitPos=c||this.awaitPos,this.awaitIdentPos=u||this.awaitIdentPos;var d=this.startNodeAt(e,n);if(d.callee=t,d.arguments=h,"Import"===d.callee.type){1!==d.arguments.length&&this.raise(d.start,"import() requires exactly one argument");var f=d.arguments[0];f&&"SpreadElement"===f.type&&this.raise(f.start,"... is not allowed in import()")}t=this.finishNode(d,"CallExpression")}else if(this.type===x.backQuote){var p=this.startNodeAt(e,n);p.tag=t,p.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(p,"TaggedTemplateExpression")}return t},K.parseExprAtom=function(t){this.type===x.slash&&this.readRegexp();var e,n=this.potentialArrowAt===this.start;switch(this.type){case x._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),e=this.startNode(),this.next(),this.type!==x.parenL||this.allowDirectSuper||this.raise(e.start,"super() call outside constructor of a subclass"),this.type!==x.dot&&this.type!==x.bracketL&&this.type!==x.parenL&&this.unexpected(),this.finishNode(e,"Super");case x._this:return e=this.startNode(),this.next(),this.finishNode(e,"ThisExpression");case x.name:var r=this.start,i=this.startLoc,s=this.containsEsc,o=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!s&&"async"===o.name&&!this.canInsertSemicolon()&&this.eat(x._function))return this.parseFunction(this.startNodeAt(r,i),0,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(x.arrow))return this.parseArrowExpression(this.startNodeAt(r,i),[o],!1);if(this.options.ecmaVersion>=8&&"async"===o.name&&this.type===x.name&&!s)return o=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(x.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,i),[o],!0)}return o;case x.regexp:var a=this.value;return(e=this.parseLiteral(a.value)).regex={pattern:a.pattern,flags:a.flags},e;case x.num:case x.string:return this.parseLiteral(this.value);case x._null:case x._true:case x._false:return(e=this.startNode()).value=this.type===x._null?null:this.type===x._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case x.parenL:var l=this.start,c=this.parseParenAndDistinguishExpression(n);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(t.parenthesizedAssign=l),t.parenthesizedBind<0&&(t.parenthesizedBind=l)),c;case x.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(x.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case x.braceL:return this.parseObj(!1,t);case x._function:return e=this.startNode(),this.next(),this.parseFunction(e,0);case x._class:return this.parseClass(this.startNode(),!1);case x._new:return this.parseNew();case x.backQuote:return this.parseTemplate();case x._import:return this.options.ecmaVersion>10?this.parseDynamicImport():this.unexpected();default:this.unexpected()}},K.parseDynamicImport=function(){var t=this.startNode();return this.next(),this.type!==x.parenL&&this.unexpected(),this.finishNode(t,"Import")},K.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1)),this.next(),this.finishNode(e,"Literal")},K.parseParenExpression=function(){this.expect(x.parenL);var t=this.parseExpression();return this.expect(x.parenR),t},K.parseParenAndDistinguishExpression=function(t){var e,n=this.start,r=this.startLoc,i=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var s,o=this.start,a=this.startLoc,l=[],c=!0,u=!1,h=new $,d=this.yieldPos,f=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==x.parenR;){if(c?c=!1:this.expect(x.comma),i&&this.afterTrailingComma(x.parenR,!0)){u=!0;break}if(this.type===x.ellipsis){s=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===x.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}l.push(this.parseMaybeAssign(!1,h,this.parseParenItem))}var p=this.start,m=this.startLoc;if(this.expect(x.parenR),t&&!this.canInsertSemicolon()&&this.eat(x.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=f,this.parseParenArrowList(n,r,l);l.length&&!u||this.unexpected(this.lastTokStart),s&&this.unexpected(s),this.checkExpressionErrors(h,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=f||this.awaitPos,l.length>1?((e=this.startNodeAt(o,a)).expressions=l,this.finishNodeAt(e,"SequenceExpression",p,m)):e=l[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var g=this.startNodeAt(n,r);return g.expression=e,this.finishNode(g,"ParenthesizedExpression")}return e},K.parseParenItem=function(t){return t},K.parseParenArrowList=function(t,e,n){return this.parseArrowExpression(this.startNodeAt(t,e),n)};var X=[];K.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(x.dot)){t.meta=e;var n=this.containsEsc;return t.property=this.parseIdent(!0),("target"!==t.property.name||n)&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is new.target"),this.inNonArrowFunction()||this.raiseRecoverable(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty")}var r=this.start,i=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),this.options.ecmaVersion>10&&"Import"===t.callee.type&&this.raise(t.callee.start,"Cannot use new with import(...)"),t.arguments=this.eat(x.parenL)?this.parseExprList(x.parenR,this.options.ecmaVersion>=8&&"Import"!==t.callee.type,!1):X,this.finishNode(t,"NewExpression")},K.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===x.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===x.backQuote,this.finishNode(n,"TemplateElement")},K.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:e});for(n.quasis=[r];!r.tail;)this.type===x.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(x.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(x.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")},K.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===x.name||this.type===x.num||this.type===x.string||this.type===x.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===x.star)&&!S.test(this.input.slice(this.lastTokEnd,this.start))},K.parseObj=function(t,e){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(x.braceR);){if(r)r=!1;else if(this.expect(x.comma),this.afterTrailingComma(x.braceR))break;var s=this.parseProperty(t,e);t||this.checkPropClash(s,i,e),n.properties.push(s)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},K.parseProperty=function(t,e){var n,r,i,s,o=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(x.ellipsis))return t?(o.argument=this.parseIdent(!1),this.type===x.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(o,"RestElement")):(this.type===x.parenL&&e&&(e.parenthesizedAssign<0&&(e.parenthesizedAssign=this.start),e.parenthesizedBind<0&&(e.parenthesizedBind=this.start)),o.argument=this.parseMaybeAssign(!1,e),this.type===x.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(o,"SpreadElement"));this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(t||e)&&(i=this.start,s=this.startLoc),t||(n=this.eat(x.star)));var a=this.containsEsc;return this.parsePropertyName(o),!t&&!a&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(o)?(r=!0,n=this.options.ecmaVersion>=9&&this.eat(x.star),this.parsePropertyName(o,e)):r=!1,this.parsePropertyValue(o,t,n,r,i,s,e,a),this.finishNode(o,"Property")},K.parsePropertyValue=function(t,e,n,r,i,s,o,a){(n||r)&&this.type===x.colon&&this.unexpected(),this.eat(x.colon)?(t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),t.kind="init"):this.options.ecmaVersion>=6&&this.type===x.parenL?(e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,r)):e||a||!(this.options.ecmaVersion>=5)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===x.comma||this.type===x.braceR?this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((n||r)&&this.unexpected(),this.checkUnreserved(t.key),"await"!==t.key.name||this.awaitIdentPos||(this.awaitIdentPos=i),t.kind="init",e?t.value=this.parseMaybeDefault(i,s,t.key):this.type===x.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),t.value=this.parseMaybeDefault(i,s,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected():((n||r)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1),t.value.params.length!==("get"===t.kind?0:1)?this.raiseRecoverable(t.value.start,"get"===t.kind?"getter should have no params":"setter should have exactly one param"):"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params"))},K.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(x.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(x.bracketR),t.key;t.computed=!1}return t.key=this.type===x.num||this.type===x.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},K.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},K.parseMethod=function(t,e,n){var r=this.startNode(),i=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=t),this.options.ecmaVersion>=8&&(r.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|B(e,r.generator)|(n?128:0)),this.expect(x.parenL),r.params=this.parseBindingList(x.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0),this.yieldPos=i,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(r,"FunctionExpression")},K.parseArrowExpression=function(t,e,n){var r=this.yieldPos,i=this.awaitPos,s=this.awaitIdentPos;return this.enterScope(16|B(n,!1)),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1),this.yieldPos=r,this.awaitPos=i,this.awaitIdentPos=s,this.finishNode(t,"ArrowFunctionExpression")},K.parseFunctionBody=function(t,e,n){var r=this.strict,i=!1;if(e&&this.type!==x.braceL)t.body=this.parseMaybeAssign(),t.expression=!0,this.checkParams(t,!1);else{var s=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);r&&!s||(i=this.strictDirective(this.end))&&s&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var o=this.labels;this.labels=[],i&&(this.strict=!0),this.checkParams(t,!r&&!i&&!e&&!n&&this.isSimpleParamList(t.params)),t.body=this.parseBlock(!1),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=o}this.exitScope(),this.strict&&t.id&&this.checkLVal(t.id,5),this.strict=r},K.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1)if("Identifier"!==n[e].type)return!1;return!0},K.checkParams=function(t,e){for(var n={},r=0,i=t.params;r<i.length;r+=1)this.checkLVal(i[r],1,e?null:n)},K.parseExprList=function(t,e,n,r){for(var i=[],s=!0;!this.eat(t);){if(s)s=!1;else if(this.expect(x.comma),e&&this.afterTrailingComma(t))break;var o=void 0;n&&this.type===x.comma?o=null:this.type===x.ellipsis?(o=this.parseSpread(r),r&&this.type===x.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):o=this.parseMaybeAssign(!1,r),i.push(o)}return i},K.checkUnreserved=function(t){var e=t.start,n=t.end,r=t.name;this.inGenerator&&"yield"===r&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===r&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(r)&&this.raise(e,"Unexpected keyword '"+r+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(e,n).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(r)&&(this.inAsync||"await"!==r||this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+r+"' is reserved"))},K.parseIdent=function(t,e){var n=this.startNode();return this.type===x.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(),this.finishNode(n,"Identifier"),t||(this.checkUnreserved(n),"await"!==n.name||this.awaitIdentPos||(this.awaitIdentPos=n.start)),n},K.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===x.semi||this.canInsertSemicolon()||this.type!==x.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(x.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")},K.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0),this.finishNode(t,"AwaitExpression")};var Q=j.prototype;Q.raise=function(t,e){var n=k(this.input,t),r=new SyntaxError(e+=" ("+n.line+":"+n.column+")");throw r.pos=t,r.loc=n,r.raisedAt=this.pos,r},Q.raiseRecoverable=Q.raise,Q.curPosition=function(){if(this.options.locations)return new I(this.curLine,this.pos-this.lineStart)};var tt=j.prototype,et=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};tt.enterScope=function(t){this.scopeStack.push(new et(t))},tt.exitScope=function(){this.scopeStack.pop()},tt.treatFunctionsAsVarInScope=function(t){return 2&t.flags||!this.inModule&&1&t.flags},tt.declareName=function(t,e,n){var r=!1;if(2===e){var i=this.currentScope();r=i.lexical.indexOf(t)>-1||i.functions.indexOf(t)>-1||i.var.indexOf(t)>-1,i.lexical.push(t),this.inModule&&1&i.flags&&delete this.undefinedExports[t]}else if(4===e)this.currentScope().lexical.push(t);else if(3===e){var s=this.currentScope();r=this.treatFunctionsAsVar?s.lexical.indexOf(t)>-1:s.lexical.indexOf(t)>-1||s.var.indexOf(t)>-1,s.functions.push(t)}else for(var o=this.scopeStack.length-1;o>=0;--o){var a=this.scopeStack[o];if(a.lexical.indexOf(t)>-1&&!(32&a.flags&&a.lexical[0]===t)||!this.treatFunctionsAsVarInScope(a)&&a.functions.indexOf(t)>-1){r=!0;break}if(a.var.push(t),this.inModule&&1&a.flags&&delete this.undefinedExports[t],3&a.flags)break}r&&this.raiseRecoverable(n,"Identifier '"+t+"' has already been declared")},tt.checkLocalExport=function(t){-1===this.scopeStack[0].lexical.indexOf(t.name)&&-1===this.scopeStack[0].var.indexOf(t.name)&&(this.undefinedExports[t.name]=t)},tt.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},tt.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags)return e}},tt.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(3&e.flags&&!(16&e.flags))return e}};var nt=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new N(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},rt=j.prototype;function it(t,e,n,r){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=r),this.options.ranges&&(t.range[1]=n),t}rt.startNode=function(){return new nt(this,this.start,this.startLoc)},rt.startNodeAt=function(t,e){return new nt(this,t,e)},rt.finishNode=function(t,e){return it.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},rt.finishNodeAt=function(t,e,n,r){return it.call(this,t,e,n,r)};var st=function(t,e,n,r,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=r,this.generator=!!i},ot={b_stat:new st("{",!1),b_expr:new st("{",!0),b_tmpl:new st("${",!1),p_stat:new st("(",!1),p_expr:new st("(",!0),q_tmpl:new st("`",!0,!0,function(t){return t.tryReadTemplateToken()}),f_stat:new st("function",!1),f_expr:new st("function",!0),f_expr_gen:new st("function",!0,!1,null,!0),f_gen:new st("function",!1,!1,null,!0)},at=j.prototype;at.initialContext=function(){return[ot.b_stat]},at.braceIsBlock=function(t){var e=this.curContext();return e===ot.f_expr||e===ot.f_stat||(t!==x.colon||e!==ot.b_stat&&e!==ot.b_expr?t===x._return||t===x.name&&this.exprAllowed?S.test(this.input.slice(this.lastTokEnd,this.start)):t===x._else||t===x.semi||t===x.eof||t===x.parenR||t===x.arrow||(t===x.braceL?e===ot.b_stat:t!==x._var&&t!==x._const&&t!==x.name&&!this.exprAllowed):!e.isExpr)},at.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},at.updateContext=function(t){var e,n=this.type;n.keyword&&t===x.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},x.parenR.updateContext=x.braceR.updateContext=function(){if(1!==this.context.length){var t=this.context.pop();t===ot.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr}else this.exprAllowed=!0},x.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?ot.b_stat:ot.b_expr),this.exprAllowed=!0},x.dollarBraceL.updateContext=function(){this.context.push(ot.b_tmpl),this.exprAllowed=!0},x.parenL.updateContext=function(t){this.context.push(t===x._if||t===x._for||t===x._with||t===x._while?ot.p_stat:ot.p_expr),this.exprAllowed=!0},x.incDec.updateContext=function(){},x._function.updateContext=x._class.updateContext=function(t){!t.beforeExpr||t===x.semi||t===x._else||t===x._return&&S.test(this.input.slice(this.lastTokEnd,this.start))||(t===x.colon||t===x.braceL)&&this.curContext()===ot.b_stat?this.context.push(ot.f_stat):this.context.push(ot.f_expr),this.exprAllowed=!1},x.backQuote.updateContext=function(){this.curContext()===ot.q_tmpl?this.context.pop():this.context.push(ot.q_tmpl),this.exprAllowed=!1},x.star.updateContext=function(t){if(t===x._function){var e=this.context.length-1;this.context[e]=this.context[e]===ot.f_expr?ot.f_expr_gen:ot.f_gen}this.exprAllowed=!0},x.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==x.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var lt={9:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",10:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic",11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},ct="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ut={9:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",10:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},ht={};function dt(t){var e=ht[t]={binary:L(lt[t]+" "+ct),nonBinary:{General_Category:L(ct),Script:L(ut[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}dt(9),dt(10),dt(11);var ft=j.prototype,pt=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":""),this.unicodeProperties=ht[t.options.ecmaVersion>=11?11:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function mt(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function gt(t){return 36===t||t>=40&&t<=43||46===t||63===t||t>=91&&t<=94||t>=123&&t<=125}function yt(t){return t>=65&&t<=90||t>=97&&t<=122}function _t(t){return yt(t)||95===t}function vt(t){return _t(t)||bt(t)}function bt(t){return t>=48&&t<=57}function wt(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function xt(t){return t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:t-48}function St(t){return t>=48&&t<=55}pt.prototype.reset=function(t,e,n){var r=-1!==n.indexOf("u");this.start=0|t,this.source=e+"",this.flags=n,this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchN=r&&this.parser.options.ecmaVersion>=9},pt.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},pt.prototype.at=function(t){var e=this.source,n=e.length;if(t>=n)return-1;var r=e.charCodeAt(t);if(!this.switchU||r<=55295||r>=57344||t+1>=n)return r;var i=e.charCodeAt(t+1);return i>=56320&&i<=57343?(r<<10)+i-56613888:r},pt.prototype.nextIndex=function(t){var e=this.source,n=e.length;if(t>=n)return n;var r,i=e.charCodeAt(t);return!this.switchU||i<=55295||i>=57344||t+1>=n||(r=e.charCodeAt(t+1))<56320||r>57343?t+1:t+2},pt.prototype.current=function(){return this.at(this.pos)},pt.prototype.lookahead=function(){return this.at(this.nextIndex(this.pos))},pt.prototype.advance=function(){this.pos=this.nextIndex(this.pos)},pt.prototype.eat=function(t){return this.current()===t&&(this.advance(),!0)},ft.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,r=0;r<n.length;r++){var i=n.charAt(r);-1===e.indexOf(i)&&this.raise(t.start,"Invalid regular expression flag"),n.indexOf(i,r+1)>-1&&this.raise(t.start,"Duplicate regular expression flag")}},ft.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))},ft.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1)-1===t.groupNames.indexOf(n[e])&&t.raise("Invalid named capture referenced")},ft.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},ft.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},ft.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):!!(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},ft.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1},ft.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},ft.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},ft.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(i=t.lastIntValue),t.eat(125)))return-1!==i&&i<r&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1},ft.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},ft.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},ft.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},ft.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},ft.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},ft.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},ft.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!gt(e)&&(t.lastIntValue=e,t.advance(),!0)},ft.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;-1!==(n=t.current())&&!gt(n);)t.advance();return t.pos!==e},ft.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return!(-1===e||36===e||e>=40&&e<=43||46===e||63===e||91===e||94===e||124===e||(t.advance(),0))},ft.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t))return-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),void t.groupNames.push(t.lastStringValue);t.raise("Invalid group")}},ft.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},ft.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=mt(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=mt(t.lastIntValue);return!0}return!1},ft.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,n=t.current();return t.advance(),92===n&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(n=t.lastIntValue),function(t){return p(t,!0)||36===t||95===t}(n)?(t.lastIntValue=n,!0):(t.pos=e,!1)},ft.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,n=t.current();return t.advance(),92===n&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(n=t.lastIntValue),function(t){return m(t,!0)||36===t||95===t||8204===t||8205===t}(n)?(t.lastIntValue=n,!0):(t.pos=e,!1)},ft.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},ft.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1},ft.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},ft.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},ft.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},ft.regexp_eatZero=function(t){return 48===t.current()&&!bt(t.lookahead())&&(t.lastIntValue=0,t.advance(),!0)},ft.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},ft.regexp_eatControlLetter=function(t){var e=t.current();return!!yt(e)&&(t.lastIntValue=e%32,t.advance(),!0)},ft.regexp_eatRegExpUnicodeEscapeSequence=function(t){var e,n=t.pos;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var r=t.lastIntValue;if(t.switchU&&r>=55296&&r<=56319){var i=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var s=t.lastIntValue;if(s>=56320&&s<=57343)return t.lastIntValue=1024*(r-55296)+(s-56320)+65536,!0}t.pos=i,t.lastIntValue=r}return!0}if(t.switchU&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&(e=t.lastIntValue)>=0&&e<=1114111)return!0;t.switchU&&t.raise("Invalid unicode escape"),t.pos=n}return!1},ft.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return!(99===e||t.switchN&&107===e||(t.lastIntValue=e,t.advance(),0))},ft.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do{t.lastIntValue=10*t.lastIntValue+(e-48),t.advance()}while((e=t.current())>=48&&e<=57);return!0}return!1},ft.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(function(t){return 100===t||68===t||115===t||83===t||119===t||87===t}(e))return t.lastIntValue=-1,t.advance(),!0;if(t.switchU&&this.options.ecmaVersion>=9&&(80===e||112===e)){if(t.lastIntValue=-1,t.advance(),t.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(t)&&t.eat(125))return!0;t.raise("Invalid property name")}return!1},ft.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t))return this.regexp_validateUnicodePropertyNameAndValue(t,n,t.lastStringValue),!0}return t.pos=e,!!this.regexp_eatLoneUnicodePropertyNameOrValue(t)&&(this.regexp_validateUnicodePropertyNameOrValue(t,t.lastStringValue),!0)},ft.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){D(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(n)||t.raise("Invalid property value")},ft.regexp_validateUnicodePropertyNameOrValue=function(t,e){t.unicodeProperties.binary.test(e)||t.raise("Invalid property name")},ft.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";_t(e=t.current());)t.lastStringValue+=mt(e),t.advance();return""!==t.lastStringValue},ft.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";vt(e=t.current());)t.lastStringValue+=mt(e),t.advance();return""!==t.lastStringValue},ft.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},ft.regexp_eatCharacterClass=function(t){if(t.eat(91)){if(t.eat(94),this.regexp_classRanges(t),t.eat(93))return!0;t.raise("Unterminated character class")}return!1},ft.regexp_classRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;!t.switchU||-1!==e&&-1!==n||t.raise("Invalid character class"),-1!==e&&-1!==n&&e>n&&t.raise("Range out of order in character class")}}},ft.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(99===n||St(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var r=t.current();return 93!==r&&(t.lastIntValue=r,t.advance(),!0)},ft.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},ft.regexp_eatClassControlLetter=function(t){var e=t.current();return!(!bt(e)&&95!==e||(t.lastIntValue=e%32,t.advance(),0))},ft.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},ft.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;bt(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e},ft.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;wt(n=t.current());)t.lastIntValue=16*t.lastIntValue+xt(n),t.advance();return t.pos!==e},ft.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;t.lastIntValue=e<=3&&this.regexp_eatOctalDigit(t)?64*e+8*n+t.lastIntValue:8*e+n}else t.lastIntValue=e;return!0}return!1},ft.regexp_eatOctalDigit=function(t){var e=t.current();return St(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},ft.regexp_eatFixedHexDigits=function(t,e){var n=t.pos;t.lastIntValue=0;for(var r=0;r<e;++r){var i=t.current();if(!wt(i))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+xt(i),t.advance()}return!0};var Et=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new N(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},At=j.prototype;function Tt(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}At.next=function(){this.options.onToken&&this.options.onToken(new Et(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},At.getToken=function(){return this.next(),new Et(this)},"undefined"!=typeof Symbol&&(At[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===x.eof,value:e}}}}),At.curContext=function(){return this.context[this.context.length-1]},At.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(x.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},At.readToken=function(t){return p(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},At.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);return t<=55295||t>=57344?t:(t<<10)+this.input.charCodeAt(this.pos+1)-56613888},At.skipBlockComment=function(){var t,e=this.options.onComment&&this.curPosition(),n=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(-1===r&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(E.lastIndex=n;(t=E.exec(this.input))&&t.index<this.pos;)++this.curLine,this.lineStart=t.index+t[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,r),n,this.pos,e,this.curPosition())},At.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!A(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())},At.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&T.test(String.fromCharCode(t))))break t;++this.pos}}},At.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)},At.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(x.ellipsis)):(++this.pos,this.finishToken(x.dot))},At.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(x.assign,2):this.finishOp(x.slash,1)},At.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,r=42===t?x.star:x.modulo;return this.options.ecmaVersion>=7&&42===t&&42===e&&(++n,r=x.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(x.assign,n+1):this.finishOp(r,n)},At.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?x.logicalOR:x.logicalAND,2):61===e?this.finishOp(x.assign,2):this.finishOp(124===t?x.bitwiseOR:x.bitwiseAND,1)},At.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(x.assign,2):this.finishOp(x.bitwiseXOR,1)},At.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45!==e||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!S.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(x.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===e?this.finishOp(x.assign,2):this.finishOp(x.plusMin,1)},At.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(x.assign,n+1):this.finishOp(x.bitShift,n)):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(n=2),this.finishOp(x.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},At.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(x.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(x.arrow)):this.finishOp(61===t?x.eq:x.prefix,1)},At.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(x.parenL);case 41:return++this.pos,this.finishToken(x.parenR);case 59:return++this.pos,this.finishToken(x.semi);case 44:return++this.pos,this.finishToken(x.comma);case 91:return++this.pos,this.finishToken(x.bracketL);case 93:return++this.pos,this.finishToken(x.bracketR);case 123:return++this.pos,this.finishToken(x.braceL);case 125:return++this.pos,this.finishToken(x.braceR);case 58:return++this.pos,this.finishToken(x.colon);case 63:return++this.pos,this.finishToken(x.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(x.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(x.prefix,1)}this.raise(this.pos,"Unexpected character '"+Tt(t)+"'")},At.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)},At.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(S.test(r)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===r)e=!0;else if("]"===r&&e)e=!1;else if("/"===r&&!e)break;t="\\"===r}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var s=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(s);var a=this.regexpState||(this.regexpState=new pt(this));a.reset(n,i,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(i,o)}catch(c){}return this.finishToken(x.regexp,{pattern:i,flags:o,value:l})},At.readInt=function(t,e){for(var n=this.pos,r=0,i=0,s=null==e?1/0:e;i<s;++i){var o,a=this.input.charCodeAt(this.pos);if((o=a>=97?a-97+10:a>=65?a-65+10:a>=48&&a<=57?a-48:1/0)>=t)break;++this.pos,r=r*t+o}return this.pos===n||null!=e&&this.pos-n!==e?null:r},At.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var n=this.readInt(t);return null==n&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n="undefined"!=typeof BigInt?BigInt(this.input.slice(e,this.pos)):null,++this.pos):p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(x.num,n)},At.readNumber=function(t){var e=this.pos;t||null!==this.readInt(10)||this.raise(e,"Invalid number");var n=this.pos-e>=2&&48===this.input.charCodeAt(e);n&&this.strict&&this.raise(e,"Invalid number"),n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1);var r=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&110===r){var i=this.input.slice(e,this.pos),s="undefined"!=typeof BigInt?BigInt(i):null;return++this.pos,p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(x.num,s)}46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||(43!==(r=this.input.charCodeAt(++this.pos))&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number")),p(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o=this.input.slice(e,this.pos),a=n?parseInt(o,8):parseFloat(o);return this.finishToken(x.num,a)},At.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},At.readString=function(t){for(var e="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===t)break;92===r?(e+=this.input.slice(n,this.pos),e+=this.readEscapedChar(!1),n=this.pos):(A(r,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(n,this.pos++),this.finishToken(x.string,e)};var Ct={};At.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==Ct)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},At.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Ct;this.raise(t,e)},At.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==x.template&&this.type!==x.invalidTemplate?(t+=this.input.slice(e,this.pos),this.finishToken(x.template,t)):36===n?(this.pos+=2,this.finishToken(x.dollarBraceL)):(++this.pos,this.finishToken(x.backQuote));if(92===n)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(A(n)){switch(t+=this.input.slice(e,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},At.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(x.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},At.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Tt(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(e>=48&&e<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(n,8);return r>255&&(n=n.slice(0,-1),r=parseInt(n,8)),this.pos+=n.length-1,e=this.input.charCodeAt(this.pos),"0"===n&&56!==e&&57!==e||!this.strict&&!t||this.invalidStringToken(this.pos-1-n.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return A(e)?"":String.fromCharCode(e)}},At.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return null===n&&this.invalidStringToken(e,"Bad character escape sequence"),n},At.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(m(i,r))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,t+=this.input.slice(n,this.pos);var s=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(e?p:m)(o,r)||this.invalidStringToken(s,"Invalid Unicode escape"),t+=Tt(o),n=this.pos}e=!1}return t+this.input.slice(n,this.pos)},At.readWord=function(){var t=this.readWord1(),e=x.name;return this.keywords.test(t)&&(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+t),e=b[t]),this.finishToken(e,t)};var Mt="6.4.2";function Ot(t,e){return j.parse(t,e)}function Pt(t,e,n){return j.parseExpressionAt(t,e,n)}function Dt(t,e){return j.tokenizer(t,e)}j.acorn={Parser:j,version:Mt,defaultOptions:F,Position:I,SourceLocation:N,getLineInfo:k,Node:nt,TokenType:g,tokTypes:x,keywordTypes:b,TokContext:st,tokContexts:ot,isIdentifierChar:m,isIdentifierStart:p,Token:Et,isNewLine:A,lineBreak:S,lineBreakG:E,nonASCIIwhitespace:T}},858:()=>{},4158:()=>{}},t=>{"use strict";t(t.s=3089)}]);