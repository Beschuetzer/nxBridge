<section class="ui form">
  <div class="{{ FILTER_MANANGER_CLASSNAME }}__header">
    <h2 class="ui header">Filters</h2>
    <button
      class="{{
        FILTER_MANANGER_CLASSNAME
      }}__reset ui button color-white bg-color-red  margin-0"
      type="button"
      (click)="onReset()"
    >
      Reset
    </button>
    <button
      class="{{
        FILTER_MANANGER_CLASSNAME
      }}__hide ui button color-white bg-color-1  margin-0"
      type="button"
      (click)="onHide()"
    >
      Hide
    </button>
  </div>
  <div #applied class="filter-manager__applied ui field">
    <nx-bridge-filter-manager-item
      *ngFor="let filterItem of filterItems | keyvalue; let i = index"
      [filterItem]="filterItem.value"
      [filterItemKey]="filterItem.key"
      [indexOfItem]="i"
      (deletion)="onFilterItemDeletion($event)"
    ></nx-bridge-filter-manager-item>
  </div>

  <!-- main checkboxes -->
  <div class="{{ FILTER_MANANGER_CLASSNAME }}__options field">
    <label>
      <input #date (click)="onDateClick($event)" type="checkbox" />
      Date
    </label>
    <label>
      <input #deal (click)="onDealClick($event)" type="checkbox" />
      Deal
    </label>
    <label>
      <input #game (click)="onGameClick($event)" type="checkbox" />
      Game
    </label>
  </div>

  <div class="{{ FILTER_MANANGER_CLASSNAME }}__details">
    <!-- sub-checkboxes -->
    <div
      class="{{ FILTER_MANANGER_CLASSNAME }}__details-deal"
      *ngIf="deal.checked"
    >
      <label>
        <input
          #playerHasCard
          (click)="onPlayerHasCardClick()"
          type="checkbox"
        />
        Player had a specific card
      </label>
      <label>
        <input #contract (click)="onContractClick()" type="checkbox" />
        Contract was ...
      </label>
      <label>
        <input #declarer (click)="onDeclarerClick()" type="checkbox" />
        Declarer was ...
      </label>
      <label>
        <input #openingBid (click)="onOpeningBidClick()" type="checkbox" />
        Opening bid was ...
      </label>
      <label>
        <input #double (click)="onDoubleClick()" type="checkbox" /> Deal was
        doubled ...
      </label>
    </div>
    <div
      class="{{ FILTER_MANANGER_CLASSNAME }}__details-game"
      *ngIf="game.checked"
    >
      <label>
        <input #gameName (click)="onGameNameClick()" type="checkbox" />
        Game was named ...
      </label>
      <label>
        <input #playerInGame (click)="onPlayerInGameClick()" type="checkbox" />
        Player was in game
      </label>
      <label>
        <input #wonBy (click)="onWonByClick()" type="checkbox" />
        Won by ... than ...
      </label>
    </div>

    <!-- Date-related filters -->
    <div *ngIf="date.checked" class="{{ FILTER_MANANGER_CLASSNAME }}__date">
      <label>
        Completed after:
        <input
          #afterDate
          id="afterDate"
          (change)="onDateAfterChange($event)"
          type="datetime-local"
        />
      </label>
      <label>
        Completed before:
        <input
          #beforeDate
          id="beforeDate"
          (change)="onDateBeforeChange($event)"
          type="datetime-local"
        />
      </label>
    </div>

    <!-- Deal-related filters -->
    <div
      *ngIf="
        deal.checked && playerHasCardCheckbox?.nativeElement.checked === true
      "
      class="{{ FILTER_MANANGER_CLASSNAME }}__player-has-card"
    >
      <span>Username:</span>
      <select
        #players
        (click)="onPlayerHasCardChange()"
        class="{{ joinedInputErrorClassnames }}"
      >
        <option *ngFor="let playerName of playerNames; let i = index">
          {{ playerName }}
        </option>
      </select>
      <span>&nbsp;had the&nbsp;</span>
      <select
        (click)="onPlayerHasCardChange()"
        class="{{ joinedInputErrorClassnames }}"
        #cards
        class=""
      >
        <option
          *ngFor="let cardAsNumber of cardsAsNumbers; let i = index"
          innerHTML="{{ cardAsNumber | cardAsNumberToCardHtmlEntityString }}"
          [ngClass]="{
            'color-red': i >= 14 && i <= 39,
            'color-black': i < 14 || i > 39,
            'filter-manager__player-options': true
          }"
          [value]="i - 1"
        ></option>
      </select>
      <button
        (click)="onAddPlayerHasCard($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>

    <div
      *ngIf="deal.checked && contractCheckbox?.nativeElement.checked"
      class="{{ FILTER_MANANGER_CLASSNAME }}__contract"
    >
      <span>Contract was :</span>
      <select
        (click)="onContractChange()"
        class="{{ joinedInputErrorClassnames }}"
        #contractsSelect
        class=""
      >
        <option
          *ngFor="let contract of contracts; let i = index"
          innerHTML="{{ contract | getContractAsHtmlEntityString }}"
          [class]="
            (i - 1) % 5 === 1 || (i - 1) % 5 === 2 ? 'color-red' : 'color-black'
          "
          [value]="i - 1"
        ></option>
      </select>
      <button
        (click)="onAddContract($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>

    <div
      *ngIf="deal.checked && declarerCheckbox?.nativeElement.checked"
      class="{{ FILTER_MANANGER_CLASSNAME }}__declarer"
    >
      <span>Declarer was:</span>
      <select
        #declarerSelect
        (click)="onDeclarerChange()"
        class="{{ joinedInputErrorClassnames }}"
      >
        <option *ngFor="let playerName of playerNames; let i = index">
          {{ playerName }}
        </option>
      </select>
      <button
        (click)="onAddDeclarer($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>

    <div
      *ngIf="deal.checked && openingBidCheckbox?.nativeElement.checked"
      class="{{ FILTER_MANANGER_CLASSNAME }}__opening-bid"
    >
      <span>Opening bid was :</span>
      <select
        (click)="onOpeningBidChange()"
        class="{{ joinedInputErrorClassnames }}"
        #openingBidSelect
        class=""
      >
        <option
          *ngFor="let bid of bids; let i = index"
          innerHTML="{{ bid | getContractAsHtmlEntityString }}"
          [class]="
            (i - 1) % 5 === 1 || (i - 1) % 5 === 2 ? 'color-red' : 'color-black'
          "
          [value]="i - 1"
        ></option>
      </select>
      <button
        (click)="onAddOpeningBid($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>

    <div
      *ngIf="deal.checked && doubleCheckbox?.nativeElement.checked"
      class="{{ FILTER_MANANGER_CLASSNAME }}__double"
    >
      <span>Deal was doubled:</span>
      <select
        (click)="onDoubleChange()"
        class="{{ joinedInputErrorClassnames }}"
        #doubleSelect
        class=""
      >
        <option
          *ngFor="let doubleOption of doubleOptions; let i = index"
          [value]="i * 2"
        >
          {{ doubleOption }}
        </option>
      </select>
      <button
        (click)="onAddDouble($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>

    <!-- Game-related filters -->
    <div
      *ngIf="game.checked && gameNameCheckbox?.nativeElement.checked"
      class="{{ FILTER_MANANGER_CLASSNAME }}__game-name"
    >
      <label>
        <div>Game was named:</div>
        <select
          #gameNameSelect
          (click)="onGameNameChange()"
          class="{{ joinedInputErrorClassnames }}"
        >
          <option 
            *ngFor="let gameName of gameNames; let i = index"
            [value]="gameName"
          >
            {{ gameName }}
          </option>
        </select>
      </label>
      <button
        (click)="onAddGameName($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>

    <div
      *ngIf="game.checked && playerInGameCheckbox?.nativeElement.checked"
      class="{{ FILTER_MANANGER_CLASSNAME }}__player-in-game"
    >
      <label>
        <div>Player was in game:</div>
        <select
          #playerInGameSelect
          (click)="onPlayerInGameChange()"
          class="{{ joinedInputErrorClassnames }}"
        >
          <option *ngFor="let playerName of playerNames; let i = index">
            {{ playerName }}
          </option>
        </select>
      </label>

      <button
        (click)="onAddPlayerInGame($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>

    <div
      *ngIf="game.checked && wonByCheckbox?.nativeElement.checked"
      class="{{ FILTER_MANANGER_CLASSNAME }}__won-by"
    >
      <label>
        <div>Won by:</div>
        <select #wonByType (click)="onWonByChange()" class="ui input">
          <option value="less">&#8804;</option>
          <option value="more">&#8805;</option>
        </select>
        <input
          #wonByInput
          (click)="onWonByChange()"
          type="number"
          min="0"
          max="100000"
          step="10"
          value="0"
          placeholder="Enter won by number here"
          class="ui input"
        />
      </label>
      <button
        (click)="onAddWonBy($event)"
        class="ui button filter-manager__add-button"
      >
        Add
      </button>
    </div>
  </div>
</section>
